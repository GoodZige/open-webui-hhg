import{s as Fe,l as Ae,i as A,n as we,d as _,B as cn,q as pn,e as V,t as Ie,k as ee,al as Li,c as z,a as M,b as Se,o as te,am as Ri,f as m,g as k,h as Te,P as el,N as ut,u as ke,y as We,S as $e,A as qe,j as ae,p as Ft,D as xe,r as Qt,v as xt,w as $t,x as en,Q as Dn,E as Ne,F as Pe,H as on,T as Jn,M as nl,z as jl,C as Sn,an as st,U as Yt,V as Et,W as Bn,Y as gn,J as ln,$ as me,a1 as Ol,ap as io,ao as Ui,_ as ao,aq as gt,a2 as Il,ai as Ua,ar as Wa,aj as Fa,I as us,ak as fs,R as ds,O as Ql,m as ja}from"./scheduler.CHqjxavM.js";import{S as Re,i as Ue,t as D,g as He,a as P,c as Be,j as hs,f as Je,b as ne,d as se,m as le,e as oe,h as xl}from"./index.Cjx-5OY6.js";import{g as Wi}from"./globals.D0QH3NT1.js";import{e as vt,u as bo,o as vo}from"./each.CCRIbD_e.js";import{t as nt}from"./Toaster.svelte_svelte_type_style_lang.NefCtMfx.js";import{C as Ya,D as Xa,F as Ka,a as Fi,b as Za,P as Ga}from"./FilesOverlay.BtAoMQsd.js";import{g as Po}from"./entry.BeaNDCfp.js";import{p as qa}from"./stores.DXXqgOfn.js";import{t as ul,u as Qn,c as Yl,p as ji,n as Yi,m as dl,a as Kn,i as wo,e as Hl,d as Ja,S as ms,l as yo,D as jt,V as Zn,C as Fn,W as Xi,h as cl,s as Xo,x as Qa,f as gs,T as xa,X as In,L as $a,E as il,r as ec,G as $l,B as tc,F as al,q as nc}from"./index.H8ql2Fza.js";import{a as lc,B as oc,C as sc,D as rc,E as ic,F as ac,G as so,H as _s,v as $n,n as Ki,r as cc,b as yn,I as uc,m as xo,f as co,J as fc,K as dc,L as hc,d as mc,t as Oo}from"./index.Bl8AKUxi.js";import{f as Ko,l as bl,C as gc,u as Ho,d as _c,a as pc}from"./index.DW-BGSg-.js";import{d as bc}from"./index.E8y8d-Yv.js";import{p as vc,h as wc}from"./index.Cn04g01A.js";import{M as yc,a as kc,b as Ec,T as Ic,S as Sc,P as Dc,q as Cc}from"./index.Da6Ld1YU.js";import{i as Mc,j as ps,k as bs}from"./index.Bfktbsyn.js";import{q as Tc,r as Vc,s as zc,t as Nc,v as Pc,w as Oc}from"./index.BE_TS0KQ.js";import{g as $o,j as Hc,k as Bc,l as Ac}from"./index.DEwEGwPj.js";import{f as vl}from"./index.DzgXSuqr.js";import{m as Sl,p as vs}from"./marked.esm._0_gBwjO.js";import{t as Zi,s as Lc}from"./index.NRlecBS4.js";import{u as Rc,b as Uc}from"./index.Ccbr7YXp.js";import"./updater.Bfy-25tm.js";import{D as ko,M as _n}from"./Dropdown.DGdPKWf2.js";import{b as Eo}from"./menu-trigger.OGZQyMrC.js";import{f as Xl}from"./index.BFuekP1B.js";import{T as Rt}from"./Tooltip.Ckuvvm8c.js";import{S as Wc}from"./Switch.CpkgZUVD.js";import{W as Fc}from"./WrenchSolid._7641YhQ.js";import{V as jc,R as Yc}from"./RichTextInput.BUUacnhy.js";import{g as Xc}from"./index.B3nNSgMs.js";import{g as Kc}from"./index.DwaxdADu.js";import{F as Gi}from"./fuse.CU2r43ac.js";import{d as Zc,r as Gc}from"./relativeTime.BDz4fsXT.js";import{S as Io}from"./Spinner.BnJ9ysqs.js";import{F as qi}from"./FileItem.BzjBLAVY.js";import{h as On,ba as Ji,bb as es,bc as Bo,bd as Ao,ah as qc,be as Jc,bf as Qc,af as Qi,bg as xc}from"./Markdown.Bvd8YfbN.js";import{X as So}from"./XMark.C3tTP9TD.js";import{G as $c}from"./GlobeAlt.BaAc1jp7.js";import{S as eu,E as tu,M as nu}from"./Messages.DNwopQIv.js";import{S as lu}from"./Selector.jwcFskNO.js";import{f as ou}from"./FileSaver.min.CimDdHIv.js";import{a as su}from"./index.CoLfSLos.js";import{U as ru}from"./UserMenu.CdaOfEtw.js";import{M as iu}from"./MenuLines.Dw7O2oN0.js";import{M as au}from"./Modal.BTvzYrvL.js";import{A as cu}from"./AdvancedParams.Bb4lJKrO.js";import{g as uu,j as fu,k as du,l as hu}from"./index.CqJ3SF6i.js";import{V as mu,H as gu}from"./Heart.Bw48BaKb.js";import{C as ro}from"./Collapsible.C8XZLfiq.js";import{D as _u}from"./Drawer.BoN98nC5.js";import{w as Qe,a as Pn,d as yl}from"./index.B7QGeYM_.js";import{g as tl,a as Bl}from"./spread.CgU5AtxT.js";import{E as pu}from"./EllipsisVertical.YckyQ2Xz.js";import{C as bu}from"./ConfirmDialog.BkASNw-x.js";function vu(l){let e;for(;e=l.sourceEvent;)l=e;return l}function Wn(l,e){if(l=vu(l),e===void 0&&(e=l.currentTarget),e){var t=e.ownerSVGElement||e;if(t.createSVGPoint){var n=t.createSVGPoint();return n.x=l.clientX,n.y=l.clientY,n=n.matrixTransform(e.getScreenCTM().inverse()),[n.x,n.y]}if(e.getBoundingClientRect){var o=e.getBoundingClientRect();return[l.clientX-o.left-e.clientLeft,l.clientY-o.top-e.clientTop]}}return[l.pageX,l.pageY]}const wu={passive:!1},Al={capture:!0,passive:!1};function Lo(l){l.stopImmediatePropagation()}function kl(l){l.preventDefault(),l.stopImmediatePropagation()}function xi(l){var e=l.document.documentElement,t=On(l).on("dragstart.drag",kl,Al);"onselectstart"in e?t.on("selectstart.drag",kl,Al):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function $i(l,e){var t=l.document.documentElement,n=On(l).on("dragstart.drag",null);e&&(n.on("click.drag",kl,Al),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in t?n.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}const eo=l=>()=>l;function Zo(l,{sourceEvent:e,subject:t,target:n,identifier:o,active:s,x:i,y:r,dx:a,dy:c,dispatch:u}){Object.defineProperties(this,{type:{value:l,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:r,enumerable:!0,configurable:!0},dx:{value:a,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:u}})}Zo.prototype.on=function(){var l=this._.on.apply(this._,arguments);return l===this._?this:l};function yu(l){return!l.ctrlKey&&!l.button}function ku(){return this.parentNode}function Eu(l,e){return e??{x:l.x,y:l.y}}function Iu(){return navigator.maxTouchPoints||"ontouchstart"in this}function Su(){var l=yu,e=ku,t=Eu,n=Iu,o={},s=Ji("start","drag","end"),i=0,r,a,c,u,f=0;function h(I){I.on("mousedown.drag",d).filter(n).on("touchstart.drag",v).on("touchmove.drag",g,wu).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(I,S){if(!(u||!l.call(this,I,S))){var T=y(this,e.call(this,I,S),I,S,"mouse");T&&(On(I.view).on("mousemove.drag",p,Al).on("mouseup.drag",b,Al),xi(I.view),Lo(I),c=!1,r=I.clientX,a=I.clientY,T("start",I))}}function p(I){if(kl(I),!c){var S=I.clientX-r,T=I.clientY-a;c=S*S+T*T>f}o.mouse("drag",I)}function b(I){On(I.view).on("mousemove.drag mouseup.drag",null),$i(I.view,c),kl(I),o.mouse("end",I)}function v(I,S){if(l.call(this,I,S)){var T=I.changedTouches,E=e.call(this,I,S),H=T.length,O,B;for(O=0;O<H;++O)(B=y(this,E,I,S,T[O].identifier,T[O]))&&(Lo(I),B("start",I,T[O]))}}function g(I){var S=I.changedTouches,T=S.length,E,H;for(E=0;E<T;++E)(H=o[S[E].identifier])&&(kl(I),H("drag",I,S[E]))}function w(I){var S=I.changedTouches,T=S.length,E,H;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),E=0;E<T;++E)(H=o[S[E].identifier])&&(Lo(I),H("end",I,S[E]))}function y(I,S,T,E,H,O){var B=s.copy(),j=Wn(O||T,S),Z,R,C;if((C=t.call(I,new Zo("beforestart",{sourceEvent:T,target:h,identifier:H,active:i,x:j[0],y:j[1],dx:0,dy:0,dispatch:B}),E))!=null)return Z=C.x-j[0]||0,R=C.y-j[1]||0,function Y(N,F,G){var K=j,X;switch(N){case"start":o[H]=Y,X=i++;break;case"end":delete o[H],--i;case"drag":j=Wn(G||F,S),X=i;break}B.call(N,I,new Zo(N,{sourceEvent:F,subject:C,target:h,identifier:H,active:X,x:j[0]+Z,y:j[1]+R,dx:j[0]-K[0],dy:j[1]-K[1],dispatch:B}),E)}}return h.filter=function(I){return arguments.length?(l=typeof I=="function"?I:eo(!!I),h):l},h.container=function(I){return arguments.length?(e=typeof I=="function"?I:eo(I),h):e},h.subject=function(I){return arguments.length?(t=typeof I=="function"?I:eo(I),h):t},h.touchable=function(I){return arguments.length?(n=typeof I=="function"?I:eo(!!I),h):n},h.on=function(){var I=s.on.apply(s,arguments);return I===s?h:I},h.clickDistance=function(I){return arguments.length?(f=(I=+I)*I,h):Math.sqrt(f)},h}var Du=1e-12;function ws(l){return((l=Math.exp(l))+1/l)/2}function Cu(l){return((l=Math.exp(l))-1/l)/2}function Mu(l){return((l=Math.exp(2*l))-1)/(l+1)}const Tu=function l(e,t,n){function o(s,i){var r=s[0],a=s[1],c=s[2],u=i[0],f=i[1],h=i[2],d=u-r,p=f-a,b=d*d+p*p,v,g;if(b<Du)g=Math.log(h/c)/e,v=function(E){return[r+E*d,a+E*p,c*Math.exp(e*E*g)]};else{var w=Math.sqrt(b),y=(h*h-c*c+n*b)/(2*c*t*w),I=(h*h-c*c-n*b)/(2*h*t*w),S=Math.log(Math.sqrt(y*y+1)-y),T=Math.log(Math.sqrt(I*I+1)-I);g=(T-S)/e,v=function(E){var H=E*g,O=ws(S),B=c/(t*w)*(O*Mu(e*H+S)-Cu(S));return[r+B*d,a+B*p,c*O/ws(e*H+S)]}}return v.duration=g*1e3*e/Math.SQRT2,v}return o.rho=function(s){var i=Math.max(.001,+s),r=i*i,a=r*r;return l(i,r,a)},o}(Math.SQRT2,2,4),to=l=>()=>l;function Vu(l,{sourceEvent:e,target:t,transform:n,dispatch:o}){Object.defineProperties(this,{type:{value:l,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:t,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:o}})}function Ro(l){l.stopImmediatePropagation()}function Pl(l){l.preventDefault(),l.stopImmediatePropagation()}function zu(l){return(!l.ctrlKey||l.type==="wheel")&&!l.button}function Nu(){var l=this;return l instanceof SVGElement?(l=l.ownerSVGElement||l,l.hasAttribute("viewBox")?(l=l.viewBox.baseVal,[[l.x,l.y],[l.x+l.width,l.y+l.height]]):[[0,0],[l.width.baseVal.value,l.height.baseVal.value]]):[[0,0],[l.clientWidth,l.clientHeight]]}function ys(){return this.__zoom||es}function Pu(l){return-l.deltaY*(l.deltaMode===1?.05:l.deltaMode?1:.002)*(l.ctrlKey?10:1)}function Ou(){return navigator.maxTouchPoints||"ontouchstart"in this}function Hu(l,e,t){var n=l.invertX(e[0][0])-t[0][0],o=l.invertX(e[1][0])-t[1][0],s=l.invertY(e[0][1])-t[0][1],i=l.invertY(e[1][1])-t[1][1];return l.translate(o>n?(n+o)/2:Math.min(0,n)||Math.max(0,o),i>s?(s+i)/2:Math.min(0,s)||Math.max(0,i))}function Bu(){var l=zu,e=Nu,t=Hu,n=Pu,o=Ou,s=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],r=250,a=Tu,c=Ji("start","zoom","end"),u,f,h,d=500,p=150,b=0,v=10;function g(C){C.property("__zoom",ys).on("wheel.zoom",H,{passive:!1}).on("mousedown.zoom",O).on("dblclick.zoom",B).filter(o).on("touchstart.zoom",j).on("touchmove.zoom",Z).on("touchend.zoom touchcancel.zoom",R).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}g.transform=function(C,Y,N,F){var G=C.selection?C.selection():C;G.property("__zoom",ys),C!==G?S(C,Y,N,F):G.interrupt().each(function(){T(this,arguments).event(F).start().zoom(null,typeof Y=="function"?Y.apply(this,arguments):Y).end()})},g.scaleBy=function(C,Y,N,F){g.scaleTo(C,function(){var G=this.__zoom.k,K=typeof Y=="function"?Y.apply(this,arguments):Y;return G*K},N,F)},g.scaleTo=function(C,Y,N,F){g.transform(C,function(){var G=e.apply(this,arguments),K=this.__zoom,X=N==null?I(G):typeof N=="function"?N.apply(this,arguments):N,Q=K.invert(X),U=typeof Y=="function"?Y.apply(this,arguments):Y;return t(y(w(K,U),X,Q),G,i)},N,F)},g.translateBy=function(C,Y,N,F){g.transform(C,function(){return t(this.__zoom.translate(typeof Y=="function"?Y.apply(this,arguments):Y,typeof N=="function"?N.apply(this,arguments):N),e.apply(this,arguments),i)},null,F)},g.translateTo=function(C,Y,N,F,G){g.transform(C,function(){var K=e.apply(this,arguments),X=this.__zoom,Q=F==null?I(K):typeof F=="function"?F.apply(this,arguments):F;return t(es.translate(Q[0],Q[1]).scale(X.k).translate(typeof Y=="function"?-Y.apply(this,arguments):-Y,typeof N=="function"?-N.apply(this,arguments):-N),K,i)},F,G)};function w(C,Y){return Y=Math.max(s[0],Math.min(s[1],Y)),Y===C.k?C:new Bo(Y,C.x,C.y)}function y(C,Y,N){var F=Y[0]-N[0]*C.k,G=Y[1]-N[1]*C.k;return F===C.x&&G===C.y?C:new Bo(C.k,F,G)}function I(C){return[(+C[0][0]+ +C[1][0])/2,(+C[0][1]+ +C[1][1])/2]}function S(C,Y,N,F){C.on("start.zoom",function(){T(this,arguments).event(F).start()}).on("interrupt.zoom end.zoom",function(){T(this,arguments).event(F).end()}).tween("zoom",function(){var G=this,K=arguments,X=T(G,K).event(F),Q=e.apply(G,K),U=N==null?I(Q):typeof N=="function"?N.apply(G,K):N,J=Math.max(Q[1][0]-Q[0][0],Q[1][1]-Q[0][1]),q=G.__zoom,ce=typeof Y=="function"?Y.apply(G,K):Y,ge=a(q.invert(U).concat(J/q.k),ce.invert(U).concat(J/ce.k));return function(re){if(re===1)re=ce;else{var Oe=ge(re),x=J/Oe[2];re=new Bo(x,U[0]-Oe[0]*x,U[1]-Oe[1]*x)}X.zoom(null,re)}})}function T(C,Y,N){return!N&&C.__zooming||new E(C,Y)}function E(C,Y){this.that=C,this.args=Y,this.active=0,this.sourceEvent=null,this.extent=e.apply(C,Y),this.taps=0}E.prototype={event:function(C){return C&&(this.sourceEvent=C),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(C,Y){return this.mouse&&C!=="mouse"&&(this.mouse[1]=Y.invert(this.mouse[0])),this.touch0&&C!=="touch"&&(this.touch0[1]=Y.invert(this.touch0[0])),this.touch1&&C!=="touch"&&(this.touch1[1]=Y.invert(this.touch1[0])),this.that.__zoom=Y,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(C){var Y=On(this.that).datum();c.call(C,this.that,new Vu(C,{sourceEvent:this.sourceEvent,target:g,type:C,transform:this.that.__zoom,dispatch:c}),Y)}};function H(C,...Y){if(!l.apply(this,arguments))return;var N=T(this,Y).event(C),F=this.__zoom,G=Math.max(s[0],Math.min(s[1],F.k*Math.pow(2,n.apply(this,arguments)))),K=Wn(C);if(N.wheel)(N.mouse[0][0]!==K[0]||N.mouse[0][1]!==K[1])&&(N.mouse[1]=F.invert(N.mouse[0]=K)),clearTimeout(N.wheel);else{if(F.k===G)return;N.mouse=[K,F.invert(K)],Ao(this),N.start()}Pl(C),N.wheel=setTimeout(X,p),N.zoom("mouse",t(y(w(F,G),N.mouse[0],N.mouse[1]),N.extent,i));function X(){N.wheel=null,N.end()}}function O(C,...Y){if(h||!l.apply(this,arguments))return;var N=C.currentTarget,F=T(this,Y,!0).event(C),G=On(C.view).on("mousemove.zoom",U,!0).on("mouseup.zoom",J,!0),K=Wn(C,N),X=C.clientX,Q=C.clientY;xi(C.view),Ro(C),F.mouse=[K,this.__zoom.invert(K)],Ao(this),F.start();function U(q){if(Pl(q),!F.moved){var ce=q.clientX-X,ge=q.clientY-Q;F.moved=ce*ce+ge*ge>b}F.event(q).zoom("mouse",t(y(F.that.__zoom,F.mouse[0]=Wn(q,N),F.mouse[1]),F.extent,i))}function J(q){G.on("mousemove.zoom mouseup.zoom",null),$i(q.view,F.moved),Pl(q),F.event(q).end()}}function B(C,...Y){if(l.apply(this,arguments)){var N=this.__zoom,F=Wn(C.changedTouches?C.changedTouches[0]:C,this),G=N.invert(F),K=N.k*(C.shiftKey?.5:2),X=t(y(w(N,K),F,G),e.apply(this,Y),i);Pl(C),r>0?On(this).transition().duration(r).call(S,X,F,C):On(this).call(g.transform,X,F,C)}}function j(C,...Y){if(l.apply(this,arguments)){var N=C.touches,F=N.length,G=T(this,Y,C.changedTouches.length===F).event(C),K,X,Q,U;for(Ro(C),X=0;X<F;++X)Q=N[X],U=Wn(Q,this),U=[U,this.__zoom.invert(U),Q.identifier],G.touch0?!G.touch1&&G.touch0[2]!==U[2]&&(G.touch1=U,G.taps=0):(G.touch0=U,K=!0,G.taps=1+!!u);u&&(u=clearTimeout(u)),K&&(G.taps<2&&(f=U[0],u=setTimeout(function(){u=null},d)),Ao(this),G.start())}}function Z(C,...Y){if(this.__zooming){var N=T(this,Y).event(C),F=C.changedTouches,G=F.length,K,X,Q,U;for(Pl(C),K=0;K<G;++K)X=F[K],Q=Wn(X,this),N.touch0&&N.touch0[2]===X.identifier?N.touch0[0]=Q:N.touch1&&N.touch1[2]===X.identifier&&(N.touch1[0]=Q);if(X=N.that.__zoom,N.touch1){var J=N.touch0[0],q=N.touch0[1],ce=N.touch1[0],ge=N.touch1[1],re=(re=ce[0]-J[0])*re+(re=ce[1]-J[1])*re,Oe=(Oe=ge[0]-q[0])*Oe+(Oe=ge[1]-q[1])*Oe;X=w(X,Math.sqrt(re/Oe)),Q=[(J[0]+ce[0])/2,(J[1]+ce[1])/2],U=[(q[0]+ge[0])/2,(q[1]+ge[1])/2]}else if(N.touch0)Q=N.touch0[0],U=N.touch0[1];else return;N.zoom("touch",t(y(X,Q,U),N.extent,i))}}function R(C,...Y){if(this.__zooming){var N=T(this,Y).event(C),F=C.changedTouches,G=F.length,K,X;for(Ro(C),h&&clearTimeout(h),h=setTimeout(function(){h=null},d),K=0;K<G;++K)X=F[K],N.touch0&&N.touch0[2]===X.identifier?delete N.touch0:N.touch1&&N.touch1[2]===X.identifier&&delete N.touch1;if(N.touch1&&!N.touch0&&(N.touch0=N.touch1,delete N.touch1),N.touch0)N.touch0[1]=this.__zoom.invert(N.touch0[0]);else if(N.end(),N.taps===2&&(X=Wn(X,this),Math.hypot(f[0]-X[0],f[1]-X[1])<v)){var Q=On(this).on("dblclick.zoom");Q&&Q.apply(this,arguments)}}}return g.wheelDelta=function(C){return arguments.length?(n=typeof C=="function"?C:to(+C),g):n},g.filter=function(C){return arguments.length?(l=typeof C=="function"?C:to(!!C),g):l},g.touchable=function(C){return arguments.length?(o=typeof C=="function"?C:to(!!C),g):o},g.extent=function(C){return arguments.length?(e=typeof C=="function"?C:to([[+C[0][0],+C[0][1]],[+C[1][0],+C[1][1]]]),g):e},g.scaleExtent=function(C){return arguments.length?(s[0]=+C[0],s[1]=+C[1],g):[s[0],s[1]]},g.translateExtent=function(C){return arguments.length?(i[0][0]=+C[0][0],i[1][0]=+C[1][0],i[0][1]=+C[0][1],i[1][1]=+C[1][1],g):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},g.constrain=function(C){return arguments.length?(t=C,g):t},g.duration=function(C){return arguments.length?(r=+C,g):r},g.interpolate=function(C){return arguments.length?(a=C,g):a},g.on=function(){var C=c.on.apply(c,arguments);return C===c?g:C},g.clickDistance=function(C){return arguments.length?(b=(C=+C)*C,g):Math.sqrt(b)},g.tapDistance=function(C){return arguments.length?(v=+C,g):v},g}function Au(l){let e,t,n,o,s,i,r;return a(),{feed:c,reset:a};function a(){e=!0,t="",n=0,o=-1,s=void 0,i=void 0,r=""}function c(f){t=t?t+f:f,e&&Lu(t)&&(t=t.slice(ea.length)),e=!1;const h=t.length;let d=0,p=!1;for(;d<h;){p&&(t[d]===`
`&&++d,p=!1);let b=-1,v=o,g;for(let w=n;b<0&&w<h;++w)g=t[w],g===":"&&v<0?v=w-d:g==="\r"?(p=!0,b=w-d):g===`
`&&(b=w-d);if(b<0){n=h-d,o=v;break}else n=0,o=-1;u(t,d,v,b),d+=b+1}d===h?t="":d>0&&(t=t.slice(d))}function u(f,h,d,p){if(p===0){r.length>0&&(l({type:"event",id:s,event:i||void 0,data:r.slice(0,-1)}),r="",s=void 0),i=void 0;return}const b=d<0,v=f.slice(h,h+(b?p:d));let g=0;b?g=p:f[h+d+1]===" "?g=d+2:g=d+1;const w=h+g,y=p-g,I=f.slice(w,w+y).toString();if(v==="data")r+=I?"".concat(I,`
`):`
`;else if(v==="event")i=I;else if(v==="id"&&!I.includes("\0"))s=I;else if(v==="retry"){const S=parseInt(I,10);Number.isNaN(S)||l({type:"reconnect-interval",value:S})}}}const ea=[239,187,191];function Lu(l){return ea.every((e,t)=>l.charCodeAt(t)===e)}class Ru extends TransformStream{constructor(){let e;super({start(t){e=Au(n=>{n.type==="event"&&t.enqueue(n)})},transform(t){e.feed(t)}})}}async function Uu(l,e){const t=l.pipeThrough(new TextDecoderStream).pipeThrough(new Ru).getReader();let n=Wu(t);return e&&(n=Fu(n)),n}async function*Wu(l){var e,t,n;for(;;){const{value:o,done:s}=await l.read();if(s){yield{done:!0,value:""};break}if(!o)continue;const i=o.data;if(i.startsWith("[DONE]")){yield{done:!0,value:""};break}try{const r=JSON.parse(i);if(console.log(r),r.error){yield{done:!0,value:"",error:r.error};break}if(r.sources){yield{done:!1,value:"",sources:r.sources};continue}if(r.selected_model_id){yield{done:!1,value:"",selectedModelId:r.selected_model_id};continue}if(r.usage){yield{done:!1,value:"",usage:r.usage};continue}yield{done:!1,value:((n=(t=(e=r.choices)==null?void 0:e[0])==null?void 0:t.delta)==null?void 0:n.content)??""}}catch(r){console.error("Error extracting delta from SSE event:",r)}}}async function*Fu(l){for await(const e of l){if(e.done){yield e;return}if(e.error){yield e;continue}if(e.sources){yield e;continue}if(e.selectedModelId){yield e;continue}if(e.usage){yield e;continue}let t=e.value;if(t.length<5){yield{done:!1,value:t};continue}for(;t!="";){const n=Math.min(Math.floor(Math.random()*3)+1,t.length);yield{done:!1,value:t.slice(0,n)},(document==null?void 0:document.visibilityState)!=="hidden"&&await ju(5),t=t.slice(n)}}}const ju=l=>new Promise(e=>setTimeout(e,l));function ks(l){let e,t=l[2]&&Es(l);return{c(){t&&t.c(),e=Ae()},l(n){t&&t.l(n),e=Ae()},m(n,o){t&&t.m(n,o),A(n,e,o)},p(n,o){n[2]?t?(t.p(n,o),o&4&&D(t,1)):(t=Es(n),t.c(),D(t,1),t.m(e.parentNode,e)):t&&(He(),P(t,1,1,()=>{t=null}),Be())},d(n){n&&_(e),t&&t.d(n)}}}function Es(l){let e,t,n,o,s=l[1].type+"",i,r,a,c,u,f,h=Sl.parse(vs.sanitize(l[1].content))+"",d,p,b,v,g,w=l[1].url&&Is(),y=l[1].url&&Ss(),I=l[1].dismissible&&Ds(l);return{c(){e=V("div"),t=V("div"),n=V("div"),o=V("div"),i=Ie(s),a=ee(),w&&w.c(),c=ee(),u=V("div"),f=new Li(!1),d=ee(),y&&y.c(),p=ee(),b=V("div"),I&&I.c(),this.h()},l(S){e=z(S,"DIV",{class:!0});var T=M(e);t=z(T,"DIV",{class:!0});var E=M(t);n=z(E,"DIV",{class:!0});var H=M(n);o=z(H,"DIV",{class:!0});var O=M(o);i=Se(O,s),O.forEach(_),a=te(H),w&&w.l(H),H.forEach(_),c=te(E),u=z(E,"DIV",{class:!0});var B=M(u);f=Ri(B,!1),B.forEach(_),E.forEach(_),d=te(T),y&&y.l(T),p=te(T),b=z(T,"DIV",{class:!0});var j=M(b);I&&I.l(j),j.forEach(_),T.forEach(_),this.h()},h(){m(o,"class",r="text-xs font-bold "+(l[3][l[1].type]??l[3].info)+" w-fit px-2 rounded-sm uppercase line-clamp-1 mr-0.5"),m(n,"class","flex justify-between self-start"),f.a=null,m(u,"class","flex-1 text-xs text-gray-700 dark:text-white"),m(t,"class","flex flex-col md:flex-row md:items-center flex-1 text-sm w-fit gap-1.5"),m(b,"class","flex self-start"),m(e,"class","top-0 left-0 right-0 p-2 mx-4 px-3 flex justify-center items-center relative rounded-xl border border-gray-100 dark:border-gray-850 text-gray-800 dark:text-gary-100 bg-white dark:bg-gray-900 backdrop-blur-xl z-30")},m(S,T){A(S,e,T),k(e,t),k(t,n),k(n,o),k(o,i),k(n,a),w&&w.m(n,null),k(t,c),k(t,u),f.m(h,u),k(e,d),y&&y.m(e,null),k(e,p),k(e,b),I&&I.m(b,null),g=!0},p(S,T){(!g||T&2)&&s!==(s=S[1].type+"")&&Te(i,s),(!g||T&2&&r!==(r="text-xs font-bold "+(S[3][S[1].type]??S[3].info)+" w-fit px-2 rounded-sm uppercase line-clamp-1 mr-0.5"))&&m(o,"class",r),S[1].url?w||(w=Is(),w.c(),w.m(n,null)):w&&(w.d(1),w=null),(!g||T&2)&&h!==(h=Sl.parse(vs.sanitize(S[1].content))+"")&&f.p(h),S[1].url?y||(y=Ss(),y.c(),y.m(e,p)):y&&(y.d(1),y=null),S[1].dismissible?I?I.p(S,T):(I=Ds(S),I.c(),I.m(b,null)):I&&(I.d(1),I=null)},i(S){g||(S&&el(()=>{g&&(v||(v=hs(e,vl,{delay:100,duration:300},!0)),v.run(1))}),g=!0)},o(S){S&&(v||(v=hs(e,vl,{delay:100,duration:300},!1)),v.run(0)),g=!1},d(S){S&&_(e),w&&w.d(),y&&y.d(),I&&I.d(),S&&v&&v.end()}}}function Is(l){let e,t='<a class="text-gray-700 dark:text-white text-xs font-semibold underline" href="/assets/files/whitepaper.pdf" target="_blank">Learn More</a> <div class="ml-1 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="w-4 h-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg></div>';return{c(){e=V("div"),e.innerHTML=t,this.h()},l(n){e=z(n,"DIV",{class:!0,"data-svelte-h":!0}),ut(e)!=="svelte-o2pz5m"&&(e.innerHTML=t),this.h()},h(){m(e,"class","flex md:hidden group w-fit md:items-center")},m(n,o){A(n,e,o)},d(n){n&&_(e)}}}function Ss(l){let e,t='<a class="text-gray-700 dark:text-white text-xs font-semibold underline" href="/" target="_blank">Learn More</a> <div class="ml-1 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg></div>';return{c(){e=V("div"),e.innerHTML=t,this.h()},l(n){e=z(n,"DIV",{class:!0,"data-svelte-h":!0}),ut(e)!=="svelte-1wr7se3"&&(e.innerHTML=t),this.h()},h(){m(e,"class","hidden md:flex group w-fit md:items-center")},m(n,o){A(n,e,o)},d(n){n&&_(e)}}}function Ds(l){let e,t="Ã—",n,o;return{c(){e=V("button"),e.textContent=t,this.h()},l(s){e=z(s,"BUTTON",{class:!0,"data-svelte-h":!0}),ut(e)!=="svelte-o8kh4p"&&(e.textContent=t),this.h()},h(){m(e,"class","-mt-1 -mb-2 -translate-y-[1px] ml-1.5 mr-1 text-gray-400 dark:hover:text-white")},m(s,i){A(s,e,i),n||(o=ke(e,"click",l[5]),n=!0)},p:we,d(s){s&&_(e),n=!1,o()}}}function Yu(l){let e,t=!l[0]&&ks(l);return{c(){t&&t.c(),e=Ae()},l(n){t&&t.l(n),e=Ae()},m(n,o){t&&t.m(n,o),A(n,e,o)},p(n,[o]){n[0]?t&&(t.d(1),t=null):t?t.p(n,o):(t=ks(n),t.c(),t.m(e.parentNode,e))},i:we,o:we,d(n){n&&_(e),t&&t.d(n)}}}function Xu(l,e,t){const n=cn();let{banner:o={id:"",type:"info",title:"",content:"",url:"",dismissable:!0,timestamp:Math.floor(Date.now()/1e3)}}=e,{dismissed:s=!1}=e,i=!1;const r={info:"bg-blue-500/20 text-blue-700 dark:text-blue-200 ",success:"bg-green-500/20 text-green-700 dark:text-green-200",warning:"bg-yellow-500/20 text-yellow-700 dark:text-yellow-200",error:"bg-red-500/20 text-red-700 dark:text-red-200"},a=u=>{t(0,s=!0),n("dismiss",u)};pn(()=>{t(2,i=!0)});const c=()=>{a(o.id)};return l.$$set=u=>{"banner"in u&&t(1,o=u.banner),"dismissed"in u&&t(0,s=u.dismissed)},[s,o,i,r,a,c]}class Ku extends Re{constructor(e){super(),Ue(this,e,Xu,Yu,Fe,{banner:1,dismissed:0})}}let Ll="",Rl="";async function Zu(){var t,n;const l=await fetch("/api/config");if(!l.ok)throw new Error("Failed to fetch Google Drive credentials");const e=await l.json();if(Ll=(t=e.google_drive)==null?void 0:t.api_key,Rl=(n=e.google_drive)==null?void 0:n.client_id,!Ll||!Rl)throw new Error("Google Drive API credentials not configured")}const Gu=["https://www.googleapis.com/auth/drive.readonly","https://www.googleapis.com/auth/drive.file"],qu=()=>{if(!Ll||!Rl)throw new Error("Google Drive API credentials not configured");if(Ll===""||Rl==="")throw new Error("Please configure valid Google Drive API credentials")};let no=null,Cs=!1;const Ju=()=>new Promise((l,e)=>{if(typeof gapi>"u"){const t=document.createElement("script");t.src="https://apis.google.com/js/api.js",t.onload=()=>{gapi.load("picker",()=>{l(!0)})},t.onerror=e,document.body.appendChild(t)}else gapi.load("picker",()=>{l(!0)})}),Qu=()=>new Promise((l,e)=>{if(typeof google>"u"){const t=document.createElement("script");t.src="https://accounts.google.com/gsi/client",t.onload=l,t.onerror=e,document.body.appendChild(t)}else l(!0)}),xu=async()=>no||new Promise((l,e)=>{google.accounts.oauth2.initTokenClient({client_id:Rl,scope:Gu.join(" "),callback:n=>{n.access_token?(no=n.access_token,l(no)):e(new Error("Failed to get access token"))},error_callback:n=>{e(new Error(n.message||"OAuth error occurred"))}}).requestAccessToken()}),$u=async()=>{Cs||(await Zu(),qu(),await Promise.all([Ju(),Qu()]),Cs=!0)},ef=()=>new Promise(async(l,e)=>{try{console.log("Initializing Google Drive Picker..."),await $u(),console.log("Getting auth token...");const t=await xu();if(!t)throw console.error("Failed to get OAuth token"),new Error("Unable to get OAuth token");console.log("Auth token obtained successfully"),new google.picker.PickerBuilder().enableFeature(google.picker.Feature.NAV_HIDDEN).enableFeature(google.picker.Feature.MULTISELECT_ENABLED).addView(new google.picker.DocsView().setIncludeFolders(!1).setSelectFolderEnabled(!1).setMimeTypes("application/pdf,text/plain,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.google-apps.document,application/vnd.google-apps.spreadsheet,application/vnd.google-apps.presentation")).setOAuthToken(t).setDeveloperKey(Ll).setCallback(async o=>{if(o[google.picker.Response.ACTION]===google.picker.Action.PICKED)try{const s=o[google.picker.Response.DOCUMENTS][0],i=s[google.picker.Document.ID],r=s[google.picker.Document.NAME],a=s[google.picker.Document.URL];if(!i||!r)throw new Error("Required file details missing");const c=s[google.picker.Document.MIME_TYPE];let u,f;c.includes("google-apps")?(c.includes("document")?f="text/plain":c.includes("spreadsheet")?f="text/csv":c.includes("presentation")?f="text/plain":f="application/pdf",u=`https://www.googleapis.com/drive/v3/files/${i}/export?mimeType=${encodeURIComponent(f)}`):u=`https://www.googleapis.com/drive/v3/files/${i}?alt=media`;const h=await fetch(u,{headers:{Authorization:`Bearer ${t}`,Accept:"*/*"}});if(!h.ok){const b=await h.text();throw console.error("Download failed:",{status:h.status,statusText:h.statusText,error:b}),new Error(`Failed to download file (${h.status}): ${b}`)}const d=await h.blob(),p={id:i,name:r,url:u,blob:d,headers:{Authorization:`Bearer ${t}`,Accept:"*/*"}};l(p)}catch(s){e(s)}else o[google.picker.Response.ACTION]===google.picker.Action.CANCEL&&l(null)}).build().setVisible(!0)}catch(t){console.error("Google Drive Picker error:",t),e(t)}});function Ms(l,e,t){const n=l.slice();return n[26]=e[t],n}function tf(l){let e;const t=l[15].default,n=Qt(t,l,l[23],null);return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&8388608)&&xt(n,t,o,o[23],e?en(t,o[23],s,null):$t(o[23]),null)},i(o){e||(D(n,o),e=!0)},o(o){P(n,o),e=!1},d(o){n&&n.d(o)}}}function nf(l){let e,t;return e=new Rt({props:{content:l[8].t("More"),$$slots:{default:[tf]},$$scope:{ctx:l}}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o&256&&(s.content=n[8].t("More")),o&8388608&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function Ts(l){let e,t,n,o,s=vt(Object.keys(l[6])),i=[];for(let a=0;a<s.length;a+=1)i[a]=Vs(Ms(l,s,a));const r=a=>P(i[a],1,1,()=>{i[a]=null});return{c(){e=V("div");for(let a=0;a<i.length;a+=1)i[a].c();t=ee(),n=V("hr"),this.h()},l(a){e=z(a,"DIV",{class:!0});var c=M(e);for(let u=0;u<i.length;u+=1)i[u].l(c);c.forEach(_),t=te(a),n=z(a,"HR",{class:!0}),this.h()},h(){m(e,"class","max-h-28 overflow-y-auto scrollbar-hidden"),m(n,"class","border-black/5 dark:border-white/5 my-1")},m(a,c){A(a,e,c);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(e,null);A(a,t,c),A(a,n,c),o=!0},p(a,c){if(c&65){s=vt(Object.keys(a[6]));let u;for(u=0;u<s.length;u+=1){const f=Ms(a,s,u);i[u]?(i[u].p(f,c),D(i[u],1)):(i[u]=Vs(f),i[u].c(),D(i[u],1),i[u].m(e,null))}for(He(),u=s.length;u<i.length;u+=1)r(u);Be()}},i(a){if(!o){for(let c=0;c<s.length;c+=1)D(i[c]);o=!0}},o(a){i=i.filter(Boolean);for(let c=0;c<i.length;c+=1)P(i[c]);o=!1},d(a){a&&(_(e),_(t),_(n)),Dn(i,a)}}}function lf(l){let e,t,n,o,s=l[6][l[26]].name+"",i,r;return t=new Fc({}),{c(){e=V("div"),ne(t.$$.fragment),n=ee(),o=V("div"),i=Ie(s),this.h()},l(a){e=z(a,"DIV",{class:!0});var c=M(e);se(t.$$.fragment,c),c.forEach(_),n=te(a),o=z(a,"DIV",{class:!0});var u=M(o);i=Se(u,s),u.forEach(_),this.h()},h(){m(e,"class","shrink-0"),m(o,"class","truncate")},m(a,c){A(a,e,c),le(t,e,null),A(a,n,c),A(a,o,c),k(o,i),r=!0},p(a,c){(!r||c&64)&&s!==(s=a[6][a[26]].name+"")&&Te(i,s)},i(a){r||(D(t.$$.fragment,a),r=!0)},o(a){P(t.$$.fragment,a),r=!1},d(a){a&&(_(e),_(n),_(o)),oe(t)}}}function Vs(l){var d;let e,t,n,o,s,i,r,a,c,u;n=new Rt({props:{content:((d=l[6][l[26]])==null?void 0:d.description)??"",placement:"top-start",className:"flex flex-1 gap-2 items-center",$$slots:{default:[lf]},$$scope:{ctx:l}}});function f(...p){return l[16](l[26],...p)}i=new Wc({props:{state:l[6][l[26]].enabled}}),i.$on("change",f);function h(){return l[17](l[26])}return{c(){e=V("button"),t=V("div"),ne(n.$$.fragment),o=ee(),s=V("div"),ne(i.$$.fragment),r=ee(),this.h()},l(p){e=z(p,"BUTTON",{class:!0});var b=M(e);t=z(b,"DIV",{class:!0});var v=M(t);se(n.$$.fragment,v),v.forEach(_),o=te(b),s=z(b,"DIV",{class:!0});var g=M(s);se(i.$$.fragment,g),g.forEach(_),r=te(b),b.forEach(_),this.h()},h(){m(t,"class","flex-1 truncate"),m(s,"class","shrink-0"),m(e,"class","flex w-full justify-between gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer rounded-xl")},m(p,b){A(p,e,b),k(e,t),le(n,t,null),k(e,o),k(e,s),le(i,s,null),k(e,r),a=!0,c||(u=ke(e,"click",h),c=!0)},p(p,b){var w;l=p;const v={};b&64&&(v.content=((w=l[6][l[26]])==null?void 0:w.description)??""),b&8388672&&(v.$$scope={dirty:b,ctx:l}),n.$set(v);const g={};b&64&&(g.state=l[6][l[26]].enabled),i.$set(g)},i(p){a||(D(n.$$.fragment,p),D(i.$$.fragment,p),a=!0)},o(p){P(n.$$.fragment,p),P(i.$$.fragment,p),a=!1},d(p){p&&_(e),oe(n),oe(i),c=!1,u()}}}function of(l){let e,t,n,o=l[8].t("Capture")+"",s,i;return e=new Ya({}),{c(){ne(e.$$.fragment),t=ee(),n=V("div"),s=Ie(o),this.h()},l(r){se(e.$$.fragment,r),t=te(r),n=z(r,"DIV",{class:!0});var a=M(n);s=Se(a,o),a.forEach(_),this.h()},h(){m(n,"class","line-clamp-1")},m(r,a){le(e,r,a),A(r,t,a),A(r,n,a),k(n,s),i=!0},p(r,a){(!i||a&256)&&o!==(o=r[8].t("Capture")+"")&&Te(s,o)},i(r){i||(D(e.$$.fragment,r),i=!0)},o(r){P(e.$$.fragment,r),i=!1},d(r){r&&(_(t),_(n)),oe(e,r)}}}function sf(l){let e,t;return e=new _n({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800  rounded-xl "+(l[7]?"":"opacity-50"),$$slots:{default:[of]},$$scope:{ctx:l}}}),e.$on("click",l[18]),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o&128&&(s.class="flex gap-2 items-center px-3 py-2 text-sm  font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800  rounded-xl "+(n[7]?"":"opacity-50")),o&8388864&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function rf(l){let e,t,n,o=l[8].t("Upload Files")+"",s,i;return e=new Xa({}),{c(){ne(e.$$.fragment),t=ee(),n=V("div"),s=Ie(o),this.h()},l(r){se(e.$$.fragment,r),t=te(r),n=z(r,"DIV",{class:!0});var a=M(n);s=Se(a,o),a.forEach(_),this.h()},h(){m(n,"class","line-clamp-1")},m(r,a){le(e,r,a),A(r,t,a),A(r,n,a),k(n,s),i=!0},p(r,a){(!i||a&256)&&o!==(o=r[8].t("Upload Files")+"")&&Te(s,o)},i(r){i||(D(e.$$.fragment,r),i=!0)},o(r){P(e.$$.fragment,r),i=!1},d(r){r&&(_(t),_(n)),oe(e,r)}}}function af(l){let e,t;return e=new _n({props:{class:"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl "+(l[7]?"":"opacity-50"),$$slots:{default:[rf]},$$scope:{ctx:l}}}),e.$on("click",l[19]),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o&128&&(s.class="flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl "+(n[7]?"":"opacity-50")),o&8388864&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function zs(l){let e,t;return e=new _n({props:{class:"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",$$slots:{default:[cf]},$$scope:{ctx:l}}}),e.$on("click",l[20]),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o&8388864&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function cf(l){let e,t,n,o,s,i,r,a,c,u=l[8].t("Google Drive")+"",f;return{c(){e=Ne("svg"),t=Ne("path"),n=Ne("path"),o=Ne("path"),s=Ne("path"),i=Ne("path"),r=Ne("path"),a=ee(),c=V("div"),f=Ie(u),this.h()},l(h){e=Pe(h,"svg",{xmlns:!0,viewBox:!0,class:!0});var d=M(e);t=Pe(d,"path",{d:!0,fill:!0}),M(t).forEach(_),n=Pe(d,"path",{d:!0,fill:!0}),M(n).forEach(_),o=Pe(d,"path",{d:!0,fill:!0}),M(o).forEach(_),s=Pe(d,"path",{d:!0,fill:!0}),M(s).forEach(_),i=Pe(d,"path",{d:!0,fill:!0}),M(i).forEach(_),r=Pe(d,"path",{d:!0,fill:!0}),M(r).forEach(_),d.forEach(_),a=te(h),c=z(h,"DIV",{class:!0});var p=M(c);f=Se(p,u),p.forEach(_),this.h()},h(){m(t,"d","m6.6 66.85 3.85 6.65c.8 1.4 1.95 2.5 3.3 3.3l13.75-23.8h-27.5c0 1.55.4 3.1 1.2 4.5z"),m(t,"fill","#0066da"),m(n,"d","m43.65 25-13.75-23.8c-1.35.8-2.5 1.9-3.3 3.3l-25.4 44a9.06 9.06 0 0 0 -1.2 4.5h27.5z"),m(n,"fill","#00ac47"),m(o,"d","m73.55 76.8c1.35-.8 2.5-1.9 3.3-3.3l1.6-2.75 7.65-13.25c.8-1.4 1.2-2.95 1.2-4.5h-27.502l5.852 11.5z"),m(o,"fill","#ea4335"),m(s,"d","m43.65 25 13.75-23.8c-1.35-.8-2.9-1.2-4.5-1.2h-18.5c-1.6 0-3.15.45-4.5 1.2z"),m(s,"fill","#00832d"),m(i,"d","m59.8 53h-32.3l-13.75 23.8c1.35.8 2.9 1.2 4.5 1.2h50.8c1.6 0 3.15-.45 4.5-1.2z"),m(i,"fill","#2684fc"),m(r,"d","m73.4 26.5-12.7-22c-.8-1.4-1.95-2.5-3.3-3.3l-13.75 23.8 16.15 28h27.45c0-1.55-.4-3.1-1.2-4.5z"),m(r,"fill","#ffba00"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 87.3 78"),m(e,"class","w-5 h-5"),m(c,"class","line-clamp-1")},m(h,d){A(h,e,d),k(e,t),k(e,n),k(e,o),k(e,s),k(e,i),k(e,r),A(h,a,d),A(h,c,d),k(c,f)},p(h,d){d&256&&u!==(u=h[8].t("Google Drive")+"")&&Te(f,u)},d(h){h&&(_(e),_(a),_(c))}}}function uf(l){var f,h;let e=Object.keys(l[6]).length>0,t,n,o,s,i,r,a,c=e&&Ts(l);n=new Rt({props:{content:l[7]?"":l[8].t("You do not have permission to upload files"),className:"w-full",$$slots:{default:[sf]},$$scope:{ctx:l}}}),s=new Rt({props:{content:l[7]?"":l[8].t("You do not have permission to upload files"),className:"w-full",$$slots:{default:[af]},$$scope:{ctx:l}}});let u=((h=(f=l[9])==null?void 0:f.features)==null?void 0:h.enable_google_drive_integration)&&zs(l);return{c(){c&&c.c(),t=ee(),ne(n.$$.fragment),o=ee(),ne(s.$$.fragment),i=ee(),u&&u.c(),r=Ae()},l(d){c&&c.l(d),t=te(d),se(n.$$.fragment,d),o=te(d),se(s.$$.fragment,d),i=te(d),u&&u.l(d),r=Ae()},m(d,p){c&&c.m(d,p),A(d,t,p),le(n,d,p),A(d,o,p),le(s,d,p),A(d,i,p),u&&u.m(d,p),A(d,r,p),a=!0},p(d,p){var g,w;p&64&&(e=Object.keys(d[6]).length>0),e?c?(c.p(d,p),p&64&&D(c,1)):(c=Ts(d),c.c(),D(c,1),c.m(t.parentNode,t)):c&&(He(),P(c,1,1,()=>{c=null}),Be());const b={};p&384&&(b.content=d[7]?"":d[8].t("You do not have permission to upload files")),p&8388994&&(b.$$scope={dirty:p,ctx:d}),n.$set(b);const v={};p&384&&(v.content=d[7]?"":d[8].t("You do not have permission to upload files")),p&8388996&&(v.$$scope={dirty:p,ctx:d}),s.$set(v),(w=(g=d[9])==null?void 0:g.features)!=null&&w.enable_google_drive_integration?u?(u.p(d,p),p&512&&D(u,1)):(u=zs(d),u.c(),D(u,1),u.m(r.parentNode,r)):u&&(He(),P(u,1,1,()=>{u=null}),Be())},i(d){a||(D(c),D(n.$$.fragment,d),D(s.$$.fragment,d),D(u),a=!0)},o(d){P(c),P(n.$$.fragment,d),P(s.$$.fragment,d),P(u),a=!1},d(d){d&&(_(t),_(o),_(i),_(r)),c&&c.d(d),oe(n,d),oe(s,d),u&&u.d(d)}}}function ff(l){let e,t,n;return t=new Eo({props:{class:"w-full max-w-[220px] rounded-xl px-1 py-1  border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-sm",sideOffset:15,alignOffset:-8,side:"top",align:"start",transition:Xl,$$slots:{default:[uf]},$$scope:{ctx:l}}}),{c(){e=V("div"),ne(t.$$.fragment),this.h()},l(o){e=z(o,"DIV",{slot:!0});var s=M(e);se(t.$$.fragment,s),s.forEach(_),this.h()},h(){m(e,"slot","content")},m(o,s){A(o,e,s),le(t,e,null),n=!0},p(o,s){const i={};s&8389583&&(i.$$scope={dirty:s,ctx:o}),t.$set(i)},i(o){n||(D(t.$$.fragment,o),n=!0)},o(o){P(t.$$.fragment,o),n=!1},d(o){o&&_(e),oe(t)}}}function df(l){let e,t,n,o,s,i,r;function a(u){l[21](u)}let c={$$slots:{content:[ff],default:[nf]},$$scope:{ctx:l}};return l[5]!==void 0&&(c.show=l[5]),n=new ko({props:c}),We.push(()=>Je(n,"show",a)),n.$on("change",l[22]),{c(){e=V("input"),t=ee(),ne(n.$$.fragment),this.h()},l(u){e=z(u,"INPUT",{id:!0,type:!0,accept:!0,capture:!0,style:!0}),t=te(u),se(n.$$.fragment,u),this.h()},h(){m(e,"id","camera-input"),m(e,"type","file"),m(e,"accept","image/*"),m(e,"capture","environment"),$e(e,"display","none")},m(u,f){A(u,e,f),A(u,t,f),le(n,u,f),s=!0,i||(r=ke(e,"change",l[12]),i=!0)},p(u,[f]){const h={};f&8389583&&(h.$$scope={dirty:f,ctx:u}),!o&&f&32&&(o=!0,h.show=u[5],qe(()=>o=!1)),n.$set(h)},i(u){s||(D(n.$$.fragment,u),s=!0)},o(u){P(n.$$.fragment,u),s=!1},d(u){u&&(_(e),_(t)),oe(n,u),i=!1,r()}}}function hf(l,e,t){let n,o,s,i;ae(l,ul,R=>t(24,n=R)),ae(l,Qn,R=>t(14,o=R)),ae(l,Yl,R=>t(9,i=R));let{$$slots:r={},$$scope:a}=e;const c=Ft("i18n");ae(l,c,R=>t(8,s=R));let{screenCaptureHandler:u}=e,{uploadFilesHandler:f}=e,{inputFilesHandler:h}=e,{uploadGoogleDriveHandler:d}=e,{selectedToolIds:p=[]}=e,{onClose:b}=e,v={},g=!1,w=!0;const y=async()=>{n===null&&await ul.set(await $o(localStorage.token)),t(6,v=n.reduce((R,C,Y,N)=>(R[C.id]={name:C.name,description:C.meta.description,enabled:p.includes(C.id)},R),{}))},I=()=>{const R=navigator.userAgent||navigator.vendor||window.opera;return/android|iphone|ipad|ipod|windows phone/i.test(R)};function S(R){var Y;const C=Array.from((Y=R.target)==null?void 0:Y.files);C&&C.length>0&&(console.log(C),h(C))}const T=async(R,C)=>{const Y=C.detail;await xe(),Y?t(0,p=[...p,R]):t(0,p=p.filter(N=>N!==R))},E=R=>{t(6,v[R].enabled=!v[R].enabled,v)},H=()=>{if(w)if(!I())u();else{const R=document.getElementById("camera-input");R&&R.click()}},O=()=>{w&&f()},B=()=>{d()};function j(R){g=R,t(5,g)}const Z=R=>{R.detail===!1&&b()};return l.$$set=R=>{"screenCaptureHandler"in R&&t(1,u=R.screenCaptureHandler),"uploadFilesHandler"in R&&t(2,f=R.uploadFilesHandler),"inputFilesHandler"in R&&t(13,h=R.inputFilesHandler),"uploadGoogleDriveHandler"in R&&t(3,d=R.uploadGoogleDriveHandler),"selectedToolIds"in R&&t(0,p=R.selectedToolIds),"onClose"in R&&t(4,b=R.onClose),"$$scope"in R&&t(23,a=R.$$scope)},l.$$.update=()=>{var R,C;l.$$.dirty&32&&g&&y(),l.$$.dirty&16384&&t(7,w=o.role==="admin"||((C=(R=o==null?void 0:o.permissions)==null?void 0:R.chat)==null?void 0:C.file_upload))},[p,u,f,d,b,g,v,w,s,i,c,I,S,h,o,r,T,E,H,O,B,j,Z,a]}class mf extends Re{constructor(e){super(),Ue(this,e,hf,df,Fe,{screenCaptureHandler:1,uploadFilesHandler:2,inputFilesHandler:13,uploadGoogleDriveHandler:3,selectedToolIds:0,onClose:4})}}function Ns(l,e,t){const n=l.slice();return n[0]=e[t],n[15]=t,n}function Ps(l){let e,t,n,o,s,i,r,a='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-3 h-3"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg>',c,u,f=l[3].t("Tip: Update multiple variable slots consecutively by pressing the tab key in the chat input after each replacement.")+"",h,d=vt(l[2]),p=[];for(let b=0;b<d.length;b+=1)p[b]=Os(Ns(l,d,b));return{c(){e=V("div"),t=V("div"),n=V("div"),o=V("div");for(let b=0;b<p.length;b+=1)p[b].c();s=ee(),i=V("div"),r=V("div"),r.innerHTML=a,c=ee(),u=V("div"),h=Ie(f),this.h()},l(b){e=z(b,"DIV",{id:!0,class:!0});var v=M(e);t=z(v,"DIV",{class:!0});var g=M(t);n=z(g,"DIV",{class:!0});var w=M(n);o=z(w,"DIV",{class:!0});var y=M(o);for(let T=0;T<p.length;T+=1)p[T].l(y);y.forEach(_),s=te(w),i=z(w,"DIV",{class:!0});var I=M(i);r=z(I,"DIV",{"data-svelte-h":!0}),ut(r)!=="svelte-cdi12d"&&(r.innerHTML=a),c=te(I),u=z(I,"DIV",{class:!0});var S=M(u);h=Se(S,f),S.forEach(_),I.forEach(_),w.forEach(_),g.forEach(_),v.forEach(_),this.h()},h(){m(o,"class","m-1 overflow-y-auto p-1 space-y-0.5 scrollbar-hidden"),m(u,"class","line-clamp-1"),m(i,"class","px-2 pt-0.5 pb-1 text-xs text-gray-600 dark:text-gray-100 bg-white dark:bg-gray-900 rounded-b-xl flex items-center space-x-1"),m(n,"class","max-h-60 flex flex-col w-full rounded-xl bg-white dark:bg-gray-900 dark:text-gray-100"),m(t,"class","flex w-full rounded-xl border border-gray-100 dark:border-gray-850"),m(e,"id","commands-container"),m(e,"class","px-2 mb-2 text-left w-full absolute bottom-0 left-0 right-0 z-10")},m(b,v){A(b,e,v),k(e,t),k(t,n),k(n,o);for(let g=0;g<p.length;g+=1)p[g]&&p[g].m(o,null);k(n,s),k(n,i),k(i,r),k(i,c),k(i,u),k(u,h)},p(b,v){if(v&38){d=vt(b[2]);let g;for(g=0;g<d.length;g+=1){const w=Ns(b,d,g);p[g]?p[g].p(w,v):(p[g]=Os(w),p[g].c(),p[g].m(o,null))}for(;g<p.length;g+=1)p[g].d(1);p.length=d.length}v&8&&f!==(f=b[3].t("Tip: Update multiple variable slots consecutively by pressing the tab key in the chat input after each replacement.")+"")&&Te(h,f)},d(b){b&&_(e),Dn(p,b)}}}function Os(l){let e,t,n=l[0].command+"",o,s,i,r=l[0].title+"",a,c,u,f,h;function d(){return l[11](l[0])}function p(){return l[12](l[15])}return{c(){e=V("button"),t=V("div"),o=Ie(n),s=ee(),i=V("div"),a=Ie(r),c=ee(),this.h()},l(b){e=z(b,"BUTTON",{class:!0,type:!0});var v=M(e);t=z(v,"DIV",{class:!0});var g=M(t);o=Se(g,n),g.forEach(_),s=te(v),i=z(v,"DIV",{class:!0});var w=M(i);a=Se(w,r),w.forEach(_),c=te(v),v.forEach(_),this.h()},h(){m(t,"class","font-medium text-black dark:text-gray-100"),m(i,"class","text-xs text-gray-600 dark:text-gray-100"),m(e,"class",u="px-3 py-1.5 rounded-xl w-full text-left "+(l[15]===l[1]?"  bg-gray-50 dark:bg-gray-850 selected-command-option-button":"")),m(e,"type","button")},m(b,v){A(b,e,v),k(e,t),k(t,o),k(e,s),k(e,i),k(i,a),k(e,c),f||(h=[ke(e,"click",d),ke(e,"mousemove",p),ke(e,"focus",_f)],f=!0)},p(b,v){l=b,v&4&&n!==(n=l[0].command+"")&&Te(o,n),v&4&&r!==(r=l[0].title+"")&&Te(a,r),v&2&&u!==(u="px-3 py-1.5 rounded-xl w-full text-left "+(l[15]===l[1]?"  bg-gray-50 dark:bg-gray-850 selected-command-option-button":""))&&m(e,"class",u)},d(b){b&&_(e),f=!1,on(h)}}}function gf(l){let e,t=l[2].length>0&&Ps(l);return{c(){t&&t.c(),e=Ae()},l(n){t&&t.l(n),e=Ae()},m(n,o){t&&t.m(n,o),A(n,e,o)},p(n,[o]){n[2].length>0?t?t.p(n,o):(t=Ps(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:we,o:we,d(n){n&&_(e),t&&t.d(n)}}}const _f=()=>{};function pf(l,e,t){let n,o,s;ae(l,Qn,g=>t(13,n=g)),ae(l,ji,g=>t(10,s=g));const i=Ft("i18n");ae(l,i,g=>t(3,o=g));let{files:r}=e,{prompt:a=""}=e,{command:c=""}=e,u=0,f=[];const h=()=>{t(1,u=Math.max(0,u-1))},d=()=>{t(1,u=Math.min(u+1,f.length-1))},p=async g=>{let w=g.content;if(g.content.includes("{{CLIPBOARD}}")){const S=await navigator.clipboard.readText().catch(H=>(nt.error(o.t("Failed to read clipboard contents")),"{{CLIPBOARD}}")),T=await navigator.clipboard.read();let E=null;for(const H of T)for(const O of H.types)if(O.startsWith("image/")){const B=await H.getType(O);E=URL.createObjectURL(B)}E&&t(6,r=[...r,{type:"image",url:E}]),w=w.replaceAll("{{CLIPBOARD}}",S)}if(g.content.includes("{{USER_LOCATION}}")){const S=await lc();w=w.replaceAll("{{USER_LOCATION}}",String(S))}if(g.content.includes("{{USER_NAME}}")){console.log(n);const S=n.name||"User";w=w.replaceAll("{{USER_NAME}}",S)}if(g.content.includes("{{USER_LANGUAGE}}")){const S=localStorage.getItem("locale")||"en-US";w=w.replaceAll("{{USER_LANGUAGE}}",S)}if(g.content.includes("{{CURRENT_DATE}}")){const S=oc();w=w.replaceAll("{{CURRENT_DATE}}",S)}if(g.content.includes("{{CURRENT_TIME}}")){const S=sc();w=w.replaceAll("{{CURRENT_TIME}}",S)}if(g.content.includes("{{CURRENT_DATETIME}}")){const S=rc();w=w.replaceAll("{{CURRENT_DATETIME}}",S)}if(g.content.includes("{{CURRENT_TIMEZONE}}")){const S=ic();w=w.replaceAll("{{CURRENT_TIMEZONE}}",S)}if(g.content.includes("{{CURRENT_WEEKDAY}}")){const S=ac();w=w.replaceAll("{{CURRENT_WEEKDAY}}",S)}t(0,a=w);const y=document.getElementById("chat-input-container"),I=document.getElementById("chat-input");await xe(),y&&(y.style.height="",y.style.height=Math.min(y.scrollHeight,200)+"px"),await xe(),I&&(I.focus(),I.dispatchEvent(new Event("input")))},b=g=>{p(g)},v=g=>{t(1,u=g)};return l.$$set=g=>{"files"in g&&t(6,r=g.files),"prompt"in g&&t(0,a=g.prompt),"command"in g&&t(7,c=g.command)},l.$$.update=()=>{l.$$.dirty&1152&&t(2,f=s.filter(g=>g.command.toLowerCase().includes(c.toLowerCase())).sort((g,w)=>g.title.localeCompare(w.title))),l.$$.dirty&128&&c&&t(1,u=0)},[a,u,f,o,i,p,r,c,h,d,s,b,v]}class bf extends Re{constructor(e){super(),Ue(this,e,pf,gf,Fe,{files:6,prompt:0,command:7,selectUp:8,selectDown:9})}get selectUp(){return this.$$.ctx[8]}get selectDown(){return this.$$.ctx[9]}}function Hs(l,e,t){const n=l.slice();return n[19]=e[t],n[21]=t,n}function Bs(l){let e,t,n,o,s,i,r,a=vt(l[2]),c=[];for(let d=0;d<a.length;d+=1)c[d]=As(Hs(l,a,d));function u(d,p){var b,v;if(p&1&&(i=null),p&1&&(r=null),i==null&&(i=!!d[0].split(" ").some(Df)),i)return If;if(r==null&&(r=!!((v=(b=d[0].split(" "))==null?void 0:b.at(0))!=null&&v.substring(1).startsWith("http"))),r)return Ef}let f=u(l,-1),h=f&&f(l);return{c(){e=V("div"),t=V("div"),n=V("div"),o=V("div");for(let d=0;d<c.length;d+=1)c[d].c();s=ee(),h&&h.c(),this.h()},l(d){e=z(d,"DIV",{id:!0,class:!0});var p=M(e);t=z(p,"DIV",{class:!0});var b=M(t);n=z(b,"DIV",{class:!0});var v=M(n);o=z(v,"DIV",{class:!0});var g=M(o);for(let w=0;w<c.length;w+=1)c[w].l(g);s=te(g),h&&h.l(g),g.forEach(_),v.forEach(_),b.forEach(_),p.forEach(_),this.h()},h(){m(o,"class","m-1 overflow-y-auto p-1 rounded-r-xl space-y-0.5 scrollbar-hidden"),m(n,"class","max-h-60 flex flex-col w-full rounded-xl bg-white dark:bg-gray-900 dark:text-gray-100"),m(t,"class","flex w-full rounded-xl border border-gray-100 dark:border-gray-850"),m(e,"id","commands-container"),m(e,"class","px-2 mb-2 text-left w-full absolute bottom-0 left-0 right-0 z-10")},m(d,p){A(d,e,p),k(e,t),k(t,n),k(n,o);for(let b=0;b<c.length;b+=1)c[b]&&c[b].m(o,null);k(o,s),h&&h.m(o,null)},p(d,p){if(p&38){a=vt(d[2]);let b;for(b=0;b<a.length;b+=1){const v=Hs(d,a,b);c[b]?c[b].p(v,p):(c[b]=As(v),c[b].c(),c[b].m(o,s))}for(;b<c.length;b+=1)c[b].d(1);c.length=a.length}f===(f=u(d,p))&&h?h.p(d,p):(h&&h.d(1),h=f&&f(d),h&&(h.c(),h.m(o,null)))},d(d){d&&_(e),Dn(c,d),h&&h.d()}}}function vf(l){let e,t="Collection";return{c(){e=V("div"),e.textContent=t,this.h()},l(n){e=z(n,"DIV",{class:!0,"data-svelte-h":!0}),ut(e)!=="svelte-1j93cxc"&&(e.textContent=t),this.h()},h(){m(e,"class","bg-green-500/20 text-green-700 dark:text-green-200 rounded-sm uppercase text-xs font-bold px-1 shrink-0")},m(n,o){A(n,e,o)},d(n){n&&_(e)}}}function wf(l){let e,t="File";return{c(){e=V("div"),e.textContent=t,this.h()},l(n){e=z(n,"DIV",{class:!0,"data-svelte-h":!0}),ut(e)!=="svelte-dn3g9i"&&(e.textContent=t),this.h()},h(){m(e,"class","bg-gray-500/20 text-gray-700 dark:text-gray-200 rounded-sm uppercase text-xs font-bold px-1 shrink-0")},m(n,o){A(n,e,o)},d(n){n&&_(e)}}}function yf(l){let e,t="Document";return{c(){e=V("div"),e.textContent=t,this.h()},l(n){e=z(n,"DIV",{class:!0,"data-svelte-h":!0}),ut(e)!=="svelte-2kpkct"&&(e.textContent=t),this.h()},h(){m(e,"class","bg-gray-500/20 text-gray-700 dark:text-gray-200 rounded-sm uppercase text-xs font-bold px-1 shrink-0")},m(n,o){A(n,e,o)},d(n){n&&_(e)}}}function kf(l){let e,t="Legacy";return{c(){e=V("div"),e.textContent=t,this.h()},l(n){e=z(n,"DIV",{class:!0,"data-svelte-h":!0}),ut(e)!=="svelte-8uyvzr"&&(e.textContent=t),this.h()},h(){m(e,"class","bg-gray-500/20 text-gray-700 dark:text-gray-200 rounded-sm uppercase text-xs font-bold px-1 shrink-0")},m(n,o){A(n,e,o)},d(n){n&&_(e)}}}function As(l){var I,S;let e,t,n,o,s,i=((I=l[19])==null?void 0:I.name)+"",r,a,c,u=((S=l[19])==null?void 0:S.description)+"",f,h,d,p;function b(T,E){var H,O,B;return T[19].legacy?kf:(O=(H=T[19])==null?void 0:H.meta)!=null&&O.document?yf:((B=T[19])==null?void 0:B.type)==="file"?wf:vf}let v=b(l),g=v(l);function w(){return l[13](l[19])}function y(){return l[14](l[21])}return{c(){e=V("button"),t=V("div"),n=V("div"),g.c(),o=ee(),s=V("div"),r=Ie(i),a=ee(),c=V("div"),f=Ie(u),this.h()},l(T){e=z(T,"BUTTON",{class:!0,type:!0});var E=M(e);t=z(E,"DIV",{});var H=M(t);n=z(H,"DIV",{class:!0});var O=M(n);g.l(O),o=te(O),s=z(O,"DIV",{class:!0});var B=M(s);r=Se(B,i),B.forEach(_),O.forEach(_),a=te(H),c=z(H,"DIV",{class:!0});var j=M(c);f=Se(j,u),j.forEach(_),H.forEach(_),E.forEach(_),this.h()},h(){m(s,"class","line-clamp-1"),m(n,"class","font-medium text-black dark:text-gray-100 flex items-center gap-1"),m(c,"class","text-xs text-gray-600 dark:text-gray-100 line-clamp-1"),m(e,"class",h="px-3 py-1.5 rounded-xl w-full text-left flex justify-between items-center "+(l[21]===l[1]?" bg-gray-50 dark:bg-gray-850 dark:text-gray-100 selected-command-option-button":"")),m(e,"type","button")},m(T,E){A(T,e,E),k(e,t),k(t,n),g.m(n,null),k(n,o),k(n,s),k(s,r),k(t,a),k(t,c),k(c,f),d||(p=[ke(e,"click",w),ke(e,"mousemove",y)],d=!0)},p(T,E){var H,O;l=T,v!==(v=b(l))&&(g.d(1),g=v(l),g&&(g.c(),g.m(n,o))),E&4&&i!==(i=((H=l[19])==null?void 0:H.name)+"")&&Te(r,i),E&4&&u!==(u=((O=l[19])==null?void 0:O.description)+"")&&Te(f,u),E&2&&h!==(h="px-3 py-1.5 rounded-xl w-full text-left flex justify-between items-center "+(l[21]===l[1]?" bg-gray-50 dark:bg-gray-850 dark:text-gray-100 selected-command-option-button":""))&&m(e,"class",h)},d(T){T&&_(e),g.d(),d=!1,on(p)}}}function Ef(l){var f,h;let e,t,n=((h=(f=l[0].split(" "))==null?void 0:f.at(0))==null?void 0:h.substring(1))+"",o,s,i,r=l[3].t("Web")+"",a,c,u;return{c(){e=V("button"),t=V("div"),o=Ie(n),s=ee(),i=V("div"),a=Ie(r),this.h()},l(d){e=z(d,"BUTTON",{class:!0,type:!0});var p=M(e);t=z(p,"DIV",{class:!0});var b=M(t);o=Se(b,n),b.forEach(_),s=te(p),i=z(p,"DIV",{class:!0});var v=M(i);a=Se(v,r),v.forEach(_),p.forEach(_),this.h()},h(){m(t,"class","font-medium text-black dark:text-gray-100 line-clamp-1"),m(i,"class","text-xs text-gray-600 line-clamp-1"),m(e,"class","px-3 py-1.5 rounded-xl w-full text-left bg-gray-50 dark:bg-gray-850 dark:text-gray-100 selected-command-option-button"),m(e,"type","button")},m(d,p){A(d,e,p),k(e,t),k(t,o),k(e,s),k(e,i),k(i,a),c||(u=ke(e,"click",l[16]),c=!0)},p(d,p){var b,v;p&1&&n!==(n=((v=(b=d[0].split(" "))==null?void 0:b.at(0))==null?void 0:v.substring(1))+"")&&Te(o,n),p&8&&r!==(r=d[3].t("Web")+"")&&Te(a,r)},d(d){d&&_(e),c=!1,u()}}}function If(l){var f,h;let e,t,n=((h=(f=l[0].split(" "))==null?void 0:f.at(0))==null?void 0:h.substring(1))+"",o,s,i,r=l[3].t("Youtube")+"",a,c,u;return{c(){e=V("button"),t=V("div"),o=Ie(n),s=ee(),i=V("div"),a=Ie(r),this.h()},l(d){e=z(d,"BUTTON",{class:!0,type:!0});var p=M(e);t=z(p,"DIV",{class:!0});var b=M(t);o=Se(b,n),b.forEach(_),s=te(p),i=z(p,"DIV",{class:!0});var v=M(i);a=Se(v,r),v.forEach(_),p.forEach(_),this.h()},h(){m(t,"class","font-medium text-black dark:text-gray-100 line-clamp-1"),m(i,"class","text-xs text-gray-600 line-clamp-1"),m(e,"class","px-3 py-1.5 rounded-xl w-full text-left bg-gray-50 dark:bg-gray-850 dark:text-gray-100 selected-command-option-button"),m(e,"type","button")},m(d,p){A(d,e,p),k(e,t),k(t,o),k(e,s),k(e,i),k(i,a),c||(u=ke(e,"click",l[15]),c=!0)},p(d,p){var b,v;p&1&&n!==(n=((v=(b=d[0].split(" "))==null?void 0:b.at(0))==null?void 0:v.substring(1))+"")&&Te(o,n),p&8&&r!==(r=d[3].t("Youtube")+"")&&Te(a,r)},d(d){d&&_(e),c=!1,u()}}}function Sf(l){var o,s;let e=l[2].length>0||((s=(o=l[0].split(" "))==null?void 0:o.at(0))==null?void 0:s.substring(1).startsWith("http")),t,n=e&&Bs(l);return{c(){n&&n.c(),t=Ae()},l(i){n&&n.l(i),t=Ae()},m(i,r){n&&n.m(i,r),A(i,t,r)},p(i,[r]){var a,c;r&5&&(e=i[2].length>0||((c=(a=i[0].split(" "))==null?void 0:a.at(0))==null?void 0:c.substring(1).startsWith("http"))),e?n?n.p(i,r):(n=Bs(i),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:we,o:we,d(i){i&&_(t),n&&n.d(i)}}}const Df=l=>l.substring(1).startsWith("https://www.youtube.com")||l.substring(1).startsWith("https://youtu.be");function Cf(l,e,t){let n,o;ae(l,Yi,T=>t(17,n=T)),Zc.extend(Gc);const s=Ft("i18n");ae(l,s,T=>t(3,o=T));let{prompt:i=""}=e,{command:r=""}=e;const a=cn();let c=0,u=[],f=null,h=[];const d=()=>{t(1,c=Math.max(0,c-1))},p=()=>{t(1,c=Math.min(c+1,h.length-1))},b=async T=>{a("select",T),t(0,i=so(i,r));const E=document.getElementById("chat-input");await xe(),E==null||E.focus(),await xe()},v=async T=>{a("url",T),t(0,i=so(i,r));const E=document.getElementById("chat-input");await xe(),E==null||E.focus(),await xe()},g=async T=>{a("youtube",T),t(0,i=so(i,r));const E=document.getElementById("chat-input");await xe(),E==null||E.focus(),await xe()};pn(()=>{let T=n.filter(B=>{var j;return(j=B==null?void 0:B.meta)==null?void 0:j.document}).map(B=>({...B,type:"file"})),E=T.length>0?[{name:"All Documents",legacy:!0,type:"collection",description:"Deprecated (legacy collection), please create a new knowledge base.",title:o.t("All Documents"),collection_names:T.map(B=>B.id)},...T.reduce((B,j)=>{var Z;return[...new Set([...B,...(((Z=j==null?void 0:j.meta)==null?void 0:Z.tags)??[]).map(R=>R.name)])]},[]).map(B=>({name:B,legacy:!0,type:"collection",description:"Deprecated (legacy collection), please create a new knowledge base.",collection_names:T.filter(j=>{var Z;return(((Z=j==null?void 0:j.meta)==null?void 0:Z.tags)??[]).map(R=>R.name).includes(B)}).map(j=>j.id)}))]:[],H=n.filter(B=>{var j;return!((j=B==null?void 0:B.meta)!=null&&j.document)}).map(B=>({...B,type:"collection"})),O=n.length>0?[...n.reduce((B,j)=>[...new Set([...B,...((j==null?void 0:j.files)??[]).map(Z=>({...Z,collection:{name:j.name,description:j.description}}))])],[]).map(B=>{var j,Z,R;return{...B,name:(j=B==null?void 0:B.meta)==null?void 0:j.name,description:`${(Z=B==null?void 0:B.collection)==null?void 0:Z.name} - ${(R=B==null?void 0:B.collection)==null?void 0:R.description}`,type:"file"}})]:[];t(11,u=[...H,...O,...E,...T].map(B=>{var j,Z;return{...B,...B!=null&&B.legacy||(j=B==null?void 0:B.meta)!=null&&j.legacy||(Z=B==null?void 0:B.meta)!=null&&Z.document?{legacy:!0}:{}}})),t(12,f=new Gi(u,{keys:["name","description"]}))});const w=T=>{console.log(T),b(T)},y=T=>{t(1,c=T)},I=()=>{var E,H;const T=(H=(E=i.split(" "))==null?void 0:E.at(0))==null?void 0:H.substring(1);_s(T)?g(T):nt.error(o.t("Oops! Looks like the URL is invalid. Please double-check and try again."))},S=()=>{var E,H;const T=(H=(E=i.split(" "))==null?void 0:E.at(0))==null?void 0:H.substring(1);_s(T)?v(T):nt.error(o.t("Oops! Looks like the URL is invalid. Please double-check and try again."))};return l.$$set=T=>{"prompt"in T&&t(0,i=T.prompt),"command"in T&&t(8,r=T.command)},l.$$.update=()=>{l.$$.dirty&6400&&f&&t(2,h=r.slice(1)?f.search(r).map(T=>T.item):u),l.$$.dirty&256&&r&&t(1,c=0)},[i,c,h,o,s,b,v,g,r,d,p,u,f,w,y,I,S]}class Mf extends Re{constructor(e){super(),Ue(this,e,Cf,Sf,Fe,{prompt:0,command:8,selectUp:9,selectDown:10})}get selectUp(){return this.$$.ctx[9]}get selectDown(){return this.$$.ctx[10]}}function Ls(l,e,t){const n=l.slice();return n[12]=e[t],n[14]=t,n}function Rs(l){let e,t,n,o,s=vt(l[1]),i=[];for(let r=0;r<s.length;r+=1)i[r]=Us(Ls(l,s,r));return{c(){e=V("div"),t=V("div"),n=V("div"),o=V("div");for(let r=0;r<i.length;r+=1)i[r].c();this.h()},l(r){e=z(r,"DIV",{id:!0,class:!0});var a=M(e);t=z(a,"DIV",{class:!0});var c=M(t);n=z(c,"DIV",{class:!0});var u=M(n);o=z(u,"DIV",{class:!0});var f=M(o);for(let h=0;h<i.length;h+=1)i[h].l(f);f.forEach(_),u.forEach(_),c.forEach(_),a.forEach(_),this.h()},h(){m(o,"class","m-1 overflow-y-auto p-1 rounded-r-lg space-y-0.5 scrollbar-hidden"),m(n,"class","max-h-60 flex flex-col w-full rounded-xl bg-white dark:bg-gray-900 dark:text-gray-100"),m(t,"class","flex w-full rounded-xl border border-gray-100 dark:border-gray-850"),m(e,"id","commands-container"),m(e,"class","px-2 mb-2 text-left w-full absolute bottom-0 left-0 right-0 z-10")},m(r,a){A(r,e,a),k(e,t),k(t,n),k(n,o);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(o,null)},p(r,a){if(a&7){s=vt(r[1]);let c;for(c=0;c<s.length;c+=1){const u=Ls(r,s,c);i[c]?i[c].p(u,a):(i[c]=Us(u),i[c].c(),i[c].m(o,null))}for(;c<i.length;c+=1)i[c].d(1);i.length=s.length}},d(r){r&&_(e),Dn(i,r)}}}function Us(l){let e,t,n,o,s,i,r=l[12].name+"",a,c,u,f,h;function d(){return l[7](l[12])}function p(){return l[8](l[14])}return{c(){e=V("button"),t=V("div"),n=V("img"),i=ee(),a=Ie(r),c=ee(),this.h()},l(b){e=z(b,"BUTTON",{class:!0,type:!0});var v=M(e);t=z(v,"DIV",{class:!0});var g=M(t);n=z(g,"IMG",{src:!0,alt:!0,class:!0}),i=te(g),a=Se(g,r),g.forEach(_),c=te(v),v.forEach(_),this.h()},h(){var b,v,g,w;Jn(n.src,o=((g=(v=(b=l[12])==null?void 0:b.info)==null?void 0:v.meta)==null?void 0:g.profile_image_url)??"/static/favicon.png")||m(n,"src",o),m(n,"alt",s=((w=l[12])==null?void 0:w.name)??l[12].id),m(n,"class","rounded-full size-6 items-center mr-2"),m(t,"class","flex font-medium text-black dark:text-gray-100 line-clamp-1"),m(e,"class",u="px-3 py-1.5 rounded-xl w-full text-left "+(l[14]===l[0]?"bg-gray-50 dark:bg-gray-850 selected-command-option-button":"")),m(e,"type","button")},m(b,v){A(b,e,v),k(e,t),k(t,n),k(t,i),k(t,a),k(e,c),f||(h=[ke(e,"click",d),ke(e,"mousemove",p),ke(e,"focus",Vf)],f=!0)},p(b,v){var g,w,y,I;l=b,v&2&&!Jn(n.src,o=((y=(w=(g=l[12])==null?void 0:g.info)==null?void 0:w.meta)==null?void 0:y.profile_image_url)??"/static/favicon.png")&&m(n,"src",o),v&2&&s!==(s=((I=l[12])==null?void 0:I.name)??l[12].id)&&m(n,"alt",s),v&2&&r!==(r=l[12].name+"")&&Te(a,r),v&1&&u!==(u="px-3 py-1.5 rounded-xl w-full text-left "+(l[14]===l[0]?"bg-gray-50 dark:bg-gray-850 selected-command-option-button":""))&&m(e,"class",u)},d(b){b&&_(e),f=!1,on(h)}}}function Tf(l){let e,t=l[1].length>0&&Rs(l);return{c(){t&&t.c(),e=Ae()},l(n){t&&t.l(n),e=Ae()},m(n,o){t&&t.m(n,o),A(n,e,o)},p(n,[o]){n[1].length>0?t?t.p(n,o):(t=Rs(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:we,o:we,d(n){n&&_(e),t&&t.d(n)}}}const Vf=()=>{};function zf(l,e,t){let n;ae(l,dl,p=>t(6,n=p)),Ft("i18n");const o=cn();let{command:s=""}=e,i=0,r=[],a=new Gi(n.filter(p=>{var b,v;return!((v=(b=p==null?void 0:p.info)==null?void 0:b.meta)!=null&&v.hidden)}).map(p=>{var v,g,w,y,I;return{...p,modelName:p==null?void 0:p.name,tags:(w=(g=(v=p==null?void 0:p.info)==null?void 0:v.meta)==null?void 0:g.tags)==null?void 0:w.map(S=>S.name).join(" "),desc:(I=(y=p==null?void 0:p.info)==null?void 0:y.meta)==null?void 0:I.description}}),{keys:["value","tags","modelName"],threshold:.3});const c=()=>{t(0,i=Math.max(0,i-1))},u=()=>{t(0,i=Math.min(i+1,r.length-1))},f=async p=>{t(3,s=""),o("select",p)};pn(async()=>{await xe();const p=document.getElementById("chat-input");await xe(),p==null||p.focus(),await xe()});const h=p=>{f(p)},d=p=>{t(0,i=p)};return l.$$set=p=>{"command"in p&&t(3,s=p.command)},l.$$.update=()=>{l.$$.dirty&72&&t(1,r=s.slice(1)?a.search(s).map(p=>p.item):n.filter(p=>{var b,v;return!((v=(b=p==null?void 0:p.info)==null?void 0:b.meta)!=null&&v.hidden)})),l.$$.dirty&8&&s&&t(0,i=0)},[i,r,f,s,c,u,n,h,d]}class Nf extends Re{constructor(e){super(),Ue(this,e,zf,Tf,Fe,{command:3,selectUp:4,selectDown:5})}get selectUp(){return this.$$.ctx[4]}get selectDown(){return this.$$.ctx[5]}}function Ws(l){let e,t,n,o;const s=[Of,Pf],i=[];function r(a,c){return a[4]?1:0}return e=r(l),t=i[e]=s[e](l),{c(){t.c(),n=Ae()},l(a){t.l(a),n=Ae()},m(a,c){i[e].m(a,c),A(a,n,c),o=!0},p(a,c){let u=e;e=r(a),e===u?i[e].p(a,c):(He(),P(i[u],1,1,()=>{i[u]=null}),Be(),t=i[e],t?t.p(a,c):(t=i[e]=s[e](a),t.c()),D(t,1),t.m(n.parentNode,n))},i(a){o||(D(t),o=!0)},o(a){P(t),o=!1},d(a){a&&_(n),i[e].d(a)}}}function Pf(l){let e,t,n,o,s;return o=new Io({}),{c(){e=V("div"),t=V("div"),n=V("div"),ne(o.$$.fragment),this.h()},l(i){e=z(i,"DIV",{id:!0,class:!0});var r=M(e);t=z(r,"DIV",{class:!0});var a=M(t);n=z(a,"DIV",{class:!0});var c=M(n);se(o.$$.fragment,c),c.forEach(_),a.forEach(_),r.forEach(_),this.h()},h(){m(n,"class","max-h-60 flex flex-col w-full rounded-xl bg-white dark:bg-gray-900 dark:text-gray-100"),m(t,"class","flex w-full rounded-xl border border-gray-100 dark:border-gray-850"),m(e,"id","commands-container"),m(e,"class","px-2 mb-2 text-left w-full absolute bottom-0 left-0 right-0 z-10")},m(i,r){A(i,e,r),k(e,t),k(t,n),le(o,n,null),s=!0},p:we,i(i){s||(D(o.$$.fragment,i),s=!0)},o(i){P(o.$$.fragment,i),s=!1},d(i){i&&_(e),oe(o)}}}function Of(l){let e,t,n,o,s,i,r;const a=[Af,Bf,Hf],c=[];function u(f,h){var d,p,b;return h&4&&(e=null),h&4&&(t=null),h&4&&(n=null),e==null&&(e=((d=f[2])==null?void 0:d.charAt(0))==="/"),e?0:(t==null&&(t=!!(((p=f[2])==null?void 0:p.charAt(0))==="#"&&f[2].startsWith("#")&&!f[2].includes("# ")||f[2].slice(0,2)==="\\#"&&f[2].startsWith("#")&&!f[2].includes("# "))),t?1:(n==null&&(n=((b=f[2])==null?void 0:b.charAt(0))==="@"),n?2:-1))}return~(o=u(l,-1))&&(s=c[o]=a[o](l)),{c(){s&&s.c(),i=Ae()},l(f){s&&s.l(f),i=Ae()},m(f,h){~o&&c[o].m(f,h),A(f,i,h),r=!0},p(f,h){let d=o;o=u(f,h),o===d?~o&&c[o].p(f,h):(s&&(He(),P(c[d],1,1,()=>{c[d]=null}),Be()),~o?(s=c[o],s?s.p(f,h):(s=c[o]=a[o](f),s.c()),D(s,1),s.m(i.parentNode,i)):s=null)},i(f){r||(D(s),r=!0)},o(f){P(s),r=!1},d(f){f&&_(i),~o&&c[o].d(f)}}}function Hf(l){let e,t,n={command:l[2]};return e=new Nf({props:n}),l[17](e),e.$on("select",l[18]),{c(){ne(e.$$.fragment)},l(o){se(e.$$.fragment,o)},m(o,s){le(e,o,s),t=!0},p(o,s){const i={};s&4&&(i.command=o[2]),e.$set(i)},i(o){t||(D(e.$$.fragment,o),t=!0)},o(o){P(e.$$.fragment,o),t=!1},d(o){l[17](null),oe(e,o)}}}function Bf(l){let e,t,n;function o(i){l[13](i)}let s={command:l[2].includes("\\#")?l[2].slice(2):l[2]};return l[0]!==void 0&&(s.prompt=l[0]),e=new Mf({props:s}),l[12](e),We.push(()=>Je(e,"prompt",o)),e.$on("youtube",l[14]),e.$on("url",l[15]),e.$on("select",l[16]),{c(){ne(e.$$.fragment)},l(i){se(e.$$.fragment,i)},m(i,r){le(e,i,r),n=!0},p(i,r){const a={};r&4&&(a.command=i[2].includes("\\#")?i[2].slice(2):i[2]),!t&&r&1&&(t=!0,a.prompt=i[0],qe(()=>t=!1)),e.$set(a)},i(i){n||(D(e.$$.fragment,i),n=!0)},o(i){P(e.$$.fragment,i),n=!1},d(i){l[12](null),oe(e,i)}}}function Af(l){let e,t,n,o;function s(a){l[10](a)}function i(a){l[11](a)}let r={command:l[2]};return l[0]!==void 0&&(r.prompt=l[0]),l[1]!==void 0&&(r.files=l[1]),e=new bf({props:r}),l[9](e),We.push(()=>Je(e,"prompt",s)),We.push(()=>Je(e,"files",i)),{c(){ne(e.$$.fragment)},l(a){se(e.$$.fragment,a)},m(a,c){le(e,a,c),o=!0},p(a,c){const u={};c&4&&(u.command=a[2]),!t&&c&1&&(t=!0,u.prompt=a[0],qe(()=>t=!1)),!n&&c&2&&(n=!0,u.files=a[1],qe(()=>n=!1)),e.$set(u)},i(a){o||(D(e.$$.fragment,a),o=!0)},o(a){P(e.$$.fragment,a),o=!1},d(a){l[9](null),oe(e,a)}}}function Lf(l){let e,t,n=l[3]&&Ws(l);return{c(){n&&n.c(),e=Ae()},l(o){n&&n.l(o),e=Ae()},m(o,s){n&&n.m(o,s),A(o,e,s),t=!0},p(o,[s]){o[3]?n?(n.p(o,s),s&8&&D(n,1)):(n=Ws(o),n.c(),D(n,1),n.m(e.parentNode,e)):n&&(He(),P(n,1,1,()=>{n=null}),Be())},i(o){t||(D(n),t=!0)},o(o){P(n),t=!1},d(o){o&&_(e),n&&n.d(o)}}}function Rf(l,e,t){const n=cn();let{prompt:o=""}=e,{files:s=[]}=e,i=!1,r=null;const a=()=>{r==null||r.selectUp()},c=()=>{r==null||r.selectDown()};let u="",f=!1;const h=async()=>{t(4,i=!0),await Promise.all([(async()=>{ji.set(await Xc(localStorage.token))})(),(async()=>{Yi.set(await Kc(localStorage.token))})()]),t(4,i=!1)};function d(E){We[E?"unshift":"push"](()=>{r=E,t(5,r)})}function p(E){o=E,t(0,o)}function b(E){s=E,t(1,s)}function v(E){We[E?"unshift":"push"](()=>{r=E,t(5,r)})}function g(E){o=E,t(0,o)}const w=E=>{console.log(E),n("upload",{type:"youtube",data:E.detail})},y=E=>{console.log(E),n("upload",{type:"web",data:E.detail})},I=E=>{console.log(E),!s.find(H=>H.id===E.detail.id)&&(t(1,s=[...s,{...E.detail,status:"processed"}]),n("select"))};function S(E){We[E?"unshift":"push"](()=>{r=E,t(5,r)})}const T=E=>{t(0,o=so(o,u)),n("select",{type:"model",data:E.detail})};return l.$$set=E=>{"prompt"in E&&t(0,o=E.prompt),"files"in E&&t(1,s=E.files)},l.$$.update=()=>{var E,H;l.$$.dirty&1&&t(2,u=((H=(E=o==null?void 0:o.split(`
`).pop())==null?void 0:E.split(" "))==null?void 0:H.pop())??""),l.$$.dirty&4&&t(3,f=["/","#","@"].includes(u==null?void 0:u.charAt(0))||u.slice(0,2)==="\\#"),l.$$.dirty&8&&f&&h()},[o,s,u,f,i,r,n,a,c,d,p,b,v,g,w,y,I,S,T]}class Uf extends Re{constructor(e){super(),Ue(this,e,Rf,Lf,Fe,{prompt:0,files:1,selectUp:7,selectDown:8})}get selectUp(){return this.$$.ctx[7]}get selectDown(){return this.$$.ctx[8]}}function Wf(l){let e,t;return{c(){e=Ne("svg"),t=Ne("path"),this.h()},l(n){e=Pe(n,"svg",{class:!0,"stroke-width":!0,"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0});var o=M(e);t=Pe(o,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),M(t).forEach(_),o.forEach(_),this.h()},h(){m(t,"stroke","currentColor"),m(t,"stroke-linecap","round"),m(t,"stroke-linejoin","round"),m(t,"stroke-width","2"),m(t,"d","m3 16 5-7 6 6.5m6.5 2.5L16 13l-4.286 6M14 10h.01M4 19h16a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1Z"),m(e,"class",l[0]),m(e,"stroke-width",l[1]),m(e,"aria-hidden","true"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","none"),m(e,"viewBox","0 0 24 24")},m(n,o){A(n,e,o),k(e,t)},p(n,[o]){o&1&&m(e,"class",n[0]),o&2&&m(e,"stroke-width",n[1])},i:we,o:we,d(n){n&&_(e)}}}function Ff(l,e,t){let{className:n="size-4"}=e,{strokeWidth:o="1.5"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}class jf extends Re{constructor(e){super(),Ue(this,e,Ff,Wf,Fe,{className:0,strokeWidth:1})}}function Yf(l){let e,t;return{c(){e=Ne("svg"),t=Ne("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var o=M(e);t=Pe(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),M(t).forEach(_),o.forEach(_),this.h()},h(){m(t,"stroke-linecap","round"),m(t,"stroke-linejoin","round"),m(t,"d","m6.75 7.5 3 2.25-3 2.25m4.5 0h3m-9 8.25h13.5A2.25 2.25 0 0 0 21 18V6a2.25 2.25 0 0 0-2.25-2.25H5.25A2.25 2.25 0 0 0 3 6v12a2.25 2.25 0 0 0 2.25 2.25Z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","none"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width",l[1]),m(e,"stroke","currentColor"),m(e,"class",l[0])},m(n,o){A(n,e,o),k(e,t)},p(n,[o]){o&2&&m(e,"stroke-width",n[1]),o&1&&m(e,"class",n[0])},i:we,o:we,d(n){n&&_(e)}}}function Xf(l,e,t){let{className:n="w-4 h-4"}=e,{strokeWidth:o="1.5"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}class Kf extends Re{constructor(e){super(),Ue(this,e,Xf,Yf,Fe,{className:0,strokeWidth:1})}}function Fs(l,e,t){const n=l.slice();return n[83]=e[t],n[85]=t,n}function js(l,e,t){const n=l.slice();return n[86]=e[t],n[88]=t,n}function Ys(l){var F,G;let e,t,n,o,s,i,r,a,c,u,f,h,d,p,b,v,g,w,y,I,S,T,E,H,O=l[6]===!1&&((F=l[12])==null?void 0:F.currentId)&&Xs(l),B=(l[0]!==void 0||l[3].length>0||l[5]||(((G=l[24])==null?void 0:G.webSearch)??!1)==="always"||l[4]||l[7])&&Ks(l);function j(K){l[42](K)}function Z(K){l[43](K)}let R={};l[1]!==void 0&&(R.prompt=l[1]),l[2]!==void 0&&(R.files=l[2]),a=new Uf({props:R}),l[41](a),We.push(()=>Je(a,"prompt",j)),We.push(()=>Je(a,"files",Z)),a.$on("upload",l[44]),a.$on("select",l[45]);const C=[qf,Gf],Y=[];function N(K,X){return K[17]?0:1}return w=N(l),y=Y[w]=C[w](l),{c(){e=V("div"),t=V("div"),n=V("div"),o=V("div"),O&&O.c(),s=ee(),i=V("div"),B&&B.c(),r=ee(),ne(a.$$.fragment),h=ee(),d=V("div"),p=V("div"),b=V("div"),v=V("input"),g=ee(),y.c(),this.h()},l(K){e=z(K,"DIV",{class:!0});var X=M(e);t=z(X,"DIV",{class:!0});var Q=M(t);n=z(Q,"DIV",{class:!0});var U=M(n);o=z(U,"DIV",{class:!0});var J=M(o);O&&O.l(J),J.forEach(_),s=te(U),i=z(U,"DIV",{class:!0});var q=M(i);B&&B.l(q),r=te(q),se(a.$$.fragment,q),q.forEach(_),U.forEach(_),Q.forEach(_),h=te(X),d=z(X,"DIV",{class:!0});var ce=M(d);p=z(ce,"DIV",{class:!0});var ge=M(p);b=z(ge,"DIV",{class:!0});var re=M(b);v=z(re,"INPUT",{type:!0}),g=te(re),y.l(re),re.forEach(_),ge.forEach(_),ce.forEach(_),X.forEach(_),this.h()},h(){var K,X;m(o,"class","relative"),m(i,"class","w-full relative"),m(n,"class",f="flex flex-col px-3 "+(((K=l[24])==null?void 0:K.widescreenMode)??null?"max-w-full":"max-w-6xl")+" w-full"),m(t,"class","mx-auto inset-x-0 bg-transparent flex justify-center"),m(v,"type","file"),v.hidden=!0,v.multiple=!0,m(b,"class",""),m(p,"class",I=(((X=l[24])==null?void 0:X.widescreenMode)??null?"max-w-full":"max-w-6xl")+" px-2.5 mx-auto inset-x-0"),m(d,"class",S=l[8]?"bg-transparent":"bg-white dark:bg-gray-900"),m(e,"class","w-full font-primary")},m(K,X){A(K,e,X),k(e,t),k(t,n),k(n,o),O&&O.m(o,null),k(n,s),k(n,i),B&&B.m(i,null),k(i,r),le(a,i,null),k(e,h),k(e,d),k(d,p),k(p,b),k(b,v),l[46](v),k(b,g),Y[w].m(b,null),T=!0,E||(H=[ke(v,"change",l[47]),ke(v,"change",l[48])],E=!0)},p(K,X){var J,q,ce,ge;K[6]===!1&&((J=K[12])!=null&&J.currentId)?O?O.p(K,X):(O=Xs(K),O.c(),O.m(o,null)):O&&(O.d(1),O=null),K[0]!==void 0||K[3].length>0||K[5]||(((q=K[24])==null?void 0:q.webSearch)??!1)==="always"||K[4]||K[7]?B?(B.p(K,X),X[0]&16777401&&D(B,1)):(B=Ks(K),B.c(),D(B,1),B.m(i,r)):B&&(He(),P(B,1,1,()=>{B=null}),Be());const Q={};!c&&X[0]&2&&(c=!0,Q.prompt=K[1],qe(()=>c=!1)),!u&&X[0]&4&&(u=!0,Q.files=K[2],qe(()=>u=!1)),a.$set(Q),(!T||X[0]&16777216&&f!==(f="flex flex-col px-3 "+(((ce=K[24])==null?void 0:ce.widescreenMode)??null?"max-w-full":"max-w-6xl")+" w-full"))&&m(n,"class",f);let U=w;w=N(K),w===U?Y[w].p(K,X):(He(),P(Y[U],1,1,()=>{Y[U]=null}),Be(),y=Y[w],y?y.p(K,X):(y=Y[w]=C[w](K),y.c()),D(y,1),y.m(b,null)),(!T||X[0]&16777216&&I!==(I=(((ge=K[24])==null?void 0:ge.widescreenMode)??null?"max-w-full":"max-w-6xl")+" px-2.5 mx-auto inset-x-0"))&&m(p,"class",I),(!T||X[0]&256&&S!==(S=K[8]?"bg-transparent":"bg-white dark:bg-gray-900"))&&m(d,"class",S)},i(K){T||(D(B),D(a.$$.fragment,K),D(y),T=!0)},o(K){P(B),P(a.$$.fragment,K),P(y),T=!1},d(K){K&&_(e),O&&O.d(),B&&B.d(),l[41](null),oe(a),l[46](null),Y[w].d(),E=!1,on(H)}}}function Xs(l){let e,t,n='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M10 3a.75.75 0 01.75.75v10.638l3.96-4.158a.75.75 0 111.08 1.04l-5.25 5.5a.75.75 0 01-1.08 0l-5.25-5.5a.75.75 0 111.08-1.04l3.96 4.158V3.75A.75.75 0 0110 3z" clip-rule="evenodd"></path></svg>',o,s;return{c(){e=V("div"),t=V("button"),t.innerHTML=n,this.h()},l(i){e=z(i,"DIV",{class:!0});var r=M(e);t=z(r,"BUTTON",{class:!0,"data-svelte-h":!0}),ut(t)!=="svelte-h8r9o0"&&(t.innerHTML=n),r.forEach(_),this.h()},h(){m(t,"class","bg-white border border-gray-100 dark:border-none dark:bg-white/20 p-1.5 rounded-full pointer-events-auto"),m(e,"class","absolute -top-12 left-0 right-0 flex justify-center z-30 pointer-events-none")},m(i,r){A(i,e,r),k(e,t),o||(s=ke(t,"click",l[37]),o=!0)},p:we,d(i){i&&_(e),o=!1,s()}}}function Ks(l){var h,d,p;let e,t,n,o,s,i,r=l[3].length>0&&Zs(l),a=(l[5]||(((d=(h=l[26])==null?void 0:h.features)==null?void 0:d.enable_web_search)&&(((p=l[24])==null?void 0:p.webSearch)??!1))==="always")&&Js(l),c=l[4]&&Qs(l),u=l[7]&&xs(l),f=l[0]!==void 0&&$s(l);return{c(){e=V("div"),r&&r.c(),t=ee(),a&&a.c(),n=ee(),c&&c.c(),o=ee(),u&&u.c(),s=ee(),f&&f.c(),this.h()},l(b){e=z(b,"DIV",{class:!0});var v=M(e);r&&r.l(v),t=te(v),a&&a.l(v),n=te(v),c&&c.l(v),o=te(v),u&&u.l(v),s=te(v),f&&f.l(v),v.forEach(_),this.h()},h(){m(e,"class","px-3 pb-0.5 pt-1.5 text-left w-full flex flex-col absolute bottom-0 left-0 right-0 bg-linear-to-t from-white dark:from-gray-900 z-10")},m(b,v){A(b,e,v),r&&r.m(e,null),k(e,t),a&&a.m(e,null),k(e,n),c&&c.m(e,null),k(e,o),u&&u.m(e,null),k(e,s),f&&f.m(e,null),i=!0},p(b,v){var g,w,y;b[3].length>0?r?(r.p(b,v),v[0]&8&&D(r,1)):(r=Zs(b),r.c(),D(r,1),r.m(e,t)):r&&(He(),P(r,1,1,()=>{r=null}),Be()),b[5]||(((w=(g=b[26])==null?void 0:g.features)==null?void 0:w.enable_web_search)&&(((y=b[24])==null?void 0:y.webSearch)??!1))==="always"?a?a.p(b,v):(a=Js(b),a.c(),a.m(e,n)):a&&(a.d(1),a=null),b[4]?c?c.p(b,v):(c=Qs(b),c.c(),c.m(e,o)):c&&(c.d(1),c=null),b[7]?u?u.p(b,v):(u=xs(b),u.c(),u.m(e,s)):u&&(u.d(1),u=null),b[0]!==void 0?f?(f.p(b,v),v[0]&1&&D(f,1)):(f=$s(b),f.c(),D(f,1),f.m(e,null)):f&&(He(),P(f,1,1,()=>{f=null}),Be())},i(b){i||(D(r),D(f),i=!0)},o(b){P(r),P(f),i=!1},d(b){b&&_(e),r&&r.d(),a&&a.d(),c&&c.d(),u&&u.d(),f&&f.d()}}}function Zs(l){let e,t,n,o='<span class="relative flex size-2"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-yellow-400 opacity-75"></span> <span class="relative inline-flex rounded-full size-2 bg-yellow-500"></span></span>',s,i,r=[],a=new Map,c,u=vt(l[3].map(l[38]));const f=h=>h[88];for(let h=0;h<u.length;h+=1){let d=js(l,u,h),p=f(d);a.set(p,r[h]=qs(p,d))}return{c(){e=V("div"),t=V("div"),n=V("div"),n.innerHTML=o,s=ee(),i=V("div");for(let h=0;h<r.length;h+=1)r[h].c();this.h()},l(h){e=z(h,"DIV",{class:!0});var d=M(e);t=z(d,"DIV",{class:!0});var p=M(t);n=z(p,"DIV",{class:!0,"data-svelte-h":!0}),ut(n)!=="svelte-1exsj7u"&&(n.innerHTML=o),s=te(p),i=z(p,"DIV",{class:!0});var b=M(i);for(let v=0;v<r.length;v+=1)r[v].l(b);b.forEach(_),p.forEach(_),d.forEach(_),this.h()},h(){m(n,"class","pl-1"),m(i,"class","text-ellipsis line-clamp-1 flex"),m(t,"class","flex items-center gap-2.5 text-sm dark:text-gray-500"),m(e,"class","flex items-center justify-between w-full")},m(h,d){A(h,e,d),k(e,t),k(t,n),k(t,s),k(t,i);for(let p=0;p<r.length;p+=1)r[p]&&r[p].m(i,null);c=!0},p(h,d){d[0]&268435464&&(u=vt(h[3].map(h[38])),He(),r=bo(r,d,f,1,h,u,a,i,vo,qs,null,js),Be())},i(h){if(!c){for(let d=0;d<u.length;d+=1)D(r[d]);c=!0}},o(h){for(let d=0;d<r.length;d+=1)P(r[d]);c=!1},d(h){h&&_(e);for(let d=0;d<r.length;d+=1)r[d].d()}}}function Zf(l){let e=l[86].name+"",t;return{c(){t=Ie(e)},l(n){t=Se(n,e)},m(n,o){A(n,t,o)},p(n,o){o[0]&268435464&&e!==(e=n[86].name+"")&&Te(t,e)},d(n){n&&_(t)}}}function Gs(l){let e,t=", ";return{c(){e=V("span"),e.textContent=t},l(n){e=z(n,"SPAN",{"data-svelte-h":!0}),ut(e)!=="svelte-1okzske"&&(e.textContent=t)},m(n,o){A(n,e,o)},d(n){n&&_(e)}}}function qs(l,e){var a,c;let t,n,o,s,i;n=new Rt({props:{content:((c=(a=e[86])==null?void 0:a.meta)==null?void 0:c.description)??"",className:" "+(e[88]!==0?"pl-0.5":"")+" shrink-0",placement:"top",$$slots:{default:[Zf]},$$scope:{ctx:e}}});let r=e[88]!==e[3].length-1&&Gs();return{key:l,first:null,c(){t=Ae(),ne(n.$$.fragment),o=ee(),r&&r.c(),s=Ae(),this.h()},l(u){t=Ae(),se(n.$$.fragment,u),o=te(u),r&&r.l(u),s=Ae(),this.h()},h(){this.first=t},m(u,f){A(u,t,f),le(n,u,f),A(u,o,f),r&&r.m(u,f),A(u,s,f),i=!0},p(u,f){var d,p;e=u;const h={};f[0]&268435464&&(h.content=((p=(d=e[86])==null?void 0:d.meta)==null?void 0:p.description)??""),f[0]&268435464&&(h.className=" "+(e[88]!==0?"pl-0.5":"")+" shrink-0"),f[0]&268435464|f[2]&134217728&&(h.$$scope={dirty:f,ctx:e}),n.$set(h),e[88]!==e[3].length-1?r||(r=Gs(),r.c(),r.m(s.parentNode,s)):r&&(r.d(1),r=null)},i(u){i||(D(n.$$.fragment,u),i=!0)},o(u){P(n.$$.fragment,u),i=!1},d(u){u&&(_(t),_(o),_(s)),oe(n,u),r&&r.d(u)}}}function Js(l){let e,t,n,o='<span class="relative flex size-2"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"></span> <span class="relative inline-flex rounded-full size-2 bg-blue-500"></span></span>',s,i,r=l[25].t("Search the internet")+"",a;return{c(){e=V("div"),t=V("div"),n=V("div"),n.innerHTML=o,s=ee(),i=V("div"),a=Ie(r),this.h()},l(c){e=z(c,"DIV",{class:!0});var u=M(e);t=z(u,"DIV",{class:!0});var f=M(t);n=z(f,"DIV",{class:!0,"data-svelte-h":!0}),ut(n)!=="svelte-19sghfm"&&(n.innerHTML=o),s=te(f),i=z(f,"DIV",{class:!0});var h=M(i);a=Se(h,r),h.forEach(_),f.forEach(_),u.forEach(_),this.h()},h(){m(n,"class","pl-1"),m(i,"class","translate-y-[0.5px]"),m(t,"class","flex items-center gap-2.5 text-sm dark:text-gray-500"),m(e,"class","flex items-center justify-between w-full")},m(c,u){A(c,e,u),k(e,t),k(t,n),k(t,s),k(t,i),k(i,a)},p(c,u){u[0]&33554432&&r!==(r=c[25].t("Search the internet")+"")&&Te(a,r)},d(c){c&&_(e)}}}function Qs(l){let e,t,n,o='<span class="relative flex size-2"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-teal-400 opacity-75"></span> <span class="relative inline-flex rounded-full size-2 bg-teal-500"></span></span>',s,i,r=l[25].t("Generate an image")+"",a;return{c(){e=V("div"),t=V("div"),n=V("div"),n.innerHTML=o,s=ee(),i=V("div"),a=Ie(r),this.h()},l(c){e=z(c,"DIV",{class:!0});var u=M(e);t=z(u,"DIV",{class:!0});var f=M(t);n=z(f,"DIV",{class:!0,"data-svelte-h":!0}),ut(n)!=="svelte-kf1e3u"&&(n.innerHTML=o),s=te(f),i=z(f,"DIV",{class:!0});var h=M(i);a=Se(h,r),h.forEach(_),f.forEach(_),u.forEach(_),this.h()},h(){m(n,"class","pl-1"),m(i,"class","translate-y-[0.5px]"),m(t,"class","flex items-center gap-2.5 text-sm dark:text-gray-500"),m(e,"class","flex items-center justify-between w-full")},m(c,u){A(c,e,u),k(e,t),k(t,n),k(t,s),k(t,i),k(i,a)},p(c,u){u[0]&33554432&&r!==(r=c[25].t("Generate an image")+"")&&Te(a,r)},d(c){c&&_(e)}}}function xs(l){let e,t,n,o='<span class="relative flex size-2"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span> <span class="relative inline-flex rounded-full size-2 bg-green-500"></span></span>',s,i,r=l[25].t("Execute code for analysis")+"",a;return{c(){e=V("div"),t=V("div"),n=V("div"),n.innerHTML=o,s=ee(),i=V("div"),a=Ie(r),this.h()},l(c){e=z(c,"DIV",{class:!0});var u=M(e);t=z(u,"DIV",{class:!0});var f=M(t);n=z(f,"DIV",{class:!0,"data-svelte-h":!0}),ut(n)!=="svelte-12j611w"&&(n.innerHTML=o),s=te(f),i=z(f,"DIV",{class:!0});var h=M(i);a=Se(h,r),h.forEach(_),f.forEach(_),u.forEach(_),this.h()},h(){m(n,"class","pl-1"),m(i,"class","translate-y-[0.5px]"),m(t,"class","flex items-center gap-2.5 text-sm dark:text-gray-500"),m(e,"class","flex items-center justify-between w-full")},m(c,u){A(c,e,u),k(e,t),k(t,n),k(t,s),k(t,i),k(i,a)},p(c,u){u[0]&33554432&&r!==(r=c[25].t("Execute code for analysis")+"")&&Te(a,r)},d(c){c&&_(e)}}}function $s(l){let e,t,n,o,s,i,r,a,c=l[0].name+"",u,f,h,d,p,b,v,g;return p=new So({}),{c(){e=V("div"),t=V("div"),n=V("img"),s=ee(),i=V("div"),r=Ie("Talking to "),a=V("span"),u=Ie(c),f=ee(),h=V("div"),d=V("button"),ne(p.$$.fragment),this.h()},l(w){e=z(w,"DIV",{class:!0});var y=M(e);t=z(y,"DIV",{class:!0});var I=M(t);n=z(I,"IMG",{crossorigin:!0,alt:!0,class:!0,src:!0}),s=te(I),i=z(I,"DIV",{class:!0});var S=M(i);r=Se(S,"Talking to "),a=z(S,"SPAN",{class:!0});var T=M(a);u=Se(T,c),T.forEach(_),S.forEach(_),I.forEach(_),f=te(y),h=z(y,"DIV",{});var E=M(h);d=z(E,"BUTTON",{class:!0});var H=M(d);se(p.$$.fragment,H),H.forEach(_),E.forEach(_),y.forEach(_),this.h()},h(){var w,y,I;m(n,"crossorigin","anonymous"),m(n,"alt","model profile"),m(n,"class","size-3.5 max-w-[28px] object-cover rounded-full"),Jn(n.src,o=((I=(y=(w=l[14].find(l[39]))==null?void 0:w.info)==null?void 0:y.meta)==null?void 0:I.profile_image_url)??(l[25].language==="dg-DG"?"/doge.png":`${Hl}/static/favicon.png`))||m(n,"src",o),m(a,"class","font-medium"),m(i,"class","translate-y-[0.5px]"),m(t,"class","pl-[1px] flex items-center gap-2 text-sm dark:text-gray-500"),m(d,"class","flex items-center dark:text-gray-500"),m(e,"class","flex items-center justify-between w-full")},m(w,y){A(w,e,y),k(e,t),k(t,n),k(t,s),k(t,i),k(i,r),k(i,a),k(a,u),k(e,f),k(e,h),k(h,d),le(p,d,null),b=!0,v||(g=ke(d,"click",l[40]),v=!0)},p(w,y){var I,S,T;(!b||y[0]&33570817&&!Jn(n.src,o=((T=(S=(I=w[14].find(w[39]))==null?void 0:I.info)==null?void 0:S.meta)==null?void 0:T.profile_image_url)??(w[25].language==="dg-DG"?"/doge.png":`${Hl}/static/favicon.png`)))&&m(n,"src",o),(!b||y[0]&1)&&c!==(c=w[0].name+"")&&Te(u,c)},i(w){b||(D(p.$$.fragment,w),b=!0)},o(w){P(p.$$.fragment,w),b=!1},d(w){w&&_(e),oe(p),v=!1,g()}}}function Gf(l){var G,K;let e,t,n,o,s,i,r,a,c,u,f,h,d,p,b,v,g,w,y,I,S,T,E=l[2].length>0&&er(l);const H=[ed,$f],O=[];function B(X,Q){var U;return((U=X[24])==null?void 0:U.richTextInput)??!0?0:1}s=B(l),i=O[s]=H[s](l);function j(X){l[71](X)}let Z={screenCaptureHandler:l[33],inputFilesHandler:l[35],uploadFilesHandler:l[68],uploadGoogleDriveHandler:l[69],onClose:l[70],$$slots:{default:[td]},$$scope:{ctx:l}};l[3]!==void 0&&(Z.selectedToolIds=l[3]),u=new mf({props:Z}),We.push(()=>Je(u,"selectedToolIds",j));let R=l[27]&&lr(l),C=(!((G=l[12])!=null&&G.currentId)||((K=l[12].messages[l[12].currentId])==null?void 0:K.done)==!0)&&ir(l);const Y=[id,rd],N=[];function F(X,Q){var U;return!X[12].currentId||((U=X[12].messages[X[12].currentId])==null?void 0:U.done)==!0?0:1}return g=F(l),w=N[g]=Y[g](l),{c(){e=V("form"),t=V("div"),E&&E.c(),n=ee(),o=V("div"),i.c(),r=ee(),a=V("div"),c=V("div"),ne(u.$$.fragment),h=ee(),d=V("div"),R&&R.c(),p=ee(),b=V("div"),C&&C.c(),v=ee(),w.c(),this.h()},l(X){e=z(X,"FORM",{class:!0});var Q=M(e);t=z(Q,"DIV",{class:!0,dir:!0});var U=M(t);E&&E.l(U),n=te(U),o=z(U,"DIV",{class:!0});var J=M(o);i.l(J),J.forEach(_),r=te(U),a=z(U,"DIV",{class:!0});var q=M(a);c=z(q,"DIV",{class:!0});var ce=M(c);se(u.$$.fragment,ce),h=te(ce),d=z(ce,"DIV",{class:!0});var ge=M(d);R&&R.l(ge),ge.forEach(_),ce.forEach(_),p=te(q),b=z(q,"DIV",{class:!0});var re=M(b);C&&C.l(re),v=te(re),w.l(re),re.forEach(_),q.forEach(_),U.forEach(_),Q.forEach(_),this.h()},h(){var X;m(o,"class","px-2.5"),m(d,"class","flex gap-0.5 items-center overflow-x-auto scrollbar-none flex-1"),m(c,"class","ml-1 self-end gap-0.5 flex items-center flex-1 max-w-[80%]"),m(b,"class","self-end flex space-x-1 mr-1 shrink-0"),m(a,"class","flex justify-between mt-1.5 mb-2.5 mx-0.5 max-w-full"),m(t,"class","flex-1 flex flex-col relative w-full rounded-3xl px-1 bg-gray-600/5 dark:bg-gray-400/5 dark:text-gray-100"),m(t,"dir",y=((X=l[24])==null?void 0:X.chatDirection)??"LTR"),m(e,"class","w-full flex gap-1.5")},m(X,Q){A(X,e,Q),k(e,t),E&&E.m(t,null),k(t,n),k(t,o),O[s].m(o,null),k(t,r),k(t,a),k(a,c),le(u,c,null),k(c,h),k(c,d),R&&R.m(d,null),k(a,p),k(a,b),C&&C.m(b,null),k(b,v),N[g].m(b,null),I=!0,S||(T=ke(e,"submit",jl(l[77])),S=!0)},p(X,Q){var ce,ge,re;X[2].length>0?E?(E.p(X,Q),Q[0]&4&&D(E,1)):(E=er(X),E.c(),D(E,1),E.m(t,n)):E&&(He(),P(E,1,1,()=>{E=null}),Be());let U=s;s=B(X),s===U?O[s].p(X,Q):(He(),P(O[U],1,1,()=>{O[U]=null}),Be(),i=O[s],i?i.p(X,Q):(i=O[s]=H[s](X),i.c()),D(i,1),i.m(o,null));const J={};Q[0]&524288&&(J.uploadFilesHandler=X[68]),Q[0]&33554432&&(J.uploadGoogleDriveHandler=X[69]),Q[2]&134217728&&(J.$$scope={dirty:Q,ctx:X}),!f&&Q[0]&8&&(f=!0,J.selectedToolIds=X[3],qe(()=>f=!1)),u.$set(J),X[27]?R?(R.p(X,Q),Q[0]&134217728&&D(R,1)):(R=lr(X),R.c(),D(R,1),R.m(d,null)):R&&(He(),P(R,1,1,()=>{R=null}),Be()),!((ce=X[12])!=null&&ce.currentId)||((ge=X[12].messages[X[12].currentId])==null?void 0:ge.done)==!0?C?(C.p(X,Q),Q[0]&4096&&D(C,1)):(C=ir(X),C.c(),D(C,1),C.m(b,v)):C&&(He(),P(C,1,1,()=>{C=null}),Be());let q=g;g=F(X),g===q?N[g].p(X,Q):(He(),P(N[q],1,1,()=>{N[q]=null}),Be(),w=N[g],w?w.p(X,Q):(w=N[g]=Y[g](X),w.c()),D(w,1),w.m(b,null)),(!I||Q[0]&16777216&&y!==(y=((re=X[24])==null?void 0:re.chatDirection)??"LTR"))&&m(t,"dir",y)},i(X){I||(D(E),D(i),D(u.$$.fragment,X),D(R),D(C),D(w),I=!0)},o(X){P(E),P(i),P(u.$$.fragment,X),P(R),P(C),P(w),I=!1},d(X){X&&_(e),E&&E.d(),O[s].d(),oe(u),R&&R.d(),C&&C.d(),N[g].d(),S=!1,T()}}}function qf(l){let e,t,n;function o(i){l[49](i)}let s={};return l[17]!==void 0&&(s.recording=l[17]),e=new jc({props:s}),We.push(()=>Je(e,"recording",o)),e.$on("cancel",l[50]),e.$on("confirm",l[51]),{c(){ne(e.$$.fragment)},l(i){se(e.$$.fragment,i)},m(i,r){le(e,i,r),n=!0},p(i,r){const a={};!t&&r[0]&131072&&(t=!0,a.recording=i[17],qe(()=>t=!1)),e.$set(a)},i(i){n||(D(e.$$.fragment,i),n=!0)},o(i){P(e.$$.fragment,i),n=!1},d(i){oe(e,i)}}}function er(l){let e,t,n=vt(l[2]),o=[];for(let i=0;i<n.length;i+=1)o[i]=nr(Fs(l,n,i));const s=i=>P(o[i],1,1,()=>{o[i]=null});return{c(){e=V("div");for(let i=0;i<o.length;i+=1)o[i].c();this.h()},l(i){e=z(i,"DIV",{class:!0});var r=M(e);for(let a=0;a<o.length;a+=1)o[a].l(r);r.forEach(_),this.h()},h(){m(e,"class","mx-2 mt-2.5 -mb-1 flex items-center flex-wrap gap-2")},m(i,r){A(i,e,r);for(let a=0;a<o.length;a+=1)o[a]&&o[a].m(e,null);t=!0},p(i,r){if(r[0]&41945093){n=vt(i[2]);let a;for(a=0;a<n.length;a+=1){const c=Fs(i,n,a);o[a]?(o[a].p(c,r),D(o[a],1)):(o[a]=nr(c),o[a].c(),D(o[a],1),o[a].m(e,null))}for(He(),a=n.length;a<o.length;a+=1)s(a);Be()}},i(i){if(!t){for(let r=0;r<n.length;r+=1)D(o[r]);t=!0}},o(i){o=o.filter(Boolean);for(let r=0;r<o.length;r+=1)P(o[r]);t=!1},d(i){i&&_(e),Dn(o,i)}}}function Jf(l){var s;let e,t;function n(){return l[54](l[83],l[85])}function o(){return l[55](l[83])}return e=new qi({props:{item:l[83],name:l[83].name,type:l[83].type,size:(s=l[83])==null?void 0:s.size,loading:l[83].status==="uploading",dismissible:!0,edit:!0}}),e.$on("dismiss",n),e.$on("click",o),{c(){ne(e.$$.fragment)},l(i){se(e.$$.fragment,i)},m(i,r){le(e,i,r),t=!0},p(i,r){var c;l=i;const a={};r[0]&4&&(a.item=l[83]),r[0]&4&&(a.name=l[83].name),r[0]&4&&(a.type=l[83].type),r[0]&4&&(a.size=(c=l[83])==null?void 0:c.size),r[0]&4&&(a.loading=l[83].status==="uploading"),e.$set(a)},i(i){t||(D(e.$$.fragment,i),t=!0)},o(i){P(e.$$.fragment,i),t=!1},d(i){oe(e,i)}}}function Qf(l){let e,t,n,o,s,i,r,a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-4"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',c,u,f,h;n=new qc({props:{src:l[83].url,alt:"input",imageClassName:" size-14 rounded-xl object-cover"}});let d=(l[0]?l[23].length===0:l[11].length!==l[23].length)&&tr(l);function p(){return l[53](l[85])}return{c(){e=V("div"),t=V("div"),ne(n.$$.fragment),o=ee(),d&&d.c(),s=ee(),i=V("div"),r=V("button"),r.innerHTML=a,c=ee(),this.h()},l(b){e=z(b,"DIV",{class:!0});var v=M(e);t=z(v,"DIV",{class:!0});var g=M(t);se(n.$$.fragment,g),o=te(g),d&&d.l(g),g.forEach(_),s=te(v),i=z(v,"DIV",{class:!0});var w=M(i);r=z(w,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),ut(r)!=="svelte-4ewxlv"&&(r.innerHTML=a),w.forEach(_),c=te(v),v.forEach(_),this.h()},h(){m(t,"class","relative flex items-center"),m(r,"class","bg-white text-black border border-white rounded-full group-hover:visible invisible transition"),m(r,"type","button"),m(i,"class","absolute -top-1 -right-1"),m(e,"class","relative group")},m(b,v){A(b,e,v),k(e,t),le(n,t,null),k(t,o),d&&d.m(t,null),k(e,s),k(e,i),k(i,r),k(e,c),u=!0,f||(h=ke(r,"click",p),f=!0)},p(b,v){l=b;const g={};v[0]&4&&(g.src=l[83].url),n.$set(g),(l[0]?l[23].length===0:l[11].length!==l[23].length)?d?(d.p(l,v),v[0]&8390657&&D(d,1)):(d=tr(l),d.c(),D(d,1),d.m(t,null)):d&&(He(),P(d,1,1,()=>{d=null}),Be())},i(b){u||(D(n.$$.fragment,b),D(d),u=!0)},o(b){P(n.$$.fragment,b),P(d),u=!1},d(b){b&&_(e),oe(n),d&&d.d(),f=!1,h()}}}function tr(l){let e,t;return e=new Rt({props:{className:" absolute top-1 left-1",content:l[25].t("{{ models }}",{models:[...l[0]?[l[0]]:l[11]].filter(l[52]).join(", ")}),$$slots:{default:[xf]},$$scope:{ctx:l}}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o[0]&41945089&&(s.content=n[25].t("{{ models }}",{models:[...n[0]?[n[0]]:n[11]].filter(n[52]).join(", ")})),o[2]&134217728&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function xf(l){let e,t;return{c(){e=Ne("svg"),t=Ne("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var o=M(e);t=Pe(o,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),M(t).forEach(_),o.forEach(_),this.h()},h(){m(t,"fill-rule","evenodd"),m(t,"d","M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z"),m(t,"clip-rule","evenodd"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 24 24"),m(e,"fill","currentColor"),m(e,"class","size-4 fill-yellow-300")},m(n,o){A(n,e,o),k(e,t)},p:we,d(n){n&&_(e)}}}function nr(l){let e,t,n,o;const s=[Qf,Jf],i=[];function r(a,c){return a[83].type==="image"?0:1}return e=r(l),t=i[e]=s[e](l),{c(){t.c(),n=Ae()},l(a){t.l(a),n=Ae()},m(a,c){i[e].m(a,c),A(a,n,c),o=!0},p(a,c){let u=e;e=r(a),e===u?i[e].p(a,c):(He(),P(i[u],1,1,()=>{i[u]=null}),Be(),t=i[e],t?t.p(a,c):(t=i[e]=s[e](a),t.c()),D(t,1),t.m(n.parentNode,n))},i(a){o||(D(t),o=!0)},o(a){P(t),o=!1},d(a){a&&_(n),i[e].d(a)}}}function $f(l){let e,t,n,o;return{c(){e=V("textarea"),this.h()},l(s){e=z(s,"TEXTAREA",{id:!0,class:!0,placeholder:!0,rows:!0}),M(e).forEach(_),this.h()},h(){m(e,"id","chat-input"),m(e,"class","scrollbar-hidden bg-transparent dark:text-gray-100 outline-hidden w-full pt-3 px-1 resize-none"),m(e,"placeholder",t=l[13]?l[13]:l[25].t("Send a Message")),m(e,"rows","1")},m(s,i){A(s,e,i),l[61](e),Sn(e,l[1]),n||(o=[ke(e,"input",l[62]),ke(e,"keypress",l[63]),ke(e,"keydown",l[64]),ke(e,"input",l[65]),ke(e,"focus",l[66]),ke(e,"paste",l[67])],n=!0)},p(s,i){i[0]&33562624&&t!==(t=s[13]?s[13]:s[25].t("Send a Message"))&&m(e,"placeholder",t),i[0]&2&&Sn(e,s[1])},i:we,o:we,d(s){s&&_(e),l[61](null),n=!1,on(o)}}}function ed(l){var r,a;let e,t,n,o;function s(c){l[58](c)}let i={id:"chat-input",messageInput:!0,shiftEnter:!l[29]||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0),placeholder:l[13]?l[13]:l[25].t("Send a Message"),largeTextAsFile:((r=l[24])==null?void 0:r.largeTextAsFile)??!1,autocomplete:(a=l[26])==null?void 0:a.features.enable_autocomplete_generation,generateAutoCompletion:l[56]};return l[1]!==void 0&&(i.value=l[1]),t=new Yc({props:i}),l[57](t),We.push(()=>Je(t,"value",s)),t.$on("keydown",l[59]),t.$on("paste",l[60]),{c(){e=V("div"),ne(t.$$.fragment),this.h()},l(c){e=z(c,"DIV",{class:!0});var u=M(e);se(t.$$.fragment,u),u.forEach(_),this.h()},h(){m(e,"class","scrollbar-hidden text-left bg-transparent dark:text-gray-100 outline-hidden w-full pt-3 px-1 resize-none h-fit max-h-80 overflow-auto")},m(c,u){A(c,e,u),le(t,e,null),o=!0},p(c,u){var h,d;const f={};u[0]&536870912&&(f.shiftEnter=!c[29]||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)),u[0]&33562624&&(f.placeholder=c[13]?c[13]:c[25].t("Send a Message")),u[0]&16777216&&(f.largeTextAsFile=((h=c[24])==null?void 0:h.largeTextAsFile)??!1),u[0]&67108864&&(f.autocomplete=(d=c[26])==null?void 0:d.features.enable_autocomplete_generation),u[0]&33591296&&(f.generateAutoCompletion=c[56]),!n&&u[0]&2&&(n=!0,f.value=c[1],qe(()=>n=!1)),t.$set(f)},i(c){o||(D(t.$$.fragment,c),o=!0)},o(c){P(t.$$.fragment,c),o=!1},d(c){c&&_(e),l[57](null),oe(t)}}}function td(l){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5"><path d="M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z"></path></svg>';return{c(){e=V("button"),e.innerHTML=t,this.h()},l(n){e=z(n,"BUTTON",{class:!0,type:!0,"aria-label":!0,"data-svelte-h":!0}),ut(e)!=="svelte-ys0us"&&(e.innerHTML=t),this.h()},h(){m(e,"class","bg-transparent hover:bg-gray-100 text-gray-800 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5 outline-hidden focus:outline-hidden"),m(e,"type","button"),m(e,"aria-label","More")},m(n,o){A(n,e,o)},p:we,d(n){n&&_(e)}}}function lr(l){var a,c,u,f,h,d,p,b,v,g,w,y,I,S,T;let e,t,n,o,s=((c=(a=l[26])==null?void 0:a.features)==null?void 0:c.enable_web_search)&&(l[27].role==="admin"||((h=(f=(u=l[27])==null?void 0:u.permissions)==null?void 0:f.features)==null?void 0:h.web_search))&&or(l),i=((p=(d=l[26])==null?void 0:d.features)==null?void 0:p.enable_image_generation)&&(l[27].role==="admin"||((g=(v=(b=l[27])==null?void 0:b.permissions)==null?void 0:v.features)==null?void 0:g.image_generation))&&sr(l),r=((y=(w=l[26])==null?void 0:w.features)==null?void 0:y.enable_code_interpreter)&&(l[27].role==="admin"||((T=(S=(I=l[27])==null?void 0:I.permissions)==null?void 0:S.features)==null?void 0:T.code_interpreter))&&rr(l);return{c(){s&&s.c(),e=ee(),i&&i.c(),t=ee(),r&&r.c(),n=Ae()},l(E){s&&s.l(E),e=te(E),i&&i.l(E),t=te(E),r&&r.l(E),n=Ae()},m(E,H){s&&s.m(E,H),A(E,e,H),i&&i.m(E,H),A(E,t,H),r&&r.m(E,H),A(E,n,H),o=!0},p(E,H){var O,B,j,Z,R,C,Y,N,F,G,K,X,Q,U,J;(B=(O=E[26])==null?void 0:O.features)!=null&&B.enable_web_search&&(E[27].role==="admin"||(R=(Z=(j=E[27])==null?void 0:j.permissions)==null?void 0:Z.features)!=null&&R.web_search)?s?(s.p(E,H),H[0]&201326592&&D(s,1)):(s=or(E),s.c(),D(s,1),s.m(e.parentNode,e)):s&&(He(),P(s,1,1,()=>{s=null}),Be()),(Y=(C=E[26])==null?void 0:C.features)!=null&&Y.enable_image_generation&&(E[27].role==="admin"||(G=(F=(N=E[27])==null?void 0:N.permissions)==null?void 0:F.features)!=null&&G.image_generation)?i?(i.p(E,H),H[0]&201326592&&D(i,1)):(i=sr(E),i.c(),D(i,1),i.m(t.parentNode,t)):i&&(He(),P(i,1,1,()=>{i=null}),Be()),(X=(K=E[26])==null?void 0:K.features)!=null&&X.enable_code_interpreter&&(E[27].role==="admin"||(J=(U=(Q=E[27])==null?void 0:Q.permissions)==null?void 0:U.features)!=null&&J.code_interpreter)?r?(r.p(E,H),H[0]&201326592&&D(r,1)):(r=rr(E),r.c(),D(r,1),r.m(n.parentNode,n)):r&&(He(),P(r,1,1,()=>{r=null}),Be())},i(E){o||(D(s),D(i),D(r),o=!0)},o(E){P(s),P(i),P(r),o=!1},d(E){E&&(_(e),_(t),_(n)),s&&s.d(E),i&&i.d(E),r&&r.d(E)}}}function or(l){let e,t;return e=new Rt({props:{content:l[25].t("Search the internet"),placement:"top",$$slots:{default:[nd]},$$scope:{ctx:l}}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o[0]&33554432&&(s.content=n[25].t("Search the internet")),o[0]&50331680|o[2]&134217728&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function nd(l){let e,t,n,o,s=l[25].t("Web Search")+"",i,r,a,c,u;return t=new $c({props:{className:"size-5",strokeWidth:"1.75"}}),{c(){e=V("button"),ne(t.$$.fragment),n=ee(),o=V("span"),i=Ie(s),this.h()},l(f){e=z(f,"BUTTON",{type:!0,class:!0});var h=M(e);se(t.$$.fragment,h),n=te(h),o=z(h,"SPAN",{class:!0});var d=M(o);i=Se(d,s),d.forEach(_),h.forEach(_),this.h()},h(){var f;m(o,"class","hidden @sm:block whitespace-nowrap overflow-hidden text-ellipsis translate-y-[0.5px] mr-0.5"),m(e,"type","button"),m(e,"class",r="px-1.5 @sm:px-2.5 py-1.5 flex gap-1.5 items-center text-sm rounded-full font-medium transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden "+(l[5]||(((f=l[24])==null?void 0:f.webSearch)??!1)==="always"?"bg-blue-100 dark:bg-blue-500/20 text-blue-500 dark:text-blue-400":"bg-transparent text-gray-600 dark:text-gray-300 border-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800"))},m(f,h){A(f,e,h),le(t,e,null),k(e,n),k(e,o),k(o,i),a=!0,c||(u=ke(e,"click",jl(l[72])),c=!0)},p(f,h){var d;(!a||h[0]&33554432)&&s!==(s=f[25].t("Web Search")+"")&&Te(i,s),(!a||h[0]&16777248&&r!==(r="px-1.5 @sm:px-2.5 py-1.5 flex gap-1.5 items-center text-sm rounded-full font-medium transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden "+(f[5]||(((d=f[24])==null?void 0:d.webSearch)??!1)==="always"?"bg-blue-100 dark:bg-blue-500/20 text-blue-500 dark:text-blue-400":"bg-transparent text-gray-600 dark:text-gray-300 border-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800")))&&m(e,"class",r)},i(f){a||(D(t.$$.fragment,f),a=!0)},o(f){P(t.$$.fragment,f),a=!1},d(f){f&&_(e),oe(t),c=!1,u()}}}function sr(l){let e,t;return e=new Rt({props:{content:l[25].t("Generate an image"),placement:"top",$$slots:{default:[ld]},$$scope:{ctx:l}}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o[0]&33554432&&(s.content=n[25].t("Generate an image")),o[0]&33554448|o[2]&134217728&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function ld(l){let e,t,n,o,s=l[25].t("Image")+"",i,r,a,c,u;return t=new jf({props:{className:"size-5",strokeWidth:"1.75"}}),{c(){e=V("button"),ne(t.$$.fragment),n=ee(),o=V("span"),i=Ie(s),this.h()},l(f){e=z(f,"BUTTON",{type:!0,class:!0});var h=M(e);se(t.$$.fragment,h),n=te(h),o=z(h,"SPAN",{class:!0});var d=M(o);i=Se(d,s),d.forEach(_),h.forEach(_),this.h()},h(){m(o,"class","hidden @sm:block whitespace-nowrap overflow-hidden text-ellipsis translate-y-[0.5px] mr-0.5"),m(e,"type","button"),m(e,"class",r="px-1.5 @sm:px-2.5 py-1.5 flex gap-1.5 items-center text-sm rounded-full font-medium transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden "+(l[4]?"bg-gray-100 dark:bg-gray-500/20 text-gray-600 dark:text-gray-400":"bg-transparent text-gray-600 dark:text-gray-300 border-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 "))},m(f,h){A(f,e,h),le(t,e,null),k(e,n),k(e,o),k(o,i),a=!0,c||(u=ke(e,"click",jl(l[73])),c=!0)},p(f,h){(!a||h[0]&33554432)&&s!==(s=f[25].t("Image")+"")&&Te(i,s),(!a||h[0]&16&&r!==(r="px-1.5 @sm:px-2.5 py-1.5 flex gap-1.5 items-center text-sm rounded-full font-medium transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden "+(f[4]?"bg-gray-100 dark:bg-gray-500/20 text-gray-600 dark:text-gray-400":"bg-transparent text-gray-600 dark:text-gray-300 border-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 ")))&&m(e,"class",r)},i(f){a||(D(t.$$.fragment,f),a=!0)},o(f){P(t.$$.fragment,f),a=!1},d(f){f&&_(e),oe(t),c=!1,u()}}}function rr(l){let e,t;return e=new Rt({props:{content:l[25].t("Execute code for analysis"),placement:"top",$$slots:{default:[od]},$$scope:{ctx:l}}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o[0]&33554432&&(s.content=n[25].t("Execute code for analysis")),o[0]&33554560|o[2]&134217728&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function od(l){let e,t,n,o,s=l[25].t("Code Interpreter")+"",i,r,a,c,u;return t=new Kf({props:{className:"size-5",strokeWidth:"1.75"}}),{c(){e=V("button"),ne(t.$$.fragment),n=ee(),o=V("span"),i=Ie(s),this.h()},l(f){e=z(f,"BUTTON",{type:!0,class:!0});var h=M(e);se(t.$$.fragment,h),n=te(h),o=z(h,"SPAN",{class:!0});var d=M(o);i=Se(d,s),d.forEach(_),h.forEach(_),this.h()},h(){m(o,"class","hidden @sm:block whitespace-nowrap overflow-hidden text-ellipsis translate-y-[0.5px] mr-0.5"),m(e,"type","button"),m(e,"class",r="px-1.5 @sm:px-2.5 py-1.5 flex gap-1.5 items-center text-sm rounded-full font-medium transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden "+(l[7]?"bg-gray-100 dark:bg-gray-500/20 text-gray-600 dark:text-gray-400":"bg-transparent text-gray-600 dark:text-gray-300 border-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 "))},m(f,h){A(f,e,h),le(t,e,null),k(e,n),k(e,o),k(o,i),a=!0,c||(u=ke(e,"click",jl(l[74])),c=!0)},p(f,h){(!a||h[0]&33554432)&&s!==(s=f[25].t("Code Interpreter")+"")&&Te(i,s),(!a||h[0]&128&&r!==(r="px-1.5 @sm:px-2.5 py-1.5 flex gap-1.5 items-center text-sm rounded-full font-medium transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden "+(f[7]?"bg-gray-100 dark:bg-gray-500/20 text-gray-600 dark:text-gray-400":"bg-transparent text-gray-600 dark:text-gray-300 border-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 ")))&&m(e,"class",r)},i(f){a||(D(t.$$.fragment,f),a=!0)},o(f){P(t.$$.fragment,f),a=!1},d(f){f&&_(e),oe(t),c=!1,u()}}}function ir(l){let e,t;return e=new Rt({props:{content:l[25].t("Record voice"),$$slots:{default:[sd]},$$scope:{ctx:l}}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o[0]&33554432&&(s.content=n[25].t("Record voice")),o[0]&33685504|o[2]&134217728&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function sd(l){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 translate-y-[0.5px]"><path d="M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z"></path><path d="M5.5 9.643a.75.75 0 00-1.5 0V10c0 3.06 2.29 5.585 5.25 5.954V17.5h-1.5a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-1.5v-1.546A6.001 6.001 0 0016 10v-.357a.75.75 0 00-1.5 0V10a4.5 4.5 0 01-9 0v-.357z"></path></svg>',n,o;return{c(){e=V("button"),e.innerHTML=t,this.h()},l(s){e=z(s,"BUTTON",{id:!0,class:!0,type:!0,"aria-label":!0,"data-svelte-h":!0}),ut(e)!=="svelte-4nqm9k"&&(e.innerHTML=t),this.h()},h(){m(e,"id","voice-input-button"),m(e,"class","text-gray-600 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-200 transition rounded-full p-1.5 mr-0.5 self-center"),m(e,"type","button"),m(e,"aria-label","Voice Input")},m(s,i){A(s,e,i),n||(o=ke(e,"click",l[75]),n=!0)},p:we,d(s){s&&_(e),n=!1,o()}}}function rd(l){let e,t,n;return t=new Rt({props:{content:l[25].t("Stop"),$$slots:{default:[ad]},$$scope:{ctx:l}}}),{c(){e=V("div"),ne(t.$$.fragment),this.h()},l(o){e=z(o,"DIV",{class:!0});var s=M(e);se(t.$$.fragment,s),s.forEach(_),this.h()},h(){m(e,"class","flex items-center")},m(o,s){A(o,e,s),le(t,e,null),n=!0},p(o,s){const i={};s[0]&33554432&&(i.content=o[25].t("Stop")),s[0]&1024|s[2]&134217728&&(i.$$scope={dirty:s,ctx:o}),t.$set(i)},i(o){n||(D(t.$$.fragment,o),n=!0)},o(o){P(t.$$.fragment,o),n=!1},d(o){o&&_(e),oe(t)}}}function id(l){let e,t,n,o;const s=[ud,cd],i=[];function r(a,c){return a[1]===""&&a[2].length===0?0:1}return e=r(l),t=i[e]=s[e](l),{c(){t.c(),n=Ae()},l(a){t.l(a),n=Ae()},m(a,c){i[e].m(a,c),A(a,n,c),o=!0},p(a,c){let u=e;e=r(a),e===u?i[e].p(a,c):(He(),P(i[u],1,1,()=>{i[u]=null}),Be(),t=i[e],t?t.p(a,c):(t=i[e]=s[e](a),t.c()),D(t,1),t.m(n.parentNode,n))},i(a){o||(D(t),o=!0)},o(a){P(t),o=!1},d(a){a&&_(n),i[e].d(a)}}}function ad(l){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-5"><path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm6-2.438c0-.724.588-1.312 1.313-1.312h4.874c.725 0 1.313.588 1.313 1.313v4.874c0 .725-.588 1.313-1.313 1.313H9.564a1.312 1.312 0 01-1.313-1.313V9.564z" clip-rule="evenodd"></path></svg>',n,o;return{c(){e=V("button"),e.innerHTML=t,this.h()},l(s){e=z(s,"BUTTON",{class:!0,"data-svelte-h":!0}),ut(e)!=="svelte-nqxd5x"&&(e.innerHTML=t),this.h()},h(){m(e,"class","bg-white hover:bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5")},m(s,i){A(s,e,i),n||(o=ke(e,"click",l[76]),n=!0)},p:we,d(s){s&&_(e),n=!1,o()}}}function cd(l){let e,t,n;return t=new Rt({props:{content:l[25].t("Send message"),$$slots:{default:[fd]},$$scope:{ctx:l}}}),{c(){e=V("div"),ne(t.$$.fragment),this.h()},l(o){e=z(o,"DIV",{class:!0});var s=M(e);se(t.$$.fragment,s),s.forEach(_),this.h()},h(){m(e,"class","flex items-center")},m(o,s){A(o,e,s),le(t,e,null),n=!0},p(o,s){const i={};s[0]&33554432&&(i.content=o[25].t("Send message")),s[0]&16777254|s[2]&134217728&&(i.$$scope={dirty:s,ctx:o}),t.$set(i)},i(o){n||(D(t.$$.fragment,o),n=!0)},o(o){P(t.$$.fragment,o),n=!1},d(o){o&&_(e),oe(t)}}}function ud(l){return{c:we,l:we,m:we,p:we,i:we,o:we,d:we}}function fd(l){let e,t,n,o,s;return{c(){e=V("button"),t=Ne("svg"),n=Ne("path"),this.h()},l(i){e=z(i,"BUTTON",{id:!0,class:!0,type:!0});var r=M(e);t=Pe(r,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var a=M(t);n=Pe(a,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),M(n).forEach(_),a.forEach(_),r.forEach(_),this.h()},h(){var i;m(n,"fill-rule","evenodd"),m(n,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),m(n,"clip-rule","evenodd"),m(t,"xmlns","http://www.w3.org/2000/svg"),m(t,"viewBox","0 0 16 16"),m(t,"fill","currentColor"),m(t,"class","size-5"),m(e,"id","send-message-button"),m(e,"class",o=(l[1]===""&&l[2].length===0?"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled":l[5]||(((i=l[24])==null?void 0:i.webSearch)??!1)==="always"?"bg-blue-500 text-white hover:bg-blue-400 ":"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ")+" transition rounded-full p-1.5 self-center"),m(e,"type","submit"),e.disabled=s=l[1]===""&&l[2].length===0},m(i,r){A(i,e,r),k(e,t),k(t,n)},p(i,r){var a;r[0]&16777254&&o!==(o=(i[1]===""&&i[2].length===0?"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled":i[5]||(((a=i[24])==null?void 0:a.webSearch)??!1)==="always"?"bg-blue-500 text-white hover:bg-blue-400 ":"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ")+" transition rounded-full p-1.5 self-center")&&m(e,"class",o),r[0]&6&&s!==(s=i[1]===""&&i[2].length===0)&&(e.disabled=s)},d(i){i&&_(e)}}}function dd(l){let e,t,n,o;e=new Ka({props:{show:l[22]}});let s=l[16]&&Ys(l);return{c(){ne(e.$$.fragment),t=ee(),s&&s.c(),n=Ae()},l(i){se(e.$$.fragment,i),t=te(i),s&&s.l(i),n=Ae()},m(i,r){le(e,i,r),A(i,t,r),s&&s.m(i,r),A(i,n,r),o=!0},p(i,r){const a={};r[0]&4194304&&(a.show=i[22]),e.$set(a),i[16]?s?(s.p(i,r),r[0]&65536&&D(s,1)):(s=Ys(i),s.c(),D(s,1),s.m(n.parentNode,n)):s&&(He(),P(s,1,1,()=>{s=null}),Be())},i(i){o||(D(e.$$.fragment,i),D(s),o=!0)},o(i){P(e.$$.fragment,i),P(s),o=!1},d(i){i&&(_(t),_(n)),oe(e,i),s&&s.d(i)}}}function hd(l,e,t){let n,o,s,i,r,a,c;ae(l,Kn,W=>t(24,n=W)),ae(l,Yl,W=>t(26,s=W)),ae(l,Qn,W=>t(27,i=W)),ae(l,dl,W=>t(14,r=W)),ae(l,ul,W=>t(28,a=W)),ae(l,wo,W=>t(29,c=W));const u=cn(),f=Ft("i18n");ae(l,f,W=>t(25,o=W));let{transparentBackground:h=!1}=e,{onChange:d=()=>{}}=e,{createMessagePair:p}=e,{stopResponse:b}=e,{autoScroll:v=!1}=e,{atSelectedModel:g=void 0}=e,{selectedModels:w}=e,y=[],{history:I}=e,{prompt:S=""}=e,{files:T=[]}=e,{selectedToolIds:E=[]}=e,{imageGenerationEnabled:H=!1}=e,{webSearchEnabled:O=!1}=e,{codeInterpreterEnabled:B=!1}=e,j=!1,Z=!1,R,C,Y,N,F=!1,{placeholder:G=""}=e,K=[];const X=()=>{const W=document.getElementById("messages-container");W.scrollTo({top:W.scrollHeight,behavior:"smooth"})},Q=async()=>{try{const W=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"never"},audio:!1}),Me=document.createElement("video");Me.srcObject=W,await Me.play();const Ze=document.createElement("canvas");Ze.width=Me.videoWidth,Ze.height=Me.videoHeight,Ze.getContext("2d").drawImage(Me,0,0,Ze.width,Ze.height),W.getTracks().forEach(at=>at.stop()),window.focus();const je=Ze.toDataURL("image/png");t(2,T=[...T,{type:"image",url:je}]),Me.srcObject=null}catch(W){console.error("Error capturing screen:",W)}},U=async(W,Me=!1)=>{var je,at,Jt,Cn;if((i==null?void 0:i.role)!=="admin"&&!(((at=(je=i==null?void 0:i.permissions)==null?void 0:je.chat)==null?void 0:at.file_upload)??!0))return nt.error(o.t("You do not have permission to upload files.")),null;const Ze=$n(),tt={type:"file",file:"",id:null,url:"",name:W.name,collection_name:"",status:"uploading",size:W.size,error:"",itemId:Ze,...Me?{context:"full"}:{}};if(tt.size==0)return nt.error(o.t("You cannot upload an empty file.")),null;if(t(2,T=[...T,tt]),["audio/mpeg","audio/wav","audio/ogg","audio/x-m4a"].includes(W.type)){const dt=await Zi(localStorage.token,W).catch(Ct=>(nt.error(`${Ct}`),null));if(dt){console.log(dt);const Ct=new Blob([dt.text],{type:"text/plain"});W=Ki(Ct,`${W.name}.txt`),tt.name=W.name,tt.size=W.size}}try{const dt=await Rc(localStorage.token,W);dt?(console.log("File upload completed:",{id:dt.id,name:tt.name,collection:(Jt=dt==null?void 0:dt.meta)==null?void 0:Jt.collection_name}),dt.error&&(console.warn("File upload warning:",dt.error),nt.warning(dt.error)),tt.status="uploaded",tt.file=dt,tt.id=dt.id,tt.collection_name=((Cn=dt==null?void 0:dt.meta)==null?void 0:Cn.collection_name)||(dt==null?void 0:dt.collection_name),tt.url=`${Ja}/files/${dt.id}`,t(2,T)):t(2,T=T.filter(Ct=>(Ct==null?void 0:Ct.itemId)!==Ze))}catch(dt){nt.error(`${dt}`),t(2,T=T.filter(Ct=>(Ct==null?void 0:Ct.itemId)!==Ze))}},J=async W=>{console.log("Input files handler called with:",W),W.forEach(Me=>{var Ze,tt,je,at;if(console.log("Processing file:",{name:Me.name,type:Me.type,size:Me.size,extension:Me.name.split(".").at(-1)}),(((Ze=s==null?void 0:s.file)==null?void 0:Ze.max_size)??null)!==null&&Me.size>(((tt=s==null?void 0:s.file)==null?void 0:tt.max_size)??0)*1024*1024){console.log("File exceeds max size limit:",{fileSize:Me.size,maxSize:(((je=s==null?void 0:s.file)==null?void 0:je.max_size)??0)*1024*1024}),nt.error(o.t("File size should not exceed {{maxSize}} MB.",{maxSize:(at=s==null?void 0:s.file)==null?void 0:at.max_size}));return}if(["image/gif","image/webp","image/jpeg","image/png","image/avif"].includes(Me.type)){if(K.length===0){nt.error(o.t("Selected model(s) do not support image inputs"));return}let Jt=new FileReader;Jt.onload=async Cn=>{var Ct,bn;let dt=Cn.target.result;if((n==null?void 0:n.imageCompression)??!1){const kn=((Ct=n==null?void 0:n.imageCompressionSize)==null?void 0:Ct.width)??null,Mn=((bn=n==null?void 0:n.imageCompressionSize)==null?void 0:bn.height)??null;(kn||Mn)&&(dt=await cc(dt,kn,Mn))}t(2,T=[...T,{type:"image",url:`${dt}`}])},Jt.readAsDataURL(Me)}else U(Me)})},q=W=>{W.key==="Escape"&&(console.log("Escape"),t(22,F=!1))},ce=W=>{var Me,Ze;W.preventDefault(),(Ze=(Me=W.dataTransfer)==null?void 0:Me.types)!=null&&Ze.includes("Files")?t(22,F=!0):t(22,F=!1)},ge=()=>{t(22,F=!1)},re=async W=>{var Me,Ze;if(W.preventDefault(),console.log(W),(Me=W.dataTransfer)!=null&&Me.files){const tt=Array.from((Ze=W.dataTransfer)==null?void 0:Ze.files);tt&&tt.length>0&&(console.log(tt),J(tt))}t(22,F=!1)};pn(async()=>{t(16,j=!0),window.setTimeout(()=>{const Me=document.getElementById("chat-input");Me==null||Me.focus()},0),window.addEventListener("keydown",q),await xe();const W=document.getElementById("chat-container");W==null||W.addEventListener("dragover",ce),W==null||W.addEventListener("drop",re),W==null||W.addEventListener("dragleave",ge)}),nl(()=>{console.log("destroy"),window.removeEventListener("keydown",q);const W=document.getElementById("chat-container");W&&(W==null||W.removeEventListener("dragover",ce),W==null||W.removeEventListener("drop",re),W==null||W.removeEventListener("dragleave",ge))});const Oe=()=>{t(6,v=!0),X()},x=W=>a?a.find(Me=>Me.id===W):{id:W,name:W},ue=W=>W.id===g.id,Ee=()=>{t(0,g=void 0)};function Xe(W){We[W?"unshift":"push"](()=>{Y=W,t(20,Y)})}function Ke(W){S=W,t(1,S)}function fe(W){T=W,t(2,T)}const lt=W=>{u("upload",W.detail)},it=W=>{const Me=W.detail;(Me==null?void 0:Me.type)==="model"&&t(0,g=Me.data);const Ze=document.getElementById("chat-input");Ze==null||Ze.focus()};function Nt(W){We[W?"unshift":"push"](()=>{C=W,t(19,C)})}function Dt(){N=this.files,t(21,N)}const Ht=async()=>{if(N&&N.length>0){const W=Array.from(N);J(W)}else nt.error(o.t("File not found."));t(19,C.value="",C)};function wt(W){Z=W,t(17,Z)}const Ut=async()=>{var W;t(17,Z=!1),await xe(),(W=document.getElementById("chat-input"))==null||W.focus()},pe=async W=>{var tt;const{text:Me,filename:Ze}=W.detail;t(1,S=`${S}${Me} `),t(17,Z=!1),await xe(),(tt=document.getElementById("chat-input"))==null||tt.focus(),((n==null?void 0:n.speechAutoSend)??!1)&&u("submit",S)},Ye=W=>!K.includes(W),ot=W=>{T.splice(W,1),t(2,T)},he=async(W,Me)=>{W.type!=="collection"&&!(W!=null&&W.collection)&&W.id&&await Uc(localStorage.token,W.id),T.splice(Me,1),t(2,T)},yt=W=>{console.log(W)},ht=async W=>{(y.length===0||!y.at(0))&&nt.error(o.t("Please select a model first."));const Me=await Tc(localStorage.token,y.at(0),W,I!=null&&I.currentId?yn(I,I.currentId):null).catch(Ze=>(console.log(Ze),null));return console.log(Me),Me};function bt(W){We[W?"unshift":"push"](()=>{R=W,t(18,R)})}function Ce(W){S=W,t(1,S)}const Pt=async W=>{var tt;W=W.detail.event;const Me=W.ctrlKey||W.metaKey,Ze=document.getElementById("commands-container");if(W.key==="Escape"&&b(),Me&&W.key==="Enter"&&W.shiftKey&&(W.preventDefault(),p(S)),S===""&&Me&&W.key.toLowerCase()==="r"){W.preventDefault(),console.log("regenerate");const je=[...document.getElementsByClassName("regenerate-response-button")].at(-1);je==null||je.click()}if(S===""&&W.key=="ArrowUp"){W.preventDefault();const je=[...document.getElementsByClassName("user-message")].at(-1);if(je){je.scrollIntoView({block:"center"});const at=[...document.getElementsByClassName("edit-user-message-button")].at(-1);at==null||at.click()}}if(Ze){if(Ze&&W.key==="ArrowUp"&&(W.preventDefault(),Y.selectUp(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),Ze&&W.key==="ArrowDown"&&(W.preventDefault(),Y.selectDown(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),Ze&&W.key==="Tab"){W.preventDefault();const je=[...document.getElementsByClassName("selected-command-option-button")].at(-1);je==null||je.click()}if(Ze&&W.key==="Enter"){W.preventDefault();const je=[...document.getElementsByClassName("selected-command-option-button")].at(-1);je?je==null||je.click():(tt=document.getElementById("send-message-button"))==null||tt.click()}}else(!c||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0))&&(W.keyCode===13&&!W.shiftKey&&W.preventDefault(),S!==""&&W.keyCode===13&&!W.shiftKey&&u("submit",S));W.key==="Escape"&&(console.log("Escape"),t(0,g=void 0),t(3,E=[]),t(5,O=!1),t(4,H=!1))},mt=async W=>{W=W.detail.event,console.log(W);const Me=W.clipboardData||window.clipboardData;if(Me&&Me.items){for(const Ze of Me.items)if(Ze.type.indexOf("image")!==-1){const tt=Ze.getAsFile(),je=new FileReader;je.onload=function(at){t(2,T=[...T,{type:"image",url:`${at.target.result}`}])},je.readAsDataURL(tt)}else if(Ze.type==="text/plain"&&((n==null?void 0:n.largeTextAsFile)??!1)){const tt=Me.getData("text/plain");if(tt.length>ms){W.preventDefault();const je=new Blob([tt],{type:"text/plain"}),at=new File([je],`Pasted_Text_${Date.now()}.txt`,{type:"text/plain"});await U(at,!0)}}}};function de(W){We[W?"unshift":"push"](()=>{R=W,t(18,R)})}function De(){S=this.value,t(1,S)}const Ve=W=>{(!c||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0))&&(W.key==="Enter"&&!W.shiftKey&&W.preventDefault(),S!==""&&W.key==="Enter"&&!W.shiftKey&&u("submit",S))},Ge=async W=>{var tt;const Me=W.ctrlKey||W.metaKey,Ze=document.getElementById("commands-container");if(W.key==="Escape"&&b(),Me&&W.key==="Enter"&&W.shiftKey&&(W.preventDefault(),p(S)),S===""&&Me&&W.key.toLowerCase()==="r"){W.preventDefault(),console.log("regenerate");const je=[...document.getElementsByClassName("regenerate-response-button")].at(-1);je==null||je.click()}if(S===""&&W.key=="ArrowUp"){W.preventDefault();const je=[...document.getElementsByClassName("user-message")].at(-1),at=[...document.getElementsByClassName("edit-user-message-button")].at(-1);console.log(je),je.scrollIntoView({block:"center"}),at==null||at.click()}if(Ze&&W.key==="ArrowUp"&&(W.preventDefault(),Y.selectUp(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),Ze&&W.key==="ArrowDown"&&(W.preventDefault(),Y.selectDown(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),Ze&&W.key==="Enter"){W.preventDefault();const je=[...document.getElementsByClassName("selected-command-option-button")].at(-1);W.shiftKey?t(1,S=`${S}
`):je?je==null||je.click():(tt=document.getElementById("send-message-button"))==null||tt.click()}if(Ze&&W.key==="Tab"){W.preventDefault();const je=[...document.getElementsByClassName("selected-command-option-button")].at(-1);je==null||je.click()}else if(W.key==="Tab"){const je=uc(S);if(je.length>0){const at=je.at(0),Jt=S;t(1,S=S.substring(0,(at==null?void 0:at.endIndex)+1)),await xe(),W.target.scrollTop=W.target.scrollHeight,t(1,S=Jt),await xe(),W.preventDefault(),W.target.setSelectionRange(at==null?void 0:at.startIndex,at.endIndex+1)}W.target.style.height="",W.target.style.height=Math.min(W.target.scrollHeight,320)+"px"}W.key==="Escape"&&(console.log("Escape"),t(0,g=void 0),t(3,E=[]),t(5,O=!1),t(4,H=!1))},It=async W=>{W.target.style.height="",W.target.style.height=Math.min(W.target.scrollHeight,320)+"px"},kt=async W=>{W.target.style.height="",W.target.style.height=Math.min(W.target.scrollHeight,320)+"px"},Mt=async W=>{const Me=W.clipboardData||window.clipboardData;if(Me&&Me.items){for(const Ze of Me.items)if(Ze.type.indexOf("image")!==-1){const tt=Ze.getAsFile(),je=new FileReader;je.onload=function(at){t(2,T=[...T,{type:"image",url:`${at.target.result}`}])},je.readAsDataURL(tt)}else if(Ze.type==="text/plain"&&((n==null?void 0:n.largeTextAsFile)??!1)){const tt=Me.getData("text/plain");if(tt.length>ms){W.preventDefault();const je=new Blob([tt],{type:"text/plain"}),at=new File([je],`Pasted_Text_${Date.now()}.txt`,{type:"text/plain"});await U(at,!0)}}}},Tt=()=>{C.click()},sn=async()=>{try{const W=await ef();if(W){const Me=new File([W.blob],W.name,{type:W.blob.type});await U(Me)}else console.log("No file was selected from Google Drive")}catch(W){console.error("Google Drive Error:",W),nt.error(o.t("Error accessing Google Drive: {{error}}",{error:W.message}))}},Bt=async()=>{await xe();const W=document.getElementById("chat-input");W==null||W.focus()};function At(W){E=W,t(3,E)}const Kt=()=>t(5,O=!O),Gt=()=>t(4,H=!H),tn=()=>t(7,B=!B),rn=async()=>{try{let W=await navigator.mediaDevices.getUserMedia({audio:!0}).catch(function(Me){return nt.error(o.t("Permission denied when accessing microphone: {{error}}",{error:Me})),null});W&&(t(17,Z=!0),W.getTracks().forEach(Ze=>Ze.stop())),W=null}catch{nt.error(o.t("Permission denied when accessing microphone"))}},Wt=()=>{b()},_t=()=>{u("submit",S)};return l.$$set=W=>{"transparentBackground"in W&&t(8,h=W.transparentBackground),"onChange"in W&&t(36,d=W.onChange),"createMessagePair"in W&&t(9,p=W.createMessagePair),"stopResponse"in W&&t(10,b=W.stopResponse),"autoScroll"in W&&t(6,v=W.autoScroll),"atSelectedModel"in W&&t(0,g=W.atSelectedModel),"selectedModels"in W&&t(11,w=W.selectedModels),"history"in W&&t(12,I=W.history),"prompt"in W&&t(1,S=W.prompt),"files"in W&&t(2,T=W.files),"selectedToolIds"in W&&t(3,E=W.selectedToolIds),"imageGenerationEnabled"in W&&t(4,H=W.imageGenerationEnabled),"webSearchEnabled"in W&&t(5,O=W.webSearchEnabled),"codeInterpreterEnabled"in W&&t(7,B=W.codeInterpreterEnabled),"placeholder"in W&&t(13,G=W.placeholder)},l.$$.update=()=>{l.$$.dirty[0]&2049&&t(15,y=g!==void 0?[g.id]:w),l.$$.dirty[0]&62|l.$$.dirty[1]&32&&d({prompt:S,files:T,selectedToolIds:E,imageGenerationEnabled:H,webSearchEnabled:O}),l.$$.dirty[0]&18433&&t(23,K=[...g?[g]:w].filter(W=>{var Me,Ze,tt,je;return((je=(tt=(Ze=(Me=r.find(at=>at.id===W))==null?void 0:Me.info)==null?void 0:Ze.meta)==null?void 0:tt.capabilities)==null?void 0:je.vision)??!0}))},[g,S,T,E,H,O,v,B,h,p,b,w,I,G,r,y,j,Z,R,C,Y,N,F,K,n,o,s,i,a,c,u,f,X,Q,U,J,d,Oe,x,ue,Ee,Xe,Ke,fe,lt,it,Nt,Dt,Ht,wt,Ut,pe,Ye,ot,he,yt,ht,bt,Ce,Pt,mt,de,De,Ve,Ge,It,kt,Mt,Tt,sn,Bt,At,Kt,Gt,tn,rn,Wt,_t]}class ta extends Re{constructor(e){super(),Ue(this,e,hd,dd,Fe,{transparentBackground:8,onChange:36,createMessagePair:9,stopResponse:10,autoScroll:6,atSelectedModel:0,selectedModels:11,history:12,prompt:1,files:2,selectedToolIds:3,imageGenerationEnabled:4,webSearchEnabled:5,codeInterpreterEnabled:7,placeholder:13},null,[-1,-1,-1])}}function ar(l,e,t){const n=l.slice();return n[12]=e[t],n[13]=e,n[14]=t,n}function md(l){let e,t,n;return t=new Rt({props:{content:l[4].t("Remove Model"),$$slots:{default:[_d]},$$scope:{ctx:l}}}),{c(){e=V("div"),ne(t.$$.fragment),this.h()},l(o){e=z(o,"DIV",{class:!0});var s=M(e);se(t.$$.fragment,s),s.forEach(_),this.h()},h(){m(e,"class","self-center mx-1 disabled:text-gray-600 disabled:hover:text-gray-600 -translate-y-[0.5px]")},m(o,s){A(o,e,s),le(t,e,null),n=!0},p(o,s){const i={};s&16&&(i.content=o[4].t("Remove Model")),s&32771&&(i.$$scope={dirty:s,ctx:o}),t.$set(i)},i(o){n||(D(t.$$.fragment,o),n=!0)},o(o){P(t.$$.fragment,o),n=!1},d(o){o&&_(e),oe(t)}}}function gd(l){let e,t,n;return t=new Rt({props:{content:l[4].t("Add Model"),$$slots:{default:[pd]},$$scope:{ctx:l}}}),{c(){e=V("div"),ne(t.$$.fragment),this.h()},l(o){e=z(o,"DIV",{class:!0});var s=M(e);se(t.$$.fragment,s),s.forEach(_),this.h()},h(){m(e,"class","self-center mx-1 disabled:text-gray-600 disabled:hover:text-gray-600 -translate-y-[0.5px]")},m(o,s){A(o,e,s),le(t,e,null),n=!0},p(o,s){const i={};s&16&&(i.content=o[4].t("Add Model")),s&32771&&(i.$$scope={dirty:s,ctx:o}),t.$set(i)},i(o){n||(D(t.$$.fragment,o),n=!0)},o(o){P(t.$$.fragment,o),n=!1},d(o){o&&_(e),oe(t)}}}function _d(l){let e,t,n,o,s;function i(){return l[10](l[14])}return{c(){e=V("button"),t=Ne("svg"),n=Ne("path"),this.h()},l(r){e=z(r,"BUTTON",{"aria-label":!0});var a=M(e);t=Pe(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var c=M(t);n=Pe(c,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),M(n).forEach(_),c.forEach(_),a.forEach(_),this.h()},h(){m(n,"stroke-linecap","round"),m(n,"stroke-linejoin","round"),m(n,"d","M19.5 12h-15"),m(t,"xmlns","http://www.w3.org/2000/svg"),m(t,"fill","none"),m(t,"viewBox","0 0 24 24"),m(t,"stroke-width","2"),m(t,"stroke","currentColor"),m(t,"class","size-3"),e.disabled=l[1],m(e,"aria-label","Remove Model")},m(r,a){A(r,e,a),k(e,t),k(t,n),o||(s=ke(e,"click",i),o=!0)},p(r,a){l=r,a&2&&(e.disabled=l[1])},d(r){r&&_(e),o=!1,s()}}}function pd(l){let e,t,n,o,s;return{c(){e=V("button"),t=Ne("svg"),n=Ne("path"),this.h()},l(i){e=z(i,"BUTTON",{class:!0,"aria-label":!0});var r=M(e);t=Pe(r,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var a=M(t);n=Pe(a,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),M(n).forEach(_),a.forEach(_),r.forEach(_),this.h()},h(){m(n,"stroke-linecap","round"),m(n,"stroke-linejoin","round"),m(n,"d","M12 6v12m6-6H6"),m(t,"xmlns","http://www.w3.org/2000/svg"),m(t,"fill","none"),m(t,"viewBox","0 0 24 24"),m(t,"stroke-width","2"),m(t,"stroke","currentColor"),m(t,"class","size-3.5"),m(e,"class",""),e.disabled=l[1],m(e,"aria-label","Add Model")},m(i,r){A(i,e,r),k(e,t),k(t,n),o||(s=ke(e,"click",l[9]),o=!0)},p(i,r){r&2&&(e.disabled=i[1])},d(i){i&&_(e),o=!1,s()}}}function cr(l){var v,g,w;let e,t,n,o,s,i,r,a,c,u;function f(y){l[8](y,l[12],l[13],l[14])}let h={id:`${l[14]}`,placeholder:l[4].t("Select a model"),items:l[3].map(fr),showTemporaryChatControl:l[5].role==="user"?((w=(g=(v=l[5])==null?void 0:v.permissions)==null?void 0:g.chat)==null?void 0:w.temporary)??!0:!0};l[12]!==void 0&&(h.value=l[12]),o=new lu({props:h}),We.push(()=>Je(o,"value",f));const d=[gd,md],p=[];function b(y,I){return y[14]===0?0:1}return r=b(l),a=p[r]=d[r](l),{c(){e=V("div"),t=V("div"),n=V("div"),ne(o.$$.fragment),i=ee(),a.c(),c=ee(),this.h()},l(y){e=z(y,"DIV",{class:!0});var I=M(e);t=z(I,"DIV",{class:!0});var S=M(t);n=z(S,"DIV",{class:!0});var T=M(n);se(o.$$.fragment,T),T.forEach(_),S.forEach(_),i=te(I),a.l(I),c=te(I),I.forEach(_),this.h()},h(){m(n,"class","mr-1 max-w-full"),m(t,"class","overflow-hidden w-full"),m(e,"class","flex w-full max-w-fit")},m(y,I){A(y,e,I),k(e,t),k(t,n),le(o,n,null),k(e,i),p[r].m(e,null),k(e,c),u=!0},p(y,I){var T,E,H;l=y;const S={};I&16&&(S.placeholder=l[4].t("Select a model")),I&8&&(S.items=l[3].map(fr)),I&32&&(S.showTemporaryChatControl=l[5].role==="user"?((H=(E=(T=l[5])==null?void 0:T.permissions)==null?void 0:E.chat)==null?void 0:H.temporary)??!0:!0),!s&&I&1&&(s=!0,S.value=l[12],qe(()=>s=!1)),o.$set(S),a.p(l,I)},i(y){u||(D(o.$$.fragment,y),D(a),u=!0)},o(y){P(o.$$.fragment,y),P(a),u=!1},d(y){y&&_(e),oe(o),p[r].d()}}}function ur(l){let e,t,n=l[4].t("Set as default")+"",o,s,i;return{c(){e=V("div"),t=V("button"),o=Ie(n),this.h()},l(r){e=z(r,"DIV",{class:!0});var a=M(e);t=z(a,"BUTTON",{});var c=M(t);o=Se(c,n),c.forEach(_),a.forEach(_),this.h()},h(){m(e,"class","absolute text-left mt-[1px] ml-1 text-[0.7rem] text-gray-500 font-primary")},m(r,a){A(r,e,a),k(e,t),k(t,o),s||(i=ke(t,"click",l[7]),s=!0)},p(r,a){a&16&&n!==(n=r[4].t("Set as default")+"")&&Te(o,n)},d(r){r&&_(e),s=!1,i()}}}function bd(l){let e,t,n,o,s=vt(l[0]),i=[];for(let c=0;c<s.length;c+=1)i[c]=cr(ar(l,s,c));const r=c=>P(i[c],1,1,()=>{i[c]=null});let a=l[2]&&ur(l);return{c(){e=V("div");for(let c=0;c<i.length;c+=1)i[c].c();t=ee(),a&&a.c(),n=Ae(),this.h()},l(c){e=z(c,"DIV",{class:!0});var u=M(e);for(let f=0;f<i.length;f+=1)i[f].l(u);u.forEach(_),t=te(c),a&&a.l(c),n=Ae(),this.h()},h(){m(e,"class","flex flex-col w-full items-start")},m(c,u){A(c,e,u);for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(e,null);A(c,t,u),a&&a.m(c,u),A(c,n,u),o=!0},p(c,[u]){if(u&59){s=vt(c[0]);let f;for(f=0;f<s.length;f+=1){const h=ar(c,s,f);i[f]?(i[f].p(h,u),D(i[f],1)):(i[f]=cr(h),i[f].c(),D(i[f],1),i[f].m(e,null))}for(He(),f=s.length;f<i.length;f+=1)r(f);Be()}c[2]?a?a.p(c,u):(a=ur(c),a.c(),a.m(n.parentNode,n)):a&&(a.d(1),a=null)},i(c){if(!o){for(let u=0;u<s.length;u+=1)D(i[u]);o=!0}},o(c){i=i.filter(Boolean);for(let u=0;u<i.length;u+=1)P(i[u]);o=!1},d(c){c&&(_(e),_(t),_(n)),Dn(i,c),a&&a.d(c)}}}const fr=l=>({value:l.id,label:l.name,model:l});function vd(l,e,t){let n,o,s,i;ae(l,dl,b=>t(3,n=b)),ae(l,Kn,b=>t(11,s=b)),ae(l,Qn,b=>t(5,i=b));const r=Ft("i18n");ae(l,r,b=>t(4,o=b));let{selectedModels:a=[""]}=e,{disabled:c=!1}=e,{showSetDefault:u=!0}=e;const f=async()=>{if(a.filter(v=>v==="").length){nt.error(o.t("Choose a model before saving..."));return}Kn.set({...s,models:a}),await Mc(localStorage.token,{ui:s}),nt.success(o.t("Default model updated"))};function h(b,v,g,w){g[w]=b,t(0,a),t(3,n)}const d=()=>{t(0,a=[...a,""])},p=b=>{a.splice(b,1),t(0,a),t(3,n)};return l.$$set=b=>{"selectedModels"in b&&t(0,a=b.selectedModels),"disabled"in b&&t(1,c=b.disabled),"showSetDefault"in b&&t(2,u=b.showSetDefault)},l.$$.update=()=>{l.$$.dirty&9&&a.length>0&&n.length>0&&t(0,a=a.map(b=>n.map(v=>v.id).includes(b)?b:""))},[a,c,u,n,o,i,r,f,h,d,p]}class wd extends Re{constructor(e){super(),Ue(this,e,vd,bd,Fe,{selectedModels:0,disabled:1,showSetDefault:2})}}function yd(l){let e,t;return{c(){e=Ne("svg"),t=Ne("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var o=M(e);t=Pe(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),M(t).forEach(_),o.forEach(_),this.h()},h(){m(t,"stroke-linecap","round"),m(t,"stroke-linejoin","round"),m(t,"d","M9 6.75V15m6-6v8.25m.503 3.498 4.875-2.437c.381-.19.622-.58.622-1.006V4.82c0-.836-.88-1.38-1.628-1.006l-3.869 1.934c-.317.159-.69.159-1.006 0L9.503 3.252a1.125 1.125 0 0 0-1.006 0L3.622 5.689C3.24 5.88 3 6.27 3 6.695V19.18c0 .836.88 1.38 1.628 1.006l3.869-1.934c.317-.159.69-.159 1.006 0l4.994 2.497c.317.158.69.158 1.006 0Z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","none"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width",l[1]),m(e,"stroke","currentColor"),m(e,"class",l[0])},m(n,o){A(n,e,o),k(e,t)},p(n,[o]){o&2&&m(e,"stroke-width",n[1]),o&1&&m(e,"class",n[0])},i:we,o:we,d(n){n&&_(e)}}}function kd(l,e,t){let{className:n="size-4"}=e,{strokeWidth:o="2"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}let Ed=class extends Re{constructor(e){super(),Ue(this,e,kd,yd,Fe,{className:0,strokeWidth:1})}};function Id(l){let e,t;return{c(){e=Ne("svg"),t=Ne("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,viewBox:!0,stroke:!0,fill:!0,class:!0,"stroke-width":!0});var o=M(e);t=Pe(o,"path",{d:!0}),M(t).forEach(_),o.forEach(_),this.h()},h(){m(t,"d","M18.75 12.75h1.5a.75.75 0 0 0 0-1.5h-1.5a.75.75 0 0 0 0 1.5ZM12 6a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 12 6ZM12 18a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 12 18ZM3.75 6.75h1.5a.75.75 0 1 0 0-1.5h-1.5a.75.75 0 0 0 0 1.5ZM5.25 18.75h-1.5a.75.75 0 0 1 0-1.5h1.5a.75.75 0 0 1 0 1.5ZM3 12a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 3 12ZM9 3.75a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5ZM12.75 12a2.25 2.25 0 1 1 4.5 0 2.25 2.25 0 0 1-4.5 0ZM9 15.75a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 24 24"),m(e,"stroke","currentColor"),m(e,"fill","currentColor"),m(e,"class",l[0]),m(e,"stroke-width",l[1])},m(n,o){A(n,e,o),k(e,t)},p(n,[o]){o&1&&m(e,"class",n[0]),o&2&&m(e,"stroke-width",n[1])},i:we,o:we,d(n){n&&_(e)}}}function Sd(l,e,t){let{className:n="w-4 h-4"}=e,{strokeWidth:o="1.5"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}class ts extends Re{constructor(e){super(),Ue(this,e,Sd,Id,Fe,{className:0,strokeWidth:1})}}function Dd(l){let e,t;return{c(){e=Ne("svg"),t=Ne("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var o=M(e);t=Pe(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),M(t).forEach(_),o.forEach(_),this.h()},h(){m(t,"stroke-linecap","round"),m(t,"stroke-linejoin","round"),m(t,"d","m21 7.5-9-5.25L3 7.5m18 0-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","none"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width",l[1]),m(e,"stroke","currentColor"),m(e,"class",l[0])},m(n,o){A(n,e,o),k(e,t)},p(n,[o]){o&2&&m(e,"stroke-width",n[1]),o&1&&m(e,"class",n[0])},i:we,o:we,d(n){n&&_(e)}}}function Cd(l,e,t){let{className:n="size-4"}=e,{strokeWidth:o="2"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}class Md extends Re{constructor(e){super(),Ue(this,e,Cd,Dd,Fe,{className:0,strokeWidth:1})}}function Td(l){let e;const t=l[13].default,n=Qt(t,l,l[23],null);return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&8388608)&&xt(n,t,o,o[23],e?en(t,o[23],s,null):$t(o[23]),null)},i(o){e||(D(n,o),e=!0)},o(o){P(n,o),e=!1},d(o){n&&n.d(o)}}}function dr(l){let e,t;return e=new _n({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-controls-button",$$slots:{default:[Vd]},$$scope:{ctx:l}}}),e.$on("click",l[14]),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o&8388640&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function Vd(l){let e,t,n,o=l[5].t("Controls")+"",s,i;return e=new ts({props:{className:" size-4",strokeWidth:"0.5"}}),{c(){ne(e.$$.fragment),t=ee(),n=V("div"),s=Ie(o),this.h()},l(r){se(e.$$.fragment,r),t=te(r),n=z(r,"DIV",{class:!0});var a=M(n);s=Se(a,o),a.forEach(_),this.h()},h(){m(n,"class","flex items-center")},m(r,a){le(e,r,a),A(r,t,a),A(r,n,a),k(n,s),i=!0},p(r,a){(!i||a&32)&&o!==(o=r[5].t("Controls")+"")&&Te(s,o)},i(r){i||(D(e.$$.fragment,r),i=!0)},o(r){P(e.$$.fragment,r),i=!1},d(r){r&&(_(t),_(n)),oe(e,r)}}}function hr(l){let e,t;return e=new _n({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-share-button",$$slots:{default:[zd]},$$scope:{ctx:l}}}),e.$on("click",l[15]),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o&8388640&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function zd(l){let e,t,n,o,s=l[5].t("Share")+"",i;return{c(){e=Ne("svg"),t=Ne("path"),n=ee(),o=V("div"),i=Ie(s),this.h()},l(r){e=Pe(r,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var a=M(e);t=Pe(a,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),M(t).forEach(_),a.forEach(_),n=te(r),o=z(r,"DIV",{class:!0});var c=M(o);i=Se(c,s),c.forEach(_),this.h()},h(){m(t,"fill-rule","evenodd"),m(t,"d","M15.75 4.5a3 3 0 1 1 .825 2.066l-8.421 4.679a3.002 3.002 0 0 1 0 1.51l8.421 4.679a3 3 0 1 1-.729 1.31l-8.421-4.678a3 3 0 1 1 0-4.132l8.421-4.679a3 3 0 0 1-.096-.755Z"),m(t,"clip-rule","evenodd"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 24 24"),m(e,"fill","currentColor"),m(e,"class","size-4"),m(o,"class","flex items-center")},m(r,a){A(r,e,a),k(e,t),A(r,n,a),A(r,o,a),k(o,i)},p(r,a){a&32&&s!==(s=r[5].t("Share")+"")&&Te(i,s)},d(r){r&&(_(e),_(n),_(o))}}}function Nd(l){let e,t,n,o=l[5].t("Overview")+"",s,i;return e=new Ed({props:{className:" size-4",strokeWidth:"1.5"}}),{c(){ne(e.$$.fragment),t=ee(),n=V("div"),s=Ie(o),this.h()},l(r){se(e.$$.fragment,r),t=te(r),n=z(r,"DIV",{class:!0});var a=M(n);s=Se(a,o),a.forEach(_),this.h()},h(){m(n,"class","flex items-center")},m(r,a){le(e,r,a),A(r,t,a),A(r,n,a),k(n,s),i=!0},p(r,a){(!i||a&32)&&o!==(o=r[5].t("Overview")+"")&&Te(s,o)},i(r){i||(D(e.$$.fragment,r),i=!0)},o(r){P(e.$$.fragment,r),i=!1},d(r){r&&(_(t),_(n)),oe(e,r)}}}function Pd(l){let e,t,n,o=l[5].t("Artifacts")+"",s,i;return e=new Md({props:{className:" size-4",strokeWidth:"1.5"}}),{c(){ne(e.$$.fragment),t=ee(),n=V("div"),s=Ie(o),this.h()},l(r){se(e.$$.fragment,r),t=te(r),n=z(r,"DIV",{class:!0});var a=M(n);s=Se(a,o),a.forEach(_),this.h()},h(){m(n,"class","flex items-center")},m(r,a){le(e,r,a),A(r,t,a),A(r,n,a),k(n,s),i=!0},p(r,a){(!i||a&32)&&o!==(o=r[5].t("Artifacts")+"")&&Te(s,o)},i(r){i||(D(e.$$.fragment,r),i=!0)},o(r){P(e.$$.fragment,r),i=!1},d(r){r&&(_(t),_(n)),oe(e,r)}}}function Od(l){let e,t,n,o,s=l[5].t("Download")+"",i;return{c(){e=Ne("svg"),t=Ne("path"),n=ee(),o=V("div"),i=Ie(s),this.h()},l(r){e=Pe(r,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var a=M(e);t=Pe(a,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),M(t).forEach(_),a.forEach(_),n=te(r),o=z(r,"DIV",{class:!0});var c=M(o);i=Se(c,s),c.forEach(_),this.h()},h(){m(t,"stroke-linecap","round"),m(t,"stroke-linejoin","round"),m(t,"d","M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","none"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width","1.5"),m(e,"stroke","currentColor"),m(e,"class","size-4"),m(o,"class","flex items-center")},m(r,a){A(r,e,a),k(e,t),A(r,n,a),A(r,o,a),k(o,i)},p(r,a){a&32&&s!==(s=r[5].t("Download")+"")&&Te(i,s)},d(r){r&&(_(e),_(n),_(o))}}}function Hd(l){let e,t=l[5].t("Export chat (.json)")+"",n;return{c(){e=V("div"),n=Ie(t),this.h()},l(o){e=z(o,"DIV",{class:!0});var s=M(e);n=Se(s,t),s.forEach(_),this.h()},h(){m(e,"class","flex items-center line-clamp-1")},m(o,s){A(o,e,s),k(e,n)},p(o,s){s&32&&t!==(t=o[5].t("Export chat (.json)")+"")&&Te(n,t)},d(o){o&&_(e)}}}function Bd(l){let e,t=l[5].t("Plain text (.txt)")+"",n;return{c(){e=V("div"),n=Ie(t),this.h()},l(o){e=z(o,"DIV",{class:!0});var s=M(e);n=Se(s,t),s.forEach(_),this.h()},h(){m(e,"class","flex items-center line-clamp-1")},m(o,s){A(o,e,s),k(e,n)},p(o,s){s&32&&t!==(t=o[5].t("Plain text (.txt)")+"")&&Te(n,t)},d(o){o&&_(e)}}}function Ad(l){let e,t=l[5].t("PDF document (.pdf)")+"",n;return{c(){e=V("div"),n=Ie(t),this.h()},l(o){e=z(o,"DIV",{class:!0});var s=M(e);n=Se(s,t),s.forEach(_),this.h()},h(){m(e,"class","flex items-center line-clamp-1")},m(o,s){A(o,e,s),k(e,n)},p(o,s){s&32&&t!==(t=o[5].t("PDF document (.pdf)")+"")&&Te(n,t)},d(o){o&&_(e)}}}function Ld(l){let e,t,n,o,s,i;return e=new _n({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[Hd]},$$scope:{ctx:l}}}),e.$on("click",l[18]),n=new _n({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[Bd]},$$scope:{ctx:l}}}),n.$on("click",l[19]),s=new _n({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[Ad]},$$scope:{ctx:l}}}),s.$on("click",l[20]),{c(){ne(e.$$.fragment),t=ee(),ne(n.$$.fragment),o=ee(),ne(s.$$.fragment)},l(r){se(e.$$.fragment,r),t=te(r),se(n.$$.fragment,r),o=te(r),se(s.$$.fragment,r)},m(r,a){le(e,r,a),A(r,t,a),le(n,r,a),A(r,o,a),le(s,r,a),i=!0},p(r,a){const c={};a&8388640&&(c.$$scope={dirty:a,ctx:r}),e.$set(c);const u={};a&8388640&&(u.$$scope={dirty:a,ctx:r}),n.$set(u);const f={};a&8388640&&(f.$$scope={dirty:a,ctx:r}),s.$set(f)},i(r){i||(D(e.$$.fragment,r),D(n.$$.fragment,r),D(s.$$.fragment,r),i=!0)},o(r){P(e.$$.fragment,r),P(n.$$.fragment,r),P(s.$$.fragment,r),i=!1},d(r){r&&(_(t),_(o)),oe(e,r),oe(n,r),oe(s,r)}}}function Rd(l){let e,t,n,o;return e=new kc({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[Od]},$$scope:{ctx:l}}}),n=new Ec({props:{class:"w-full rounded-xl px-1 py-1.5 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",transition:Xl,sideOffset:8,$$slots:{default:[Ld]},$$scope:{ctx:l}}}),{c(){ne(e.$$.fragment),t=ee(),ne(n.$$.fragment)},l(s){se(e.$$.fragment,s),t=te(s),se(n.$$.fragment,s)},m(s,i){le(e,s,i),A(s,t,i),le(n,s,i),o=!0},p(s,i){const r={};i&8388640&&(r.$$scope={dirty:i,ctx:s}),e.$set(r);const a={};i&8388640&&(a.$$scope={dirty:i,ctx:s}),n.$set(a)},i(s){o||(D(e.$$.fragment,s),D(n.$$.fragment,s),o=!0)},o(s){P(e.$$.fragment,s),P(n.$$.fragment,s),o=!1},d(s){s&&_(t),oe(e,s),oe(n,s)}}}function Ud(l){let e,t,n,o=l[5].t("Copy")+"",s,i;return e=new Jc({props:{className:" size-4",strokeWidth:"1.5"}}),{c(){ne(e.$$.fragment),t=ee(),n=V("div"),s=Ie(o),this.h()},l(r){se(e.$$.fragment,r),t=te(r),n=z(r,"DIV",{class:!0});var a=M(n);s=Se(a,o),a.forEach(_),this.h()},h(){m(n,"class","flex items-center")},m(r,a){le(e,r,a),A(r,t,a),A(r,n,a),k(n,s),i=!0},p(r,a){(!i||a&32)&&o!==(o=r[5].t("Copy")+"")&&Te(s,o)},i(r){i||(D(e.$$.fragment,r),i=!0)},o(r){P(e.$$.fragment,r),i=!1},d(r){r&&(_(t),_(n)),oe(e,r)}}}function mr(l){let e,t,n,o,s;return o=new Ic({props:{chatId:l[1].id}}),{c(){e=V("hr"),t=ee(),n=V("div"),ne(o.$$.fragment),this.h()},l(i){e=z(i,"HR",{class:!0}),t=te(i),n=z(i,"DIV",{class:!0});var r=M(n);se(o.$$.fragment,r),r.forEach(_),this.h()},h(){m(e,"class","border-gray-100 dark:border-gray-850 my-0.5"),m(n,"class","flex p-1")},m(i,r){A(i,e,r),A(i,t,r),A(i,n,r),le(o,n,null),s=!0},p(i,r){const a={};r&2&&(a.chatId=i[1].id),o.$set(a)},i(i){s||(D(o.$$.fragment,i),s=!0)},o(i){P(o.$$.fragment,i),s=!1},d(i){i&&(_(e),_(t),_(n)),oe(o)}}}function Wd(l){let e,t,n,o,s,i,r,a,c,u,f,h,d=l[4]&&dr(l),p=!l[3]&&hr(l);n=new _n({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-overview-button",$$slots:{default:[Nd]},$$scope:{ctx:l}}}),n.$on("click",l[16]),s=new _n({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-overview-button",$$slots:{default:[Pd]},$$scope:{ctx:l}}}),s.$on("click",l[17]),r=new yc({props:{$$slots:{default:[Rd]},$$scope:{ctx:l}}}),c=new _n({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-copy-button",$$slots:{default:[Ud]},$$scope:{ctx:l}}}),c.$on("click",l[21]);let b=!l[3]&&mr(l);return{c(){d&&d.c(),e=ee(),p&&p.c(),t=ee(),ne(n.$$.fragment),o=ee(),ne(s.$$.fragment),i=ee(),ne(r.$$.fragment),a=ee(),ne(c.$$.fragment),u=ee(),b&&b.c(),f=Ae()},l(v){d&&d.l(v),e=te(v),p&&p.l(v),t=te(v),se(n.$$.fragment,v),o=te(v),se(s.$$.fragment,v),i=te(v),se(r.$$.fragment,v),a=te(v),se(c.$$.fragment,v),u=te(v),b&&b.l(v),f=Ae()},m(v,g){d&&d.m(v,g),A(v,e,g),p&&p.m(v,g),A(v,t,g),le(n,v,g),A(v,o,g),le(s,v,g),A(v,i,g),le(r,v,g),A(v,a,g),le(c,v,g),A(v,u,g),b&&b.m(v,g),A(v,f,g),h=!0},p(v,g){v[4]?d?(d.p(v,g),g&16&&D(d,1)):(d=dr(v),d.c(),D(d,1),d.m(e.parentNode,e)):d&&(He(),P(d,1,1,()=>{d=null}),Be()),v[3]?p&&(He(),P(p,1,1,()=>{p=null}),Be()):p?(p.p(v,g),g&8&&D(p,1)):(p=hr(v),p.c(),D(p,1),p.m(t.parentNode,t));const w={};g&8388640&&(w.$$scope={dirty:g,ctx:v}),n.$set(w);const y={};g&8388640&&(y.$$scope={dirty:g,ctx:v}),s.$set(y);const I={};g&8388640&&(I.$$scope={dirty:g,ctx:v}),r.$set(I);const S={};g&8388640&&(S.$$scope={dirty:g,ctx:v}),c.$set(S),v[3]?b&&(He(),P(b,1,1,()=>{b=null}),Be()):b?(b.p(v,g),g&8&&D(b,1)):(b=mr(v),b.c(),D(b,1),b.m(f.parentNode,f))},i(v){h||(D(d),D(p),D(n.$$.fragment,v),D(s.$$.fragment,v),D(r.$$.fragment,v),D(c.$$.fragment,v),D(b),h=!0)},o(v){P(d),P(p),P(n.$$.fragment,v),P(s.$$.fragment,v),P(r.$$.fragment,v),P(c.$$.fragment,v),P(b),h=!1},d(v){v&&(_(e),_(t),_(o),_(i),_(a),_(u),_(f)),d&&d.d(v),p&&p.d(v),oe(n,v),oe(s,v),oe(r,v),oe(c,v),b&&b.d(v)}}}function Fd(l){let e,t,n;return t=new Eo({props:{class:"w-full max-w-[200px] rounded-xl px-1 py-1.5  z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",sideOffset:8,side:"bottom",align:"end",transition:Xl,$$slots:{default:[Wd]},$$scope:{ctx:l}}}),{c(){e=V("div"),ne(t.$$.fragment),this.h()},l(o){e=z(o,"DIV",{slot:!0});var s=M(e);se(t.$$.fragment,s),s.forEach(_),this.h()},h(){m(e,"slot","content")},m(o,s){A(o,e,s),le(t,e,null),n=!0},p(o,s){const i={};s&8388667&&(i.$$scope={dirty:s,ctx:o}),t.$set(i)},i(o){n||(D(t.$$.fragment,o),n=!0)},o(o){P(t.$$.fragment,o),n=!1},d(o){o&&_(e),oe(t)}}}function jd(l){let e,t;return e=new ko({props:{$$slots:{content:[Fd],default:[Td]},$$scope:{ctx:l}}}),e.$on("change",l[22]),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,[o]){const s={};o&8388667&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function Yd(l,e,t){let n,o,s;ae(l,yo,Z=>t(3,n=Z)),ae(l,wo,Z=>t(4,o=Z));let{$$slots:i={},$$scope:r}=e;const{saveAs:a}=ou,c=Ft("i18n");ae(l,c,Z=>t(5,s=Z));let{shareEnabled:u=!1}=e,{shareHandler:f}=e,{downloadHandler:h}=e,{chat:d}=e,{onClose:p=()=>{}}=e;const b=async()=>{const Z=d.chat.history;return yn(Z,Z.currentId).reduce((Y,N,F,G)=>`${Y}### ${N.role.toUpperCase()}
${N.content}

`,"").trim()},v=async()=>{const Z=await b();let R=new Blob([Z],{type:"text/plain"});a(R,`chat-${d.chat.title}.txt`)},g=async()=>{const Z=d.chat.history,R=yn(Z,Z.currentId),C=await su(localStorage.token,d.chat.title,R),Y=window.URL.createObjectURL(C),N=document.createElement("a");N.href=Y,N.download=`chat-${d.chat.title}.pdf`,document.body.appendChild(N),N.click(),document.body.removeChild(N),window.URL.revokeObjectURL(Y)},w=async()=>{if(d.id){let Z=null;d.id==="local"||n?Z=d:Z=await Ko(localStorage.token,d.id);let R=new Blob([JSON.stringify([Z])],{type:"application/json"});a(R,`chat-export-${Date.now()}.json`)}},y=async()=>{await jt.set(!0),await Zn.set(!1),await Fn.set(!1)},I=()=>{f()},S=async()=>{await jt.set(!0),await Zn.set(!0),await Fn.set(!1)},T=async()=>{await jt.set(!0),await Fn.set(!0),await Zn.set(!1)},E=()=>{w()},H=()=>{v()},O=()=>{g()},B=async()=>{await xo(await b()).catch(R=>{console.error(R)})&&nt.success(s.t("Copied to clipboard"))},j=Z=>{Z.detail===!1&&p()};return l.$$set=Z=>{"shareEnabled"in Z&&t(11,u=Z.shareEnabled),"shareHandler"in Z&&t(0,f=Z.shareHandler),"downloadHandler"in Z&&t(12,h=Z.downloadHandler),"chat"in Z&&t(1,d=Z.chat),"onClose"in Z&&t(2,p=Z.onClose),"$$scope"in Z&&t(23,r=Z.$$scope)},[f,d,p,n,o,s,c,b,v,g,w,u,h,i,y,I,S,T,E,H,O,B,j,r]}class Xd extends Re{constructor(e){super(),Ue(this,e,Yd,jd,Fe,{shareEnabled:11,shareHandler:0,downloadHandler:12,chat:1,onClose:2})}}function gr(l){let e,t,n;function o(i){l[18](i)}let s={showSetDefault:!l[2]};return l[0]!==void 0&&(s.selectedModels=l[0]),e=new wd({props:s}),We.push(()=>Je(e,"selectedModels",o)),{c(){ne(e.$$.fragment)},l(i){se(e.$$.fragment,i)},m(i,r){le(e,i,r),n=!0},p(i,r){const a={};r&4&&(a.showSetDefault=!i[2]),!t&&r&1&&(t=!0,a.selectedModels=i[0],qe(()=>t=!1)),e.$set(a)},i(i){n||(D(e.$$.fragment,i),n=!0)},o(i){P(e.$$.fragment,i),n=!1},d(i){oe(e,i)}}}function Kd(l){let e,t;return e=new Rt({props:{content:l[12].t("Controls"),$$slots:{default:[Gd]},$$scope:{ctx:l}}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o&4096&&(s.content=n[12].t("Controls")),o&67117056&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function Zd(l){let e,t;return e=new Xd({props:{chat:l[3],shareEnabled:l[2],shareHandler:l[19],downloadHandler:l[20],$$slots:{default:[qd]},$$scope:{ctx:l}}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o&8&&(s.chat=n[3]),o&4&&(s.shareEnabled=n[2]),o&32&&(s.shareHandler=n[19]),o&64&&(s.downloadHandler=n[20]),o&67108864&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function Gd(l){let e,t,n,o,s,i;return n=new ts({props:{className:" size-5",strokeWidth:"0.5"}}),{c(){e=V("button"),t=V("div"),ne(n.$$.fragment),this.h()},l(r){e=z(r,"BUTTON",{class:!0,"aria-label":!0});var a=M(e);t=z(a,"DIV",{class:!0});var c=M(t);se(n.$$.fragment,c),c.forEach(_),a.forEach(_),this.h()},h(){m(t,"class","m-auto self-center"),m(e,"class","flex cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition"),m(e,"aria-label","Controls")},m(r,a){A(r,e,a),k(e,t),le(n,t,null),o=!0,s||(i=ke(e,"click",l[21]),s=!0)},p:we,i(r){o||(D(n.$$.fragment,r),o=!0)},o(r){P(n.$$.fragment,r),o=!1},d(r){r&&_(e),oe(n),s=!1,i()}}}function qd(l){let e,t='<div class="m-auto self-center"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"></path></svg></div>';return{c(){e=V("button"),e.innerHTML=t,this.h()},l(n){e=z(n,"BUTTON",{class:!0,id:!0,"data-svelte-h":!0}),ut(e)!=="svelte-xd5mtd"&&(e.innerHTML=t),this.h()},h(){m(e,"class","flex cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition"),m(e,"id","chat-context-menu-button")},m(n,o){A(n,e,o)},p:we,d(n){n&&_(e)}}}function _r(l){let e,t;return e=new Rt({props:{content:l[12].t("Controls"),$$slots:{default:[Jd]},$$scope:{ctx:l}}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o&4096&&(s.content=n[12].t("Controls")),o&67117056&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function Jd(l){let e,t,n,o,s,i;return n=new ts({props:{className:" size-5",strokeWidth:"0.5"}}),{c(){e=V("button"),t=V("div"),ne(n.$$.fragment),this.h()},l(r){e=z(r,"BUTTON",{class:!0,"aria-label":!0});var a=M(e);t=z(a,"DIV",{class:!0});var c=M(t);se(n.$$.fragment,c),c.forEach(_),a.forEach(_),this.h()},h(){m(t,"class","m-auto self-center"),m(e,"class","flex cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition"),m(e,"aria-label","Controls")},m(r,a){A(r,e,a),k(e,t),le(n,t,null),o=!0,s||(i=ke(e,"click",l[22]),s=!0)},p:we,i(r){o||(D(n.$$.fragment,r),o=!0)},o(r){P(n.$$.fragment,r),o=!1},d(r){r&&_(e),oe(n),s=!1,i()}}}function Qd(l){let e,t,n,o,s,i,r;return n=new Dc({props:{className:" size-5",strokeWidth:"2"}}),{c(){e=V("button"),t=V("div"),ne(n.$$.fragment),this.h()},l(a){e=z(a,"BUTTON",{id:!0,class:!0,"aria-label":!0});var c=M(e);t=z(c,"DIV",{class:!0});var u=M(t);se(n.$$.fragment,u),u.forEach(_),c.forEach(_),this.h()},h(){m(t,"class","m-auto self-center"),m(e,"id","new-chat-button"),m(e,"class",o="flex "+(l[8]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition"),m(e,"aria-label","New Chat")},m(a,c){A(a,e,c),k(e,t),le(n,t,null),s=!0,i||(r=ke(e,"click",l[23]),i=!0)},p(a,c){(!s||c&256&&o!==(o="flex "+(a[8]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition"))&&m(e,"class",o)},i(a){s||(D(n.$$.fragment,a),s=!0)},o(a){P(n.$$.fragment,a),s=!1},d(a){a&&_(e),oe(n),i=!1,r()}}}function pr(l){let e,t;return e=new ru({props:{className:"max-w-[200px]",role:l[11].role,$$slots:{default:[xd]},$$scope:{ctx:l}}}),e.$on("show",l[24]),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o&2048&&(s.role=n[11].role),o&67110912&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function xd(l){let e,t,n,o;return{c(){e=V("button"),t=V("div"),n=V("img"),this.h()},l(s){e=z(s,"BUTTON",{class:!0,"aria-label":!0});var i=M(e);t=z(i,"DIV",{class:!0});var r=M(t);n=z(r,"IMG",{src:!0,class:!0,alt:!0,draggable:!0}),r.forEach(_),i.forEach(_),this.h()},h(){Jn(n.src,o=l[11].profile_image_url)||m(n,"src",o),m(n,"class","size-6 object-cover rounded-full"),m(n,"alt","User profile"),m(n,"draggable","false"),m(t,"class","self-center"),m(e,"class","select-none flex rounded-xl p-1.5 w-full hover:bg-gray-50 dark:hover:bg-gray-850 transition"),m(e,"aria-label","User Menu")},m(s,i){A(s,e,i),k(e,t),k(t,n)},p(s,i){i&2048&&!Jn(n.src,o=s[11].profile_image_url)&&m(n,"src",o)},d(s){s&&_(e)}}}function $d(l){var X,Q,U;let e,t,n,o,s,i,r,a,c,u,f,h,d,p,b,v,g,w,y,I,S,T,E,H,O,B,j;function Z(J){l[16](J)}let R={chatId:l[7]};l[5]!==void 0&&(R.show=l[5]),e=new Sc({props:R}),We.push(()=>Je(e,"show",Z)),h=new iu({});let C=l[4]&&gr(l);const Y=[Zd,Kd],N=[];function F(J,q){var ce,ge,re;return J[2]&&J[3]&&(J[3].id||J[9])?0:J[10]&&(J[11].role==="admin"||(re=(ge=(ce=J[11])==null?void 0:ce.permissions)==null?void 0:ge.chat)!=null&&re.controls)?1:-1}~(y=F(l))&&(I=N[y]=Y[y](l));let G=!l[10]&&(l[11].role==="admin"||((U=(Q=(X=l[11])==null?void 0:X.permissions)==null?void 0:Q.chat)==null?void 0:U.controls))&&_r(l);E=new Rt({props:{content:l[12].t("New Chat"),$$slots:{default:[Qd]},$$scope:{ctx:l}}});let K=l[11]!==void 0&&pr(l);return{c(){ne(e.$$.fragment),n=ee(),o=V("nav"),s=V("div"),i=ee(),r=V("div"),a=V("div"),c=V("div"),u=V("button"),f=V("div"),ne(h.$$.fragment),p=ee(),b=V("div"),C&&C.c(),g=ee(),w=V("div"),I&&I.c(),S=ee(),G&&G.c(),T=ee(),ne(E.$$.fragment),H=ee(),K&&K.c(),this.h()},l(J){se(e.$$.fragment,J),n=te(J),o=z(J,"NAV",{class:!0});var q=M(o);s=z(q,"DIV",{class:!0}),M(s).forEach(_),i=te(q),r=z(q,"DIV",{class:!0});var ce=M(r);a=z(ce,"DIV",{class:!0});var ge=M(a);c=z(ge,"DIV",{class:!0});var re=M(c);u=z(re,"BUTTON",{id:!0,class:!0,"aria-label":!0});var Oe=M(u);f=z(Oe,"DIV",{class:!0});var x=M(f);se(h.$$.fragment,x),x.forEach(_),Oe.forEach(_),re.forEach(_),p=te(ge),b=z(ge,"DIV",{class:!0});var ue=M(b);C&&C.l(ue),ue.forEach(_),g=te(ge),w=z(ge,"DIV",{class:!0});var Ee=M(w);I&&I.l(Ee),S=te(Ee),G&&G.l(Ee),T=te(Ee),se(E.$$.fragment,Ee),H=te(Ee),K&&K.l(Ee),Ee.forEach(_),ge.forEach(_),ce.forEach(_),q.forEach(_),this.h()},h(){m(s,"class","bg-linear-to-b via-50% from-white via-white to-transparent dark:from-gray-900 dark:via-gray-900 dark:to-transparent pointer-events-none absolute inset-0 -bottom-7 z-[-1]"),m(f,"class","m-auto self-center"),m(u,"id","sidebar-toggle-button"),m(u,"class","cursor-pointer px-2 py-2 flex rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition"),m(u,"aria-label","Toggle Sidebar"),m(c,"class",d=(l[8]?"md:hidden":"")+" mr-1 self-start flex flex-none items-center text-gray-600 dark:text-gray-400"),m(b,"class",v="flex-1 overflow-hidden max-w-full py-0.5 "+(l[8]?"ml-1":"")),m(w,"class","self-start flex flex-none items-center text-gray-600 dark:text-gray-400"),m(a,"class","flex items-center w-full max-w-full"),m(r,"class","flex max-w-full w-full mx-auto px-1 pt-0.5 bg-transparent"),m(o,"class","sticky top-0 z-30 w-full px-1.5 py-1.5 -mb-8 flex items-center drag-region")},m(J,q){le(e,J,q),A(J,n,q),A(J,o,q),k(o,s),k(o,i),k(o,r),k(r,a),k(a,c),k(c,u),k(u,f),le(h,f,null),k(a,p),k(a,b),C&&C.m(b,null),k(a,g),k(a,w),~y&&N[y].m(w,null),k(w,S),G&&G.m(w,null),k(w,T),le(E,w,null),k(w,H),K&&K.m(w,null),O=!0,B||(j=ke(u,"click",l[17]),B=!0)},p(J,[q]){var Oe,x,ue;const ce={};q&128&&(ce.chatId=J[7]),!t&&q&32&&(t=!0,ce.show=J[5],qe(()=>t=!1)),e.$set(ce),(!O||q&256&&d!==(d=(J[8]?"md:hidden":"")+" mr-1 self-start flex flex-none items-center text-gray-600 dark:text-gray-400"))&&m(c,"class",d),J[4]?C?(C.p(J,q),q&16&&D(C,1)):(C=gr(J),C.c(),D(C,1),C.m(b,null)):C&&(He(),P(C,1,1,()=>{C=null}),Be()),(!O||q&256&&v!==(v="flex-1 overflow-hidden max-w-full py-0.5 "+(J[8]?"ml-1":"")))&&m(b,"class",v);let ge=y;y=F(J),y===ge?~y&&N[y].p(J,q):(I&&(He(),P(N[ge],1,1,()=>{N[ge]=null}),Be()),~y?(I=N[y],I?I.p(J,q):(I=N[y]=Y[y](J),I.c()),D(I,1),I.m(w,S)):I=null),!J[10]&&(J[11].role==="admin"||(ue=(x=(Oe=J[11])==null?void 0:Oe.permissions)==null?void 0:x.chat)!=null&&ue.controls)?G?(G.p(J,q),q&3072&&D(G,1)):(G=_r(J),G.c(),D(G,1),G.m(w,T)):G&&(He(),P(G,1,1,()=>{G=null}),Be());const re={};q&4096&&(re.content=J[12].t("New Chat")),q&67109122&&(re.$$scope={dirty:q,ctx:J}),E.$set(re),J[11]!==void 0?K?(K.p(J,q),q&2048&&D(K,1)):(K=pr(J),K.c(),D(K,1),K.m(w,null)):K&&(He(),P(K,1,1,()=>{K=null}),Be())},i(J){O||(D(e.$$.fragment,J),D(h.$$.fragment,J),D(C),D(I),D(G),D(E.$$.fragment,J),D(K),O=!0)},o(J){P(e.$$.fragment,J),P(h.$$.fragment,J),P(C),P(I),P(G),P(E.$$.fragment,J),P(K),O=!1},d(J){J&&(_(n),_(o)),oe(e,J),oe(h),C&&C.d(),~y&&N[y].d(),G&&G.d(),oe(E),K&&K.d(),B=!1,j()}}}function eh(l,e,t){let n,o,s,i,r,a,c,u;ae(l,Xi,R=>t(25,n=R)),ae(l,cl,R=>t(7,o=R)),ae(l,Xo,R=>t(8,s=R)),ae(l,yo,R=>t(9,i=R)),ae(l,wo,R=>t(10,r=R)),ae(l,Qn,R=>t(11,a=R)),ae(l,jt,R=>t(13,u=R));const f=Ft("i18n");ae(l,f,R=>t(12,c=R));let{initNewChat:h}=e,{title:d=n}=e,{shareEnabled:p=!1}=e,{chat:b}=e,{selectedModels:v}=e,{showModelSelector:g=!0}=e,w=!1,y=!1;function I(R){w=R,t(5,w)}const S=()=>{Xo.set(!s)};function T(R){v=R,t(0,v)}const E=()=>{t(5,w=!w)},H=()=>{t(6,y=!y)},O=async()=>{await jt.set(!u)},B=async()=>{await jt.set(!u)},j=()=>{h()},Z=R=>{R.detail==="archived-chat"&&Qa.set(!0)};return l.$$set=R=>{"initNewChat"in R&&t(1,h=R.initNewChat),"title"in R&&t(15,d=R.title),"shareEnabled"in R&&t(2,p=R.shareEnabled),"chat"in R&&t(3,b=R.chat),"selectedModels"in R&&t(0,v=R.selectedModels),"showModelSelector"in R&&t(4,g=R.showModelSelector)},[v,h,p,b,g,w,y,o,s,i,r,a,c,u,f,d,I,S,T,E,H,O,B,j,Z]}class th extends Re{constructor(e){super(),Ue(this,e,eh,$d,Fe,{initNewChat:1,title:15,shareEnabled:2,chat:3,selectedModels:0,showModelSelector:4})}}function Ot(l){if(typeof l=="string"||typeof l=="number")return""+l;let e="";if(Array.isArray(l))for(let t=0,n;t<l.length;t++)(n=Ot(l[t]))!==""&&(e+=(e&&" ")+n);else for(let t in l)l[t]&&(e+=(e&&" ")+t);return e}const Kl={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:l=>`Node type "${l}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:l=>`The old edge with id=${l} does not exist.`,error009:l=>`Marker type "${l}" doesn't exist.`,error008:(l,{id:e,sourceHandle:t,targetHandle:n})=>`Couldn't create edge for ${l} handle id: "${l==="source"?t:n}", edge id: ${e}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:l=>`Edge type "${l}" not found. Using fallback type "default".`,error012:l=>`Node with id "${l}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(l="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${l}/dist/style.css' or base.css to make sure everything is working properly.`},uo=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]];var fl;(function(l){l.Strict="strict",l.Loose="loose"})(fl||(fl={}));var jn;(function(l){l.Free="free",l.Vertical="vertical",l.Horizontal="horizontal"})(jn||(jn={}));var fo;(function(l){l.Partial="partial",l.Full="full"})(fo||(fo={}));const Go={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var El;(function(l){l.Bezier="default",l.Straight="straight",l.Step="step",l.SmoothStep="smoothstep",l.SimpleBezier="simplebezier"})(El||(El={}));var ho;(function(l){l.Arrow="arrow",l.ArrowClosed="arrowclosed"})(ho||(ho={}));var rt;(function(l){l.Left="left",l.Top="top",l.Right="right",l.Bottom="bottom"})(rt||(rt={}));const br={[rt.Left]:rt.Right,[rt.Right]:rt.Left,[rt.Top]:rt.Bottom,[rt.Bottom]:rt.Top};function nh(l,e){if(!l&&!e)return!0;if(!l||!e||l.size!==e.size)return!1;if(!l.size&&!e.size)return!0;for(const t of l.keys())if(!e.has(t))return!1;return!0}function vr(l,e,t){if(!t)return;const n=[];l.forEach((o,s)=>{e!=null&&e.has(s)||n.push(o)}),n.length&&t(n)}function wr(l){return l===null?null:l?"valid":"invalid"}const lh=l=>"id"in l&&"source"in l&&"target"in l,oh=l=>"id"in l&&"position"in l&&!("source"in l)&&!("target"in l),ns=l=>"id"in l&&"internals"in l&&!("source"in l)&&!("target"in l),Do=(l,e=[0,0])=>{const{width:t,height:n}=Vl(l),o=l.origin??e,s=t*o[0],i=n*o[1];return{x:l.position.x-s,y:l.position.y-i}},sh=(l,e={nodeOrigin:[0,0],nodeLookup:void 0})=>{if(l.length===0)return{x:0,y:0,width:0,height:0};const t=l.reduce((n,o)=>{const s=typeof o=="string";let i=!e.nodeLookup&&!s?o:void 0;e.nodeLookup&&(i=s?e.nodeLookup.get(o):ns(o)?o:e.nodeLookup.get(o.id));const r=i?mo(i,e.nodeOrigin):{x:0,y:0,x2:0,y2:0};return Mo(n,r)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return To(t)},Co=(l,e={})=>{if(l.size===0)return{x:0,y:0,width:0,height:0};let t={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return l.forEach(n=>{if(e.filter===void 0||e.filter(n)){const o=mo(n);t=Mo(t,o)}}),To(t)},na=(l,e,[t,n,o]=[0,0,1],s=!1,i=!1)=>{const r={...Zl(e,[t,n,o]),width:e.width/o,height:e.height/o},a=[];for(const c of l.values()){const{measured:u,selectable:f=!0,hidden:h=!1}=c;if(i&&!f||h)continue;const d=u.width??c.width??c.initialWidth??null,p=u.height??c.height??c.initialHeight??null,b=Ul(r,Ml(c)),v=(d??0)*(p??0),g=s&&b>0;(!c.internals.handleBounds||g||b>=v||c.dragging)&&a.push(c)}return a},qo=(l,e)=>{const t=new Set;return l.forEach(n=>{t.add(n.id)}),e.filter(n=>t.has(n.source)||t.has(n.target))};function yr(l,e){const t=new Map,n=e!=null&&e.nodes?new Set(e.nodes.map(o=>o.id)):null;return l.forEach(o=>{o.measured.width&&o.measured.height&&((e==null?void 0:e.includeHiddenNodes)||!o.hidden)&&(!n||n.has(o.id))&&t.set(o.id,o)}),t}async function kr({nodes:l,width:e,height:t,panZoom:n,minZoom:o,maxZoom:s},i){if(l.size===0)return Promise.resolve(!1);const r=Co(l),a=os(r,e,t,(i==null?void 0:i.minZoom)??o,(i==null?void 0:i.maxZoom)??s,(i==null?void 0:i.padding)??.1);return await n.setViewport(a,{duration:i==null?void 0:i.duration}),Promise.resolve(!0)}function rh({nodeId:l,nextPosition:e,nodeLookup:t,nodeOrigin:n=[0,0],nodeExtent:o,onError:s}){const i=t.get(l),r=i.parentId?t.get(i.parentId):void 0,{x:a,y:c}=r?r.internals.positionAbsolute:{x:0,y:0},u=i.origin??n;let f=o;if(i.extent==="parent"&&!i.expandParent)if(!r)s==null||s("005",Kl.error005());else{const d=r.measured.width,p=r.measured.height;d&&p&&(f=[[a,c],[a+d,c+p]])}else r&&Wl(i.extent)&&(f=[[i.extent[0][0]+a,i.extent[0][1]+c],[i.extent[1][0]+a,i.extent[1][1]+c]]);const h=Wl(f)?Cl(e,f,i.measured):e;return{position:{x:h.x-a+i.measured.width*u[0],y:h.y-c+i.measured.height*u[1]},positionAbsolute:h}}async function la({nodesToRemove:l=[],edgesToRemove:e=[],nodes:t,edges:n,onBeforeDelete:o}){const s=new Set(l.map(h=>h.id)),i=[];for(const h of t){if(h.deletable===!1)continue;const d=s.has(h.id),p=!d&&h.parentId&&i.find(b=>b.id===h.parentId);(d||p)&&i.push(h)}const r=new Set(e.map(h=>h.id)),a=n.filter(h=>h.deletable!==!1),u=qo(i,a);for(const h of a)r.has(h.id)&&!u.find(p=>p.id===h.id)&&u.push(h);if(!o)return{edges:u,nodes:i};const f=await o({nodes:i,edges:u});return typeof f=="boolean"?f?{edges:u,nodes:i}:{edges:[],nodes:[]}:f}const Dl=(l,e=0,t=1)=>Math.min(Math.max(l,e),t),Cl=(l={x:0,y:0},e,t)=>({x:Dl(l.x,e[0][0],e[1][0]-((t==null?void 0:t.width)??0)),y:Dl(l.y,e[0][1],e[1][1]-((t==null?void 0:t.height)??0))});function oa(l,e,t){const{width:n,height:o}=Vl(t),{x:s,y:i}=t.internals.positionAbsolute;return Cl(l,[[s,i],[s+n,i+o]],e)}const Er=(l,e,t)=>l<e?Dl(Math.abs(l-e),1,e)/e:l>t?-Dl(Math.abs(l-t),1,e)/e:0,sa=(l,e,t=15,n=40)=>{const o=Er(l.x,n,e.width-n)*t,s=Er(l.y,n,e.height-n)*t;return[o,s]},Mo=(l,e)=>({x:Math.min(l.x,e.x),y:Math.min(l.y,e.y),x2:Math.max(l.x2,e.x2),y2:Math.max(l.y2,e.y2)}),Jo=({x:l,y:e,width:t,height:n})=>({x:l,y:e,x2:l+t,y2:e+n}),To=({x:l,y:e,x2:t,y2:n})=>({x:l,y:e,width:t-l,height:n-e}),Ml=(l,e=[0,0])=>{var o,s;const{x:t,y:n}=ns(l)?l.internals.positionAbsolute:Do(l,e);return{x:t,y:n,width:((o=l.measured)==null?void 0:o.width)??l.width??l.initialWidth??0,height:((s=l.measured)==null?void 0:s.height)??l.height??l.initialHeight??0}},mo=(l,e=[0,0])=>{var o,s;const{x:t,y:n}=ns(l)?l.internals.positionAbsolute:Do(l,e);return{x:t,y:n,x2:t+(((o=l.measured)==null?void 0:o.width)??l.width??l.initialWidth??0),y2:n+(((s=l.measured)==null?void 0:s.height)??l.height??l.initialHeight??0)}},ih=(l,e)=>To(Mo(Jo(l),Jo(e))),Ul=(l,e)=>{const t=Math.max(0,Math.min(l.x+l.width,e.x+e.width)-Math.max(l.x,e.x)),n=Math.max(0,Math.min(l.y+l.height,e.y+e.height)-Math.max(l.y,e.y));return Math.ceil(t*n)},Ir=l=>Hn(l.width)&&Hn(l.height)&&Hn(l.x)&&Hn(l.y),Hn=l=>!isNaN(l)&&isFinite(l),ah=(l,e)=>{},ls=(l,e=[1,1])=>({x:e[0]*Math.round(l.x/e[0]),y:e[1]*Math.round(l.y/e[1])}),Zl=({x:l,y:e},[t,n,o],s=!1,i=[1,1])=>{const r={x:(l-t)/o,y:(e-n)/o};return s?ls(r,i):r},ra=({x:l,y:e},[t,n,o])=>({x:l*o+t,y:e*o+n}),os=(l,e,t,n,o,s)=>{const i=e/(l.width*(1+s)),r=t/(l.height*(1+s)),a=Math.min(i,r),c=Dl(a,n,o),u=l.x+l.width/2,f=l.y+l.height/2,h=e/2-u*c,d=t/2-f*c;return{x:h,y:d,zoom:c}},go=()=>{var l;return typeof navigator<"u"&&((l=navigator==null?void 0:navigator.userAgent)==null?void 0:l.indexOf("Mac"))>=0};function Wl(l){return l!==void 0&&l!=="parent"}function Vl(l){var e,t;return{width:((e=l.measured)==null?void 0:e.width)??l.width??l.initialWidth??0,height:((t=l.measured)==null?void 0:t.height)??l.height??l.initialHeight??0}}function Sr(l){var e,t;return(((e=l.measured)==null?void 0:e.width)??l.width??l.initialWidth)!==void 0&&(((t=l.measured)==null?void 0:t.height)??l.height??l.initialHeight)!==void 0}function ch(l,e={width:0,height:0},t,n,o){let s=t;const i={...l};for(;s;){const r=n.get(s);if(s=r==null?void 0:r.parentId,r){const a=r.origin||o;i.x+=r.internals.positionAbsolute.x-(e.width??0)*a[0],i.y+=r.internals.positionAbsolute.y-(e.height??0)*a[1]}}return i}function Uo(l,{snapGrid:e=[0,0],snapToGrid:t=!1,transform:n}){const{x:o,y:s}=Gn(l),i=Zl({x:o,y:s},n),{x:r,y:a}=t?ls(i,e):i;return{xSnapped:r,ySnapped:a,...i}}const ia=l=>({width:l.offsetWidth,height:l.offsetHeight}),uh=l=>{var e;return((e=l.getRootNode)==null?void 0:e.call(l))||(window==null?void 0:window.document)},fh=["INPUT","SELECT","TEXTAREA"];function dh(l){var n,o;const e=((o=(n=l.composedPath)==null?void 0:n.call(l))==null?void 0:o[0])||l.target;return fh.includes(e==null?void 0:e.nodeName)||(e==null?void 0:e.hasAttribute("contenteditable"))||!!(e!=null&&e.closest(".nokey"))}const aa=l=>"clientX"in l,Gn=(l,e)=>{var s,i;const t=aa(l),n=t?l.clientX:(s=l.touches)==null?void 0:s[0].clientX,o=t?l.clientY:(i=l.touches)==null?void 0:i[0].clientY;return{x:n-((e==null?void 0:e.left)??0),y:o-((e==null?void 0:e.top)??0)}},Dr=(l,e,t,n,o)=>{const s=e.querySelectorAll(`.${l}`);return!s||!s.length?null:Array.from(s).map(i=>{const r=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:l,nodeId:o,position:i.getAttribute("data-handlepos"),x:(r.left-t.left)/n,y:(r.top-t.top)/n,...ia(i)}})};function hh({sourceX:l,sourceY:e,targetX:t,targetY:n,sourceControlX:o,sourceControlY:s,targetControlX:i,targetControlY:r}){const a=l*.125+o*.375+i*.375+t*.125,c=e*.125+s*.375+r*.375+n*.125,u=Math.abs(a-l),f=Math.abs(c-e);return[a,c,u,f]}function lo(l,e){return l>=0?.5*l:e*25*Math.sqrt(-l)}function Cr({pos:l,x1:e,y1:t,x2:n,y2:o,c:s}){switch(l){case rt.Left:return[e-lo(e-n,s),t];case rt.Right:return[e+lo(n-e,s),t];case rt.Top:return[e,t-lo(t-o,s)];case rt.Bottom:return[e,t+lo(o-t,s)]}}function ca({sourceX:l,sourceY:e,sourcePosition:t=rt.Bottom,targetX:n,targetY:o,targetPosition:s=rt.Top,curvature:i=.25}){const[r,a]=Cr({pos:t,x1:l,y1:e,x2:n,y2:o,c:i}),[c,u]=Cr({pos:s,x1:n,y1:o,x2:l,y2:e,c:i}),[f,h,d,p]=hh({sourceX:l,sourceY:e,targetX:n,targetY:o,sourceControlX:r,sourceControlY:a,targetControlX:c,targetControlY:u});return[`M${l},${e} C${r},${a} ${c},${u} ${n},${o}`,f,h,d,p]}function ua({sourceX:l,sourceY:e,targetX:t,targetY:n}){const o=Math.abs(t-l)/2,s=t<l?t+o:t-o,i=Math.abs(n-e)/2,r=n<e?n+i:n-i;return[s,r,o,i]}function mh({sourceNode:l,targetNode:e,selected:t=!1,zIndex:n=0,elevateOnSelect:o=!1}){if(!o)return n;const s=t||e.selected||l.selected,i=Math.max(l.internals.z||0,e.internals.z||0,1e3);return n+(s?i:0)}function gh({sourceNode:l,targetNode:e,width:t,height:n,transform:o}){const s=Mo(mo(l),mo(e));s.x===s.x2&&(s.x2+=1),s.y===s.y2&&(s.y2+=1);const i={x:-o[0]/o[2],y:-o[1]/o[2],width:t/o[2],height:n/o[2]};return Ul(i,To(s))>0}const _h=({source:l,sourceHandle:e,target:t,targetHandle:n})=>`xy-edge__${l}${e||""}-${t}${n||""}`,ph=(l,e)=>e.some(t=>t.source===l.source&&t.target===l.target&&(t.sourceHandle===l.sourceHandle||!t.sourceHandle&&!l.sourceHandle)&&(t.targetHandle===l.targetHandle||!t.targetHandle&&!l.targetHandle)),bh=(l,e)=>{if(!l.source||!l.target)return e;let t;return lh(l)?t={...l}:t={...l,id:_h(l)},ph(t,e)?e:(t.sourceHandle===null&&delete t.sourceHandle,t.targetHandle===null&&delete t.targetHandle,e.concat(t))};function fa({sourceX:l,sourceY:e,targetX:t,targetY:n}){const[o,s,i,r]=ua({sourceX:l,sourceY:e,targetX:t,targetY:n});return[`M ${l},${e}L ${t},${n}`,o,s,i,r]}const Mr={[rt.Left]:{x:-1,y:0},[rt.Right]:{x:1,y:0},[rt.Top]:{x:0,y:-1},[rt.Bottom]:{x:0,y:1}},vh=({source:l,sourcePosition:e=rt.Bottom,target:t})=>e===rt.Left||e===rt.Right?l.x<t.x?{x:1,y:0}:{x:-1,y:0}:l.y<t.y?{x:0,y:1}:{x:0,y:-1},Tr=(l,e)=>Math.sqrt(Math.pow(e.x-l.x,2)+Math.pow(e.y-l.y,2));function wh({source:l,sourcePosition:e=rt.Bottom,target:t,targetPosition:n=rt.Top,center:o,offset:s}){const i=Mr[e],r=Mr[n],a={x:l.x+i.x*s,y:l.y+i.y*s},c={x:t.x+r.x*s,y:t.y+r.y*s},u=vh({source:a,sourcePosition:e,target:c}),f=u.x!==0?"x":"y",h=u[f];let d=[],p,b;const v={x:0,y:0},g={x:0,y:0},[w,y,I,S]=ua({sourceX:l.x,sourceY:l.y,targetX:t.x,targetY:t.y});if(i[f]*r[f]===-1){p=o.x??w,b=o.y??y;const E=[{x:p,y:a.y},{x:p,y:c.y}],H=[{x:a.x,y:b},{x:c.x,y:b}];i[f]===h?d=f==="x"?E:H:d=f==="x"?H:E}else{const E=[{x:a.x,y:c.y}],H=[{x:c.x,y:a.y}];if(f==="x"?d=i.x===h?H:E:d=i.y===h?E:H,e===n){const R=Math.abs(l[f]-t[f]);if(R<=s){const C=Math.min(s-1,s-R);i[f]===h?v[f]=(a[f]>l[f]?-1:1)*C:g[f]=(c[f]>t[f]?-1:1)*C}}if(e!==n){const R=f==="x"?"y":"x",C=i[f]===r[R],Y=a[R]>c[R],N=a[R]<c[R];(i[f]===1&&(!C&&Y||C&&N)||i[f]!==1&&(!C&&N||C&&Y))&&(d=f==="x"?E:H)}const O={x:a.x+v.x,y:a.y+v.y},B={x:c.x+g.x,y:c.y+g.y},j=Math.max(Math.abs(O.x-d[0].x),Math.abs(B.x-d[0].x)),Z=Math.max(Math.abs(O.y-d[0].y),Math.abs(B.y-d[0].y));j>=Z?(p=(O.x+B.x)/2,b=d[0].y):(p=d[0].x,b=(O.y+B.y)/2)}return[[l,{x:a.x+v.x,y:a.y+v.y},...d,{x:c.x+g.x,y:c.y+g.y},t],p,b,I,S]}function yh(l,e,t,n){const o=Math.min(Tr(l,e)/2,Tr(e,t)/2,n),{x:s,y:i}=e;if(l.x===s&&s===t.x||l.y===i&&i===t.y)return`L${s} ${i}`;if(l.y===i){const c=l.x<t.x?-1:1,u=l.y<t.y?1:-1;return`L ${s+o*c},${i}Q ${s},${i} ${s},${i+o*u}`}const r=l.x<t.x?1:-1,a=l.y<t.y?-1:1;return`L ${s},${i+o*a}Q ${s},${i} ${s+o*r},${i}`}function _o({sourceX:l,sourceY:e,sourcePosition:t=rt.Bottom,targetX:n,targetY:o,targetPosition:s=rt.Top,borderRadius:i=5,centerX:r,centerY:a,offset:c=20}){const[u,f,h,d,p]=wh({source:{x:l,y:e},sourcePosition:t,target:{x:n,y:o},targetPosition:s,center:{x:r,y:a},offset:c});return[u.reduce((v,g,w)=>{let y="";return w>0&&w<u.length-1?y=yh(u[w-1],g,u[w+1],i):y=`${w===0?"M":"L"}${g.x} ${g.y}`,v+=y,v},""),f,h,d,p]}function Vr(l){var e;return l&&!!(l.internals.handleBounds||(e=l.handles)!=null&&e.length)&&!!(l.measured.width||l.width||l.initialWidth)}function kh(l){var f;const{sourceNode:e,targetNode:t}=l;if(!Vr(e)||!Vr(t))return null;const n=e.internals.handleBounds||zr(e.handles),o=t.internals.handleBounds||zr(t.handles),s=Nr((n==null?void 0:n.source)??[],l.sourceHandle),i=Nr(l.connectionMode===fl.Strict?(o==null?void 0:o.target)??[]:((o==null?void 0:o.target)??[]).concat((o==null?void 0:o.source)??[]),l.targetHandle);if(!s||!i)return(f=l.onError)==null||f.call(l,"008",Kl.error008(s?"target":"source",{id:l.id,sourceHandle:l.sourceHandle,targetHandle:l.targetHandle})),null;const r=(s==null?void 0:s.position)||rt.Bottom,a=(i==null?void 0:i.position)||rt.Top,c=Fl(e,s,r),u=Fl(t,i,a);return{sourceX:c.x,sourceY:c.y,targetX:u.x,targetY:u.y,sourcePosition:r,targetPosition:a}}function zr(l){if(!l)return null;const e=[],t=[];for(const n of l)n.width=n.width??1,n.height=n.height??1,n.type==="source"?e.push(n):n.type==="target"&&t.push(n);return{source:e,target:t}}function Fl(l,e,t=rt.Left,n=!1){const o=((e==null?void 0:e.x)??0)+l.internals.positionAbsolute.x,s=((e==null?void 0:e.y)??0)+l.internals.positionAbsolute.y,{width:i,height:r}=e??Vl(l);if(n)return{x:o+i/2,y:s+r/2};switch((e==null?void 0:e.position)??t){case rt.Top:return{x:o+i/2,y:s};case rt.Right:return{x:o+i,y:s+r/2};case rt.Bottom:return{x:o+i/2,y:s+r};case rt.Left:return{x:o,y:s+r/2}}}function Nr(l,e){return l&&(e?l.find(t=>t.id===e):l[0])||null}function Qo(l,e){return l?typeof l=="string"?l:`${e?`${e}__`:""}${Object.keys(l).sort().map(n=>`${n}=${l[n]}`).join("&")}`:""}function Eh(l,{id:e,defaultColor:t,defaultMarkerStart:n,defaultMarkerEnd:o}){const s=new Set;return l.reduce((i,r)=>([r.markerStart||n,r.markerEnd||o].forEach(a=>{if(a&&typeof a=="object"){const c=Qo(a,e);s.has(c)||(i.push({id:c,color:a.color||t,...a}),s.add(c))}}),i),[]).sort((i,r)=>i.id.localeCompare(r.id))}const da={nodeOrigin:[0,0],nodeExtent:uo,elevateNodesOnSelect:!0,defaults:{}},Ih={...da,checkEquality:!0};function ha(l,e){const t={...l};for(const n in e)e[n]!==void 0&&(t[n]=e[n]);return t}function ma(l,e,t,n){var r,a;const o=ha(Ih,n),s=new Map(e),i=o!=null&&o.elevateNodesOnSelect?1e3:0;e.clear(),t.clear();for(const c of l){let u=s.get(c.id);if(o.checkEquality&&c===(u==null?void 0:u.internals.userNode))e.set(c.id,u);else{const f=Do(c,o.nodeOrigin),h=Wl(c.extent)?c.extent:o.nodeExtent,d=Cl(f,h,Vl(c));u={...o.defaults,...c,measured:{width:(r=c.measured)==null?void 0:r.width,height:(a=c.measured)==null?void 0:a.height},internals:{positionAbsolute:d,handleBounds:c.measured?u==null?void 0:u.internals.handleBounds:void 0,z:_a(c,i),userNode:c}},e.set(c.id,u)}c.parentId&&ga(u,e,t,n)}}function Sh(l,e){if(!l.parentId)return;const t=e.get(l.parentId);t?t.set(l.id,l):e.set(l.parentId,new Map([[l.id,l]]))}function ga(l,e,t,n){const{elevateNodesOnSelect:o,nodeOrigin:s,nodeExtent:i}=ha(da,n),r=l.parentId,a=e.get(r);if(!a){console.warn(`Parent node ${r} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}Sh(l,t);const c=o?1e3:0,{x:u,y:f,z:h}=Dh(l,a,s,i,c),{positionAbsolute:d}=l.internals,p=u!==d.x||f!==d.y;(p||h!==l.internals.z)&&(l.internals={...l.internals,positionAbsolute:p?{x:u,y:f}:d,z:h})}function _a(l,e){return(Hn(l.zIndex)?l.zIndex:0)+(l.selected?e:0)}function Dh(l,e,t,n,o){const{x:s,y:i}=e.internals.positionAbsolute,r=Vl(l),a=Do(l,t),c=Wl(l.extent)?Cl(a,l.extent,r):a;let u=Cl({x:s+c.x,y:i+c.y},n,r);l.extent==="parent"&&(u=oa(u,r,e));const f=_a(l,o),h=e.internals.z??0;return{x:u.x,y:u.y,z:h>f?h:f}}function Ch(l,e,t,n=[0,0]){var i;const o=[],s=new Map;for(const r of l){const a=e.get(r.parentId);if(!a)continue;const c=((i=s.get(r.parentId))==null?void 0:i.expandedRect)??Ml(a),u=ih(c,r.rect);s.set(r.parentId,{expandedRect:u,parent:a})}return s.size>0&&s.forEach(({expandedRect:r,parent:a},c)=>{var y;const u=a.internals.positionAbsolute,f=Vl(a),h=a.origin??n,d=r.x<u.x?Math.round(Math.abs(u.x-r.x)):0,p=r.y<u.y?Math.round(Math.abs(u.y-r.y)):0,b=Math.max(f.width,Math.round(r.width)),v=Math.max(f.height,Math.round(r.height)),g=(b-f.width)*h[0],w=(v-f.height)*h[1];(d>0||p>0||g||w)&&(o.push({id:c,type:"position",position:{x:a.position.x-d+g,y:a.position.y-p+w}}),(y=t.get(c))==null||y.forEach(I=>{l.some(S=>S.id===I.id)||o.push({id:I.id,type:"position",position:{x:I.position.x+d,y:I.position.y+p}})})),(f.width<r.width||f.height<r.height||d||p)&&o.push({id:c,type:"dimensions",setAttributes:!0,dimensions:{width:b+(d?h[0]*d-g:0),height:v+(p?h[1]*p-w:0)}})}),o}function Mh(l,e,t,n,o,s){const i=n==null?void 0:n.querySelector(".xyflow__viewport");let r=!1;if(!i)return{changes:[],updatedInternals:r};const a=[],c=window.getComputedStyle(i),{m22:u}=new window.DOMMatrixReadOnly(c.transform),f=[];for(const h of l.values()){const d=e.get(h.id);if(d)if(d.hidden)d.internals={...d.internals,handleBounds:void 0},r=!0;else{const p=ia(h.nodeElement),b=d.measured.width!==p.width||d.measured.height!==p.height;if(!!(p.width&&p.height&&(b||!d.internals.handleBounds||h.force))){const g=h.nodeElement.getBoundingClientRect(),w=Wl(d.extent)?d.extent:s;let{positionAbsolute:y}=d.internals;d.parentId&&d.extent==="parent"?y=oa(y,p,e.get(d.parentId)):w&&(y=Cl(y,w,p)),d.measured=p,d.internals={...d.internals,positionAbsolute:y,handleBounds:{source:Dr("source",h.nodeElement,g,u,d.id),target:Dr("target",h.nodeElement,g,u,d.id)}},d.parentId&&ga(d,e,t,{nodeOrigin:o}),r=!0,b&&(a.push({id:d.id,type:"dimensions",dimensions:p}),d.expandParent&&d.parentId&&f.push({id:d.id,parentId:d.parentId,rect:Ml(d,o)}))}}}if(f.length>0){const h=Ch(f,e,t,o);a.push(...h)}return{changes:a,updatedInternals:r}}async function Th({delta:l,panZoom:e,transform:t,translateExtent:n,width:o,height:s}){if(!e||!l.x&&!l.y)return Promise.resolve(!1);const i=await e.setViewportConstrained({x:t[0]+l.x,y:t[1]+l.y,zoom:t[2]},[[0,0],[o,s]],n),r=!!i&&(i.x!==t[0]||i.y!==t[1]||i.k!==t[2]);return Promise.resolve(r)}function pa(l,e,t){l.clear(),e.clear();for(const n of t){const{source:o,target:s,sourceHandle:i=null,targetHandle:r=null}=n,a=`${o}-source-${i}`,c=`${s}-target-${r}`,u=l.get(a)||new Map,f=l.get(c)||new Map,h={edgeId:n.id,source:o,target:s,sourceHandle:i,targetHandle:r};e.set(n.id,n),l.set(a,u.set(`${s}-${r}`,h)),l.set(c,f.set(`${o}-${i}`,h))}}function ba(l,e){if(!l.parentId)return!1;const t=e.get(l.parentId);return t?t.selected?!0:ba(t,e):!1}function Pr(l,e,t){let n=l;do{if(n!=null&&n.matches(e))return!0;if(n===t)return!1;n=n.parentElement}while(n);return!1}function Vh(l,e,t,n){const o=new Map;for(const[s,i]of l)if((i.selected||i.id===n)&&(!i.parentId||!ba(i,l))&&(i.draggable||e&&typeof i.draggable>"u")){const r=l.get(s);r&&o.set(s,{id:s,position:r.position||{x:0,y:0},distance:{x:t.x-r.internals.positionAbsolute.x,y:t.y-r.internals.positionAbsolute.y},extent:r.extent,parentId:r.parentId,origin:r.origin,expandParent:r.expandParent,internals:{positionAbsolute:r.internals.positionAbsolute||{x:0,y:0}},measured:{width:r.measured.width??0,height:r.measured.height??0}})}return o}function Wo({nodeId:l,dragItems:e,nodeLookup:t,dragging:n=!0}){var i,r;const o=[];for(const[a,c]of e){const u=(i=t.get(a))==null?void 0:i.internals.userNode;u&&o.push({...u,position:c.position,dragging:n})}if(!l)return[o[0],o];const s=t.get(l).internals.userNode;return[{...s,position:((r=e.get(l))==null?void 0:r.position)||s.position,dragging:n},o]}function zh({onNodeMouseDown:l,getStoreItems:e,onDragStart:t,onDrag:n,onDragStop:o}){let s={x:null,y:null},i=0,r=new Map,a=!1,c={x:0,y:0},u=null,f=!1,h=null,d=!1;function p({noDragClassName:v,handleSelector:g,domNode:w,isSelectable:y,nodeId:I,nodeClickDistance:S=0}){h=On(w);function T({x:B,y:j},Z){const{nodeLookup:R,nodeExtent:C,snapGrid:Y,snapToGrid:N,nodeOrigin:F,onNodeDrag:G,onSelectionDrag:K,onError:X,updateNodePositions:Q}=e();s={x:B,y:j};let U=!1,J={x:0,y:0,x2:0,y2:0};if(r.size>1&&C){const q=Co(r);J=Jo(q)}for(const[q,ce]of r){let ge={x:B-ce.distance.x,y:j-ce.distance.y};N&&(ge=ls(ge,Y));let re=[[C[0][0],C[0][1]],[C[1][0],C[1][1]]];if(r.size>1&&C&&!ce.extent){const{positionAbsolute:ue}=ce.internals,Ee=ue.x-J.x+C[0][0],Xe=ue.x+ce.measured.width-J.x2+C[1][0],Ke=ue.y-J.y+C[0][1],fe=ue.y+ce.measured.height-J.y2+C[1][1];re=[[Ee,Ke],[Xe,fe]]}const{position:Oe,positionAbsolute:x}=rh({nodeId:q,nextPosition:ge,nodeLookup:R,nodeExtent:re,nodeOrigin:F,onError:X});U=U||ce.position.x!==Oe.x||ce.position.y!==Oe.y,ce.position=Oe,ce.internals.positionAbsolute=x}if(U&&(Q(r,!0),Z&&(n||G||!I&&K))){const[q,ce]=Wo({nodeId:I,dragItems:r,nodeLookup:R});n==null||n(Z,r,q,ce),G==null||G(Z,q,ce),I||K==null||K(Z,ce)}}async function E(){if(!u)return;const{transform:B,panBy:j,autoPanSpeed:Z}=e(),[R,C]=sa(c,u,Z);(R!==0||C!==0)&&(s.x=(s.x??0)-R/B[2],s.y=(s.y??0)-C/B[2],await j({x:R,y:C})&&T(s,null)),i=requestAnimationFrame(E)}function H(B){var U;const{nodeLookup:j,multiSelectionActive:Z,nodesDraggable:R,transform:C,snapGrid:Y,snapToGrid:N,selectNodesOnDrag:F,onNodeDragStart:G,onSelectionDragStart:K,unselectNodesAndEdges:X}=e();f=!0,(!F||!y)&&!Z&&I&&((U=j.get(I))!=null&&U.selected||X()),y&&F&&I&&(l==null||l(I));const Q=Uo(B.sourceEvent,{transform:C,snapGrid:Y,snapToGrid:N});if(s=Q,r=Vh(j,R,Q,I),r.size>0&&(t||G||!I&&K)){const[J,q]=Wo({nodeId:I,dragItems:r,nodeLookup:j});t==null||t(B.sourceEvent,r,J,q),G==null||G(B.sourceEvent,J,q),I||K==null||K(B.sourceEvent,q)}}const O=Su().clickDistance(S).on("start",B=>{const{domNode:j,nodeDragThreshold:Z,transform:R,snapGrid:C,snapToGrid:Y}=e();d=!1,Z===0&&H(B),s=Uo(B.sourceEvent,{transform:R,snapGrid:C,snapToGrid:Y}),u=(j==null?void 0:j.getBoundingClientRect())||null,c=Gn(B.sourceEvent,u)}).on("drag",B=>{const{autoPanOnNodeDrag:j,transform:Z,snapGrid:R,snapToGrid:C,nodeDragThreshold:Y}=e(),N=Uo(B.sourceEvent,{transform:Z,snapGrid:R,snapToGrid:C});if(B.sourceEvent.type==="touchmove"&&B.sourceEvent.touches.length>1&&(d=!0),!d){if(!a&&j&&f&&(a=!0,E()),!f){const F=N.xSnapped-(s.x??0),G=N.ySnapped-(s.y??0);Math.sqrt(F*F+G*G)>Y&&H(B)}(s.x!==N.xSnapped||s.y!==N.ySnapped)&&r&&f&&(c=Gn(B.sourceEvent,u),T(N,B.sourceEvent))}}).on("end",B=>{if(!(!f||d)&&(a=!1,f=!1,cancelAnimationFrame(i),r.size>0)){const{nodeLookup:j,updateNodePositions:Z,onNodeDragStop:R,onSelectionDragStop:C}=e();if(Z(r,!1),o||R||!I&&C){const[Y,N]=Wo({nodeId:I,dragItems:r,nodeLookup:j,dragging:!1});o==null||o(B.sourceEvent,r,Y,N),R==null||R(B.sourceEvent,Y,N),I||C==null||C(B.sourceEvent,N)}}}).filter(B=>{const j=B.target;return!B.button&&(!v||!Pr(j,`.${v}`,w))&&(!g||Pr(j,g,w))});h.call(O)}function b(){h==null||h.on(".drag",null)}return{update:p,destroy:b}}function Nh(l,e,t){const n=[],o={x:l.x-t,y:l.y-t,width:t*2,height:t*2};for(const s of e.values())Ul(o,Ml(s))>0&&n.push(s);return n}const Ph=250;function Oh(l,e,t,n){var r,a;let o=[],s=1/0;const i=Nh(l,t,e+Ph);for(const c of i){const u=[...((r=c.internals.handleBounds)==null?void 0:r.source)??[],...((a=c.internals.handleBounds)==null?void 0:a.target)??[]];for(const f of u){if(n.nodeId===f.nodeId&&n.type===f.type&&n.id===f.id)continue;const{x:h,y:d}=Fl(c,f,f.position,!0),p=Math.sqrt(Math.pow(h-l.x,2)+Math.pow(d-l.y,2));p>e||(p<s?(o=[{...f,x:h,y:d}],s=p):p===s&&o.push({...f,x:h,y:d}))}}if(!o.length)return null;if(o.length>1){const c=n.type==="source"?"target":"source";return o.find(u=>u.type===c)??o[0]}return o[0]}function va(l,e,t,n,o,s=!1){var c,u,f;const i=n.get(l);if(!i)return null;const r=o==="strict"?(c=i.internals.handleBounds)==null?void 0:c[e]:[...((u=i.internals.handleBounds)==null?void 0:u.source)??[],...((f=i.internals.handleBounds)==null?void 0:f.target)??[]],a=(t?r==null?void 0:r.find(h=>h.id===t):r==null?void 0:r[0])??null;return a&&s?{...a,...Fl(i,a,a.position,!0)}:a}function wa(l,e){return l||(e!=null&&e.classList.contains("target")?"target":e!=null&&e.classList.contains("source")?"source":null)}function Hh(l,e){let t=null;return e?t=!0:l&&!e&&(t=!1),t}const ya=()=>!0;function Bh(l,{connectionMode:e,connectionRadius:t,handleId:n,nodeId:o,edgeUpdaterType:s,isTarget:i,domNode:r,nodeLookup:a,lib:c,autoPanOnConnect:u,flowId:f,panBy:h,cancelConnection:d,onConnectStart:p,onConnect:b,onConnectEnd:v,isValidConnection:g=ya,onReconnectEnd:w,updateConnection:y,getTransform:I,getFromHandle:S,autoPanSpeed:T}){const E=uh(l.target);let H=0,O;const{x:B,y:j}=Gn(l),Z=E==null?void 0:E.elementFromPoint(B,j),R=wa(s,Z),C=r==null?void 0:r.getBoundingClientRect();if(!C||!R)return;const Y=va(o,R,n,a,e);if(!Y)return;let N=Gn(l,C),F=!1,G=null,K=!1,X=null;function Q(){if(!u||!C)return;const[x,ue]=sa(N,C,T);h({x,y:ue}),H=requestAnimationFrame(Q)}const U={...Y,nodeId:o,type:R,position:Y.position},J=a.get(o),ce={inProgress:!0,isValid:null,from:Fl(J,U,rt.Left,!0),fromHandle:U,fromPosition:U.position,fromNode:J,to:N,toHandle:null,toPosition:br[U.position],toNode:null};y(ce);let ge=ce;p==null||p(l,{nodeId:o,handleId:n,handleType:R});function re(x){if(!S()||!U){Oe(x);return}const ue=I();N=Gn(x,C),O=Oh(Zl(N,ue,!1,[1,1]),t,a,U),F||(Q(),F=!0);const Ee=ka(x,{handle:O,connectionMode:e,fromNodeId:o,fromHandleId:n,fromType:i?"target":"source",isValidConnection:g,doc:E,lib:c,flowId:f,nodeLookup:a});X=Ee.handleDomNode,G=Ee.connection,K=Hh(!!O,Ee.isValid);const Xe={...ge,isValid:K,to:O&&K?ra({x:O.x,y:O.y},ue):N,toHandle:Ee.toHandle,toPosition:K&&Ee.toHandle?Ee.toHandle.position:br[U.position],toNode:Ee.toHandle?a.get(Ee.toHandle.nodeId):null};K&&O&&ge.toHandle&&Xe.toHandle&&ge.toHandle.type===Xe.toHandle.type&&ge.toHandle.nodeId===Xe.toHandle.nodeId&&ge.toHandle.id===Xe.toHandle.id&&ge.to.x===Xe.to.x&&ge.to.y===Xe.to.y||(y(Xe),ge=Xe)}function Oe(x){(O||X)&&G&&K&&(b==null||b(G));const{inProgress:ue,...Ee}=ge,Xe={...Ee,toPosition:ge.toHandle?ge.toPosition:null};v==null||v(x,Xe),s&&(w==null||w(x,Xe)),d(),cancelAnimationFrame(H),F=!1,K=!1,G=null,X=null,E.removeEventListener("mousemove",re),E.removeEventListener("mouseup",Oe),E.removeEventListener("touchmove",re),E.removeEventListener("touchend",Oe)}E.addEventListener("mousemove",re),E.addEventListener("mouseup",Oe),E.addEventListener("touchmove",re),E.addEventListener("touchend",Oe)}function ka(l,{handle:e,connectionMode:t,fromNodeId:n,fromHandleId:o,fromType:s,doc:i,lib:r,flowId:a,isValidConnection:c=ya,nodeLookup:u}){const f=s==="target",h=e?i.querySelector(`.${r}-flow__handle[data-id="${a}-${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`):null,{x:d,y:p}=Gn(l),b=i.elementFromPoint(d,p),v=b!=null&&b.classList.contains(`${r}-flow__handle`)?b:h,g={handleDomNode:v,isValid:!1,connection:null,toHandle:null};if(v){const w=wa(void 0,v),y=v.getAttribute("data-nodeid"),I=v.getAttribute("data-handleid"),S=v.classList.contains("connectable"),T=v.classList.contains("connectableend");if(!y||!w)return g;const E={source:f?y:n,sourceHandle:f?I:o,target:f?n:y,targetHandle:f?o:I};g.connection=E;const O=S&&T&&(t===fl.Strict?f&&w==="source"||!f&&w==="target":y!==n||I!==o);g.isValid=O&&c(E),g.toHandle=va(y,w,I,u,t,!1)}return g}const Ah={onPointerDown:Bh,isValid:ka},Lh=(l,e)=>l.x!==e.x||l.y!==e.y||l.zoom!==e.k,Vo=l=>({x:l.x,y:l.y,zoom:l.k}),Fo=({x:l,y:e,zoom:t})=>es.translate(l,e).scale(t),wl=(l,e)=>l.target.closest(`.${e}`),Ea=(l,e)=>e===2&&Array.isArray(l)&&l.includes(2),jo=(l,e=0,t=()=>{})=>{const n=typeof e=="number"&&e>0;return n||t(),n?l.transition().duration(e).on("end",t):l},Ia=l=>{const e=l.ctrlKey&&go()?10:1;return-l.deltaY*(l.deltaMode===1?.05:l.deltaMode?1:.002)*e};function Rh({zoomPanValues:l,noWheelClassName:e,d3Selection:t,d3Zoom:n,panOnScrollMode:o,panOnScrollSpeed:s,zoomOnPinch:i,onPanZoomStart:r,onPanZoom:a,onPanZoomEnd:c}){return u=>{if(wl(u,e))return!1;u.preventDefault(),u.stopImmediatePropagation();const f=t.property("__zoom").k||1;if(u.ctrlKey&&i){const v=Wn(u),g=Ia(u),w=f*Math.pow(2,g);n.scaleTo(t,w,v,u);return}const h=u.deltaMode===1?20:1;let d=o===jn.Vertical?0:u.deltaX*h,p=o===jn.Horizontal?0:u.deltaY*h;!go()&&u.shiftKey&&o!==jn.Vertical&&(d=u.deltaY*h,p=0),n.translateBy(t,-(d/f)*s,-(p/f)*s,{internal:!0});const b=Vo(t.property("__zoom"));clearTimeout(l.panScrollTimeout),l.isPanScrolling||(l.isPanScrolling=!0,r==null||r(u,b)),l.isPanScrolling&&(a==null||a(u,b),l.panScrollTimeout=setTimeout(()=>{c==null||c(u,b),l.isPanScrolling=!1},150))}}function Uh({noWheelClassName:l,preventScrolling:e,d3ZoomHandler:t}){return function(n,o){if(!e&&n.type==="wheel"&&!n.ctrlKey||wl(n,l))return null;n.preventDefault(),t.call(this,n,o)}}function Wh({zoomPanValues:l,onDraggingChange:e,onPanZoomStart:t}){return n=>{var s,i,r;if((s=n.sourceEvent)!=null&&s.internal)return;const o=Vo(n.transform);l.mouseButton=((i=n.sourceEvent)==null?void 0:i.button)||0,l.isZoomingOrPanning=!0,l.prevViewport=o,((r=n.sourceEvent)==null?void 0:r.type)==="mousedown"&&e(!0),t&&(t==null||t(n.sourceEvent,o))}}function Fh({zoomPanValues:l,panOnDrag:e,onPaneContextMenu:t,onTransformChange:n,onPanZoom:o}){return s=>{var i,r;l.usedRightMouseButton=!!(t&&Ea(e,l.mouseButton??0)),(i=s.sourceEvent)!=null&&i.sync||n([s.transform.x,s.transform.y,s.transform.k]),o&&!((r=s.sourceEvent)!=null&&r.internal)&&(o==null||o(s.sourceEvent,Vo(s.transform)))}}function jh({zoomPanValues:l,panOnDrag:e,panOnScroll:t,onDraggingChange:n,onPanZoomEnd:o,onPaneContextMenu:s}){return i=>{var r;if(!((r=i.sourceEvent)!=null&&r.internal)&&(l.isZoomingOrPanning=!1,s&&Ea(e,l.mouseButton??0)&&!l.usedRightMouseButton&&i.sourceEvent&&s(i.sourceEvent),l.usedRightMouseButton=!1,n(!1),o&&Lh(l.prevViewport,i.transform))){const a=Vo(i.transform);l.prevViewport=a,clearTimeout(l.timerId),l.timerId=setTimeout(()=>{o==null||o(i.sourceEvent,a)},t?150:0)}}}function Yh({zoomActivationKeyPressed:l,zoomOnScroll:e,zoomOnPinch:t,panOnDrag:n,panOnScroll:o,zoomOnDoubleClick:s,userSelectionActive:i,noWheelClassName:r,noPanClassName:a,lib:c}){return u=>{var p;const f=l||e,h=t&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&(wl(u,`${c}-flow__node`)||wl(u,`${c}-flow__edge`)))return!0;if(!n&&!f&&!o&&!s&&!t||i||wl(u,r)&&u.type==="wheel"||wl(u,a)&&(u.type!=="wheel"||o&&u.type==="wheel"&&!l)||!t&&u.ctrlKey&&u.type==="wheel")return!1;if(!t&&u.type==="touchstart"&&((p=u.touches)==null?void 0:p.length)>1)return u.preventDefault(),!1;if(!f&&!o&&!h&&u.type==="wheel"||!n&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(n)&&!n.includes(u.button)&&u.type==="mousedown")return!1;const d=Array.isArray(n)&&n.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&d}}function Xh({domNode:l,minZoom:e,maxZoom:t,paneClickDistance:n,translateExtent:o,viewport:s,onPanZoom:i,onPanZoomStart:r,onPanZoomEnd:a,onDraggingChange:c}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},f=l.getBoundingClientRect(),h=Bu().clickDistance(!Hn(n)||n<0?0:n).scaleExtent([e,t]).translateExtent(o),d=On(l).call(h);y({x:s.x,y:s.y,zoom:Dl(s.zoom,e,t)},[[0,0],[f.width,f.height]],o);const p=d.on("wheel.zoom"),b=d.on("dblclick.zoom");h.wheelDelta(Ia);function v(Z,R){return d?new Promise(C=>{h==null||h.transform(jo(d,R==null?void 0:R.duration,()=>C(!0)),Z)}):Promise.resolve(!1)}function g({noWheelClassName:Z,noPanClassName:R,onPaneContextMenu:C,userSelectionActive:Y,panOnScroll:N,panOnDrag:F,panOnScrollMode:G,panOnScrollSpeed:K,preventScrolling:X,zoomOnPinch:Q,zoomOnScroll:U,zoomOnDoubleClick:J,zoomActivationKeyPressed:q,lib:ce,onTransformChange:ge}){Y&&!u.isZoomingOrPanning&&w();const Oe=N&&!q&&!Y?Rh({zoomPanValues:u,noWheelClassName:Z,d3Selection:d,d3Zoom:h,panOnScrollMode:G,panOnScrollSpeed:K,zoomOnPinch:Q,onPanZoomStart:r,onPanZoom:i,onPanZoomEnd:a}):Uh({noWheelClassName:Z,preventScrolling:X,d3ZoomHandler:p});if(d.on("wheel.zoom",Oe,{passive:!1}),!Y){const ue=Wh({zoomPanValues:u,onDraggingChange:c,onPanZoomStart:r});h.on("start",ue);const Ee=Fh({zoomPanValues:u,panOnDrag:F,onPaneContextMenu:!!C,onPanZoom:i,onTransformChange:ge});h.on("zoom",Ee);const Xe=jh({zoomPanValues:u,panOnDrag:F,panOnScroll:N,onPaneContextMenu:C,onPanZoomEnd:a,onDraggingChange:c});h.on("end",Xe)}const x=Yh({zoomActivationKeyPressed:q,panOnDrag:F,zoomOnScroll:U,panOnScroll:N,zoomOnDoubleClick:J,zoomOnPinch:Q,userSelectionActive:Y,noPanClassName:R,noWheelClassName:Z,lib:ce});h.filter(x),J?d.on("dblclick.zoom",b):d.on("dblclick.zoom",null)}function w(){h.on("zoom",null)}async function y(Z,R,C){const Y=Fo(Z),N=h==null?void 0:h.constrain()(Y,R,C);return N&&await v(N),new Promise(F=>F(N))}async function I(Z,R){const C=Fo(Z);return await v(C,R),new Promise(Y=>Y(C))}function S(Z){if(d){const R=Fo(Z),C=d.property("__zoom");(C.k!==Z.zoom||C.x!==Z.x||C.y!==Z.y)&&(h==null||h.transform(d,R,null,{sync:!0}))}}function T(){const Z=d?Qc(d.node()):{x:0,y:0,k:1};return{x:Z.x,y:Z.y,zoom:Z.k}}function E(Z,R){return d?new Promise(C=>{h==null||h.scaleTo(jo(d,R==null?void 0:R.duration,()=>C(!0)),Z)}):Promise.resolve(!1)}function H(Z,R){return d?new Promise(C=>{h==null||h.scaleBy(jo(d,R==null?void 0:R.duration,()=>C(!0)),Z)}):Promise.resolve(!1)}function O(Z){h==null||h.scaleExtent(Z)}function B(Z){h==null||h.translateExtent(Z)}function j(Z){const R=!Hn(Z)||Z<0?0:Z;h==null||h.clickDistance(R)}return{update:g,destroy:w,setViewport:I,setViewportConstrained:y,getViewport:T,scaleTo:E,scaleBy:H,setScaleExtent:O,setTranslateExtent:B,syncViewport:S,setClickDistance:j}}var Or;(function(l){l.Line="line",l.Handle="handle"})(Or||(Or={}));function Kh(l){let e,t,n,o,s,i;const r=l[45].default,a=Qt(r,l,l[44],null);return{c(){e=V("div"),a&&a.c(),this.h()},l(c){e=z(c,"DIV",{"data-handleid":!0,"data-nodeid":!0,"data-handlepos":!0,"data-id":!0,class:!0,style:!0,role:!0,tabindex:!0});var u=M(e);a&&a.l(u),u.forEach(_),this.h()},h(){m(e,"data-handleid",l[6]),m(e,"data-nodeid",l[14]),m(e,"data-handlepos",l[2]),m(e,"data-id",t=l[13]+"-"+l[14]+"-"+(l[0]||null)+"-"+l[1]),m(e,"class",n=Ot(["svelte-flow__handle",`svelte-flow__handle-${l[2]}`,"nodrag","nopan",l[2],l[4]])),m(e,"style",l[3]),m(e,"role","button"),m(e,"tabindex","-1"),st(e,"valid",l[7]),st(e,"connectingto",l[5]),st(e,"connectingfrom",l[9]),st(e,"source",!l[11]),st(e,"target",l[11]),st(e,"connectablestart",l[12]),st(e,"connectableend",l[12]),st(e,"connectable",l[12]),st(e,"connectionindicator",l[12]&&(!l[10]||l[8]))},m(c,u){A(c,e,u),a&&a.m(e,null),o=!0,s||(i=[ke(e,"mousedown",l[32]),ke(e,"touchstart",l[32])],s=!0)},p(c,u){a&&a.p&&(!o||u[1]&8192)&&xt(a,r,c,c[44],o?en(r,c[44],u,null):$t(c[44]),null),(!o||u[0]&64)&&m(e,"data-handleid",c[6]),(!o||u[0]&4)&&m(e,"data-handlepos",c[2]),(!o||u[0]&8195&&t!==(t=c[13]+"-"+c[14]+"-"+(c[0]||null)+"-"+c[1]))&&m(e,"data-id",t),(!o||u[0]&20&&n!==(n=Ot(["svelte-flow__handle",`svelte-flow__handle-${c[2]}`,"nodrag","nopan",c[2],c[4]])))&&m(e,"class",n),(!o||u[0]&8)&&m(e,"style",c[3]),(!o||u[0]&148)&&st(e,"valid",c[7]),(!o||u[0]&52)&&st(e,"connectingto",c[5]),(!o||u[0]&532)&&st(e,"connectingfrom",c[9]),(!o||u[0]&2068)&&st(e,"source",!c[11]),(!o||u[0]&2068)&&st(e,"target",c[11]),(!o||u[0]&4116)&&st(e,"connectablestart",c[12]),(!o||u[0]&4116)&&st(e,"connectableend",c[12]),(!o||u[0]&4116)&&st(e,"connectable",c[12]),(!o||u[0]&5396)&&st(e,"connectionindicator",c[12]&&(!c[10]||c[8]))},i(c){o||(D(a,c),o=!0)},o(c){P(a,c),o=!1},d(c){c&&_(e),a&&a.d(c),s=!1,on(i)}}}function Zh(l,e,t){let n,o,s,i,r,a,c,u,f,h,d,p,b,v,g,w,y,I,S,T,E,H,O,B,j,{$$slots:Z={},$$scope:R}=e,{id:C=void 0}=e,{type:Y="source"}=e,{position:N=rt.Top}=e,{style:F=void 0}=e,{isValidConnection:G=void 0}=e,{onconnect:K=void 0}=e,{ondisconnect:X=void 0}=e,{isConnectable:Q=void 0}=e,{class:U=void 0}=e;const J=Ft("svelteflow__node_id"),q=Ft("svelteflow__node_connectable");ae(l,q,Ce=>t(43,j=Ce));const ce=Xt(),{connectionMode:ge,domNode:re,nodeLookup:Oe,connectionRadius:x,viewport:ue,isValidConnection:Ee,lib:Xe,addEdge:Ke,onedgecreate:fe,panBy:lt,cancelConnection:it,updateConnection:Nt,autoPanOnConnect:Dt,edges:Ht,connectionLookup:wt,onconnect:Ut,onconnectstart:pe,onconnectend:Ye,flowId:ot,connection:he}=ce;ae(l,ge,Ce=>t(40,h=Ce)),ae(l,re,Ce=>t(55,O=Ce)),ae(l,Oe,Ce=>t(54,H=Ce)),ae(l,x,Ce=>t(56,B=Ce)),ae(l,ue,Ce=>t(46,b=Ce)),ae(l,Ee,Ce=>t(51,I=Ce)),ae(l,Xe,Ce=>t(53,E=Ce)),ae(l,fe,Ce=>t(50,y=Ce)),ae(l,Dt,Ce=>t(52,T=Ce)),ae(l,Ht,Ce=>t(42,p=Ce)),ae(l,wt,Ce=>t(41,d=Ce)),ae(l,Ut,Ce=>t(49,w=Ce)),ae(l,pe,Ce=>t(48,g=Ce)),ae(l,Ye,Ce=>t(47,v=Ce)),ae(l,ot,Ce=>t(13,S=Ce)),ae(l,he,Ce=>t(39,f=Ce));function yt(Ce){const Pt=aa(Ce);(Pt&&Ce.button===0||!Pt)&&Ah.onPointerDown(Ce,{handleId:s,nodeId:J,isTarget:n,connectionRadius:B,domNode:O,nodeLookup:H,connectionMode:h,lib:E,autoPanOnConnect:T,flowId:S,isValidConnection:G??I,updateConnection:Nt,cancelConnection:it,panBy:lt,onConnect:mt=>{const de=y?y(mt):mt;de&&(Ke(de),w==null||w(mt))},onConnectStart:(mt,de)=>{g==null||g(mt,{nodeId:de.nodeId,handleId:de.handleId,handleType:de.handleType})},onConnectEnd:(mt,de)=>{v==null||v(mt,de)},getTransform:()=>[b.x,b.y,b.zoom],getFromHandle:()=>f.fromHandle})}let ht=null,bt;return l.$$set=Ce=>{"id"in Ce&&t(0,C=Ce.id),"type"in Ce&&t(1,Y=Ce.type),"position"in Ce&&t(2,N=Ce.position),"style"in Ce&&t(3,F=Ce.style),"isValidConnection"in Ce&&t(33,G=Ce.isValidConnection),"onconnect"in Ce&&t(34,K=Ce.onconnect),"ondisconnect"in Ce&&t(35,X=Ce.ondisconnect),"isConnectable"in Ce&&t(36,Q=Ce.isConnectable),"class"in Ce&&t(4,U=Ce.class),"$$scope"in Ce&&t(44,R=Ce.$$scope)},l.$$.update=()=>{var Ce,Pt,mt,de,De,Ve,Ge,It,kt;if(l.$$.dirty[0]&2&&t(11,n=Y==="target"),l.$$.dirty[1]&4128&&t(12,o=Q!==void 0?Q:j),l.$$.dirty[0]&1&&t(6,s=C||null),l.$$.dirty[0]&3|l.$$.dirty[1]&3096&&(K||X)&&t(38,bt=d.get(`${J}-${Y}-${C||null}`)),l.$$.dirty[1]&216){if(ht&&!nh(bt,ht)){const Mt=bt??new Map;vr(ht,Mt,X),vr(Mt,ht,K)}t(37,ht=bt??new Map)}l.$$.dirty[1]&256&&t(10,i=!!f.fromHandle),l.$$.dirty[0]&66|l.$$.dirty[1]&256&&t(9,r=((Ce=f.fromHandle)==null?void 0:Ce.nodeId)===J&&((Pt=f.fromHandle)==null?void 0:Pt.type)===Y&&((mt=f.fromHandle)==null?void 0:mt.id)===s),l.$$.dirty[0]&66|l.$$.dirty[1]&256&&t(5,a=((de=f.toHandle)==null?void 0:de.nodeId)===J&&((De=f.toHandle)==null?void 0:De.type)===Y&&((Ve=f.toHandle)==null?void 0:Ve.id)===s),l.$$.dirty[0]&66|l.$$.dirty[1]&768&&t(8,c=h===fl.Strict?((Ge=f.fromHandle)==null?void 0:Ge.type)!==Y:J!==((It=f.fromHandle)==null?void 0:It.nodeId)||s!==((kt=f.fromHandle)==null?void 0:kt.id)),l.$$.dirty[0]&32|l.$$.dirty[1]&256&&t(7,u=a&&f.isValid)},[C,Y,N,F,U,a,s,u,c,r,i,n,o,S,J,q,ge,re,Oe,x,ue,Ee,Xe,fe,Dt,Ht,wt,Ut,pe,Ye,ot,he,yt,G,K,X,Q,ht,bt,f,h,d,p,j,R,Z]}class Tl extends Re{constructor(e){super(),Ue(this,e,Zh,Kh,Fe,{id:0,type:1,position:2,style:3,isValidConnection:33,onconnect:34,ondisconnect:35,isConnectable:36,class:4},null,[-1,-1])}}function Gh(l){var a;let e,t,n=((a=l[0])==null?void 0:a.label)+"",o,s,i,r;return e=new Tl({props:{type:"target",position:l[1]??rt.Top}}),i=new Tl({props:{type:"source",position:l[2]??rt.Bottom}}),{c(){ne(e.$$.fragment),t=ee(),o=Ie(n),s=ee(),ne(i.$$.fragment)},l(c){se(e.$$.fragment,c),t=te(c),o=Se(c,n),s=te(c),se(i.$$.fragment,c)},m(c,u){le(e,c,u),A(c,t,u),A(c,o,u),A(c,s,u),le(i,c,u),r=!0},p(c,[u]){var d;const f={};u&2&&(f.position=c[1]??rt.Top),e.$set(f),(!r||u&1)&&n!==(n=((d=c[0])==null?void 0:d.label)+"")&&Te(o,n);const h={};u&4&&(h.position=c[2]??rt.Bottom),i.$set(h)},i(c){r||(D(e.$$.fragment,c),D(i.$$.fragment,c),r=!0)},o(c){P(e.$$.fragment,c),P(i.$$.fragment,c),r=!1},d(c){c&&(_(t),_(o),_(s)),oe(e,c),oe(i,c)}}}function qh(l,e,t){const n=["data","targetPosition","sourcePosition"];Yt(e,n);let{data:o={label:"Node"}}=e,{targetPosition:s=void 0}=e,{sourcePosition:i=void 0}=e;return l.$$set=r=>{e=Et(Et({},e),Bn(r)),t(3,Yt(e,n)),"data"in r&&t(0,o=r.data),"targetPosition"in r&&t(1,s=r.targetPosition),"sourcePosition"in r&&t(2,i=r.sourcePosition)},[o,s,i]}class Sa extends Re{constructor(e){super(),Ue(this,e,qh,Gh,Fe,{data:0,targetPosition:1,sourcePosition:2})}}function Jh(l){var i;let e=((i=l[0])==null?void 0:i.label)+"",t,n,o,s;return o=new Tl({props:{type:"source",position:l[1]??rt.Bottom}}),{c(){t=Ie(e),n=ee(),ne(o.$$.fragment)},l(r){t=Se(r,e),n=te(r),se(o.$$.fragment,r)},m(r,a){A(r,t,a),A(r,n,a),le(o,r,a),s=!0},p(r,[a]){var u;(!s||a&1)&&e!==(e=((u=r[0])==null?void 0:u.label)+"")&&Te(t,e);const c={};a&2&&(c.position=r[1]??rt.Bottom),o.$set(c)},i(r){s||(D(o.$$.fragment,r),s=!0)},o(r){P(o.$$.fragment,r),s=!1},d(r){r&&(_(t),_(n)),oe(o,r)}}}function Qh(l,e,t){const n=["data","sourcePosition"];Yt(e,n);let{data:o={label:"Node"}}=e,{sourcePosition:s=void 0}=e;return l.$$set=i=>{e=Et(Et({},e),Bn(i)),t(2,Yt(e,n)),"data"in i&&t(0,o=i.data),"sourcePosition"in i&&t(1,s=i.sourcePosition)},[o,s]}class xh extends Re{constructor(e){super(),Ue(this,e,Qh,Jh,Fe,{data:0,sourcePosition:1})}}function $h(l){var i;let e=((i=l[0])==null?void 0:i.label)+"",t,n,o,s;return o=new Tl({props:{type:"target",position:l[1]??rt.Top}}),{c(){t=Ie(e),n=ee(),ne(o.$$.fragment)},l(r){t=Se(r,e),n=te(r),se(o.$$.fragment,r)},m(r,a){A(r,t,a),A(r,n,a),le(o,r,a),s=!0},p(r,[a]){var u;(!s||a&1)&&e!==(e=((u=r[0])==null?void 0:u.label)+"")&&Te(t,e);const c={};a&2&&(c.position=r[1]??rt.Top),o.$set(c)},i(r){s||(D(o.$$.fragment,r),s=!0)},o(r){P(o.$$.fragment,r),s=!1},d(r){r&&(_(t),_(n)),oe(o,r)}}}function em(l,e,t){const n=["data","targetPosition"];Yt(e,n);let{data:o={label:"Node"}}=e,{targetPosition:s=void 0}=e;return l.$$set=i=>{e=Et(Et({},e),Bn(i)),t(2,Yt(e,n)),"data"in i&&t(0,o=i.data),"targetPosition"in i&&t(1,s=i.targetPosition)},[o,s]}class tm extends Re{constructor(e){super(),Ue(this,e,em,$h,Fe,{data:0,targetPosition:1})}}function nm(l,e,t){const n=[];return Yt(e,n),l.$$set=o=>{e=Et(Et({},e),Bn(o)),t(0,Yt(e,n))},[]}class lm extends Re{constructor(e){super(),Ue(this,e,nm,null,Fe,{})}}function Hr(l,e,t){if(!e)return;const n=t?e.querySelector(t):e;n&&n.appendChild(l)}function om(l,{target:e,domNode:t}){return Hr(l,t,e),{async update({target:n,domNode:o}){Hr(l,o,n)},destroy(){l.parentNode&&l.parentNode.removeChild(l)}}}function sm(l){let e,t,n,o,s;const i=l[3].default,r=Qt(i,l,l[2],null);return{c(){e=V("div"),r&&r.c()},l(a){e=z(a,"DIV",{});var c=M(e);r&&r.l(c),c.forEach(_)},m(a,c){A(a,e,c),r&&r.m(e,null),n=!0,o||(s=gn(t=om.call(null,e,{target:".svelte-flow__edgelabel-renderer",domNode:l[0]})),o=!0)},p(a,[c]){r&&r.p&&(!n||c&4)&&xt(r,i,a,a[2],n?en(i,a[2],c,null):$t(a[2]),null),t&&ln(t.update)&&c&1&&t.update.call(null,{target:".svelte-flow__edgelabel-renderer",domNode:a[0]})},i(a){n||(D(r,a),n=!0)},o(a){P(r,a),n=!1},d(a){a&&_(e),r&&r.d(a),o=!1,s()}}}function rm(l,e,t){let n,{$$slots:o={},$$scope:s}=e;const{domNode:i}=Xt();return ae(l,i,r=>t(0,n=r)),l.$$set=r=>{"$$scope"in r&&t(2,s=r.$$scope)},[n,i,s,o]}class im extends Re{constructor(e){super(),Ue(this,e,rm,sm,Fe,{})}}function Da(){const{edgeLookup:l,selectionRect:e,selectionRectMode:t,multiselectionKeyPressed:n,addSelectedEdges:o,unselectNodesAndEdges:s,elementsSelectable:i}=Xt();return r=>{const a=me(l).get(r);if(!a){console.warn("012",Kl.error012(r));return}(a.selectable||me(i)&&typeof a.selectable>"u")&&(e.set(null),t.set(null),a.selected?a.selected&&me(n)&&s({nodes:[],edges:[a]}):o([r]))}}function am(l){let e,t,n=`translate(-50%, -50%) translate(${l[1]}px,${l[2]}px)`,o,s,i;const r=l[5].default,a=Qt(r,l,l[7],null);return{c(){e=V("div"),a&&a.c(),this.h()},l(c){e=z(c,"DIV",{class:!0,style:!0,role:!0,tabindex:!0});var u=M(e);a&&a.l(u),u.forEach(_),this.h()},h(){m(e,"class","svelte-flow__edge-label"),m(e,"style",t="pointer-events: all;"+l[0]),m(e,"role","button"),m(e,"tabindex","-1"),$e(e,"transform",n)},m(c,u){A(c,e,u),a&&a.m(e,null),o=!0,s||(i=[ke(e,"keyup",um),ke(e,"click",l[6])],s=!0)},p(c,u){a&&a.p&&(!o||u&128)&&xt(a,r,c,c[7],o?en(r,c[7],u,null):$t(c[7]),null),(!o||u&1&&t!==(t="pointer-events: all;"+c[0]))&&m(e,"style",t);const f=u&1;(u&7&&n!==(n=`translate(-50%, -50%) translate(${c[1]}px,${c[2]}px)`)||f)&&$e(e,"transform",n)},i(c){o||(D(a,c),o=!0)},o(c){P(a,c),o=!1},d(c){c&&_(e),a&&a.d(c),s=!1,on(i)}}}function cm(l){let e,t;return e=new im({props:{$$slots:{default:[am]},$$scope:{ctx:l}}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,[o]){const s={};o&135&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}const um=()=>{};function fm(l,e,t){let{$$slots:n={},$$scope:o}=e,{style:s=void 0}=e,{x:i=void 0}=e,{y:r=void 0}=e;const a=Da(),c=Ft("svelteflow__edge_id"),u=()=>{c&&a(c)};return l.$$set=f=>{"style"in f&&t(0,s=f.style),"x"in f&&t(1,i=f.x),"y"in f&&t(2,r=f.y),"$$scope"in f&&t(7,o=f.$$scope)},[s,i,r,a,c,n,u,o]}class dm extends Re{constructor(e){super(),Ue(this,e,fm,cm,Fe,{style:0,x:1,y:2})}}function hm(l){let e;return{c(){e=Ne("path"),this.h()},l(t){e=Pe(t,"path",{d:!0,"stroke-opacity":!0,"stroke-width":!0,fill:!0,class:!0}),M(e).forEach(_),this.h()},h(){m(e,"d",l[1]),m(e,"stroke-opacity",0),m(e,"stroke-width",l[10]),m(e,"fill","none"),m(e,"class","svelte-flow__edge-interaction")},m(t,n){A(t,e,n)},p(t,n){n&2&&m(e,"d",t[1])},d(t){t&&_(e)}}}function Br(l){let e,t;return e=new dm({props:{x:l[3],y:l[4],style:l[5],$$slots:{default:[mm]},$$scope:{ctx:l}}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o&8&&(s.x=n[3]),o&16&&(s.y=n[4]),o&32&&(s.style=n[5]),o&4100&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function mm(l){let e;return{c(){e=Ie(l[2])},l(t){e=Se(t,l[2])},m(t,n){A(t,e,n)},p(t,n){n&4&&Te(e,t[2])},d(t){t&&_(e)}}}function gm(l){let e,t,n,o,s,i,r=l[10]&&hm(l),a=l[2]&&Br(l);return{c(){e=Ne("path"),n=ee(),r&&r.c(),o=ee(),a&&a.c(),s=Ae(),this.h()},l(c){e=Pe(c,"path",{id:!0,d:!0,class:!0,"marker-start":!0,"marker-end":!0,fill:!0,style:!0}),M(e).forEach(_),n=te(c),r&&r.l(c),o=te(c),a&&a.l(c),s=Ae(),this.h()},h(){m(e,"id",l[0]),m(e,"d",l[1]),m(e,"class",t=Ot(["svelte-flow__edge-path",l[9]])),m(e,"marker-start",l[6]),m(e,"marker-end",l[7]),m(e,"fill","none"),m(e,"style",l[8])},m(c,u){A(c,e,u),A(c,n,u),r&&r.m(c,u),A(c,o,u),a&&a.m(c,u),A(c,s,u),i=!0},p(c,[u]){(!i||u&1)&&m(e,"id",c[0]),(!i||u&2)&&m(e,"d",c[1]),(!i||u&512&&t!==(t=Ot(["svelte-flow__edge-path",c[9]])))&&m(e,"class",t),(!i||u&64)&&m(e,"marker-start",c[6]),(!i||u&128)&&m(e,"marker-end",c[7]),(!i||u&256)&&m(e,"style",c[8]),c[10]&&r.p(c,u),c[2]?a?(a.p(c,u),u&4&&D(a,1)):(a=Br(c),a.c(),D(a,1),a.m(s.parentNode,s)):a&&(He(),P(a,1,1,()=>{a=null}),Be())},i(c){i||(D(a),i=!0)},o(c){P(a),i=!1},d(c){c&&(_(e),_(n),_(o),_(s)),r&&r.d(c),a&&a.d(c)}}}function _m(l,e,t){let{id:n=void 0}=e,{path:o}=e,{label:s=void 0}=e,{labelX:i=void 0}=e,{labelY:r=void 0}=e,{labelStyle:a=void 0}=e,{markerStart:c=void 0}=e,{markerEnd:u=void 0}=e,{style:f=void 0}=e,{interactionWidth:h=20}=e,{class:d=void 0}=e,p=h===void 0?20:h;return l.$$set=b=>{"id"in b&&t(0,n=b.id),"path"in b&&t(1,o=b.path),"label"in b&&t(2,s=b.label),"labelX"in b&&t(3,i=b.labelX),"labelY"in b&&t(4,r=b.labelY),"labelStyle"in b&&t(5,a=b.labelStyle),"markerStart"in b&&t(6,c=b.markerStart),"markerEnd"in b&&t(7,u=b.markerEnd),"style"in b&&t(8,f=b.style),"interactionWidth"in b&&t(11,h=b.interactionWidth),"class"in b&&t(9,d=b.class)},[n,o,s,i,r,a,c,u,f,d,p,h]}class zo extends Re{constructor(e){super(),Ue(this,e,_m,gm,Fe,{id:0,path:1,label:2,labelX:3,labelY:4,labelStyle:5,markerStart:6,markerEnd:7,style:8,interactionWidth:11,class:9})}}function pm(l){let e,t;return e=new zo({props:{path:l[8],labelX:l[7],labelY:l[6],label:l[0],labelStyle:l[1],markerStart:l[3],markerEnd:l[4],interactionWidth:l[5],style:l[2]}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,[o]){const s={};o&256&&(s.path=n[8]),o&128&&(s.labelX=n[7]),o&64&&(s.labelY=n[6]),o&1&&(s.label=n[0]),o&2&&(s.labelStyle=n[1]),o&8&&(s.markerStart=n[3]),o&16&&(s.markerEnd=n[4]),o&32&&(s.interactionWidth=n[5]),o&4&&(s.style=n[2]),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function bm(l,e,t){let n,o,s;const i=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","sourcePosition","targetX","targetY","targetPosition"];Yt(e,i);let{label:r=void 0}=e,{labelStyle:a=void 0}=e,{style:c=void 0}=e,{markerStart:u=void 0}=e,{markerEnd:f=void 0}=e,{interactionWidth:h=void 0}=e,{sourceX:d}=e,{sourceY:p}=e,{sourcePosition:b}=e,{targetX:v}=e,{targetY:g}=e,{targetPosition:w}=e;return l.$$set=y=>{e=Et(Et({},e),Bn(y)),t(15,Yt(e,i)),"label"in y&&t(0,r=y.label),"labelStyle"in y&&t(1,a=y.labelStyle),"style"in y&&t(2,c=y.style),"markerStart"in y&&t(3,u=y.markerStart),"markerEnd"in y&&t(4,f=y.markerEnd),"interactionWidth"in y&&t(5,h=y.interactionWidth),"sourceX"in y&&t(9,d=y.sourceX),"sourceY"in y&&t(10,p=y.sourceY),"sourcePosition"in y&&t(11,b=y.sourcePosition),"targetX"in y&&t(12,v=y.targetX),"targetY"in y&&t(13,g=y.targetY),"targetPosition"in y&&t(14,w=y.targetPosition)},l.$$.update=()=>{l.$$.dirty&32256&&t(8,[n,o,s]=ca({sourceX:d,sourceY:p,targetX:v,targetY:g,sourcePosition:b,targetPosition:w}),n,(t(7,o),t(9,d),t(10,p),t(12,v),t(13,g),t(11,b),t(14,w)),(t(6,s),t(9,d),t(10,p),t(12,v),t(13,g),t(11,b),t(14,w)))},[r,a,c,u,f,h,s,o,n,d,p,b,v,g,w]}class Ca extends Re{constructor(e){super(),Ue(this,e,bm,pm,Fe,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,sourcePosition:11,targetX:12,targetY:13,targetPosition:14})}}function vm(l){let e,t;return e=new zo({props:{path:l[8],labelX:l[7],labelY:l[6],label:l[0],labelStyle:l[1],markerStart:l[3],markerEnd:l[4],interactionWidth:l[5],style:l[2]}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,[o]){const s={};o&256&&(s.path=n[8]),o&128&&(s.labelX=n[7]),o&64&&(s.labelY=n[6]),o&1&&(s.label=n[0]),o&2&&(s.labelStyle=n[1]),o&8&&(s.markerStart=n[3]),o&16&&(s.markerEnd=n[4]),o&32&&(s.interactionWidth=n[5]),o&4&&(s.style=n[2]),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function wm(l,e,t){let n,o,s;const i=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","sourcePosition","targetX","targetY","targetPosition"];Yt(e,i);let{label:r=void 0}=e,{labelStyle:a=void 0}=e,{style:c=void 0}=e,{markerStart:u=void 0}=e,{markerEnd:f=void 0}=e,{interactionWidth:h=void 0}=e,{sourceX:d}=e,{sourceY:p}=e,{sourcePosition:b}=e,{targetX:v}=e,{targetY:g}=e,{targetPosition:w}=e;return l.$$set=y=>{e=Et(Et({},e),Bn(y)),t(15,Yt(e,i)),"label"in y&&t(0,r=y.label),"labelStyle"in y&&t(1,a=y.labelStyle),"style"in y&&t(2,c=y.style),"markerStart"in y&&t(3,u=y.markerStart),"markerEnd"in y&&t(4,f=y.markerEnd),"interactionWidth"in y&&t(5,h=y.interactionWidth),"sourceX"in y&&t(9,d=y.sourceX),"sourceY"in y&&t(10,p=y.sourceY),"sourcePosition"in y&&t(11,b=y.sourcePosition),"targetX"in y&&t(12,v=y.targetX),"targetY"in y&&t(13,g=y.targetY),"targetPosition"in y&&t(14,w=y.targetPosition)},l.$$.update=()=>{l.$$.dirty&32256&&t(8,[n,o,s]=_o({sourceX:d,sourceY:p,targetX:v,targetY:g,sourcePosition:b,targetPosition:w}),n,(t(7,o),t(9,d),t(10,p),t(12,v),t(13,g),t(11,b),t(14,w)),(t(6,s),t(9,d),t(10,p),t(12,v),t(13,g),t(11,b),t(14,w)))},[r,a,c,u,f,h,s,o,n,d,p,b,v,g,w]}class ym extends Re{constructor(e){super(),Ue(this,e,wm,vm,Fe,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,sourcePosition:11,targetX:12,targetY:13,targetPosition:14})}}function km(l){let e,t;return e=new zo({props:{path:l[8],labelX:l[7],labelY:l[6],label:l[0],labelStyle:l[1],markerStart:l[3],markerEnd:l[4],interactionWidth:l[5],style:l[2]}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,[o]){const s={};o&256&&(s.path=n[8]),o&128&&(s.labelX=n[7]),o&64&&(s.labelY=n[6]),o&1&&(s.label=n[0]),o&2&&(s.labelStyle=n[1]),o&8&&(s.markerStart=n[3]),o&16&&(s.markerEnd=n[4]),o&32&&(s.interactionWidth=n[5]),o&4&&(s.style=n[2]),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function Em(l,e,t){let n,o,s;const i=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","targetX","targetY"];Yt(e,i);let{label:r=void 0}=e,{labelStyle:a=void 0}=e,{style:c=void 0}=e,{markerStart:u=void 0}=e,{markerEnd:f=void 0}=e,{interactionWidth:h=void 0}=e,{sourceX:d}=e,{sourceY:p}=e,{targetX:b}=e,{targetY:v}=e;return l.$$set=g=>{e=Et(Et({},e),Bn(g)),t(13,Yt(e,i)),"label"in g&&t(0,r=g.label),"labelStyle"in g&&t(1,a=g.labelStyle),"style"in g&&t(2,c=g.style),"markerStart"in g&&t(3,u=g.markerStart),"markerEnd"in g&&t(4,f=g.markerEnd),"interactionWidth"in g&&t(5,h=g.interactionWidth),"sourceX"in g&&t(9,d=g.sourceX),"sourceY"in g&&t(10,p=g.sourceY),"targetX"in g&&t(11,b=g.targetX),"targetY"in g&&t(12,v=g.targetY)},l.$$.update=()=>{l.$$.dirty&7680&&t(8,[n,o,s]=fa({sourceX:d,sourceY:p,targetX:b,targetY:v}),n,(t(7,o),t(9,d),t(10,p),t(11,b),t(12,v)),(t(6,s),t(9,d),t(10,p),t(11,b),t(12,v)))},[r,a,c,u,f,h,s,o,n,d,p,b,v]}class Im extends Re{constructor(e){super(),Ue(this,e,Em,km,Fe,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,targetX:11,targetY:12})}}function Sm(l){let e,t;return e=new zo({props:{path:l[8],labelX:l[7],labelY:l[6],label:l[0],labelStyle:l[1],markerStart:l[3],markerEnd:l[4],interactionWidth:l[5],style:l[2]}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,[o]){const s={};o&256&&(s.path=n[8]),o&128&&(s.labelX=n[7]),o&64&&(s.labelY=n[6]),o&1&&(s.label=n[0]),o&2&&(s.labelStyle=n[1]),o&8&&(s.markerStart=n[3]),o&16&&(s.markerEnd=n[4]),o&32&&(s.interactionWidth=n[5]),o&4&&(s.style=n[2]),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function Dm(l,e,t){let n,o,s;const i=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","sourcePosition","targetX","targetY","targetPosition"];Yt(e,i);let{label:r=void 0}=e,{labelStyle:a=void 0}=e,{style:c=void 0}=e,{markerStart:u=void 0}=e,{markerEnd:f=void 0}=e,{interactionWidth:h=void 0}=e,{sourceX:d}=e,{sourceY:p}=e,{sourcePosition:b}=e,{targetX:v}=e,{targetY:g}=e,{targetPosition:w}=e;return l.$$set=y=>{e=Et(Et({},e),Bn(y)),t(15,Yt(e,i)),"label"in y&&t(0,r=y.label),"labelStyle"in y&&t(1,a=y.labelStyle),"style"in y&&t(2,c=y.style),"markerStart"in y&&t(3,u=y.markerStart),"markerEnd"in y&&t(4,f=y.markerEnd),"interactionWidth"in y&&t(5,h=y.interactionWidth),"sourceX"in y&&t(9,d=y.sourceX),"sourceY"in y&&t(10,p=y.sourceY),"sourcePosition"in y&&t(11,b=y.sourcePosition),"targetX"in y&&t(12,v=y.targetX),"targetY"in y&&t(13,g=y.targetY),"targetPosition"in y&&t(14,w=y.targetPosition)},l.$$.update=()=>{l.$$.dirty&32256&&t(8,[n,o,s]=_o({sourceX:d,sourceY:p,targetX:v,targetY:g,sourcePosition:b,targetPosition:w,borderRadius:0}),n,(t(7,o),t(9,d),t(10,p),t(12,v),t(13,g),t(11,b),t(14,w)),(t(6,s),t(9,d),t(10,p),t(12,v),t(13,g),t(11,b),t(14,w)))},[r,a,c,u,f,h,s,o,n,d,p,b,v,g,w]}class Cm extends Re{constructor(e){super(),Ue(this,e,Dm,Sm,Fe,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,sourcePosition:11,targetX:12,targetY:13,targetPosition:14})}}function Mm(l,e){const t=l.set,n=e.set,o=me(l),s=me(e);let r=o.length===0&&s.length>0?s:o;l.set(r);const a=c=>{const u=t(c);return r=u,n(r),u};l.set=e.set=a,l.update=e.update=c=>a(c(r))}function Tm(l,e){const t=l.set,n=e.set;let o=me(e);l.set(o);const s=i=>{t(i),n(i),o=i};l.set=e.set=s,l.update=e.update=i=>s(i(o))}const Vm=(l,e,t)=>{if(!t)return;const n=me(l),o=e.set,s=t.set;let i=t?me(t):{x:0,y:0,zoom:1};e.set(i),e.set=r=>(o(r),s(r),i=r,r),t.set=r=>(n==null||n.syncViewport(r),o(r),s(r),i=r,r),e.update=r=>{e.set(r(i))},t.update=r=>{t.set(r(i))}},zm=(l,e,t,n=[0,0],o=uo)=>{const{subscribe:s,set:i,update:r}=Qe([]);let a=l,c={},u=!0;const f=b=>(ma(b,e,t,{elevateNodesOnSelect:u,nodeOrigin:n,nodeExtent:o,defaults:c,checkEquality:!1}),a=b,i(a),a),h=b=>f(b(a)),d=b=>{c=b},p=b=>{u=b.elevateNodesOnSelect??u};return f(a),{subscribe:s,set:f,update:h,setDefaultOptions:d,setOptions:p}},Nm=(l,e,t,n)=>{const{subscribe:o,set:s,update:i}=Qe([]);let r=l,a={};const c=h=>{const d=a?h.map(p=>({...a,...p})):h;pa(e,t,d),r=d,s(r)},u=h=>c(h(r)),f=h=>{a=h};return c(r),{subscribe:o,set:c,update:u,setDefaultOptions:f}},Ma={input:xh,output:tm,default:Sa,group:lm},Ta={straight:Im,smoothstep:ym,default:Ca,step:Cm},Pm=({nodes:l=[],edges:e=[],width:t,height:n,fitView:o,nodeOrigin:s,nodeExtent:i})=>{const r=new Map,a=new Map,c=new Map,u=new Map,f=s??[0,0],h=i??uo;ma(l,r,a,{nodeExtent:h,nodeOrigin:f,elevateNodesOnSelect:!1,checkEquality:!1}),pa(c,u,e);let d={x:0,y:0,zoom:1};if(o&&t&&n){const p=Co(r,{filter:b=>!!((b.width||b.initialWidth)&&(b.height||b.initialHeight))});d=os(p,t,n,.5,2,.1)}return{flowId:Qe(null),nodes:zm(l,r,a,f,h),nodeLookup:Pn(r),parentLookup:Pn(a),edgeLookup:Pn(u),visibleNodes:Pn([]),edges:Nm(e,c,u),visibleEdges:Pn([]),connectionLookup:Pn(c),height:Qe(500),width:Qe(500),minZoom:Qe(.5),maxZoom:Qe(2),nodeOrigin:Qe(f),nodeDragThreshold:Qe(1),nodeExtent:Qe(h),translateExtent:Qe(uo),autoPanOnNodeDrag:Qe(!0),autoPanOnConnect:Qe(!0),fitViewOnInit:Qe(!1),fitViewOnInitDone:Qe(!1),fitViewOptions:Qe(void 0),panZoom:Qe(null),snapGrid:Qe(null),dragging:Qe(!1),selectionRect:Qe(null),selectionKeyPressed:Qe(!1),multiselectionKeyPressed:Qe(!1),deleteKeyPressed:Qe(!1),panActivationKeyPressed:Qe(!1),zoomActivationKeyPressed:Qe(!1),selectionRectMode:Qe(null),selectionMode:Qe(fo.Partial),nodeTypes:Qe(Ma),edgeTypes:Qe(Ta),viewport:Qe(d),connectionMode:Qe(fl.Strict),domNode:Qe(null),connection:Pn(Go),connectionLineType:Qe(El.Bezier),connectionRadius:Qe(20),isValidConnection:Qe(()=>!0),nodesDraggable:Qe(!0),nodesConnectable:Qe(!0),elementsSelectable:Qe(!0),selectNodesOnDrag:Qe(!0),markers:Pn([]),defaultMarkerColor:Qe("#b1b1b7"),lib:Pn("svelte"),onlyRenderVisibleElements:Qe(!1),onerror:Qe(ah),ondelete:Qe(void 0),onedgecreate:Qe(void 0),onconnect:Qe(void 0),onconnectstart:Qe(void 0),onconnectend:Qe(void 0),onbeforedelete:Qe(void 0),nodesInitialized:Qe(!1),edgesInitialized:Qe(!1),viewportInitialized:Qe(!1),initialized:Pn(!1)}};function Om(l){const e=yl([l.edges,l.nodes,l.nodeLookup,l.onlyRenderVisibleElements,l.viewport,l.width,l.height],([t,,n,o,s,i,r])=>o&&i&&r?t.filter(c=>{const u=n.get(c.source),f=n.get(c.target);return u&&f&&gh({sourceNode:u,targetNode:f,width:i,height:r,transform:[s.x,s.y,s.zoom]})}):t);return yl([e,l.nodes,l.nodeLookup,l.connectionMode,l.onerror],([t,,n,o,s])=>t.reduce((r,a)=>{const c=n.get(a.source),u=n.get(a.target);if(!c||!u)return r;const f=kh({id:a.id,sourceNode:c,targetNode:u,sourceHandle:a.sourceHandle||null,targetHandle:a.targetHandle||null,connectionMode:o,onError:s});return f&&r.push({...a,zIndex:mh({selected:a.selected,zIndex:a.zIndex,sourceNode:c,targetNode:u,elevateOnSelect:!1}),...f}),r},[]))}function Hm(l){return yl([l.nodeLookup,l.onlyRenderVisibleElements,l.width,l.height,l.viewport,l.nodes],([e,t,n,o,s])=>{const i=[s.x,s.y,s.zoom];return t?na(e,{x:0,y:0,width:n,height:o},i,!0):Array.from(e.values())})}const No=Symbol();function Va({nodes:l,edges:e,width:t,height:n,fitView:o,nodeOrigin:s,nodeExtent:i}){const r=Pm({nodes:l,edges:e,width:t,height:n,fitView:o,nodeOrigin:s,nodeExtent:i});function a(N){r.nodeTypes.set({...Ma,...N})}function c(N){r.edgeTypes.set({...Ta,...N})}function u(N){const F=me(r.edges);r.edges.set(bh(N,F))}const f=(N,F=!1)=>{var K;const G=me(r.nodeLookup);for(const[X,Q]of N){const U=(K=G.get(X))==null?void 0:K.internals.userNode;U&&(U.position=Q.position,U.dragging=F)}r.nodes.update(X=>X)};function h(N){var X,Q,U;const F=me(r.nodeLookup),{changes:G,updatedInternals:K}=Mh(N,F,me(r.parentLookup),me(r.domNode),me(r.nodeOrigin));if(K){if(!me(r.fitViewOnInitDone)&&me(r.fitViewOnInit)){const J=me(r.fitViewOptions),q=p({...J,nodes:J==null?void 0:J.nodes});r.fitViewOnInitDone.set(q)}for(const J of G){const q=(X=F.get(J.id))==null?void 0:X.internals.userNode;if(q)switch(J.type){case"dimensions":{const ce={...q.measured,...J.dimensions};J.setAttributes&&(q.width=((Q=J.dimensions)==null?void 0:Q.width)??q.width,q.height=((U=J.dimensions)==null?void 0:U.height)??q.height),q.measured=ce;break}case"position":q.position=J.position??q.position;break}}r.nodes.update(J=>J),me(r.nodesInitialized)||r.nodesInitialized.set(!0)}}function d(N){const F=me(r.panZoom);if(!F)return Promise.resolve(!1);const G=yr(me(r.nodeLookup),N);return kr({nodes:G,width:me(r.width),height:me(r.height),minZoom:me(r.minZoom),maxZoom:me(r.maxZoom),panZoom:F},N)}function p(N){const F=me(r.panZoom);if(!F)return!1;const G=yr(me(r.nodeLookup),N);return kr({nodes:G,width:me(r.width),height:me(r.height),minZoom:me(r.minZoom),maxZoom:me(r.maxZoom),panZoom:F},N),G.size>0}function b(N,F){const G=me(r.panZoom);return G?G.scaleBy(N,F):Promise.resolve(!1)}function v(N){return b(1.2,N)}function g(N){return b(1/1.2,N)}function w(N){const F=me(r.panZoom);F&&(F.setScaleExtent([N,me(r.maxZoom)]),r.minZoom.set(N))}function y(N){const F=me(r.panZoom);F&&(F.setScaleExtent([me(r.minZoom),N]),r.maxZoom.set(N))}function I(N){const F=me(r.panZoom);F&&(F.setTranslateExtent(N),r.translateExtent.set(N))}function S(N){let F=!1;return N.forEach(G=>{G.selected&&(G.selected=!1,F=!0)}),F}function T(N){var F;(F=me(r.panZoom))==null||F.setClickDistance(N)}function E(N){S((N==null?void 0:N.nodes)||me(r.nodes))&&r.nodes.set(me(r.nodes)),S((N==null?void 0:N.edges)||me(r.edges))&&r.edges.set(me(r.edges))}r.deleteKeyPressed.subscribe(async N=>{var F;if(N){const G=me(r.nodes),K=me(r.edges),X=G.filter(q=>q.selected),Q=K.filter(q=>q.selected),{nodes:U,edges:J}=await la({nodesToRemove:X,edgesToRemove:Q,nodes:G,edges:K,onBeforeDelete:me(r.onbeforedelete)});(U.length||J.length)&&(r.nodes.update(q=>q.filter(ce=>!U.some(ge=>ge.id===ce.id))),r.edges.update(q=>q.filter(ce=>!J.some(ge=>ge.id===ce.id))),(F=me(r.ondelete))==null||F({nodes:U,edges:J}))}});function H(N){const F=me(r.multiselectionKeyPressed);r.nodes.update(G=>G.map(K=>{const X=N.includes(K.id),Q=F&&K.selected||X;return K.selected=Q,K})),F||r.edges.update(G=>G.map(K=>(K.selected=!1,K)))}function O(N){const F=me(r.multiselectionKeyPressed);r.edges.update(G=>G.map(K=>{const X=N.includes(K.id),Q=F&&K.selected||X;return K.selected=Q,K})),F||r.nodes.update(G=>G.map(K=>(K.selected=!1,K)))}function B(N){var G;const F=(G=me(r.nodes))==null?void 0:G.find(K=>K.id===N);if(!F){console.warn("012",Kl.error012(N));return}r.selectionRect.set(null),r.selectionRectMode.set(null),F.selected?F.selected&&me(r.multiselectionKeyPressed)&&E({nodes:[F],edges:[]}):H([N])}function j(N){const F=me(r.viewport);return Th({delta:N,panZoom:me(r.panZoom),transform:[F.x,F.y,F.zoom],translateExtent:me(r.translateExtent),width:me(r.width),height:me(r.height)})}const Z=Qe(Go),R=N=>{Z.set({...N})};function C(){Z.set(Go)}function Y(){r.fitViewOnInitDone.set(!1),r.selectionRect.set(null),r.selectionRectMode.set(null),r.snapGrid.set(null),r.isValidConnection.set(()=>!0),E(),C()}return{...r,visibleEdges:Om(r),visibleNodes:Hm(r),connection:yl([Z,r.viewport],([N,F])=>N.inProgress?{...N,to:Zl(N.to,[F.x,F.y,F.zoom])}:{...N}),markers:yl([r.edges,r.defaultMarkerColor,r.flowId],([N,F,G])=>Eh(N,{defaultColor:F,id:G})),initialized:(()=>{let N=!1;const F=me(r.nodes).length,G=me(r.edges).length;return yl([r.nodesInitialized,r.edgesInitialized,r.viewportInitialized],([K,X,Q])=>N||(F===0?N=Q:G===0?N=Q&&K:N=Q&&K&&X,N))})(),syncNodeStores:N=>Mm(r.nodes,N),syncEdgeStores:N=>Tm(r.edges,N),syncViewport:N=>Vm(r.panZoom,r.viewport,N),setNodeTypes:a,setEdgeTypes:c,addEdge:u,updateNodePositions:f,updateNodeInternals:h,zoomIn:v,zoomOut:g,fitView:N=>d(N),setMinZoom:w,setMaxZoom:y,setTranslateExtent:I,setPaneClickDistance:T,unselectNodesAndEdges:E,addSelectedNodes:H,addSelectedEdges:O,handleNodeSelection:B,panBy:j,updateConnection:R,cancelConnection:C,reset:Y}}function Xt(){const l=Ft(No);if(!l)throw new Error("In order to use useStore you need to wrap your component in a <SvelteFlowProvider />");return l.getStore()}function Bm({nodes:l,edges:e,width:t,height:n,fitView:o,nodeOrigin:s,nodeExtent:i}){const r=Va({nodes:l,edges:e,width:t,height:n,fitView:o,nodeOrigin:s,nodeExtent:i});return Ol(No,{getStore:()=>r}),r}function Am(l,e){const{panZoom:t,minZoom:n,maxZoom:o,initialViewport:s,viewport:i,dragging:r,translateExtent:a,paneClickDistance:c}=e,u=Xh({domNode:l,minZoom:n,maxZoom:o,translateExtent:a,viewport:s,paneClickDistance:c,onDraggingChange:r.set}),f=u.getViewport();return i.set(f),t.set(u),u.update(e),{update(h){u.update(h)}}}function Lm(l){let e,t,n,o,s;const i=l[35].default,r=Qt(i,l,l[34],null);return{c(){e=V("div"),r&&r.c(),this.h()},l(a){e=z(a,"DIV",{class:!0});var c=M(e);r&&r.l(c),c.forEach(_),this.h()},h(){m(e,"class","svelte-flow__zoom svelte-4xkw84")},m(a,c){A(a,e,c),r&&r.m(e,null),n=!0,o||(s=gn(t=Am.call(null,e,{viewport:l[18],minZoom:l[12],maxZoom:l[13],initialViewport:l[11],dragging:l[23],panZoom:l[19],onPanZoomStart:l[0],onPanZoom:l[1],onPanZoomEnd:l[2],zoomOnScroll:l[5],zoomOnDoubleClick:l[6],zoomOnPinch:l[7],panOnScroll:l[9],panOnDrag:l[10],panOnScrollSpeed:.5,panOnScrollMode:l[3]||jn.Free,zoomActivationKeyPressed:l[14],preventScrolling:typeof l[4]=="boolean"?l[4]:!0,noPanClassName:"nopan",noWheelClassName:"nowheel",userSelectionActive:!!l[15],translateExtent:l[16],lib:l[17],paneClickDistance:l[8],onTransformChange:l[29]})),o=!0)},p(a,c){r&&r.p&&(!n||c[1]&8)&&xt(r,i,a,a[34],n?en(i,a[34],c,null):$t(a[34]),null),t&&ln(t.update)&&c[0]&262143&&t.update.call(null,{viewport:a[18],minZoom:a[12],maxZoom:a[13],initialViewport:a[11],dragging:a[23],panZoom:a[19],onPanZoomStart:a[0],onPanZoom:a[1],onPanZoomEnd:a[2],zoomOnScroll:a[5],zoomOnDoubleClick:a[6],zoomOnPinch:a[7],panOnScroll:a[9],panOnDrag:a[10],panOnScrollSpeed:.5,panOnScrollMode:a[3]||jn.Free,zoomActivationKeyPressed:a[14],preventScrolling:typeof a[4]=="boolean"?a[4]:!0,noPanClassName:"nopan",noWheelClassName:"nowheel",userSelectionActive:!!a[15],translateExtent:a[16],lib:a[17],paneClickDistance:a[8],onTransformChange:a[29]})},i(a){n||(D(r,a),n=!0)},o(a){P(r,a),n=!1},d(a){a&&_(e),r&&r.d(a),o=!1,s()}}}function Rm(l,e,t){let n,o,s,i,r,a,c,u,f,h,d,{$$slots:p={},$$scope:b}=e,{initialViewport:v=void 0}=e,{onMoveStart:g=void 0}=e,{onMove:w=void 0}=e,{onMoveEnd:y=void 0}=e,{panOnScrollMode:I}=e,{preventScrolling:S}=e,{zoomOnScroll:T}=e,{zoomOnDoubleClick:E}=e,{zoomOnPinch:H}=e,{panOnDrag:O}=e,{panOnScroll:B}=e,{paneClickDistance:j}=e;const{viewport:Z,panZoom:R,selectionRect:C,minZoom:Y,maxZoom:N,dragging:F,translateExtent:G,lib:K,panActivationKeyPressed:X,zoomActivationKeyPressed:Q,viewportInitialized:U}=Xt();ae(l,C,q=>t(15,f=q)),ae(l,Y,q=>t(12,a=q)),ae(l,N,q=>t(13,c=q)),ae(l,G,q=>t(16,h=q)),ae(l,K,q=>t(17,d=q)),ae(l,X,q=>t(33,r=q)),ae(l,Q,q=>t(14,u=q)),ae(l,U,q=>t(36,i=q));const J=q=>Z.set({x:q[0],y:q[1],zoom:q[2]});return pn(()=>{io(U,i=!0,i)}),l.$$set=q=>{"initialViewport"in q&&t(30,v=q.initialViewport),"onMoveStart"in q&&t(0,g=q.onMoveStart),"onMove"in q&&t(1,w=q.onMove),"onMoveEnd"in q&&t(2,y=q.onMoveEnd),"panOnScrollMode"in q&&t(3,I=q.panOnScrollMode),"preventScrolling"in q&&t(4,S=q.preventScrolling),"zoomOnScroll"in q&&t(5,T=q.zoomOnScroll),"zoomOnDoubleClick"in q&&t(6,E=q.zoomOnDoubleClick),"zoomOnPinch"in q&&t(7,H=q.zoomOnPinch),"panOnDrag"in q&&t(31,O=q.panOnDrag),"panOnScroll"in q&&t(32,B=q.panOnScroll),"paneClickDistance"in q&&t(8,j=q.paneClickDistance),"$$scope"in q&&t(34,b=q.$$scope)},l.$$.update=()=>{l.$$.dirty[0]&1073741824&&t(11,n=v||{x:0,y:0,zoom:1}),l.$$.dirty[1]&5&&t(10,o=r||O),l.$$.dirty[1]&6&&t(9,s=r||B)},[g,w,y,I,S,T,E,H,j,s,o,n,a,c,u,f,h,d,Z,R,C,Y,N,F,G,K,X,Q,U,J,v,O,B,r,b,p]}class Um extends Re{constructor(e){super(),Ue(this,e,Rm,Lm,Fe,{initialViewport:30,onMoveStart:0,onMove:1,onMoveEnd:2,panOnScrollMode:3,preventScrolling:4,zoomOnScroll:5,zoomOnDoubleClick:6,zoomOnPinch:7,panOnDrag:31,panOnScroll:32,paneClickDistance:8},null,[-1,-1])}}function Wm(l){let e,t,n,o;const s=l[28].default,i=Qt(s,l,l[27],null);return{c(){e=V("div"),i&&i.c(),this.h()},l(r){e=z(r,"DIV",{class:!0});var a=M(e);i&&i.l(a),a.forEach(_),this.h()},h(){m(e,"class","svelte-flow__pane svelte-1esy7hx"),st(e,"draggable",l[0]===!0||Array.isArray(l[0])&&l[0].includes(0)),st(e,"dragging",l[4]),st(e,"selection",l[1])},m(r,a){A(r,e,a),i&&i.m(e,null),l[29](e),t=!0,n||(o=[ke(e,"click",function(){ln(l[3]?void 0:oo(l[15],l[2]))&&(l[3]?void 0:oo(l[15],l[2])).apply(this,arguments)}),ke(e,"pointerdown",function(){ln(l[3]?l[16]:void 0)&&(l[3]?l[16]:void 0).apply(this,arguments)}),ke(e,"pointermove",function(){ln(l[3]?l[17]:void 0)&&(l[3]?l[17]:void 0).apply(this,arguments)}),ke(e,"pointerup",function(){ln(l[3]?l[18]:void 0)&&(l[3]?l[18]:void 0).apply(this,arguments)}),ke(e,"contextmenu",function(){ln(oo(l[19],l[2]))&&oo(l[19],l[2]).apply(this,arguments)})],n=!0)},p(r,a){l=r,i&&i.p&&(!t||a[0]&134217728)&&xt(i,s,l,l[27],t?en(s,l[27],a,null):$t(l[27]),null),(!t||a[0]&1)&&st(e,"draggable",l[0]===!0||Array.isArray(l[0])&&l[0].includes(0)),(!t||a[0]&16)&&st(e,"dragging",l[4]),(!t||a[0]&2)&&st(e,"selection",l[1])},i(r){t||(D(i,r),t=!0)},o(r){P(i,r),t=!1},d(r){r&&_(e),i&&i.d(r),l[29](null),n=!1,on(o)}}}function oo(l,e){return t=>{t.target===e&&(l==null||l(t))}}function Ar(l){return e=>{const t=l.includes(e.id);return e.selected!==t&&(e.selected=t),e}}function Fm(l,e,t){let n,o,s,i,r,a,c,u,f,h,d,p,b,{$$slots:v={},$$scope:g}=e,{panOnDrag:w=void 0}=e,{selectionOnDrag:y=void 0}=e;const I=cn(),{nodes:S,nodeLookup:T,edges:E,viewport:H,dragging:O,elementsSelectable:B,selectionRect:j,selectionRectMode:Z,selectionKeyPressed:R,selectionMode:C,panActivationKeyPressed:Y,unselectNodesAndEdges:N}=Xt();ae(l,T,re=>t(36,f=re)),ae(l,E,re=>t(33,a=re)),ae(l,H,re=>t(35,u=re)),ae(l,O,re=>t(4,b=re)),ae(l,B,re=>t(25,d=re)),ae(l,j,re=>t(24,h=re)),ae(l,Z,re=>t(23,r=re)),ae(l,R,re=>t(22,i=re)),ae(l,C,re=>t(34,c=re)),ae(l,Y,re=>t(26,p=re));let F,G=null,K=[],X=!1;function Q(re){if(X){X=!1;return}I("paneclick",{event:re}),N(),Z.set(null)}function U(re){var ue,Ee;if(G=F.getBoundingClientRect(),!B||!o||re.button!==0||re.target!==F||!G)return;(Ee=(ue=re.target)==null?void 0:ue.setPointerCapture)==null||Ee.call(ue,re.pointerId);const{x:Oe,y:x}=Gn(re,G);N(),j.set({width:0,height:0,startX:Oe,startY:x,x:Oe,y:x})}function J(re){if(!o||!G||!h)return;X=!0;const Oe=Gn(re,G),x=h.startX??0,ue=h.startY??0,Ee={...h,x:Oe.x<x?Oe.x:x,y:Oe.y<ue?Oe.y:ue,width:Math.abs(Oe.x-x),height:Math.abs(Oe.y-ue)},Xe=K.map(it=>it.id),Ke=qo(K,a).map(it=>it.id);K=na(f,Ee,[u.x,u.y,u.zoom],c===fo.Partial,!0);const fe=qo(K,a).map(it=>it.id),lt=K.map(it=>it.id);(Xe.length!==lt.length||lt.some(it=>!Xe.includes(it)))&&S.update(it=>it.map(Ar(lt))),(Ke.length!==fe.length||fe.some(it=>!Ke.includes(it)))&&E.update(it=>it.map(Ar(fe))),Z.set("user"),j.set(Ee)}function q(re){var Oe,x;re.button===0&&((x=(Oe=re.target)==null?void 0:Oe.releasePointerCapture)==null||x.call(Oe,re.pointerId),!o&&r==="user"&&re.target===F&&(Q==null||Q(re)),j.set(null),K.length>0&&io(Z,r="nodes",r),i&&(X=!1))}const ce=re=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){re.preventDefault();return}I("panecontextmenu",{event:re})};function ge(re){We[re?"unshift":"push"](()=>{F=re,t(2,F)})}return l.$$set=re=>{"panOnDrag"in re&&t(0,w=re.panOnDrag),"selectionOnDrag"in re&&t(20,y=re.selectionOnDrag),"$$scope"in re&&t(27,g=re.$$scope)},l.$$.update=()=>{l.$$.dirty[0]&67108865&&t(21,n=p||w),l.$$.dirty[0]&24117248&&t(1,o=i||h||y&&n!==!0),l.$$.dirty[0]&41943042&&t(3,s=d&&(o||r==="user"))},[w,o,F,s,b,T,E,H,O,B,j,Z,R,C,Y,Q,U,J,q,ce,y,n,i,r,h,d,p,g,v,ge]}class jm extends Re{constructor(e){super(),Ue(this,e,Fm,Wm,Fe,{panOnDrag:0,selectionOnDrag:20},null,[-1,-1])}}function Ym(l){let e,t;const n=l[3].default,o=Qt(n,l,l[2],null);return{c(){e=V("div"),o&&o.c(),this.h()},l(s){e=z(s,"DIV",{class:!0,style:!0});var i=M(e);o&&o.l(i),i.forEach(_),this.h()},h(){m(e,"class","svelte-flow__viewport xyflow__viewport svelte-1floaup"),$e(e,"transform","translate("+l[0].x+"px, "+l[0].y+"px) scale("+l[0].zoom+")")},m(s,i){A(s,e,i),o&&o.m(e,null),t=!0},p(s,[i]){o&&o.p&&(!t||i&4)&&xt(o,n,s,s[2],t?en(n,s[2],i,null):$t(s[2]),null),(!t||i&1)&&$e(e,"transform","translate("+s[0].x+"px, "+s[0].y+"px) scale("+s[0].zoom+")")},i(s){t||(D(o,s),t=!0)},o(s){P(o,s),t=!1},d(s){s&&_(e),o&&o.d(s)}}}function Xm(l,e,t){let n,{$$slots:o={},$$scope:s}=e;const{viewport:i}=Xt();return ae(l,i,r=>t(0,n=r)),l.$$set=r=>{"$$scope"in r&&t(2,s=r.$$scope)},[n,i,s,o]}class Km extends Re{constructor(e){super(),Ue(this,e,Xm,Ym,Fe,{})}}function za(l,e){const{store:t,onDrag:n,onDragStart:o,onDragStop:s,onNodeMouseDown:i}=e,r=zh({onDrag:n,onDragStart:o,onDragStop:s,onNodeMouseDown:i,getStoreItems:()=>{const c=me(t.snapGrid),u=me(t.viewport);return{nodes:me(t.nodes),nodeLookup:me(t.nodeLookup),edges:me(t.edges),nodeExtent:me(t.nodeExtent),snapGrid:c||[0,0],snapToGrid:!!c,nodeOrigin:me(t.nodeOrigin),multiSelectionActive:me(t.multiselectionKeyPressed),domNode:me(t.domNode),transform:[u.x,u.y,u.zoom],autoPanOnNodeDrag:me(t.autoPanOnNodeDrag),nodesDraggable:me(t.nodesDraggable),selectNodesOnDrag:me(t.selectNodesOnDrag),nodeDragThreshold:me(t.nodeDragThreshold),unselectNodesAndEdges:t.unselectNodesAndEdges,updateNodePositions:t.updateNodePositions,panBy:t.panBy}}});function a(c,u){if(u.disabled){r.destroy();return}r.update({domNode:c,noDragClassName:u.noDragClass,handleSelector:u.handleSelector,nodeId:u.nodeId,isSelectable:u.isSelectable,nodeClickDistance:u.nodeClickDistance})}return a(l,e),{update(c){a(l,c)},destroy(){r.destroy()}}}function Zm({width:l,height:e,initialWidth:t,initialHeight:n,measuredWidth:o,measuredHeight:s}){if(o===void 0&&s===void 0){const i=l??t,r=e??n;return{width:i?`width:${i}px;`:"",height:r?`height:${r}px;`:""}}return{width:l?`width:${l}px;`:"",height:e?`height:${e}px;`:""}}function Lr(l){let e,t,n,o,s,i=`translate(${l[12]}px, ${l[13]}px)`,r,a,c;var u=l[27];function f(h,d){return{props:{data:h[2],id:h[1],selected:h[3],selectable:h[5],deletable:h[7],sourcePosition:h[14],targetPosition:h[15],zIndex:h[16],dragging:h[9],draggable:h[4],dragHandle:h[19],parentId:h[21],type:h[25],isConnectable:h[28],positionAbsoluteX:h[12],positionAbsoluteY:h[13],width:h[17],height:h[18]}}}return u&&(t=ao(u,f(l))),{c(){e=V("div"),t&&ne(t.$$.fragment),this.h()},l(h){e=z(h,"DIV",{"data-id":!0,class:!0,style:!0});var d=M(e);t&&se(t.$$.fragment,d),d.forEach(_),this.h()},h(){m(e,"data-id",l[1]),m(e,"class",n=Ot(["svelte-flow__node",`svelte-flow__node-${l[25]}`,l[23]])),m(e,"style",o=(l[10]??"")+";"+l[26].width+l[26].height),st(e,"dragging",l[9]),st(e,"selected",l[3]),st(e,"draggable",l[4]),st(e,"connectable",l[6]),st(e,"selectable",l[5]),st(e,"nopan",l[4]),st(e,"parent",l[11]),$e(e,"z-index",l[16]),$e(e,"transform",i),$e(e,"visibility",l[20]?"visible":"hidden")},m(h,d){A(h,e,d),t&&le(t,e,null),l[50](e),r=!0,a||(c=[gn(s=za.call(null,e,{nodeId:l[1],isSelectable:l[5],disabled:!1,handleSelector:l[19],noDragClass:"nodrag",nodeClickDistance:l[22],onNodeMouseDown:l[31],onDrag:l[47],onDragStart:l[48],onDragStop:l[49],store:l[29]})),ke(e,"click",l[34]),ke(e,"mouseenter",l[51]),ke(e,"mouseleave",l[52]),ke(e,"mousemove",l[53]),ke(e,"contextmenu",l[54])],a=!0)},p(h,d){if(d[0]&134217728&&u!==(u=h[27])){if(t){He();const b=t;P(b.$$.fragment,1,0,()=>{oe(b,1)}),Be()}u?(t=ao(u,f(h)),ne(t.$$.fragment),D(t.$$.fragment,1),le(t,e,null)):t=null}else if(u){const b={};d[0]&4&&(b.data=h[2]),d[0]&2&&(b.id=h[1]),d[0]&8&&(b.selected=h[3]),d[0]&32&&(b.selectable=h[5]),d[0]&128&&(b.deletable=h[7]),d[0]&16384&&(b.sourcePosition=h[14]),d[0]&32768&&(b.targetPosition=h[15]),d[0]&65536&&(b.zIndex=h[16]),d[0]&512&&(b.dragging=h[9]),d[0]&16&&(b.draggable=h[4]),d[0]&524288&&(b.dragHandle=h[19]),d[0]&2097152&&(b.parentId=h[21]),d[0]&33554432&&(b.type=h[25]),d[0]&268435456&&(b.isConnectable=h[28]),d[0]&4096&&(b.positionAbsoluteX=h[12]),d[0]&8192&&(b.positionAbsoluteY=h[13]),d[0]&131072&&(b.width=h[17]),d[0]&262144&&(b.height=h[18]),t.$set(b)}(!r||d[0]&2)&&m(e,"data-id",h[1]),(!r||d[0]&41943040&&n!==(n=Ot(["svelte-flow__node",`svelte-flow__node-${h[25]}`,h[23]])))&&m(e,"class",n),(!r||d[0]&67109888&&o!==(o=(h[10]??"")+";"+h[26].width+h[26].height))&&m(e,"style",o),s&&ln(s.update)&&d[0]&4718626&&s.update.call(null,{nodeId:h[1],isSelectable:h[5],disabled:!1,handleSelector:h[19],noDragClass:"nodrag",nodeClickDistance:h[22],onNodeMouseDown:h[31],onDrag:h[47],onDragStart:h[48],onDragStop:h[49],store:h[29]}),(!r||d[0]&41943552)&&st(e,"dragging",h[9]),(!r||d[0]&41943048)&&st(e,"selected",h[3]),(!r||d[0]&41943056)&&st(e,"draggable",h[4]),(!r||d[0]&41943104)&&st(e,"connectable",h[6]),(!r||d[0]&41943072)&&st(e,"selectable",h[5]),(!r||d[0]&41943056)&&st(e,"nopan",h[4]),(!r||d[0]&41945088)&&st(e,"parent",h[11]);const p=d[0]&67109888;(d[0]&67175424||p)&&$e(e,"z-index",h[16]),(d[0]&67122176&&i!==(i=`translate(${h[12]}px, ${h[13]}px)`)||p)&&$e(e,"transform",i),(d[0]&68158464||p)&&$e(e,"visibility",h[20]?"visible":"hidden")},i(h){r||(t&&D(t.$$.fragment,h),r=!0)},o(h){t&&P(t.$$.fragment,h),r=!1},d(h){h&&_(e),t&&oe(t),l[50](null),a=!1,on(c)}}}function Gm(l){let e,t,n=!l[8]&&Lr(l);return{c(){n&&n.c(),e=Ae()},l(o){n&&n.l(o),e=Ae()},m(o,s){n&&n.m(o,s),A(o,e,s),t=!0},p(o,s){o[8]?n&&(He(),P(n,1,1,()=>{n=null}),Be()):n?(n.p(o,s),s[0]&256&&D(n,1)):(n=Lr(o),n.c(),D(n,1),n.m(e.parentNode,e))},i(o){t||(D(n),t=!0)},o(o){P(n),t=!1},d(o){o&&_(e),n&&n.d(o)}}}function qm(l,e,t){let n,o,s,i,r,a,{node:c}=e,{id:u}=e,{data:f={}}=e,{selected:h=!1}=e,{draggable:d=void 0}=e,{selectable:p=void 0}=e,{connectable:b=!0}=e,{deletable:v=!0}=e,{hidden:g=!1}=e,{dragging:w=!1}=e,{resizeObserver:y=null}=e,{style:I=void 0}=e,{type:S="default"}=e,{isParent:T=!1}=e,{positionX:E}=e,{positionY:H}=e,{sourcePosition:O=void 0}=e,{targetPosition:B=void 0}=e,{zIndex:j}=e,{measuredWidth:Z=void 0}=e,{measuredHeight:R=void 0}=e,{initialWidth:C=void 0}=e,{initialHeight:Y=void 0}=e,{width:N=void 0}=e,{height:F=void 0}=e,{dragHandle:G=void 0}=e,{initialized:K=!1}=e,{parentId:X=void 0}=e,{nodeClickDistance:Q=void 0}=e,{class:U=""}=e;const J=Xt(),{nodeTypes:q,nodeDragThreshold:ce,selectNodesOnDrag:ge,handleNodeSelection:re,updateNodeInternals:Oe}=J;ae(l,q,he=>t(46,r=he));let x,ue=null;const Ee=cn(),Xe=Qe(b);ae(l,Xe,he=>t(28,a=he));let Ke,fe,lt;Ol("svelteflow__node_id",u),Ol("svelteflow__node_connectable",Xe),nl(()=>{ue&&(y==null||y.unobserve(ue))});function it(he){p&&(!me(ge)||!d||me(ce)>0)&&re(u),Ee("nodeclick",{node:c.internals.userNode,event:he})}const Nt=(he,yt,ht,bt)=>{Ee("nodedrag",{event:he,targetNode:ht,nodes:bt})},Dt=(he,yt,ht,bt)=>{Ee("nodedragstart",{event:he,targetNode:ht,nodes:bt})},Ht=(he,yt,ht,bt)=>{Ee("nodedragstop",{event:he,targetNode:ht,nodes:bt})};function wt(he){We[he?"unshift":"push"](()=>{x=he,t(24,x)})}const Ut=he=>Ee("nodemouseenter",{node:c,event:he}),pe=he=>Ee("nodemouseleave",{node:c,event:he}),Ye=he=>Ee("nodemousemove",{node:c,event:he}),ot=he=>Ee("nodecontextmenu",{node:c,event:he});return l.$$set=he=>{"node"in he&&t(0,c=he.node),"id"in he&&t(1,u=he.id),"data"in he&&t(2,f=he.data),"selected"in he&&t(3,h=he.selected),"draggable"in he&&t(4,d=he.draggable),"selectable"in he&&t(5,p=he.selectable),"connectable"in he&&t(6,b=he.connectable),"deletable"in he&&t(7,v=he.deletable),"hidden"in he&&t(8,g=he.hidden),"dragging"in he&&t(9,w=he.dragging),"resizeObserver"in he&&t(35,y=he.resizeObserver),"style"in he&&t(10,I=he.style),"type"in he&&t(36,S=he.type),"isParent"in he&&t(11,T=he.isParent),"positionX"in he&&t(12,E=he.positionX),"positionY"in he&&t(13,H=he.positionY),"sourcePosition"in he&&t(14,O=he.sourcePosition),"targetPosition"in he&&t(15,B=he.targetPosition),"zIndex"in he&&t(16,j=he.zIndex),"measuredWidth"in he&&t(37,Z=he.measuredWidth),"measuredHeight"in he&&t(38,R=he.measuredHeight),"initialWidth"in he&&t(39,C=he.initialWidth),"initialHeight"in he&&t(40,Y=he.initialHeight),"width"in he&&t(17,N=he.width),"height"in he&&t(18,F=he.height),"dragHandle"in he&&t(19,G=he.dragHandle),"initialized"in he&&t(20,K=he.initialized),"parentId"in he&&t(21,X=he.parentId),"nodeClickDistance"in he&&t(22,Q=he.nodeClickDistance),"class"in he&&t(23,U=he.class)},l.$$.update=()=>{l.$$.dirty[1]&32&&t(25,n=S||"default"),l.$$.dirty[0]&33554432|l.$$.dirty[1]&32768&&t(45,o=!!r[n]),l.$$.dirty[0]&33554432|l.$$.dirty[1]&32768&&t(27,s=r[n]||Sa),l.$$.dirty[1]&16416&&(o||console.warn("003",Kl.error003(S))),l.$$.dirty[0]&393216|l.$$.dirty[1]&960&&t(26,i=Zm({width:N,height:F,initialWidth:C,initialHeight:Y,measuredWidth:Z,measuredHeight:R})),l.$$.dirty[0]&64&&Xe.set(!!b),l.$$.dirty[0]&50380802|l.$$.dirty[1]&14336&&((Ke&&n!==Ke||fe&&O!==fe||lt&&B!==lt)&&requestAnimationFrame(()=>Oe(new Map([[u,{id:u,nodeElement:x,force:!0}]]))),t(42,Ke=n),t(43,fe=O),t(44,lt=B)),l.$$.dirty[0]&17825792|l.$$.dirty[1]&1040&&y&&(x!==ue||!K)&&(ue&&y.unobserve(ue),x&&y.observe(x),t(41,ue=x))},[c,u,f,h,d,p,b,v,g,w,I,T,E,H,O,B,j,N,F,G,K,X,Q,U,x,n,i,s,a,J,q,re,Ee,Xe,it,y,S,Z,R,C,Y,ue,Ke,fe,lt,o,r,Nt,Dt,Ht,wt,Ut,pe,Ye,ot]}class Jm extends Re{constructor(e){super(),Ue(this,e,qm,Gm,Ui,{node:0,id:1,data:2,selected:3,draggable:4,selectable:5,connectable:6,deletable:7,hidden:8,dragging:9,resizeObserver:35,style:10,type:36,isParent:11,positionX:12,positionY:13,sourcePosition:14,targetPosition:15,zIndex:16,measuredWidth:37,measuredHeight:38,initialWidth:39,initialHeight:40,width:17,height:18,dragHandle:19,initialized:20,parentId:21,nodeClickDistance:22,class:23},null,[-1,-1])}}const{Map:Qm}=Wi;function Rr(l,e,t){const n=l.slice();return n[21]=e[t],n}function Ur(l,e){let t,n,o;return n=new Jm({props:{node:e[21],id:e[21].id,data:e[21].data,selected:!!e[21].selected,hidden:!!e[21].hidden,draggable:!!(e[21].draggable||e[2]&&typeof e[21].draggable>"u"),selectable:!!(e[21].selectable||e[3]&&typeof e[21].selectable>"u"),connectable:!!(e[21].connectable||e[4]&&typeof e[21].connectable>"u"),deletable:e[21].deletable??!0,positionX:e[21].internals.positionAbsolute.x,positionY:e[21].internals.positionAbsolute.y,isParent:e[5].has(e[21].id),style:e[21].style,class:e[21].class,type:e[21].type??"default",sourcePosition:e[21].sourcePosition,targetPosition:e[21].targetPosition,dragging:e[21].dragging,zIndex:e[21].internals.z??0,dragHandle:e[21].dragHandle,initialized:Sr(e[21]),width:e[21].width,height:e[21].height,initialWidth:e[21].initialWidth,initialHeight:e[21].initialHeight,measuredWidth:e[21].measured.width,measuredHeight:e[21].measured.height,parentId:e[21].parentId,resizeObserver:e[11],nodeClickDistance:e[0]}}),n.$on("nodeclick",e[12]),n.$on("nodemouseenter",e[13]),n.$on("nodemousemove",e[14]),n.$on("nodemouseleave",e[15]),n.$on("nodedrag",e[16]),n.$on("nodedragstart",e[17]),n.$on("nodedragstop",e[18]),n.$on("nodecontextmenu",e[19]),{key:l,first:null,c(){t=Ae(),ne(n.$$.fragment),this.h()},l(s){t=Ae(),se(n.$$.fragment,s),this.h()},h(){this.first=t},m(s,i){A(s,t,i),le(n,s,i),o=!0},p(s,i){e=s;const r={};i&2&&(r.node=e[21]),i&2&&(r.id=e[21].id),i&2&&(r.data=e[21].data),i&2&&(r.selected=!!e[21].selected),i&2&&(r.hidden=!!e[21].hidden),i&6&&(r.draggable=!!(e[21].draggable||e[2]&&typeof e[21].draggable>"u")),i&10&&(r.selectable=!!(e[21].selectable||e[3]&&typeof e[21].selectable>"u")),i&18&&(r.connectable=!!(e[21].connectable||e[4]&&typeof e[21].connectable>"u")),i&2&&(r.deletable=e[21].deletable??!0),i&2&&(r.positionX=e[21].internals.positionAbsolute.x),i&2&&(r.positionY=e[21].internals.positionAbsolute.y),i&34&&(r.isParent=e[5].has(e[21].id)),i&2&&(r.style=e[21].style),i&2&&(r.class=e[21].class),i&2&&(r.type=e[21].type??"default"),i&2&&(r.sourcePosition=e[21].sourcePosition),i&2&&(r.targetPosition=e[21].targetPosition),i&2&&(r.dragging=e[21].dragging),i&2&&(r.zIndex=e[21].internals.z??0),i&2&&(r.dragHandle=e[21].dragHandle),i&2&&(r.initialized=Sr(e[21])),i&2&&(r.width=e[21].width),i&2&&(r.height=e[21].height),i&2&&(r.initialWidth=e[21].initialWidth),i&2&&(r.initialHeight=e[21].initialHeight),i&2&&(r.measuredWidth=e[21].measured.width),i&2&&(r.measuredHeight=e[21].measured.height),i&2&&(r.parentId=e[21].parentId),i&1&&(r.nodeClickDistance=e[0]),n.$set(r)},i(s){o||(D(n.$$.fragment,s),o=!0)},o(s){P(n.$$.fragment,s),o=!1},d(s){s&&_(t),oe(n,s)}}}function xm(l){let e,t=[],n=new Qm,o,s=vt(l[1]);const i=r=>r[21].id;for(let r=0;r<s.length;r+=1){let a=Rr(l,s,r),c=i(a);n.set(c,t[r]=Ur(c,a))}return{c(){e=V("div");for(let r=0;r<t.length;r+=1)t[r].c();this.h()},l(r){e=z(r,"DIV",{class:!0});var a=M(e);for(let c=0;c<t.length;c+=1)t[c].l(a);a.forEach(_),this.h()},h(){m(e,"class","svelte-flow__nodes svelte-tf4uy4")},m(r,a){A(r,e,a);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);o=!0},p(r,[a]){a&2111&&(s=vt(r[1]),He(),t=bo(t,a,i,1,r,s,n,e,vo,Ur,null,Rr),Be())},i(r){if(!o){for(let a=0;a<s.length;a+=1)D(t[a]);o=!0}},o(r){for(let a=0;a<t.length;a+=1)P(t[a]);o=!1},d(r){r&&_(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function $m(l,e,t){let n,o,s,i,r,{nodeClickDistance:a=0}=e;const{visibleNodes:c,nodesDraggable:u,nodesConnectable:f,elementsSelectable:h,updateNodeInternals:d,parentLookup:p}=Xt();ae(l,c,H=>t(1,n=H)),ae(l,u,H=>t(2,o=H)),ae(l,f,H=>t(4,i=H)),ae(l,h,H=>t(3,s=H)),ae(l,p,H=>t(5,r=H));const b=typeof ResizeObserver>"u"?null:new ResizeObserver(H=>{const O=new Map;H.forEach(B=>{const j=B.target.getAttribute("data-id");O.set(j,{id:j,nodeElement:B.target,force:!0})}),d(O)});nl(()=>{b==null||b.disconnect()});function v(H){gt.call(this,l,H)}function g(H){gt.call(this,l,H)}function w(H){gt.call(this,l,H)}function y(H){gt.call(this,l,H)}function I(H){gt.call(this,l,H)}function S(H){gt.call(this,l,H)}function T(H){gt.call(this,l,H)}function E(H){gt.call(this,l,H)}return l.$$set=H=>{"nodeClickDistance"in H&&t(0,a=H.nodeClickDistance)},[a,n,o,s,i,r,c,u,f,h,p,b,v,g,w,y,I,S,T,E]}class eg extends Re{constructor(e){super(),Ue(this,e,$m,xm,Fe,{nodeClickDistance:0})}}function Wr(l){let e,t,n,o,s,i,r,a;var c=l[27];function u(f,h){return{props:{id:f[0],source:f[1],target:f[2],sourceX:f[14],sourceY:f[15],targetX:f[16],targetY:f[17],sourcePosition:f[18],targetPosition:f[19],animated:f[6],selected:f[7],label:f[10],labelStyle:f[11],data:f[3],style:f[4],interactionWidth:f[21],selectable:f[24],deletable:f[8]??!0,type:f[23],sourceHandleId:f[12],targetHandleId:f[13],markerStart:f[26],markerEnd:f[25]}}}return c&&(n=ao(c,u(l))),{c(){e=Ne("svg"),t=Ne("g"),n&&ne(n.$$.fragment),this.h()},l(f){e=Pe(f,"svg",{});var h=M(e);t=Pe(h,"g",{class:!0,"data-id":!0,"aria-label":!0,role:!0});var d=M(t);n&&se(n.$$.fragment,d),d.forEach(_),h.forEach(_),this.h()},h(){m(t,"class",o=Ot(["svelte-flow__edge",l[22]])),m(t,"data-id",l[0]),m(t,"aria-label",s=l[20]===null?void 0:l[20]?l[20]:`Edge from ${l[1]} to ${l[2]}`),m(t,"role","img"),st(t,"animated",l[6]),st(t,"selected",l[7]),st(t,"selectable",l[24]),$e(e,"z-index",l[5])},m(f,h){A(f,e,h),k(e,t),n&&le(n,t,null),i=!0,r||(a=[ke(t,"click",l[32]),ke(t,"contextmenu",l[41]),ke(t,"mouseenter",l[42]),ke(t,"mouseleave",l[43])],r=!0)},p(f,h){if(h[0]&134217728&&c!==(c=f[27])){if(n){He();const d=n;P(d.$$.fragment,1,0,()=>{oe(d,1)}),Be()}c?(n=ao(c,u(f)),ne(n.$$.fragment),D(n.$$.fragment,1),le(n,t,null)):n=null}else if(c){const d={};h[0]&1&&(d.id=f[0]),h[0]&2&&(d.source=f[1]),h[0]&4&&(d.target=f[2]),h[0]&16384&&(d.sourceX=f[14]),h[0]&32768&&(d.sourceY=f[15]),h[0]&65536&&(d.targetX=f[16]),h[0]&131072&&(d.targetY=f[17]),h[0]&262144&&(d.sourcePosition=f[18]),h[0]&524288&&(d.targetPosition=f[19]),h[0]&64&&(d.animated=f[6]),h[0]&128&&(d.selected=f[7]),h[0]&1024&&(d.label=f[10]),h[0]&2048&&(d.labelStyle=f[11]),h[0]&8&&(d.data=f[3]),h[0]&16&&(d.style=f[4]),h[0]&2097152&&(d.interactionWidth=f[21]),h[0]&16777216&&(d.selectable=f[24]),h[0]&256&&(d.deletable=f[8]??!0),h[0]&8388608&&(d.type=f[23]),h[0]&4096&&(d.sourceHandleId=f[12]),h[0]&8192&&(d.targetHandleId=f[13]),h[0]&67108864&&(d.markerStart=f[26]),h[0]&33554432&&(d.markerEnd=f[25]),n.$set(d)}(!i||h[0]&4194304&&o!==(o=Ot(["svelte-flow__edge",f[22]])))&&m(t,"class",o),(!i||h[0]&1)&&m(t,"data-id",f[0]),(!i||h[0]&1048582&&s!==(s=f[20]===null?void 0:f[20]?f[20]:`Edge from ${f[1]} to ${f[2]}`))&&m(t,"aria-label",s),(!i||h[0]&4194368)&&st(t,"animated",f[6]),(!i||h[0]&4194432)&&st(t,"selected",f[7]),(!i||h[0]&20971520)&&st(t,"selectable",f[24]),h[0]&32&&$e(e,"z-index",f[5])},i(f){i||(n&&D(n.$$.fragment,f),i=!0)},o(f){n&&P(n.$$.fragment,f),i=!1},d(f){f&&_(e),n&&oe(n),r=!1,on(a)}}}function tg(l){let e,t,n=!l[9]&&Wr(l);return{c(){n&&n.c(),e=Ae()},l(o){n&&n.l(o),e=Ae()},m(o,s){n&&n.m(o,s),A(o,e,s),t=!0},p(o,s){o[9]?n&&(He(),P(n,1,1,()=>{n=null}),Be()):n?(n.p(o,s),s[0]&512&&D(n,1)):(n=Wr(o),n.c(),D(n,1),n.m(e.parentNode,e))},i(o){t||(D(n),t=!0)},o(o){P(n),t=!1},d(o){o&&_(e),n&&n.d(o)}}}function ng(l,e,t){let n,o,s,i,r,a,c,u,f,{id:h}=e,{type:d="default"}=e,{source:p=""}=e,{target:b=""}=e,{data:v={}}=e,{style:g=void 0}=e,{zIndex:w=void 0}=e,{animated:y=!1}=e,{selected:I=!1}=e,{selectable:S=void 0}=e,{deletable:T=void 0}=e,{hidden:E=!1}=e,{label:H=void 0}=e,{labelStyle:O=void 0}=e,{markerStart:B=void 0}=e,{markerEnd:j=void 0}=e,{sourceHandle:Z=void 0}=e,{targetHandle:R=void 0}=e,{sourceX:C}=e,{sourceY:Y}=e,{targetX:N}=e,{targetY:F}=e,{sourcePosition:G}=e,{targetPosition:K}=e,{ariaLabel:X=void 0}=e,{interactionWidth:Q=void 0}=e,{class:U=""}=e;Ol("svelteflow__edge_id",h);const{edgeLookup:J,edgeTypes:q,flowId:ce,elementsSelectable:ge}=Xt();ae(l,J,fe=>t(44,a=fe)),ae(l,q,fe=>t(40,f=fe)),ae(l,ce,fe=>t(39,u=fe)),ae(l,ge,fe=>t(38,c=fe));const re=cn(),Oe=Da();function x(fe){const lt=a.get(h);lt&&(Oe(h),re("edgeclick",{event:fe,edge:lt}))}function ue(fe,lt){const it=a.get(h);it&&re(lt,{event:fe,edge:it})}const Ee=fe=>{ue(fe,"edgecontextmenu")},Xe=fe=>{ue(fe,"edgemouseenter")},Ke=fe=>{ue(fe,"edgemouseleave")};return l.$$set=fe=>{"id"in fe&&t(0,h=fe.id),"type"in fe&&t(34,d=fe.type),"source"in fe&&t(1,p=fe.source),"target"in fe&&t(2,b=fe.target),"data"in fe&&t(3,v=fe.data),"style"in fe&&t(4,g=fe.style),"zIndex"in fe&&t(5,w=fe.zIndex),"animated"in fe&&t(6,y=fe.animated),"selected"in fe&&t(7,I=fe.selected),"selectable"in fe&&t(35,S=fe.selectable),"deletable"in fe&&t(8,T=fe.deletable),"hidden"in fe&&t(9,E=fe.hidden),"label"in fe&&t(10,H=fe.label),"labelStyle"in fe&&t(11,O=fe.labelStyle),"markerStart"in fe&&t(36,B=fe.markerStart),"markerEnd"in fe&&t(37,j=fe.markerEnd),"sourceHandle"in fe&&t(12,Z=fe.sourceHandle),"targetHandle"in fe&&t(13,R=fe.targetHandle),"sourceX"in fe&&t(14,C=fe.sourceX),"sourceY"in fe&&t(15,Y=fe.sourceY),"targetX"in fe&&t(16,N=fe.targetX),"targetY"in fe&&t(17,F=fe.targetY),"sourcePosition"in fe&&t(18,G=fe.sourcePosition),"targetPosition"in fe&&t(19,K=fe.targetPosition),"ariaLabel"in fe&&t(20,X=fe.ariaLabel),"interactionWidth"in fe&&t(21,Q=fe.interactionWidth),"class"in fe&&t(22,U=fe.class)},l.$$.update=()=>{l.$$.dirty[1]&8&&t(23,n=d||"default"),l.$$.dirty[0]&8388608|l.$$.dirty[1]&512&&t(27,o=f[n]||Ca),l.$$.dirty[1]&288&&t(26,s=B?`url('#${Qo(B,u)}')`:void 0),l.$$.dirty[1]&320&&t(25,i=j?`url('#${Qo(j,u)}')`:void 0),l.$$.dirty[1]&144&&t(24,r=S??c)},[h,p,b,v,g,w,y,I,T,E,H,O,Z,R,C,Y,N,F,G,K,X,Q,U,n,r,i,s,o,J,q,ce,ge,x,ue,d,S,B,j,c,u,f,Ee,Xe,Ke]}class lg extends Re{constructor(e){super(),Ue(this,e,ng,tg,Ui,{id:0,type:34,source:1,target:2,data:3,style:4,zIndex:5,animated:6,selected:7,selectable:35,deletable:8,hidden:9,label:10,labelStyle:11,markerStart:36,markerEnd:37,sourceHandle:12,targetHandle:13,sourceX:14,sourceY:15,targetX:16,targetY:17,sourcePosition:18,targetPosition:19,ariaLabel:20,interactionWidth:21,class:22},null,[-1,-1])}}function og(l,e,t){let{onMount:n=void 0}=e,{onDestroy:o=void 0}=e;return pn(()=>(n==null||n(),o)),l.$$set=s=>{"onMount"in s&&t(0,n=s.onMount),"onDestroy"in s&&t(1,o=s.onDestroy)},[n,o]}class sg extends Re{constructor(e){super(),Ue(this,e,og,null,Fe,{onMount:0,onDestroy:1})}}function Fr(l,e,t){const n=l.slice();return n[2]=e[t],n}function jr(l,e){let t,n,o;const s=[e[2]];let i={};for(let r=0;r<s.length;r+=1)i=Et(i,s[r]);return n=new hg({props:i}),{key:l,first:null,c(){t=Ae(),ne(n.$$.fragment),this.h()},l(r){t=Ae(),se(n.$$.fragment,r),this.h()},h(){this.first=t},m(r,a){A(r,t,a),le(n,r,a),o=!0},p(r,a){e=r;const c=a&1?tl(s,[Bl(e[2])]):{};n.$set(c)},i(r){o||(D(n.$$.fragment,r),o=!0)},o(r){P(n.$$.fragment,r),o=!1},d(r){r&&_(t),oe(n,r)}}}function rg(l){let e,t=[],n=new Map,o,s=vt(l[0]);const i=r=>r[2].id;for(let r=0;r<s.length;r+=1){let a=Fr(l,s,r),c=i(a);n.set(c,t[r]=jr(c,a))}return{c(){e=Ne("defs");for(let r=0;r<t.length;r+=1)t[r].c()},l(r){e=Pe(r,"defs",{});var a=M(e);for(let c=0;c<t.length;c+=1)t[c].l(a);a.forEach(_)},m(r,a){A(r,e,a);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);o=!0},p(r,[a]){a&1&&(s=vt(r[0]),He(),t=bo(t,a,i,1,r,s,n,e,vo,jr,null,Fr),Be())},i(r){if(!o){for(let a=0;a<s.length;a+=1)D(t[a]);o=!0}},o(r){for(let a=0;a<t.length;a+=1)P(t[a]);o=!1},d(r){r&&_(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function ig(l,e,t){let n;const{markers:o}=Xt();return ae(l,o,s=>t(0,n=s)),[n,o]}class ag extends Re{constructor(e){super(),Ue(this,e,ig,rg,Fe,{})}}function cg(l){let e;return{c(){e=Ne("polyline"),this.h()},l(t){e=Pe(t,"polyline",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,fill:!0,points:!0}),M(e).forEach(_),this.h()},h(){m(e,"stroke",l[6]),m(e,"stroke-linecap","round"),m(e,"stroke-linejoin","round"),m(e,"stroke-width",l[7]),m(e,"fill",l[6]),m(e,"points","-5,-4 0,0 -5,4 -5,-4")},m(t,n){A(t,e,n)},p(t,n){n&64&&m(e,"stroke",t[6]),n&128&&m(e,"stroke-width",t[7]),n&64&&m(e,"fill",t[6])},d(t){t&&_(e)}}}function ug(l){let e;return{c(){e=Ne("polyline"),this.h()},l(t){e=Pe(t,"polyline",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,fill:!0,points:!0}),M(e).forEach(_),this.h()},h(){m(e,"stroke",l[6]),m(e,"stroke-linecap","round"),m(e,"stroke-linejoin","round"),m(e,"stroke-width",l[7]),m(e,"fill","none"),m(e,"points","-5,-4 0,0 -5,4")},m(t,n){A(t,e,n)},p(t,n){n&64&&m(e,"stroke",t[6]),n&128&&m(e,"stroke-width",t[7])},d(t){t&&_(e)}}}function fg(l){let e,t,n;function o(r,a){if(r[1]===ho.Arrow)return ug;if(r[1]===ho.ArrowClosed)return cg}let s=o(l),i=s&&s(l);return{c(){e=Ne("marker"),i&&i.c(),this.h()},l(r){e=Pe(r,"marker",{class:!0,id:!0,markerWidth:!0,markerHeight:!0,viewBox:!0,markerUnits:!0,orient:!0,refX:!0,refY:!0});var a=M(e);i&&i.l(a),a.forEach(_),this.h()},h(){m(e,"class","svelte-flow__arrowhead"),m(e,"id",l[0]),m(e,"markerWidth",t=`${l[2]}`),m(e,"markerHeight",n=`${l[3]}`),m(e,"viewBox","-10 -10 20 20"),m(e,"markerUnits",l[4]),m(e,"orient",l[5]),m(e,"refX","0"),m(e,"refY","0")},m(r,a){A(r,e,a),i&&i.m(e,null)},p(r,[a]){s===(s=o(r))&&i?i.p(r,a):(i&&i.d(1),i=s&&s(r),i&&(i.c(),i.m(e,null))),a&1&&m(e,"id",r[0]),a&4&&t!==(t=`${r[2]}`)&&m(e,"markerWidth",t),a&8&&n!==(n=`${r[3]}`)&&m(e,"markerHeight",n),a&16&&m(e,"markerUnits",r[4]),a&32&&m(e,"orient",r[5])},i:we,o:we,d(r){r&&_(e),i&&i.d()}}}function dg(l,e,t){let{id:n}=e,{type:o}=e,{width:s=12.5}=e,{height:i=12.5}=e,{markerUnits:r="strokeWidth"}=e,{orient:a="auto-start-reverse"}=e,{color:c=void 0}=e,{strokeWidth:u=void 0}=e;return l.$$set=f=>{"id"in f&&t(0,n=f.id),"type"in f&&t(1,o=f.type),"width"in f&&t(2,s=f.width),"height"in f&&t(3,i=f.height),"markerUnits"in f&&t(4,r=f.markerUnits),"orient"in f&&t(5,a=f.orient),"color"in f&&t(6,c=f.color),"strokeWidth"in f&&t(7,u=f.strokeWidth)},[n,o,s,i,r,a,c,u]}class hg extends Re{constructor(e){super(),Ue(this,e,dg,fg,Fe,{id:0,type:1,width:2,height:3,markerUnits:4,orient:5,color:6,strokeWidth:7})}}function Yr(l,e,t){const n=l.slice();return n[14]=e[t],n}function Xr(l,e){let t,n,o;return n=new lg({props:{id:e[14].id,source:e[14].source,target:e[14].target,data:e[14].data,style:e[14].style,animated:e[14].animated,selected:e[14].selected,selectable:e[14].selectable??e[1],deletable:e[14].deletable,hidden:e[14].hidden,label:e[14].label,labelStyle:e[14].labelStyle,markerStart:e[14].markerStart,markerEnd:e[14].markerEnd,sourceHandle:e[14].sourceHandle,targetHandle:e[14].targetHandle,sourceX:e[14].sourceX,sourceY:e[14].sourceY,targetX:e[14].targetX,targetY:e[14].targetY,sourcePosition:e[14].sourcePosition,targetPosition:e[14].targetPosition,ariaLabel:e[14].ariaLabel,interactionWidth:e[14].interactionWidth,class:e[14].class,type:e[14].type||"default",zIndex:e[14].zIndex}}),n.$on("edgeclick",e[7]),n.$on("edgecontextmenu",e[8]),n.$on("edgemouseenter",e[9]),n.$on("edgemouseleave",e[10]),{key:l,first:null,c(){t=Ae(),ne(n.$$.fragment),this.h()},l(s){t=Ae(),se(n.$$.fragment,s),this.h()},h(){this.first=t},m(s,i){A(s,t,i),le(n,s,i),o=!0},p(s,i){e=s;const r={};i&1&&(r.id=e[14].id),i&1&&(r.source=e[14].source),i&1&&(r.target=e[14].target),i&1&&(r.data=e[14].data),i&1&&(r.style=e[14].style),i&1&&(r.animated=e[14].animated),i&1&&(r.selected=e[14].selected),i&3&&(r.selectable=e[14].selectable??e[1]),i&1&&(r.deletable=e[14].deletable),i&1&&(r.hidden=e[14].hidden),i&1&&(r.label=e[14].label),i&1&&(r.labelStyle=e[14].labelStyle),i&1&&(r.markerStart=e[14].markerStart),i&1&&(r.markerEnd=e[14].markerEnd),i&1&&(r.sourceHandle=e[14].sourceHandle),i&1&&(r.targetHandle=e[14].targetHandle),i&1&&(r.sourceX=e[14].sourceX),i&1&&(r.sourceY=e[14].sourceY),i&1&&(r.targetX=e[14].targetX),i&1&&(r.targetY=e[14].targetY),i&1&&(r.sourcePosition=e[14].sourcePosition),i&1&&(r.targetPosition=e[14].targetPosition),i&1&&(r.ariaLabel=e[14].ariaLabel),i&1&&(r.interactionWidth=e[14].interactionWidth),i&1&&(r.class=e[14].class),i&1&&(r.type=e[14].type||"default"),i&1&&(r.zIndex=e[14].zIndex),n.$set(r)},i(s){o||(D(n.$$.fragment,s),o=!0)},o(s){P(n.$$.fragment,s),o=!1},d(s){s&&_(t),oe(n,s)}}}function Kr(l){let e,t;return e=new sg({props:{onMount:l[11],onDestroy:l[12]}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o&4&&(s.onMount=n[11]),o&4&&(s.onDestroy=n[12]),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function mg(l){let e,t,n,o,s=[],i=new Map,r,a;n=new ag({});let c=vt(l[0]);const u=h=>h[14].id;for(let h=0;h<c.length;h+=1){let d=Yr(l,c,h),p=u(d);i.set(p,s[h]=Xr(p,d))}let f=l[0].length>0&&Kr(l);return{c(){e=V("div"),t=Ne("svg"),ne(n.$$.fragment),o=ee();for(let h=0;h<s.length;h+=1)s[h].c();r=ee(),f&&f.c(),this.h()},l(h){e=z(h,"DIV",{class:!0});var d=M(e);t=Pe(d,"svg",{class:!0});var p=M(t);se(n.$$.fragment,p),p.forEach(_),o=te(d);for(let b=0;b<s.length;b+=1)s[b].l(d);r=te(d),f&&f.l(d),d.forEach(_),this.h()},h(){m(t,"class","svelte-flow__marker"),m(e,"class","svelte-flow__edges")},m(h,d){A(h,e,d),k(e,t),le(n,t,null),k(e,o);for(let p=0;p<s.length;p+=1)s[p]&&s[p].m(e,null);k(e,r),f&&f.m(e,null),a=!0},p(h,[d]){d&3&&(c=vt(h[0]),He(),s=bo(s,d,u,1,h,c,i,e,vo,Xr,r,Yr),Be()),h[0].length>0?f?(f.p(h,d),d&1&&D(f,1)):(f=Kr(h),f.c(),D(f,1),f.m(e,null)):f&&(He(),P(f,1,1,()=>{f=null}),Be())},i(h){if(!a){D(n.$$.fragment,h);for(let d=0;d<c.length;d+=1)D(s[d]);D(f),a=!0}},o(h){P(n.$$.fragment,h);for(let d=0;d<s.length;d+=1)P(s[d]);P(f),a=!1},d(h){h&&_(e),oe(n);for(let d=0;d<s.length;d+=1)s[d].d();f&&f.d()}}}function gg(l,e,t){let n,o,s,{defaultEdgeOptions:i}=e;const{visibleEdges:r,edgesInitialized:a,edges:{setDefaultOptions:c},elementsSelectable:u}=Xt();ae(l,r,g=>t(0,n=g)),ae(l,a,g=>t(2,s=g)),ae(l,u,g=>t(1,o=g)),pn(()=>{i&&c(i)});function f(g){gt.call(this,l,g)}function h(g){gt.call(this,l,g)}function d(g){gt.call(this,l,g)}function p(g){gt.call(this,l,g)}const b=()=>{io(a,s=!0,s)},v=()=>{io(a,s=!1,s)};return l.$$set=g=>{"defaultEdgeOptions"in g&&t(6,i=g.defaultEdgeOptions)},[n,o,s,r,a,u,i,f,h,d,p,b,v]}class _g extends Re{constructor(e){super(),Ue(this,e,gg,mg,Fe,{defaultEdgeOptions:6})}}function Zr(l){let e;return{c(){e=V("div"),this.h()},l(t){e=z(t,"DIV",{class:!0}),M(e).forEach(_),this.h()},h(){m(e,"class","svelte-flow__selection svelte-1iugwpu"),$e(e,"width",typeof l[2]=="string"?l[2]:`${l[2]}px`),$e(e,"height",typeof l[3]=="string"?l[3]:`${l[3]}px`),$e(e,"transform",`translate(${l[0]}px, ${l[1]}px)`)},m(t,n){A(t,e,n)},p(t,n){n&4&&$e(e,"width",typeof t[2]=="string"?t[2]:`${t[2]}px`),n&8&&$e(e,"height",typeof t[3]=="string"?t[3]:`${t[3]}px`),n&3&&$e(e,"transform",`translate(${t[0]}px, ${t[1]}px)`)},d(t){t&&_(e)}}}function pg(l){let e,t=l[4]&&Zr(l);return{c(){t&&t.c(),e=Ae()},l(n){t&&t.l(n),e=Ae()},m(n,o){t&&t.m(n,o),A(n,e,o)},p(n,[o]){n[4]?t?t.p(n,o):(t=Zr(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:we,o:we,d(n){n&&_(e),t&&t.d(n)}}}function bg(l,e,t){let{x:n=0}=e,{y:o=0}=e,{width:s=0}=e,{height:i=0}=e,{isVisible:r=!0}=e;return l.$$set=a=>{"x"in a&&t(0,n=a.x),"y"in a&&t(1,o=a.y),"width"in a&&t(2,s=a.width),"height"in a&&t(3,i=a.height),"isVisible"in a&&t(4,r=a.isVisible)},[n,o,s,i,r]}class Na extends Re{constructor(e){super(),Ue(this,e,bg,pg,Fe,{x:0,y:1,width:2,height:3,isVisible:4})}}function vg(l){var n,o,s,i;let e,t;return e=new Na({props:{isVisible:!!(l[0]&&l[1]==="user"),width:(n=l[0])==null?void 0:n.width,height:(o=l[0])==null?void 0:o.height,x:(s=l[0])==null?void 0:s.x,y:(i=l[0])==null?void 0:i.y}}),{c(){ne(e.$$.fragment)},l(r){se(e.$$.fragment,r)},m(r,a){le(e,r,a),t=!0},p(r,[a]){var u,f,h,d;const c={};a&3&&(c.isVisible=!!(r[0]&&r[1]==="user")),a&1&&(c.width=(u=r[0])==null?void 0:u.width),a&1&&(c.height=(f=r[0])==null?void 0:f.height),a&1&&(c.x=(h=r[0])==null?void 0:h.x),a&1&&(c.y=(d=r[0])==null?void 0:d.y),e.$set(c)},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){oe(e,r)}}}function wg(l,e,t){let n,o;const{selectionRect:s,selectionRectMode:i}=Xt();return ae(l,s,r=>t(0,n=r)),ae(l,i,r=>t(1,o=r)),[n,o,s,i]}class yg extends Re{constructor(e){super(),Ue(this,e,wg,vg,Fe,{})}}function Gr(l){let e,t,n,o,s;return t=new Na({props:{width:"100%",height:"100%",x:0,y:0}}),{c(){e=V("div"),ne(t.$$.fragment),this.h()},l(i){e=z(i,"DIV",{class:!0,style:!0,role:!0,tabindex:!0});var r=M(e);se(t.$$.fragment,r),r.forEach(_),this.h()},h(){m(e,"class","selection-wrapper nopan svelte-5pxri"),$e(e,"width",l[1].width+"px"),$e(e,"height",l[1].height+"px"),$e(e,"transform","translate("+l[1].x+"px, "+l[1].y+"px)"),m(e,"role","button"),m(e,"tabindex","-1")},m(i,r){A(i,e,r),le(t,e,null),n=!0,o||(s=[gn(za.call(null,e,{disabled:!1,store:l[2],onDrag:l[11],onDragStart:l[12],onDragStop:l[13]})),ke(e,"contextmenu",l[7]),ke(e,"click",l[8]),ke(e,"keyup",Eg)],o=!0)},p(i,r){(!n||r&2)&&$e(e,"width",i[1].width+"px"),(!n||r&2)&&$e(e,"height",i[1].height+"px"),(!n||r&2)&&$e(e,"transform","translate("+i[1].x+"px, "+i[1].y+"px)")},i(i){n||(D(t.$$.fragment,i),n=!0)},o(i){P(t.$$.fragment,i),n=!1},d(i){i&&_(e),oe(t),o=!1,on(s)}}}function kg(l){let e=l[0]==="nodes"&&l[1]&&Hn(l[1].x)&&Hn(l[1].y),t,n,o=e&&Gr(l);return{c(){o&&o.c(),t=Ae()},l(s){o&&o.l(s),t=Ae()},m(s,i){o&&o.m(s,i),A(s,t,i),n=!0},p(s,[i]){i&3&&(e=s[0]==="nodes"&&s[1]&&Hn(s[1].x)&&Hn(s[1].y)),e?o?(o.p(s,i),i&3&&D(o,1)):(o=Gr(s),o.c(),D(o,1),o.m(t.parentNode,t)):o&&(He(),P(o,1,1,()=>{o=null}),Be())},i(s){n||(D(o),n=!0)},o(s){P(o),n=!1},d(s){s&&_(t),o&&o.d(s)}}}const Eg=()=>{};function Ig(l,e,t){let n,o,s;const i=Xt(),{selectionRectMode:r,nodes:a,nodeLookup:c}=i;ae(l,r,g=>t(0,s=g)),ae(l,a,g=>t(9,n=g)),ae(l,c,g=>t(10,o=g));const u=cn();let f=null;function h(g){const w=n.filter(y=>y.selected);u("selectioncontextmenu",{nodes:w,event:g})}function d(g){const w=n.filter(y=>y.selected);u("selectionclick",{nodes:w,event:g})}const p=(g,w,y,I)=>{u("nodedrag",{event:g,targetNode:null,nodes:I})},b=(g,w,y,I)=>{u("nodedragstart",{event:g,targetNode:null,nodes:I})},v=(g,w,y,I)=>{u("nodedragstop",{event:g,targetNode:null,nodes:I})};return l.$$.update=()=>{l.$$.dirty&1537&&s==="nodes"&&t(1,f=Co(o,{filter:g=>!!g.selected}))},[s,f,i,r,a,c,u,h,d,n,o,p,b,v]}class Sg extends Re{constructor(e){super(),Ue(this,e,Ig,kg,Fe,{})}}function Un(l,e){let{enabled:t=!0,trigger:n,type:o="keydown"}=e;function s(i){const r=Array.isArray(n)?n:[n],a={alt:i.altKey,ctrl:i.ctrlKey,shift:i.shiftKey,meta:i.metaKey};for(const c of r){const u={modifier:[],preventDefault:!1,enabled:!0,...c},{modifier:f,key:h,callback:d,preventDefault:p,enabled:b}=u;if(b){if(f.length&&!(Array.isArray(f)?f:[f]).map(w=>typeof w=="string"?[w]:w).some(w=>w.every(y=>a[y])))continue;if(i.key===h){p&&i.preventDefault();const v={node:l,trigger:u,originalEvent:i};l.dispatchEvent(new CustomEvent("shortcut",{detail:v})),d==null||d(v)}}}}return t&&l.addEventListener(o,s),{update:i=>{const{enabled:r=!0,type:a="keydown"}=i;t&&(!r||o!==a)?l.removeEventListener(o,s):!t&&r&&l.addEventListener(a,s),t=r,o=a,n=i.trigger},destroy:()=>{l.removeEventListener(o,s)}}}function Dg(l){let e,t,n,o,s,i,r,a,c,u,f,h;return{c:we,l:we,m(d,p){f||(h=[gn(e=Un.call(null,window,{trigger:qt(l[0],l[11]),type:"keydown"})),gn(t=Un.call(null,window,{trigger:qt(l[0],l[12]),type:"keyup"})),gn(n=Un.call(null,window,{trigger:qt(l[1],l[13]),type:"keydown"})),gn(o=Un.call(null,window,{trigger:qt(l[1],l[14]),type:"keyup"})),gn(s=Un.call(null,window,{trigger:qt(l[2],l[15]),type:"keydown"})),gn(i=Un.call(null,window,{trigger:qt(l[2],l[16]),type:"keyup"})),gn(r=Un.call(null,window,{trigger:qt(l[3],l[17]),type:"keydown"})),gn(a=Un.call(null,window,{trigger:qt(l[3],l[18]),type:"keyup"})),gn(c=Un.call(null,window,{trigger:qt(l[4],l[19]),type:"keydown"})),gn(u=Un.call(null,window,{trigger:qt(l[4],l[20]),type:"keyup"})),ke(window,"blur",l[10]),ke(window,"contextmenu",l[10])],f=!0)},p(d,[p]){e&&ln(e.update)&&p&1&&e.update.call(null,{trigger:qt(d[0],d[11]),type:"keydown"}),t&&ln(t.update)&&p&1&&t.update.call(null,{trigger:qt(d[0],d[12]),type:"keyup"}),n&&ln(n.update)&&p&2&&n.update.call(null,{trigger:qt(d[1],d[13]),type:"keydown"}),o&&ln(o.update)&&p&2&&o.update.call(null,{trigger:qt(d[1],d[14]),type:"keyup"}),s&&ln(s.update)&&p&4&&s.update.call(null,{trigger:qt(d[2],d[15]),type:"keydown"}),i&&ln(i.update)&&p&4&&i.update.call(null,{trigger:qt(d[2],d[16]),type:"keyup"}),r&&ln(r.update)&&p&8&&r.update.call(null,{trigger:qt(d[3],d[17]),type:"keydown"}),a&&ln(a.update)&&p&8&&a.update.call(null,{trigger:qt(d[3],d[18]),type:"keyup"}),c&&ln(c.update)&&p&16&&c.update.call(null,{trigger:qt(d[4],d[19]),type:"keydown"}),u&&ln(u.update)&&p&16&&u.update.call(null,{trigger:qt(d[4],d[20]),type:"keyup"})},i:we,o:we,d(d){f=!1,on(h)}}}function Pa(l){return l!==null&&typeof l=="object"}function Cg(l){return Pa(l)?l.modifier||[]:[]}function Mg(l){return l==null?"":Pa(l)?l.key:l}function qt(l,e){return(Array.isArray(l)?l:[l]).map(n=>{const o=Mg(n);return{key:o,modifier:Cg(n),enabled:o!==null,callback:e}})}function Tg(l,e,t){let{selectionKey:n="Shift"}=e,{multiSelectionKey:o=go()?"Meta":"Control"}=e,{deleteKey:s="Backspace"}=e,{panActivationKey:i=" "}=e,{zoomActivationKey:r=go()?"Meta":"Control"}=e;const{selectionKeyPressed:a,multiselectionKeyPressed:c,deleteKeyPressed:u,panActivationKeyPressed:f,zoomActivationKeyPressed:h,selectionRect:d}=Xt();function p(){d.set(null),a.set(!1),c.set(!1),u.set(!1),f.set(!1),h.set(!1)}const b=()=>a.set(!0),v=()=>a.set(!1),g=()=>c.set(!0),w=()=>c.set(!1),y=O=>{!(O.originalEvent.ctrlKey||O.originalEvent.metaKey||O.originalEvent.shiftKey)&&!dh(O.originalEvent)&&u.set(!0)},I=()=>u.set(!1),S=()=>f.set(!0),T=()=>f.set(!1),E=()=>h.set(!0),H=()=>h.set(!1);return l.$$set=O=>{"selectionKey"in O&&t(0,n=O.selectionKey),"multiSelectionKey"in O&&t(1,o=O.multiSelectionKey),"deleteKey"in O&&t(2,s=O.deleteKey),"panActivationKey"in O&&t(3,i=O.panActivationKey),"zoomActivationKey"in O&&t(4,r=O.zoomActivationKey)},[n,o,s,i,r,a,c,u,f,h,p,b,v,g,w,y,I,S,T,E,H]}class Vg extends Re{constructor(e){super(),Ue(this,e,Tg,Dg,Fe,{selectionKey:0,multiSelectionKey:1,deleteKey:2,panActivationKey:3,zoomActivationKey:4})}}const zg=l=>({}),qr=l=>({});function Jr(l){let e,t,n,o;const s=l[13].connectionLine,i=Qt(s,l,l[12],qr);let r=!l[2]&&Qr(l);return{c(){e=Ne("svg"),t=Ne("g"),i&&i.c(),r&&r.c(),this.h()},l(a){e=Pe(a,"svg",{width:!0,height:!0,class:!0,style:!0});var c=M(e);t=Pe(c,"g",{class:!0});var u=M(t);i&&i.l(u),r&&r.l(u),u.forEach(_),c.forEach(_),this.h()},h(){m(t,"class",n=Ot(["svelte-flow__connection",wr(l[3].isValid)])),m(e,"width",l[5]),m(e,"height",l[6]),m(e,"class","svelte-flow__connectionline"),m(e,"style",l[0])},m(a,c){A(a,e,c),k(e,t),i&&i.m(t,null),r&&r.m(t,null),o=!0},p(a,c){i&&i.p&&(!o||c&4096)&&xt(i,s,a,a[12],o?en(s,a[12],c,zg):$t(a[12]),qr),a[2]?r&&(r.d(1),r=null):r?r.p(a,c):(r=Qr(a),r.c(),r.m(t,null)),(!o||c&8&&n!==(n=Ot(["svelte-flow__connection",wr(a[3].isValid)])))&&m(t,"class",n),(!o||c&32)&&m(e,"width",a[5]),(!o||c&64)&&m(e,"height",a[6]),(!o||c&1)&&m(e,"style",a[0])},i(a){o||(D(i,a),o=!0)},o(a){P(i,a),o=!1},d(a){a&&_(e),i&&i.d(a),r&&r.d()}}}function Qr(l){let e;return{c(){e=Ne("path"),this.h()},l(t){e=Pe(t,"path",{d:!0,style:!0,fill:!0,class:!0}),M(e).forEach(_),this.h()},h(){m(e,"d",l[4]),m(e,"style",l[1]),m(e,"fill","none"),m(e,"class","svelte-flow__connection-path")},m(t,n){A(t,e,n)},p(t,n){n&16&&m(e,"d",t[4]),n&2&&m(e,"style",t[1])},d(t){t&&_(e)}}}function Ng(l){let e,t,n=l[3].inProgress&&Jr(l);return{c(){n&&n.c(),e=Ae()},l(o){n&&n.l(o),e=Ae()},m(o,s){n&&n.m(o,s),A(o,e,s),t=!0},p(o,[s]){o[3].inProgress?n?(n.p(o,s),s&8&&D(n,1)):(n=Jr(o),n.c(),D(n,1),n.m(e.parentNode,e)):n&&(He(),P(n,1,1,()=>{n=null}),Be())},i(o){t||(D(n),t=!0)},o(o){P(n),t=!1},d(o){o&&_(e),n&&n.d(o)}}}function Pg(l,e,t){let n,o,s,i,{$$slots:r={},$$scope:a}=e,{containerStyle:c=""}=e,{style:u=""}=e,{isCustomComponent:f=!1}=e;const{width:h,height:d,connection:p,connectionLineType:b}=Xt();ae(l,h,g=>t(5,s=g)),ae(l,d,g=>t(6,i=g)),ae(l,p,g=>t(3,o=g)),ae(l,b,g=>t(11,n=g));let v=null;return l.$$set=g=>{"containerStyle"in g&&t(0,c=g.containerStyle),"style"in g&&t(1,u=g.style),"isCustomComponent"in g&&t(2,f=g.isCustomComponent),"$$scope"in g&&t(12,a=g.$$scope)},l.$$.update=()=>{if(l.$$.dirty&2060&&o.inProgress&&!f){const{from:g,to:w,fromPosition:y,toPosition:I}=o,S={sourceX:g.x,sourceY:g.y,sourcePosition:y,targetX:w.x,targetY:w.y,targetPosition:I};switch(n){case El.Bezier:t(4,[v]=ca(S),v);break;case El.Step:t(4,[v]=_o({...S,borderRadius:0}),v);break;case El.SmoothStep:t(4,[v]=_o(S),v);break;default:t(4,[v]=fa(S),v)}}},[c,u,f,o,v,s,i,h,d,p,b,n,a,r]}class Og extends Re{constructor(e){super(),Ue(this,e,Pg,Ng,Fe,{containerStyle:0,style:1,isCustomComponent:2})}}function Hg(l){let e,t,n;const o=l[8].default,s=Qt(o,l,l[7],null);let i=[{class:t=Ot(["svelte-flow__panel",l[1],...l[2]])},{style:l[0]},l[5]],r={};for(let a=0;a<i.length;a+=1)r=Et(r,i[a]);return{c(){e=V("div"),s&&s.c(),this.h()},l(a){e=z(a,"DIV",{class:!0,style:!0});var c=M(e);s&&s.l(c),c.forEach(_),this.h()},h(){Il(e,r),$e(e,"pointer-events",l[3]?"none":"")},m(a,c){A(a,e,c),s&&s.m(e,null),n=!0},p(a,[c]){s&&s.p&&(!n||c&128)&&xt(s,o,a,a[7],n?en(o,a[7],c,null):$t(a[7]),null),Il(e,r=tl(i,[(!n||c&6&&t!==(t=Ot(["svelte-flow__panel",a[1],...a[2]])))&&{class:t},(!n||c&1)&&{style:a[0]},c&32&&a[5]])),$e(e,"pointer-events",a[3]?"none":"")},i(a){n||(D(s,a),n=!0)},o(a){P(s,a),n=!1},d(a){a&&_(e),s&&s.d(a)}}}function Bg(l,e,t){let n;const o=["position","style","class"];let s=Yt(e,o),i,{$$slots:r={},$$scope:a}=e,{position:c="top-right"}=e,{style:u=void 0}=e,{class:f=void 0}=e;const{selectionRectMode:h}=Xt();return ae(l,h,d=>t(3,i=d)),l.$$set=d=>{e=Et(Et({},e),Bn(d)),t(5,s=Yt(e,o)),"position"in d&&t(6,c=d.position),"style"in d&&t(0,u=d.style),"class"in d&&t(1,f=d.class),"$$scope"in d&&t(7,a=d.$$scope)},l.$$.update=()=>{l.$$.dirty&64&&t(2,n=`${c}`.split("-"))},[u,f,n,i,h,s,c,a,r]}class Oa extends Re{constructor(e){super(),Ue(this,e,Bg,Hg,Fe,{position:6,style:0,class:1})}}function xr(l){let e,t;return e=new Oa({props:{position:l[1],class:"svelte-flow__attribution","data-message":"Feel free to remove the attribution or check out how you could support us: https://svelteflow.dev/support-us",$$slots:{default:[Ag]},$$scope:{ctx:l}}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o&2&&(s.position=n[1]),o&4&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function Ag(l){let e,t="Svelte Flow";return{c(){e=V("a"),e.textContent=t,this.h()},l(n){e=z(n,"A",{href:!0,target:!0,rel:!0,"aria-label":!0,"data-svelte-h":!0}),ut(e)!=="svelte-2vm8e4"&&(e.textContent=t),this.h()},h(){m(e,"href","https://svelteflow.dev"),m(e,"target","_blank"),m(e,"rel","noopener noreferrer"),m(e,"aria-label","Svelte Flow attribution")},m(n,o){A(n,e,o)},p:we,d(n){n&&_(e)}}}function Lg(l){var o;let e,t,n=!((o=l[0])!=null&&o.hideAttribution)&&xr(l);return{c(){n&&n.c(),e=Ae()},l(s){n&&n.l(s),e=Ae()},m(s,i){n&&n.m(s,i),A(s,e,i),t=!0},p(s,[i]){var r;(r=s[0])!=null&&r.hideAttribution?n&&(He(),P(n,1,1,()=>{n=null}),Be()):n?(n.p(s,i),i&1&&D(n,1)):(n=xr(s),n.c(),D(n,1),n.m(e.parentNode,e))},i(s){t||(D(n),t=!0)},o(s){P(n),t=!1},d(s){s&&_(e),n&&n.d(s)}}}function Rg(l,e,t){let{proOptions:n=void 0}=e,{position:o="bottom-right"}=e;return l.$$set=s=>{"proOptions"in s&&t(0,n=s.proOptions),"position"in s&&t(1,o=s.position)},[n,o]}class Ug extends Re{constructor(e){super(),Ue(this,e,Rg,Lg,Fe,{proOptions:0,position:1})}}function $r(l,{nodeTypes:e,edgeTypes:t,minZoom:n,maxZoom:o,translateExtent:s,paneClickDistance:i}){e!==void 0&&l.setNodeTypes(e),t!==void 0&&l.setEdgeTypes(t),n!==void 0&&l.setMinZoom(n),o!==void 0&&l.setMaxZoom(o),s!==void 0&&l.setTranslateExtent(s),i!==void 0&&l.setPaneClickDistance(i)}const Wg=l=>Object.keys(l);function Fg(l,e){Wg(e).forEach(t=>{const n=e[t];n!==void 0&&l[t].set(n)})}function jg(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function Yg(l="light"){return Pn("light",t=>{if(l!=="system"){t(l);return}const n=jg(),o=()=>t(n!=null&&n.matches?"dark":"light");return t(n!=null&&n.matches?"dark":"light"),n==null||n.addEventListener("change",o),()=>{n==null||n.removeEventListener("change",o)}})}const Xg=l=>({}),ei=l=>({slot:"connectionLine"});function Kg(l){let e;const t=l[75].connectionLine,n=Qt(t,l,l[99],ei);return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s[3]&64)&&xt(n,t,o,o[99],e?en(t,o[99],s,Xg):$t(o[99]),ei)},i(o){e||(D(n,o),e=!0)},o(o){P(n,o),e=!1},d(o){n&&n.d(o)}}}function Zg(l){let e,t,n,o,s,i,r,a,c,u,f,h;return e=new _g({props:{defaultEdgeOptions:l[21]}}),e.$on("edgeclick",l[78]),e.$on("edgecontextmenu",l[79]),e.$on("edgemouseenter",l[80]),e.$on("edgemouseleave",l[81]),n=new Og({props:{containerStyle:l[7],style:l[6],isCustomComponent:l[34].connectionLine,$$slots:{connectionLine:[Kg]},$$scope:{ctx:l}}}),c=new eg({props:{nodeClickDistance:l[23]}}),c.$on("nodeclick",l[82]),c.$on("nodemouseenter",l[83]),c.$on("nodemousemove",l[84]),c.$on("nodemouseleave",l[85]),c.$on("nodedragstart",l[86]),c.$on("nodedrag",l[87]),c.$on("nodedragstop",l[88]),c.$on("nodecontextmenu",l[89]),f=new Sg({}),f.$on("selectionclick",l[90]),f.$on("selectioncontextmenu",l[91]),f.$on("nodedragstart",l[92]),f.$on("nodedrag",l[93]),f.$on("nodedragstop",l[94]),{c(){ne(e.$$.fragment),t=ee(),ne(n.$$.fragment),o=ee(),s=V("div"),i=ee(),r=V("div"),a=ee(),ne(c.$$.fragment),u=ee(),ne(f.$$.fragment),this.h()},l(d){se(e.$$.fragment,d),t=te(d),se(n.$$.fragment,d),o=te(d),s=z(d,"DIV",{class:!0}),M(s).forEach(_),i=te(d),r=z(d,"DIV",{class:!0}),M(r).forEach(_),a=te(d),se(c.$$.fragment,d),u=te(d),se(f.$$.fragment,d),this.h()},h(){m(s,"class","svelte-flow__edgelabel-renderer"),m(r,"class","svelte-flow__viewport-portal")},m(d,p){le(e,d,p),A(d,t,p),le(n,d,p),A(d,o,p),A(d,s,p),A(d,i,p),A(d,r,p),A(d,a,p),le(c,d,p),A(d,u,p),le(f,d,p),h=!0},p(d,p){const b={};p[0]&2097152&&(b.defaultEdgeOptions=d[21]),e.$set(b);const v={};p[0]&128&&(v.containerStyle=d[7]),p[0]&64&&(v.style=d[6]),p[1]&8&&(v.isCustomComponent=d[34].connectionLine),p[3]&64&&(v.$$scope={dirty:p,ctx:d}),n.$set(v);const g={};p[0]&8388608&&(g.nodeClickDistance=d[23]),c.$set(g)},i(d){h||(D(e.$$.fragment,d),D(n.$$.fragment,d),D(c.$$.fragment,d),D(f.$$.fragment,d),h=!0)},o(d){P(e.$$.fragment,d),P(n.$$.fragment,d),P(c.$$.fragment,d),P(f.$$.fragment,d),h=!1},d(d){d&&(_(t),_(o),_(s),_(i),_(r),_(a),_(u)),oe(e,d),oe(n,d),oe(c,d),oe(f,d)}}}function Gg(l){let e,t,n,o;return e=new Km({props:{$$slots:{default:[Zg]},$$scope:{ctx:l}}}),n=new yg({}),{c(){ne(e.$$.fragment),t=ee(),ne(n.$$.fragment)},l(s){se(e.$$.fragment,s),t=te(s),se(n.$$.fragment,s)},m(s,i){le(e,s,i),A(s,t,i),le(n,s,i),o=!0},p(s,i){const r={};i[0]&10485952|i[1]&8|i[3]&64&&(r.$$scope={dirty:i,ctx:s}),e.$set(r)},i(s){o||(D(e.$$.fragment,s),D(n.$$.fragment,s),o=!0)},o(s){P(e.$$.fragment,s),P(n.$$.fragment,s),o=!1},d(s){s&&_(t),oe(e,s),oe(n,s)}}}function qg(l){let e,t;return e=new jm({props:{panOnDrag:l[17]===void 0?!0:l[17],selectionOnDrag:l[18],$$slots:{default:[Gg]},$$scope:{ctx:l}}}),e.$on("paneclick",l[95]),e.$on("panecontextmenu",l[96]),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o[0]&131072&&(s.panOnDrag=n[17]===void 0?!0:n[17]),o[0]&262144&&(s.selectionOnDrag=n[18]),o[0]&10485952|o[1]&8|o[3]&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function Jg(l){let e,t,n,o,s,i,r,a,c,u,f,h;t=new Vg({props:{selectionKey:l[1],deleteKey:l[5],panActivationKey:l[2],multiSelectionKey:l[3],zoomActivationKey:l[4]}}),o=new Um({props:{initialViewport:l[31],onMoveStart:l[8],onMove:l[9],onMoveEnd:l[10],panOnScrollMode:l[11]===void 0?jn.Free:l[11],preventScrolling:l[12]===void 0?!0:l[12],zoomOnScroll:l[13]===void 0?!0:l[13],zoomOnDoubleClick:l[14]===void 0?!0:l[14],zoomOnPinch:l[15]===void 0?!0:l[15],panOnScroll:l[16]===void 0?!1:l[16],panOnDrag:l[17]===void 0?!0:l[17],paneClickDistance:l[22]===void 0?0:l[22],$$slots:{default:[qg]},$$scope:{ctx:l}}}),i=new Ug({props:{proOptions:l[20],position:l[19]}});const d=l[75].default,p=Qt(d,l,l[99],null);let b=[{style:l[24]},{class:a=Ot(["svelte-flow",l[25],l[30]])},{"data-testid":"svelte-flow__wrapper"},l[33],{role:"application"}],v={};for(let g=0;g<b.length;g+=1)v=Et(v,b[g]);return{c(){e=V("div"),ne(t.$$.fragment),n=ee(),ne(o.$$.fragment),s=ee(),ne(i.$$.fragment),r=ee(),p&&p.c(),this.h()},l(g){e=z(g,"DIV",{style:!0,class:!0,"data-testid":!0,role:!0});var w=M(e);se(t.$$.fragment,w),n=te(w),se(o.$$.fragment,w),s=te(w),se(i.$$.fragment,w),r=te(w),p&&p.l(w),w.forEach(_),this.h()},h(){Il(e,v),el(()=>l[98].call(e)),st(e,"svelte-12wlba6",!0)},m(g,w){A(g,e,w),le(t,e,null),k(e,n),le(o,e,null),k(e,s),le(i,e,null),k(e,r),p&&p.m(e,null),l[97](e),c=Ua(e,l[98].bind(e)),u=!0,f||(h=[ke(e,"dragover",l[76]),ke(e,"drop",l[77])],f=!0)},p(g,w){const y={};w[0]&2&&(y.selectionKey=g[1]),w[0]&32&&(y.deleteKey=g[5]),w[0]&4&&(y.panActivationKey=g[2]),w[0]&8&&(y.multiSelectionKey=g[3]),w[0]&16&&(y.zoomActivationKey=g[4]),t.$set(y);const I={};w[0]&256&&(I.onMoveStart=g[8]),w[0]&512&&(I.onMove=g[9]),w[0]&1024&&(I.onMoveEnd=g[10]),w[0]&2048&&(I.panOnScrollMode=g[11]===void 0?jn.Free:g[11]),w[0]&4096&&(I.preventScrolling=g[12]===void 0?!0:g[12]),w[0]&8192&&(I.zoomOnScroll=g[13]===void 0?!0:g[13]),w[0]&16384&&(I.zoomOnDoubleClick=g[14]===void 0?!0:g[14]),w[0]&32768&&(I.zoomOnPinch=g[15]===void 0?!0:g[15]),w[0]&65536&&(I.panOnScroll=g[16]===void 0?!1:g[16]),w[0]&131072&&(I.panOnDrag=g[17]===void 0?!0:g[17]),w[0]&4194304&&(I.paneClickDistance=g[22]===void 0?0:g[22]),w[0]&10879168|w[1]&8|w[3]&64&&(I.$$scope={dirty:w,ctx:g}),o.$set(I);const S={};w[0]&1048576&&(S.proOptions=g[20]),w[0]&524288&&(S.position=g[19]),i.$set(S),p&&p.p&&(!u||w[3]&64)&&xt(p,d,g,g[99],u?en(d,g[99],w,null):$t(g[99]),null),Il(e,v=tl(b,[(!u||w[0]&16777216)&&{style:g[24]},(!u||w[0]&1107296256&&a!==(a=Ot(["svelte-flow",g[25],g[30]])))&&{class:a},{"data-testid":"svelte-flow__wrapper"},w[1]&4&&g[33],{role:"application"}])),st(e,"svelte-12wlba6",!0)},i(g){u||(D(t.$$.fragment,g),D(o.$$.fragment,g),D(i.$$.fragment,g),D(p,g),u=!0)},o(g){P(t.$$.fragment,g),P(o.$$.fragment,g),P(i.$$.fragment,g),P(p,g),u=!1},d(g){g&&_(e),oe(t),oe(o),oe(i),p&&p.d(g),l[97](null),c(),f=!1,on(h)}}}function Qg(l,e,t){let n;const o=["id","nodes","edges","fitView","fitViewOptions","minZoom","maxZoom","initialViewport","viewport","nodeTypes","edgeTypes","selectionKey","selectionMode","panActivationKey","multiSelectionKey","zoomActivationKey","nodesDraggable","nodesConnectable","nodeDragThreshold","elementsSelectable","snapGrid","deleteKey","connectionRadius","connectionLineType","connectionMode","connectionLineStyle","connectionLineContainerStyle","onMoveStart","onMove","onMoveEnd","isValidConnection","translateExtent","nodeExtent","onlyRenderVisibleElements","panOnScrollMode","preventScrolling","zoomOnScroll","zoomOnDoubleClick","zoomOnPinch","panOnScroll","panOnDrag","selectionOnDrag","autoPanOnConnect","autoPanOnNodeDrag","onerror","ondelete","onedgecreate","attributionPosition","proOptions","defaultEdgeOptions","width","height","colorMode","onconnect","onconnectstart","onconnectend","onbeforedelete","oninit","nodeOrigin","paneClickDistance","nodeClickDistance","defaultMarkerColor","style","class"];let s=Yt(e,o),i,r,a=we,c=()=>(a(),a=us(H,$=>t(100,r=$)),H),u,f=we,h=()=>(f(),f=us(n,$=>t(30,u=$)),n);l.$$.on_destroy.push(()=>a()),l.$$.on_destroy.push(()=>f());let{$$slots:d={},$$scope:p}=e;const b=Wa(d);let{id:v="1"}=e,{nodes:g}=e,{edges:w}=e,{fitView:y=void 0}=e,{fitViewOptions:I=void 0}=e,{minZoom:S=void 0}=e,{maxZoom:T=void 0}=e,{initialViewport:E=void 0}=e,{viewport:H=void 0}=e;c();let{nodeTypes:O=void 0}=e,{edgeTypes:B=void 0}=e,{selectionKey:j=void 0}=e,{selectionMode:Z=void 0}=e,{panActivationKey:R=void 0}=e,{multiSelectionKey:C=void 0}=e,{zoomActivationKey:Y=void 0}=e,{nodesDraggable:N=void 0}=e,{nodesConnectable:F=void 0}=e,{nodeDragThreshold:G=void 0}=e,{elementsSelectable:K=void 0}=e,{snapGrid:X=void 0}=e,{deleteKey:Q=void 0}=e,{connectionRadius:U=void 0}=e,{connectionLineType:J=void 0}=e,{connectionMode:q=fl.Strict}=e,{connectionLineStyle:ce=""}=e,{connectionLineContainerStyle:ge=""}=e,{onMoveStart:re=void 0}=e,{onMove:Oe=void 0}=e,{onMoveEnd:x=void 0}=e,{isValidConnection:ue=void 0}=e,{translateExtent:Ee=void 0}=e,{nodeExtent:Xe=void 0}=e,{onlyRenderVisibleElements:Ke=void 0}=e,{panOnScrollMode:fe=jn.Free}=e,{preventScrolling:lt=!0}=e,{zoomOnScroll:it=!0}=e,{zoomOnDoubleClick:Nt=!0}=e,{zoomOnPinch:Dt=!0}=e,{panOnScroll:Ht=!1}=e,{panOnDrag:wt=!0}=e,{selectionOnDrag:Ut=void 0}=e,{autoPanOnConnect:pe=!0}=e,{autoPanOnNodeDrag:Ye=!0}=e,{onerror:ot=void 0}=e,{ondelete:he=void 0}=e,{onedgecreate:yt=void 0}=e,{attributionPosition:ht=void 0}=e,{proOptions:bt=void 0}=e,{defaultEdgeOptions:Ce=void 0}=e,{width:Pt=void 0}=e,{height:mt=void 0}=e,{colorMode:de="light"}=e,{onconnect:De=void 0}=e,{onconnectstart:Ve=void 0}=e,{onconnectend:Ge=void 0}=e,{onbeforedelete:It=void 0}=e,{oninit:kt=void 0}=e,{nodeOrigin:Mt=void 0}=e,{paneClickDistance:Tt=0}=e,{nodeClickDistance:sn=0}=e,{defaultMarkerColor:Bt="#b1b1b7"}=e,{style:At=void 0}=e,{class:Kt=void 0}=e,Gt,tn,rn;const Wt=r||E,_t=Fa(No)?Xt():Bm({nodes:me(g),edges:me(w),width:Pt,height:mt,fitView:y,nodeOrigin:Mt,nodeExtent:Xe});pn(()=>(_t.width.set(tn),_t.height.set(rn),_t.domNode.set(Gt),_t.syncNodeStores(g),_t.syncEdgeStores(w),_t.syncViewport(H),y!==void 0&&_t.fitViewOnInit.set(y),I&&_t.fitViewOptions.set(I),$r(_t,{nodeTypes:O,edgeTypes:B,minZoom:S,maxZoom:T,translateExtent:Ee,paneClickDistance:Tt}),()=>{_t.reset()}));const{initialized:W}=_t;ae(l,W,$=>t(74,i=$));let Me=!1;function Ze($){gt.call(this,l,$)}function tt($){gt.call(this,l,$)}function je($){gt.call(this,l,$)}function at($){gt.call(this,l,$)}function Jt($){gt.call(this,l,$)}function Cn($){gt.call(this,l,$)}function dt($){gt.call(this,l,$)}function Ct($){gt.call(this,l,$)}function bn($){gt.call(this,l,$)}function kn($){gt.call(this,l,$)}function Mn($){gt.call(this,l,$)}function ll($){gt.call(this,l,$)}function Tn($){gt.call(this,l,$)}function hl($){gt.call(this,l,$)}function ol($){gt.call(this,l,$)}function En($){gt.call(this,l,$)}function An($){gt.call(this,l,$)}function Yn($){gt.call(this,l,$)}function xn($){gt.call(this,l,$)}function sl($){gt.call(this,l,$)}function Vn($){gt.call(this,l,$)}function ml($){We[$?"unshift":"push"](()=>{Gt=$,t(28,Gt)})}function rl(){tn=this.clientWidth,rn=this.clientHeight,t(26,tn),t(27,rn)}return l.$$set=$=>{e=Et(Et({},e),Bn($)),t(33,s=Yt(e,o)),"id"in $&&t(35,v=$.id),"nodes"in $&&t(36,g=$.nodes),"edges"in $&&t(37,w=$.edges),"fitView"in $&&t(38,y=$.fitView),"fitViewOptions"in $&&t(39,I=$.fitViewOptions),"minZoom"in $&&t(40,S=$.minZoom),"maxZoom"in $&&t(41,T=$.maxZoom),"initialViewport"in $&&t(42,E=$.initialViewport),"viewport"in $&&c(t(0,H=$.viewport)),"nodeTypes"in $&&t(43,O=$.nodeTypes),"edgeTypes"in $&&t(44,B=$.edgeTypes),"selectionKey"in $&&t(1,j=$.selectionKey),"selectionMode"in $&&t(45,Z=$.selectionMode),"panActivationKey"in $&&t(2,R=$.panActivationKey),"multiSelectionKey"in $&&t(3,C=$.multiSelectionKey),"zoomActivationKey"in $&&t(4,Y=$.zoomActivationKey),"nodesDraggable"in $&&t(46,N=$.nodesDraggable),"nodesConnectable"in $&&t(47,F=$.nodesConnectable),"nodeDragThreshold"in $&&t(48,G=$.nodeDragThreshold),"elementsSelectable"in $&&t(49,K=$.elementsSelectable),"snapGrid"in $&&t(50,X=$.snapGrid),"deleteKey"in $&&t(5,Q=$.deleteKey),"connectionRadius"in $&&t(51,U=$.connectionRadius),"connectionLineType"in $&&t(52,J=$.connectionLineType),"connectionMode"in $&&t(53,q=$.connectionMode),"connectionLineStyle"in $&&t(6,ce=$.connectionLineStyle),"connectionLineContainerStyle"in $&&t(7,ge=$.connectionLineContainerStyle),"onMoveStart"in $&&t(8,re=$.onMoveStart),"onMove"in $&&t(9,Oe=$.onMove),"onMoveEnd"in $&&t(10,x=$.onMoveEnd),"isValidConnection"in $&&t(54,ue=$.isValidConnection),"translateExtent"in $&&t(55,Ee=$.translateExtent),"nodeExtent"in $&&t(56,Xe=$.nodeExtent),"onlyRenderVisibleElements"in $&&t(57,Ke=$.onlyRenderVisibleElements),"panOnScrollMode"in $&&t(11,fe=$.panOnScrollMode),"preventScrolling"in $&&t(12,lt=$.preventScrolling),"zoomOnScroll"in $&&t(13,it=$.zoomOnScroll),"zoomOnDoubleClick"in $&&t(14,Nt=$.zoomOnDoubleClick),"zoomOnPinch"in $&&t(15,Dt=$.zoomOnPinch),"panOnScroll"in $&&t(16,Ht=$.panOnScroll),"panOnDrag"in $&&t(17,wt=$.panOnDrag),"selectionOnDrag"in $&&t(18,Ut=$.selectionOnDrag),"autoPanOnConnect"in $&&t(58,pe=$.autoPanOnConnect),"autoPanOnNodeDrag"in $&&t(59,Ye=$.autoPanOnNodeDrag),"onerror"in $&&t(60,ot=$.onerror),"ondelete"in $&&t(61,he=$.ondelete),"onedgecreate"in $&&t(62,yt=$.onedgecreate),"attributionPosition"in $&&t(19,ht=$.attributionPosition),"proOptions"in $&&t(20,bt=$.proOptions),"defaultEdgeOptions"in $&&t(21,Ce=$.defaultEdgeOptions),"width"in $&&t(63,Pt=$.width),"height"in $&&t(64,mt=$.height),"colorMode"in $&&t(65,de=$.colorMode),"onconnect"in $&&t(66,De=$.onconnect),"onconnectstart"in $&&t(67,Ve=$.onconnectstart),"onconnectend"in $&&t(68,Ge=$.onconnectend),"onbeforedelete"in $&&t(69,It=$.onbeforedelete),"oninit"in $&&t(70,kt=$.oninit),"nodeOrigin"in $&&t(71,Mt=$.nodeOrigin),"paneClickDistance"in $&&t(22,Tt=$.paneClickDistance),"nodeClickDistance"in $&&t(23,sn=$.nodeClickDistance),"defaultMarkerColor"in $&&t(72,Bt=$.defaultMarkerColor),"style"in $&&t(24,At=$.style),"class"in $&&t(25,Kt=$.class),"$$scope"in $&&t(99,p=$.$$scope)},l.$$.update=()=>{l.$$.dirty[0]&201326592&&tn!==void 0&&rn!==void 0&&(_t.width.set(tn),_t.height.set(rn)),l.$$.dirty[2]&6400&&!Me&&i&&(kt==null||kt(),t(73,Me=!0)),l.$$.dirty[1]&2097135632|l.$$.dirty[2]&1777&&Fg(_t,{flowId:v,connectionLineType:J,connectionRadius:U,selectionMode:Z,snapGrid:X,defaultMarkerColor:Bt,nodesDraggable:N,nodesConnectable:F,elementsSelectable:K,onlyRenderVisibleElements:Ke,isValidConnection:ue,autoPanOnConnect:pe,autoPanOnNodeDrag:Ye,onerror:ot,ondelete:he,onedgecreate:yt,connectionMode:q,nodeDragThreshold:G,onconnect:De,onconnectstart:Ve,onconnectend:Ge,onbeforedelete:It,nodeOrigin:Mt}),l.$$.dirty[0]&4194304|l.$$.dirty[1]&16791040&&$r(_t,{nodeTypes:O,edgeTypes:B,minZoom:S,maxZoom:T,translateExtent:Ee,paneClickDistance:Tt}),l.$$.dirty[2]&8&&h(t(29,n=Yg(de)))},[H,j,R,C,Y,Q,ce,ge,re,Oe,x,fe,lt,it,Nt,Dt,Ht,wt,Ut,ht,bt,Ce,Tt,sn,At,Kt,tn,rn,Gt,n,u,Wt,W,s,b,v,g,w,y,I,S,T,E,O,B,Z,N,F,G,K,X,U,J,q,ue,Ee,Xe,Ke,pe,Ye,ot,he,yt,Pt,mt,de,De,Ve,Ge,It,kt,Mt,Bt,Me,i,d,Ze,tt,je,at,Jt,Cn,dt,Ct,bn,kn,Mn,ll,Tn,hl,ol,En,An,Yn,xn,sl,Vn,ml,rl,p]}class xg extends Re{constructor(e){super(),Ue(this,e,Qg,Jg,Fe,{id:35,nodes:36,edges:37,fitView:38,fitViewOptions:39,minZoom:40,maxZoom:41,initialViewport:42,viewport:0,nodeTypes:43,edgeTypes:44,selectionKey:1,selectionMode:45,panActivationKey:2,multiSelectionKey:3,zoomActivationKey:4,nodesDraggable:46,nodesConnectable:47,nodeDragThreshold:48,elementsSelectable:49,snapGrid:50,deleteKey:5,connectionRadius:51,connectionLineType:52,connectionMode:53,connectionLineStyle:6,connectionLineContainerStyle:7,onMoveStart:8,onMove:9,onMoveEnd:10,isValidConnection:54,translateExtent:55,nodeExtent:56,onlyRenderVisibleElements:57,panOnScrollMode:11,preventScrolling:12,zoomOnScroll:13,zoomOnDoubleClick:14,zoomOnPinch:15,panOnScroll:16,panOnDrag:17,selectionOnDrag:18,autoPanOnConnect:58,autoPanOnNodeDrag:59,onerror:60,ondelete:61,onedgecreate:62,attributionPosition:19,proOptions:20,defaultEdgeOptions:21,width:63,height:64,colorMode:65,onconnect:66,onconnectstart:67,onconnectend:68,onbeforedelete:69,oninit:70,nodeOrigin:71,paneClickDistance:22,nodeClickDistance:23,defaultMarkerColor:72,style:24,class:25},null,[-1,-1,-1,-1])}}function $g(l){let e;const t=l[7].default,n=Qt(t,l,l[6],null);return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,s){n&&n.m(o,s),e=!0},p(o,[s]){n&&n.p&&(!e||s&64)&&xt(n,t,o,o[6],e?en(t,o[6],s,null):$t(o[6]),null)},i(o){e||(D(n,o),e=!0)},o(o){P(n,o),e=!1},d(o){n&&n.d(o)}}}function e1(l,e,t){let{$$slots:n={},$$scope:o}=e,{initialNodes:s=void 0}=e,{initialEdges:i=void 0}=e,{initialWidth:r=void 0}=e,{initialHeight:a=void 0}=e,{fitView:c=void 0}=e,{nodeOrigin:u=void 0}=e;const f=Va({nodes:s,edges:i,width:r,height:a,nodeOrigin:u,fitView:c});return Ol(No,{getStore:()=>f}),nl(()=>{f.reset()}),l.$$set=h=>{"initialNodes"in h&&t(0,s=h.initialNodes),"initialEdges"in h&&t(1,i=h.initialEdges),"initialWidth"in h&&t(2,r=h.initialWidth),"initialHeight"in h&&t(3,a=h.initialHeight),"fitView"in h&&t(4,c=h.fitView),"nodeOrigin"in h&&t(5,u=h.nodeOrigin),"$$scope"in h&&t(6,o=h.$$scope)},[s,i,r,a,c,u,o,n]}class t1 extends Re{constructor(e){super(),Ue(this,e,e1,$g,Fe,{initialNodes:0,initialEdges:1,initialWidth:2,initialHeight:3,fitView:4,nodeOrigin:5})}}const n1=l=>({}),ti=l=>({class:"button-svg"});function l1(l){let e,t,n,o,s;const i=l[8].default,r=Qt(i,l,l[7],ti);let a=[{type:"button"},{class:t=Ot(["svelte-flow__controls-button",l[0]])},l[6]],c={};for(let u=0;u<a.length;u+=1)c=Et(c,a[u]);return{c(){e=V("button"),r&&r.c(),this.h()},l(u){e=z(u,"BUTTON",{type:!0,class:!0});var f=M(e);r&&r.l(f),f.forEach(_),this.h()},h(){Il(e,c),$e(e,"--xy-controls-button-background-color-props",l[1]),$e(e,"--xy-controls-button-background-color-hover-props",l[2]),$e(e,"--xy-controls-button-color-props",l[3]),$e(e,"--xy-controls-button-color-hover-props",l[4]),$e(e,"--xy-controls-button-border-color-props",l[5])},m(u,f){A(u,e,f),r&&r.m(e,null),e.autofocus&&e.focus(),n=!0,o||(s=ke(e,"click",l[9]),o=!0)},p(u,[f]){r&&r.p&&(!n||f&128)&&xt(r,i,u,u[7],n?en(i,u[7],f,n1):$t(u[7]),ti),Il(e,c=tl(a,[{type:"button"},(!n||f&1&&t!==(t=Ot(["svelte-flow__controls-button",u[0]])))&&{class:t},f&64&&u[6]])),$e(e,"--xy-controls-button-background-color-props",u[1]),$e(e,"--xy-controls-button-background-color-hover-props",u[2]),$e(e,"--xy-controls-button-color-props",u[3]),$e(e,"--xy-controls-button-color-hover-props",u[4]),$e(e,"--xy-controls-button-border-color-props",u[5])},i(u){n||(D(r,u),n=!0)},o(u){P(r,u),n=!1},d(u){u&&_(e),r&&r.d(u),o=!1,s()}}}function o1(l,e,t){const n=["class"];let o=Yt(e,n),{$$slots:s={},$$scope:i}=e,{class:r=void 0}=e,a,c,u,f,h;function d(p){gt.call(this,l,p)}return l.$$set=p=>{e=Et(Et({},e),Bn(p)),t(6,o=Yt(e,n)),"class"in p&&t(0,r=p.class),"$$scope"in p&&t(7,i=p.$$scope)},[r,a,c,u,f,h,o,i,s,d]}class po extends Re{constructor(e){super(),Ue(this,e,o1,l1,Fe,{class:0})}}function s1(l){let e,t;return{c(){e=Ne("svg"),t=Ne("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,viewBox:!0});var o=M(e);t=Pe(o,"path",{d:!0}),M(t).forEach(_),o.forEach(_),this.h()},h(){m(t,"d","M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 32 32")},m(n,o){A(n,e,o),k(e,t)},p:we,i:we,o:we,d(n){n&&_(e)}}}class r1 extends Re{constructor(e){super(),Ue(this,e,null,s1,Fe,{})}}function i1(l){let e,t;return{c(){e=Ne("svg"),t=Ne("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,viewBox:!0});var o=M(e);t=Pe(o,"path",{d:!0}),M(t).forEach(_),o.forEach(_),this.h()},h(){m(t,"d","M0 0h32v4.2H0z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 32 5")},m(n,o){A(n,e,o),k(e,t)},p:we,i:we,o:we,d(n){n&&_(e)}}}class a1 extends Re{constructor(e){super(),Ue(this,e,null,i1,Fe,{})}}function c1(l){let e,t;return{c(){e=Ne("svg"),t=Ne("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,viewBox:!0});var o=M(e);t=Pe(o,"path",{d:!0}),M(t).forEach(_),o.forEach(_),this.h()},h(){m(t,"d","M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 32 30")},m(n,o){A(n,e,o),k(e,t)},p:we,i:we,o:we,d(n){n&&_(e)}}}class u1 extends Re{constructor(e){super(),Ue(this,e,null,c1,Fe,{})}}function f1(l){let e,t;return{c(){e=Ne("svg"),t=Ne("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,viewBox:!0});var o=M(e);t=Pe(o,"path",{d:!0}),M(t).forEach(_),o.forEach(_),this.h()},h(){m(t,"d","M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 25 32")},m(n,o){A(n,e,o),k(e,t)},p:we,i:we,o:we,d(n){n&&_(e)}}}class d1 extends Re{constructor(e){super(),Ue(this,e,null,f1,Fe,{})}}function h1(l){let e,t;return{c(){e=Ne("svg"),t=Ne("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,viewBox:!0});var o=M(e);t=Pe(o,"path",{d:!0}),M(t).forEach(_),o.forEach(_),this.h()},h(){m(t,"d","M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 25 32")},m(n,o){A(n,e,o),k(e,t)},p:we,i:we,o:we,d(n){n&&_(e)}}}class m1 extends Re{constructor(e){super(),Ue(this,e,null,h1,Fe,{})}}const g1=l=>({}),ni=l=>({}),_1=l=>({}),li=l=>({});function oi(l){let e,t,n,o;const s=[{class:"svelte-flow__controls-zoomin"},{title:"zoom in"},{"aria-label":"zoom in"},{disabled:l[9]},l[17]];let i={$$slots:{default:[p1]},$$scope:{ctx:l}};for(let c=0;c<s.length;c+=1)i=Et(i,s[c]);e=new po({props:i}),e.$on("click",l[18]);const r=[{class:"svelte-flow__controls-zoomout"},{title:"zoom out"},{"aria-label":"zoom out"},{disabled:l[10]},l[17]];let a={$$slots:{default:[b1]},$$scope:{ctx:l}};for(let c=0;c<r.length;c+=1)a=Et(a,r[c]);return n=new po({props:a}),n.$on("click",l[19]),{c(){ne(e.$$.fragment),t=ee(),ne(n.$$.fragment)},l(c){se(e.$$.fragment,c),t=te(c),se(n.$$.fragment,c)},m(c,u){le(e,c,u),A(c,t,u),le(n,c,u),o=!0},p(c,u){const f=u[0]&131584?tl(s,[s[0],s[1],s[2],u[0]&512&&{disabled:c[9]},u[0]&131072&&Bl(c[17])]):{};u[1]&32&&(f.$$scope={dirty:u,ctx:c}),e.$set(f);const h=u[0]&132096?tl(r,[r[0],r[1],r[2],u[0]&1024&&{disabled:c[10]},u[0]&131072&&Bl(c[17])]):{};u[1]&32&&(h.$$scope={dirty:u,ctx:c}),n.$set(h)},i(c){o||(D(e.$$.fragment,c),D(n.$$.fragment,c),o=!0)},o(c){P(e.$$.fragment,c),P(n.$$.fragment,c),o=!1},d(c){c&&_(t),oe(e,c),oe(n,c)}}}function p1(l){let e,t;return e=new r1({}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function b1(l){let e,t;return e=new a1({}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function si(l){let e,t;const n=[{class:"svelte-flow__controls-fitview"},{title:"fit view"},{"aria-label":"fit view"},l[17]];let o={$$slots:{default:[v1]},$$scope:{ctx:l}};for(let s=0;s<n.length;s+=1)o=Et(o,n[s]);return e=new po({props:o}),e.$on("click",l[20]),{c(){ne(e.$$.fragment)},l(s){se(e.$$.fragment,s)},m(s,i){le(e,s,i),t=!0},p(s,i){const r=i[0]&131072?tl(n,[n[0],n[1],n[2],Bl(s[17])]):{};i[1]&32&&(r.$$scope={dirty:i,ctx:s}),e.$set(r)},i(s){t||(D(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){oe(e,s)}}}function v1(l){let e,t;return e=new u1({}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function ri(l){let e,t;const n=[{class:"svelte-flow__controls-interactive"},{title:"toggle interactivity"},{"aria-label":"toggle interactivity"},l[17]];let o={$$slots:{default:[k1]},$$scope:{ctx:l}};for(let s=0;s<n.length;s+=1)o=Et(o,n[s]);return e=new po({props:o}),e.$on("click",l[21]),{c(){ne(e.$$.fragment)},l(s){se(e.$$.fragment,s)},m(s,i){le(e,s,i),t=!0},p(s,i){const r=i[0]&131072?tl(n,[n[0],n[1],n[2],Bl(s[17])]):{};i[0]&256|i[1]&32&&(r.$$scope={dirty:i,ctx:s}),e.$set(r)},i(s){t||(D(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){oe(e,s)}}}function w1(l){let e,t;return e=new d1({}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function y1(l){let e,t;return e=new m1({}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function k1(l){let e,t,n,o;const s=[y1,w1],i=[];function r(a,c){return a[8]?0:1}return e=r(l),t=i[e]=s[e](l),{c(){t.c(),n=Ae()},l(a){t.l(a),n=Ae()},m(a,c){i[e].m(a,c),A(a,n,c),o=!0},p(a,c){let u=e;e=r(a),e!==u&&(He(),P(i[u],1,1,()=>{i[u]=null}),Be(),t=i[e],t||(t=i[e]=s[e](a),t.c()),D(t,1),t.m(n.parentNode,n))},i(a){o||(D(t),o=!0)},o(a){P(t),o=!1},d(a){a&&_(n),i[e].d(a)}}}function E1(l){let e,t,n,o,s,i;const r=l[35].before,a=Qt(r,l,l[36],li);let c=l[1]&&oi(l),u=l[2]&&si(l),f=l[3]&&ri(l);const h=l[35].default,d=Qt(h,l,l[36],null),p=l[35].after,b=Qt(p,l,l[36],ni);return{c(){a&&a.c(),e=ee(),c&&c.c(),t=ee(),u&&u.c(),n=ee(),f&&f.c(),o=ee(),d&&d.c(),s=ee(),b&&b.c()},l(v){a&&a.l(v),e=te(v),c&&c.l(v),t=te(v),u&&u.l(v),n=te(v),f&&f.l(v),o=te(v),d&&d.l(v),s=te(v),b&&b.l(v)},m(v,g){a&&a.m(v,g),A(v,e,g),c&&c.m(v,g),A(v,t,g),u&&u.m(v,g),A(v,n,g),f&&f.m(v,g),A(v,o,g),d&&d.m(v,g),A(v,s,g),b&&b.m(v,g),i=!0},p(v,g){a&&a.p&&(!i||g[1]&32)&&xt(a,r,v,v[36],i?en(r,v[36],g,_1):$t(v[36]),li),v[1]?c?(c.p(v,g),g[0]&2&&D(c,1)):(c=oi(v),c.c(),D(c,1),c.m(t.parentNode,t)):c&&(He(),P(c,1,1,()=>{c=null}),Be()),v[2]?u?(u.p(v,g),g[0]&4&&D(u,1)):(u=si(v),u.c(),D(u,1),u.m(n.parentNode,n)):u&&(He(),P(u,1,1,()=>{u=null}),Be()),v[3]?f?(f.p(v,g),g[0]&8&&D(f,1)):(f=ri(v),f.c(),D(f,1),f.m(o.parentNode,o)):f&&(He(),P(f,1,1,()=>{f=null}),Be()),d&&d.p&&(!i||g[1]&32)&&xt(d,h,v,v[36],i?en(h,v[36],g,null):$t(v[36]),null),b&&b.p&&(!i||g[1]&32)&&xt(b,p,v,v[36],i?en(p,v[36],g,g1):$t(v[36]),ni)},i(v){i||(D(a,v),D(c),D(u),D(f),D(d,v),D(b,v),i=!0)},o(v){P(a,v),P(c),P(u),P(f),P(d,v),P(b,v),i=!1},d(v){v&&(_(e),_(t),_(n),_(o),_(s)),a&&a.d(v),c&&c.d(v),u&&u.d(v),f&&f.d(v),d&&d.d(v),b&&b.d(v)}}}function I1(l){let e,t;return e=new Oa({props:{class:Ot(["svelte-flow__controls",l[7],l[6]]),position:l[0],"data-testid":"svelte-flow__controls","aria-label":l[4]??"Svelte Flow controls",style:l[5],$$slots:{default:[E1]},$$scope:{ctx:l}}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o[0]&192&&(s.class=Ot(["svelte-flow__controls",n[7],n[6]])),o[0]&1&&(s.position=n[0]),o[0]&16&&(s["aria-label"]=n[4]??"Svelte Flow controls"),o[0]&32&&(s.style=n[5]),o[0]&1806|o[1]&32&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function S1(l,e,t){let n,o,s,i,r,a,c,u,f,h,{$$slots:d={},$$scope:p}=e,{position:b="bottom-left"}=e,{showZoom:v=!0}=e,{showFitView:g=!0}=e,{showLock:w=!0}=e,{buttonBgColor:y=void 0}=e,{buttonBgColorHover:I=void 0}=e,{buttonColor:S=void 0}=e,{buttonColorHover:T=void 0}=e,{buttonBorderColor:E=void 0}=e,{ariaLabel:H=void 0}=e,{style:O=void 0}=e,{orientation:B="vertical"}=e,{fitViewOptions:j=void 0}=e,{class:Z=""}=e;const{zoomIn:R,zoomOut:C,fitView:Y,viewport:N,minZoom:F,maxZoom:G,nodesDraggable:K,nodesConnectable:X,elementsSelectable:Q}=Xt();ae(l,N,re=>t(30,a=re)),ae(l,F,re=>t(31,c=re)),ae(l,G,re=>t(29,r=re)),ae(l,K,re=>t(34,h=re)),ae(l,X,re=>t(33,f=re)),ae(l,Q,re=>t(32,u=re));const U={bgColor:y,bgColorHover:I,color:S,colorHover:T,borderColor:E},J=()=>{R()},q=()=>{C()},ce=()=>{Y(j)},ge=()=>{t(8,n=!n),K.set(n),X.set(n),Q.set(n)};return l.$$set=re=>{"position"in re&&t(0,b=re.position),"showZoom"in re&&t(1,v=re.showZoom),"showFitView"in re&&t(2,g=re.showFitView),"showLock"in re&&t(3,w=re.showLock),"buttonBgColor"in re&&t(22,y=re.buttonBgColor),"buttonBgColorHover"in re&&t(23,I=re.buttonBgColorHover),"buttonColor"in re&&t(24,S=re.buttonColor),"buttonColorHover"in re&&t(25,T=re.buttonColorHover),"buttonBorderColor"in re&&t(26,E=re.buttonBorderColor),"ariaLabel"in re&&t(4,H=re.ariaLabel),"style"in re&&t(5,O=re.style),"orientation"in re&&t(27,B=re.orientation),"fitViewOptions"in re&&t(28,j=re.fitViewOptions),"class"in re&&t(6,Z=re.class),"$$scope"in re&&t(36,p=re.$$scope)},l.$$.update=()=>{l.$$.dirty[1]&14&&t(8,n=h||f||u),l.$$.dirty[0]&1073741824|l.$$.dirty[1]&1&&t(10,o=a.zoom<=c),l.$$.dirty[0]&1610612736&&t(9,s=a.zoom>=r),l.$$.dirty[0]&134217728&&t(7,i=B==="horizontal"?"horizontal":"vertical")},[b,v,g,w,H,O,Z,i,n,s,o,N,F,G,K,X,Q,U,J,q,ce,ge,y,I,S,T,E,B,j,r,a,c,u,f,h,d,p]}let D1=class extends Re{constructor(e){super(),Ue(this,e,S1,I1,Fe,{position:0,showZoom:1,showFitView:2,showLock:3,buttonBgColor:22,buttonBgColorHover:23,buttonColor:24,buttonColorHover:25,buttonBorderColor:26,ariaLabel:4,style:5,orientation:27,fitViewOptions:28,class:6},null,[-1,-1])}};var qn;(function(l){l.Lines="lines",l.Dots="dots",l.Cross="cross"})(qn||(qn={}));function C1(l){let e,t;return{c(){e=Ne("circle"),this.h()},l(n){e=Pe(n,"circle",{cx:!0,cy:!0,r:!0,class:!0}),M(e).forEach(_),this.h()},h(){m(e,"cx",l[0]),m(e,"cy",l[0]),m(e,"r",l[0]),m(e,"class",t=Ot(["svelte-flow__background-pattern","dots",l[1]]))},m(n,o){A(n,e,o)},p(n,[o]){o&1&&m(e,"cx",n[0]),o&1&&m(e,"cy",n[0]),o&1&&m(e,"r",n[0]),o&2&&t!==(t=Ot(["svelte-flow__background-pattern","dots",n[1]]))&&m(e,"class",t)},i:we,o:we,d(n){n&&_(e)}}}function M1(l,e,t){let{radius:n=5}=e,{class:o=""}=e;return l.$$set=s=>{"radius"in s&&t(0,n=s.radius),"class"in s&&t(1,o=s.class)},[n,o]}class T1 extends Re{constructor(e){super(),Ue(this,e,M1,C1,Fe,{radius:0,class:1})}}function V1(l){let e,t,n;return{c(){e=Ne("path"),this.h()},l(o){e=Pe(o,"path",{"stroke-width":!0,d:!0,class:!0}),M(e).forEach(_),this.h()},h(){m(e,"stroke-width",l[0]),m(e,"d",t=`M${l[1][0]/2} 0 V${l[1][1]} M0 ${l[1][1]/2} H${l[1][0]}`),m(e,"class",n=Ot(["svelte-flow__background-pattern",l[2],l[3]]))},m(o,s){A(o,e,s)},p(o,[s]){s&1&&m(e,"stroke-width",o[0]),s&2&&t!==(t=`M${o[1][0]/2} 0 V${o[1][1]} M0 ${o[1][1]/2} H${o[1][0]}`)&&m(e,"d",t),s&12&&n!==(n=Ot(["svelte-flow__background-pattern",o[2],o[3]]))&&m(e,"class",n)},i:we,o:we,d(o){o&&_(e)}}}function z1(l,e,t){let{lineWidth:n=1}=e,{dimensions:o}=e,{variant:s=void 0}=e,{class:i=""}=e;return l.$$set=r=>{"lineWidth"in r&&t(0,n=r.lineWidth),"dimensions"in r&&t(1,o=r.dimensions),"variant"in r&&t(2,s=r.variant),"class"in r&&t(3,i=r.class)},[n,o,s,i]}class N1 extends Re{constructor(e){super(),Ue(this,e,z1,V1,Fe,{lineWidth:0,dimensions:1,variant:2,class:3})}}function P1(l){let e,t;return e=new N1({props:{dimensions:l[6],variant:l[0],lineWidth:l[1],class:l[4]}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o&64&&(s.dimensions=n[6]),o&1&&(s.variant=n[0]),o&2&&(s.lineWidth=n[1]),o&16&&(s.class=n[4]),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function O1(l){let e,t;return e=new T1({props:{radius:l[7]/2,class:l[4]}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o&128&&(s.radius=n[7]/2),o&16&&(s.class=n[4]),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function H1(l){let e,t,n,o,s,i,r,a,c,u,f,h,d;const p=[O1,P1],b=[];function v(g,w){return g[14]?0:1}return n=v(l),o=b[n]=p[n](l),{c(){e=Ne("svg"),t=Ne("pattern"),o.c(),u=Ne("rect"),this.h()},l(g){e=Pe(g,"svg",{class:!0,"data-testid":!0});var w=M(e);t=Pe(w,"pattern",{id:!0,x:!0,y:!0,width:!0,height:!0,patternUnits:!0,patternTransform:!0});var y=M(t);o.l(y),y.forEach(_),u=Pe(w,"rect",{x:!0,y:!0,width:!0,height:!0,fill:!0}),M(u).forEach(_),w.forEach(_),this.h()},h(){m(t,"id",l[11]),m(t,"x",s=l[9].x%l[8][0]),m(t,"y",i=l[9].y%l[8][1]),m(t,"width",r=l[8][0]),m(t,"height",a=l[8][1]),m(t,"patternUnits","userSpaceOnUse"),m(t,"patternTransform",c=`translate(-${l[10][0]},-${l[10][1]})`),m(u,"x","0"),m(u,"y","0"),m(u,"width","100%"),m(u,"height","100%"),m(u,"fill",f=`url(#${l[11]})`),m(e,"class",h=fs(Ot(["svelte-flow__background",l[5]]))+" svelte-1r7pe8d"),m(e,"data-testid","svelte-flow__background"),$e(e,"--xy-background-color-props",l[2]),$e(e,"--xy-background-pattern-color-props",l[3])},m(g,w){A(g,e,w),k(e,t),b[n].m(t,null),k(e,u),d=!0},p(g,[w]){o.p(g,w),(!d||w&2048)&&m(t,"id",g[11]),(!d||w&768&&s!==(s=g[9].x%g[8][0]))&&m(t,"x",s),(!d||w&768&&i!==(i=g[9].y%g[8][1]))&&m(t,"y",i),(!d||w&256&&r!==(r=g[8][0]))&&m(t,"width",r),(!d||w&256&&a!==(a=g[8][1]))&&m(t,"height",a),(!d||w&1024&&c!==(c=`translate(-${g[10][0]},-${g[10][1]})`))&&m(t,"patternTransform",c),(!d||w&2048&&f!==(f=`url(#${g[11]})`))&&m(u,"fill",f),(!d||w&32&&h!==(h=fs(Ot(["svelte-flow__background",g[5]]))+" svelte-1r7pe8d"))&&m(e,"class",h),w&4&&$e(e,"--xy-background-color-props",g[2]),w&8&&$e(e,"--xy-background-pattern-color-props",g[3])},i(g){d||(D(o),d=!0)},o(g){P(o),d=!1},d(g){g&&_(e),b[n].d()}}}const B1={[qn.Dots]:1,[qn.Lines]:1,[qn.Cross]:6};function A1(l,e,t){let n,o,s,i,r,a,c,{id:u=void 0}=e,{variant:f=qn.Dots}=e,{gap:h=20}=e,{size:d=1}=e,{lineWidth:p=1}=e,{bgColor:b=void 0}=e,{patternColor:v=void 0}=e,{patternClass:g=void 0}=e,{class:w=""}=e;const{viewport:y,flowId:I}=Xt();ae(l,y,O=>t(9,a=O)),ae(l,I,O=>t(18,c=O));const S=d||B1[f],T=f===qn.Dots,E=f===qn.Cross,H=Array.isArray(h)?h:[h,h];return l.$$set=O=>{"id"in O&&t(15,u=O.id),"variant"in O&&t(0,f=O.variant),"gap"in O&&t(16,h=O.gap),"size"in O&&t(17,d=O.size),"lineWidth"in O&&t(1,p=O.lineWidth),"bgColor"in O&&t(2,b=O.bgColor),"patternColor"in O&&t(3,v=O.patternColor),"patternClass"in O&&t(4,g=O.patternClass),"class"in O&&t(5,w=O.class)},l.$$.update=()=>{l.$$.dirty&294912&&t(11,n=`background-pattern-${c}-${u||""}`),l.$$.dirty&512&&t(8,o=[H[0]*a.zoom||1,H[1]*a.zoom||1]),l.$$.dirty&512&&t(7,s=S*a.zoom),l.$$.dirty&384&&t(6,i=E?[s,s]:o),l.$$.dirty&192&&t(10,r=T?[s/2,s/2]:[i[0]/2,i[1]/2])},[f,p,b,v,g,w,i,s,o,a,r,n,y,I,T,u,h,d,c]}class L1 extends Re{constructor(e){super(),Ue(this,e,A1,H1,Fe,{id:15,variant:0,gap:16,size:17,lineWidth:1,bgColor:2,patternColor:3,patternClass:4,class:5})}}const ii=l=>oh(l);function R1(){const{zoomIn:l,zoomOut:e,fitView:t,onbeforedelete:n,snapGrid:o,viewport:s,width:i,height:r,minZoom:a,maxZoom:c,panZoom:u,nodes:f,edges:h,domNode:d,nodeLookup:p,nodeOrigin:b,edgeLookup:v,connectionLookup:g}=Xt(),w=S=>{var B,j;const T=me(p),E=ii(S)?S:T.get(S.id),H=E.parentId?ch(E.position,E.measured,E.parentId,T,me(b)):E.position,O={id:E.id,position:H,width:((B=E.measured)==null?void 0:B.width)??E.width,height:((j=E.measured)==null?void 0:j.height)??E.height,data:E.data};return Ml(O)},y=(S,T,E={replace:!1})=>{var B;const H=(B=me(p).get(S))==null?void 0:B.internals.userNode;if(!H)return;const O=typeof T=="function"?T(H):T;E.replace?f.update(j=>j.map(Z=>Z.id===S?ii(O)?O:{...Z,...O}:Z)):(Object.assign(H,O),f.update(j=>j))},I=S=>me(p).get(S);return{zoomIn:l,zoomOut:e,getInternalNode:I,getNode:S=>{var T;return(T=I(S))==null?void 0:T.internals.userNode},getNodes:S=>S===void 0?me(f):ai(me(p),S),getEdge:S=>me(v).get(S),getEdges:S=>S===void 0?me(h):ai(me(v),S),setZoom:(S,T)=>{const E=me(u);return E?E.scaleTo(S,{duration:T==null?void 0:T.duration}):Promise.resolve(!1)},getZoom:()=>me(s).zoom,setViewport:async(S,T)=>{const E=me(s),H=me(u);return H?(await H.setViewport({x:S.x??E.x,y:S.y??E.y,zoom:S.zoom??E.zoom},{duration:T==null?void 0:T.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>me(s),setCenter:async(S,T,E)=>{const H=typeof(E==null?void 0:E.zoom)<"u"?E.zoom:me(c),O=me(u);return O?(await O.setViewport({x:me(i)/2-S*H,y:me(r)/2-T*H,zoom:H},{duration:E==null?void 0:E.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitView:t,fitBounds:async(S,T)=>{const E=me(u);if(!E)return Promise.resolve(!1);const H=os(S,me(i),me(r),me(a),me(c),(T==null?void 0:T.padding)??.1);return await E.setViewport(H,{duration:T==null?void 0:T.duration}),Promise.resolve(!0)},getIntersectingNodes:(S,T=!0,E)=>{const H=Ir(S),O=H?S:w(S);return O?(E||me(f)).filter(B=>{const j=me(p).get(B.id);if(!j||!H&&B.id===S.id)return!1;const Z=Ml(j),R=Ul(Z,O);return T&&R>0||R>=O.width*O.height}):[]},isNodeIntersecting:(S,T,E=!0)=>{const O=Ir(S)?S:w(S);if(!O)return!1;const B=Ul(O,T);return E&&B>0||B>=O.width*O.height},deleteElements:async({nodes:S=[],edges:T=[]})=>{const{nodes:E,edges:H}=await la({nodesToRemove:S,edgesToRemove:T,nodes:me(f),edges:me(h),onBeforeDelete:me(n)});return E&&f.update(O=>O.filter(B=>!E.some(({id:j})=>j===B.id))),H&&h.update(O=>O.filter(B=>!H.some(({id:j})=>j===B.id))),{deletedNodes:E,deletedEdges:H}},screenToFlowPosition:(S,T={snapToGrid:!0})=>{const E=me(d);if(!E)return S;const H=T.snapToGrid?me(o):!1,{x:O,y:B,zoom:j}=me(s),{x:Z,y:R}=E.getBoundingClientRect(),C={x:S.x-Z,y:S.y-R};return Zl(C,[O,B,j],H!==null,H||[1,1])},flowToScreenPosition:S=>{const T=me(d);if(!T)return S;const{x:E,y:H,zoom:O}=me(s),{x:B,y:j}=T.getBoundingClientRect(),Z=ra(S,[E,H,O]);return{x:Z.x+B,y:Z.y+j}},toObject:()=>({nodes:me(f).map(S=>({...S,position:{...S.position},data:{...S.data}})),edges:me(h).map(S=>({...S})),viewport:{...me(s)}}),updateNode:y,updateNodeData:(S,T,E)=>{var B;const H=(B=me(p).get(S))==null?void 0:B.internals.userNode;if(!H)return;const O=typeof T=="function"?T(H):T;H.data=E!=null&&E.replace?O:{...H.data,...O},f.update(j=>j)},getNodesBounds:S=>{const T=me(p),E=me(b);return sh(S,{nodeLookup:T,nodeOrigin:E})},getHandleConnections:({type:S,id:T,nodeId:E})=>{var H;return Array.from(((H=me(g).get(`${E}-${S}-${T??null}`))==null?void 0:H.values())??[])},viewport:s}}function ai(l,e){var n;const t=[];for(const o of e){const s=l.get(o);if(s){const i="internals"in s?(n=s.internals)==null?void 0:n.userNode:s;t.push(i)}}return t}function U1(){const{nodesInitialized:l}=Xt();return{subscribe:l.subscribe}}function ci(l,e,t){const n=l.slice();return n[25]=e[t],n[27]=t,n}function ui(l,e,t){const n=l.slice();return n[22]=e[t],n[24]=t,n}function W1(l){let e,t;return e=new Io({props:{className:"size-4"}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p:we,i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function F1(l){let e,t,n,o,s,i,r,a=l[8].t("Tools")+"",c,u,f=l[8].t("Functions")+"",h,d,p,b,v,g,w,y;function I(H,O){if(H[1]==="tools")return Y1;if(H[1]==="functions")return j1}let S=I(l),T=S&&S(l),E=l[2]&&hi(l);return{c(){e=V("form"),t=V("div"),n=V("div"),o=V("div"),s=V("div"),i=V("select"),r=V("option"),c=Ie(a),u=V("option"),h=Ie(f),d=ee(),p=V("div"),b=V("select"),T&&T.c(),v=ee(),E&&E.c(),this.h()},l(H){e=z(H,"FORM",{class:!0});var O=M(e);t=z(O,"DIV",{class:!0});var B=M(t);n=z(B,"DIV",{class:!0});var j=M(n);o=z(j,"DIV",{class:!0});var Z=M(o);s=z(Z,"DIV",{class:!0});var R=M(s);i=z(R,"SELECT",{class:!0,placeholder:!0});var C=M(i);r=z(C,"OPTION",{class:!0});var Y=M(r);c=Se(Y,a),Y.forEach(_),u=z(C,"OPTION",{class:!0});var N=M(u);h=Se(N,f),N.forEach(_),C.forEach(_),R.forEach(_),d=te(Z),p=z(Z,"DIV",{class:!0});var F=M(p);b=z(F,"SELECT",{class:!0});var G=M(b);T&&T.l(G),G.forEach(_),F.forEach(_),Z.forEach(_),j.forEach(_),v=te(B),E&&E.l(B),B.forEach(_),O.forEach(_),this.h()},h(){r.__value="tools",Sn(r,r.__value),m(r,"class","bg-gray-100 dark:bg-gray-800"),u.__value="functions",Sn(u,u.__value),m(u,"class","bg-gray-100 dark:bg-gray-800"),m(i,"class","w-full rounded-sm text-xs py-2 px-1 bg-transparent outline-hidden"),m(i,"placeholder","Select"),l[1]===void 0&&el(()=>l[13].call(i)),m(s,"class","flex-1"),m(b,"class","w-full rounded-sm py-2 px-1 text-xs bg-transparent outline-hidden"),l[2]===void 0&&el(()=>l[14].call(b)),m(p,"class","flex-1"),m(o,"class","flex gap-2"),m(n,"class","space-y-1"),m(t,"class","flex flex-col"),m(e,"class","flex flex-col h-full justify-between space-y-3 text-sm")},m(H,O){A(H,e,O),k(e,t),k(t,n),k(n,o),k(o,s),k(s,i),k(i,r),k(r,c),k(i,u),k(u,h),Ql(i,l[1],!0),k(o,d),k(o,p),k(p,b),T&&T.m(b,null),Ql(b,l[2],!0),k(t,v),E&&E.m(t,null),g=!0,w||(y=[ke(i,"change",l[13]),ke(b,"change",l[14]),ke(b,"change",l[15]),ke(e,"submit",jl(l[18]))],w=!0)},p(H,O){(!g||O&256)&&a!==(a=H[8].t("Tools")+"")&&Te(c,a),(!g||O&256)&&f!==(f=H[8].t("Functions")+"")&&Te(h,f),O&2&&Ql(i,H[1]),S===(S=I(H))&&T?T.p(H,O):(T&&T.d(1),T=S&&S(H),T&&(T.c(),T.m(b,null))),O&196&&Ql(b,H[2]),H[2]?E?(E.p(H,O),O&4&&D(E,1)):(E=hi(H),E.c(),D(E,1),E.m(t,null)):E&&(He(),P(E,1,1,()=>{E=null}),Be())},i(H){g||(D(E),g=!0)},o(H){P(E),g=!1},d(H){H&&_(e),T&&T.d(),E&&E.d(),w=!1,on(y)}}}function j1(l){let e,t=l[8].t("Select a function")+"",n,o,s=vt(l[7]),i=[];for(let r=0;r<s.length;r+=1)i[r]=fi(ci(l,s,r));return{c(){e=V("option"),n=Ie(t);for(let r=0;r<i.length;r+=1)i[r].c();o=Ae(),this.h()},l(r){e=z(r,"OPTION",{class:!0});var a=M(e);n=Se(a,t),a.forEach(_);for(let c=0;c<i.length;c+=1)i[c].l(r);o=Ae(),this.h()},h(){e.__value="",Sn(e,e.__value),e.selected=!0,e.disabled=!0,m(e,"class","bg-gray-100 dark:bg-gray-800")},m(r,a){A(r,e,a),k(e,n);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(r,a);A(r,o,a)},p(r,a){if(a&256&&t!==(t=r[8].t("Select a function")+"")&&Te(n,t),a&128){s=vt(r[7]);let c;for(c=0;c<s.length;c+=1){const u=ci(r,s,c);i[c]?i[c].p(u,a):(i[c]=fi(u),i[c].c(),i[c].m(o.parentNode,o))}for(;c<i.length;c+=1)i[c].d(1);i.length=s.length}},d(r){r&&(_(e),_(o)),Dn(i,r)}}}function Y1(l){let e,t=l[8].t("Select a tool")+"",n,o,s=vt(l[6]),i=[];for(let r=0;r<s.length;r+=1)i[r]=di(ui(l,s,r));return{c(){e=V("option"),n=Ie(t);for(let r=0;r<i.length;r+=1)i[r].c();o=Ae(),this.h()},l(r){e=z(r,"OPTION",{class:!0});var a=M(e);n=Se(a,t),a.forEach(_);for(let c=0;c<i.length;c+=1)i[c].l(r);o=Ae(),this.h()},h(){e.__value="",Sn(e,e.__value),e.selected=!0,e.disabled=!0,m(e,"class","bg-gray-100 dark:bg-gray-800")},m(r,a){A(r,e,a),k(e,n);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(r,a);A(r,o,a)},p(r,a){if(a&256&&t!==(t=r[8].t("Select a tool")+"")&&Te(n,t),a&64){s=vt(r[6]);let c;for(c=0;c<s.length;c+=1){const u=ui(r,s,c);i[c]?i[c].p(u,a):(i[c]=di(u),i[c].c(),i[c].m(o.parentNode,o))}for(;c<i.length;c+=1)i[c].d(1);i.length=s.length}},d(r){r&&(_(e),_(o)),Dn(i,r)}}}function fi(l){let e,t=l[25].name+"",n,o;return{c(){e=V("option"),n=Ie(t),this.h()},l(s){e=z(s,"OPTION",{class:!0});var i=M(e);n=Se(i,t),i.forEach(_),this.h()},h(){e.__value=o=l[25].id,Sn(e,e.__value),m(e,"class","bg-gray-100 dark:bg-gray-800")},m(s,i){A(s,e,i),k(e,n)},p(s,i){i&128&&t!==(t=s[25].name+"")&&Te(n,t),i&128&&o!==(o=s[25].id)&&(e.__value=o,Sn(e,e.__value))},d(s){s&&_(e)}}}function di(l){let e,t=l[22].name+"",n,o;return{c(){e=V("option"),n=Ie(t),this.h()},l(s){e=z(s,"OPTION",{class:!0});var i=M(e);n=Se(i,t),i.forEach(_),this.h()},h(){e.__value=o=l[22].id,Sn(e,e.__value),m(e,"class","bg-gray-100 dark:bg-gray-800")},m(s,i){A(s,e,i),k(e,n)},p(s,i){i&64&&t!==(t=s[22].name+"")&&Te(n,t),i&64&&o!==(o=s[22].id)&&(e.__value=o,Sn(e,e.__value))},d(s){s&&_(e)}}}function hi(l){let e,t,n,o,s,i;const r=[K1,X1],a=[];function c(u,f){return u[3]?1:0}return o=c(l),s=a[o]=r[o](l),{c(){e=V("hr"),t=ee(),n=V("div"),s.c(),this.h()},l(u){e=z(u,"HR",{class:!0}),t=te(u),n=z(u,"DIV",{class:!0});var f=M(n);s.l(f),f.forEach(_),this.h()},h(){m(e,"class","dark:border-gray-800 my-1 w-full"),m(n,"class","my-2 text-xs")},m(u,f){A(u,e,f),A(u,t,f),A(u,n,f),a[o].m(n,null),i=!0},p(u,f){let h=o;o=c(u),o===h?a[o].p(u,f):(He(),P(a[h],1,1,()=>{a[h]=null}),Be(),s=a[o],s?s.p(u,f):(s=a[o]=r[o](u),s.c()),D(s,1),s.m(n,null))},i(u){i||(D(s),i=!0)},o(u){P(s),i=!1},d(u){u&&(_(e),_(t),_(n)),a[o].d()}}}function X1(l){let e,t;return e=new Io({props:{className:"size-5"}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p:we,i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function K1(l){let e,t,n;function o(i){l[16](i)}let s={valvesSpec:l[4]};return l[5]!==void 0&&(s.valves=l[5]),e=new mu({props:s}),We.push(()=>Je(e,"valves",o)),e.$on("change",l[17]),{c(){ne(e.$$.fragment)},l(i){se(e.$$.fragment,i)},m(i,r){le(e,i,r),n=!0},p(i,r){const a={};r&16&&(a.valvesSpec=i[4]),!t&&r&32&&(t=!0,a.valves=i[5],qe(()=>t=!1)),e.$set(a)},i(i){n||(D(e.$$.fragment,i),n=!0)},o(i){P(e.$$.fragment,i),n=!1},d(i){oe(e,i)}}}function Z1(l){let e,t,n,o;const s=[F1,W1],i=[];function r(a,c){return a[0]&&!a[3]?0:1}return e=r(l),t=i[e]=s[e](l),{c(){t.c(),n=Ae()},l(a){t.l(a),n=Ae()},m(a,c){i[e].m(a,c),A(a,n,c),o=!0},p(a,[c]){let u=e;e=r(a),e===u?i[e].p(a,c):(He(),P(i[u],1,1,()=>{i[u]=null}),Be(),t=i[e],t?t.p(a,c):(t=i[e]=s[e](a),t.c()),D(t,1),t.m(n.parentNode,n))},i(a){o||(D(t),o=!0)},o(a){P(t),o=!1},d(a){a&&_(n),i[e].d(a)}}}function G1(l,e,t){let n,o,s;ae(l,ul,O=>t(6,n=O)),ae(l,gs,O=>t(7,o=O));const i=cn(),r=Ft("i18n");ae(l,r,O=>t(8,s=O));let{show:a=!1}=e,c="tools",u="",f=!1,h=null,d={},p;const b=async()=>{p&&clearTimeout(p),p=setTimeout(()=>{g()},500)},v=async()=>{var O;if(t(3,f=!0),c==="tools"?(t(5,d=await Hc(localStorage.token,u)),t(4,h=await Bc(localStorage.token,u))):c==="functions"&&(t(5,d=await fu(localStorage.token,u)),t(4,h=await du(localStorage.token,u))),h)for(const B in h.properties)((O=h.properties[B])==null?void 0:O.type)==="array"&&t(5,d[B]=(d[B]??[]).join(","),d);t(3,f=!1)},g=async()=>{var O;if(h){for(const B in h.properties)((O=h.properties[B])==null?void 0:O.type)==="array"&&t(5,d[B]=(d[B]??"").split(",").map(j=>j.trim()),d);if(c==="tools"){const B=await Ac(localStorage.token,u,d).catch(j=>(nt.error(`${j}`),null));B&&(nt.success(s.t("Valves updated")),t(5,d=B))}else if(c==="functions"){const B=await hu(localStorage.token,u,d).catch(j=>(nt.error(`${j}`),null));B&&(nt.success(s.t("Valves updated")),t(5,d=B))}}},w=async()=>{t(3,f=!0),o===null&&gs.set(await uu(localStorage.token)),n===null&&ul.set(await $o(localStorage.token)),t(3,f=!1)};function y(){c=ds(this),t(1,c)}function I(){u=ds(this),t(2,u),t(1,c)}const S=async()=>{await xe()};function T(O){d=O,t(5,d)}const E=()=>{b()},H=()=>{g(),i("save")};return l.$$set=O=>{"show"in O&&t(0,a=O.show)},l.$$.update=()=>{l.$$.dirty&2&&c&&t(2,u=""),l.$$.dirty&4&&u&&v(),l.$$.dirty&1&&a&&w()},[a,c,u,f,h,d,n,o,s,i,r,b,g,y,I,S,T,E,H]}class q1 extends Re{constructor(e){super(),Ue(this,e,G1,Z1,Fe,{show:0})}}function mi(l,e,t){const n=l.slice();return n[14]=e[t],n[16]=t,n}function J1(l){let e,t=l[3].t("You do not have permission to access this feature.")+"",n;return{c(){e=V("div"),n=Ie(t),this.h()},l(o){e=z(o,"DIV",{class:!0});var s=M(e);n=Se(s,t),s.forEach(_),this.h()},h(){m(e,"class","text-sm dark:text-gray-300 text-center py-2 px-10")},m(o,s){A(o,e,s),k(e,n)},p(o,s){s&8&&t!==(t=o[3].t("You do not have permission to access this feature.")+"")&&Te(n,t)},i:we,o:we,d(o){o&&_(e)}}}function Q1(l){let e,t,n,o,s,i,r,a,c,u,f,h,d,p=l[0].length>0&&gi(l);function b(g){l[11](g)}let v={title:l[3].t("Valves"),buttonClassName:"w-full",$$slots:{content:[$1]},$$scope:{ctx:l}};return l[2]!==void 0&&(v.open=l[2]),n=new ro({props:v}),We.push(()=>Je(n,"open",b)),a=new ro({props:{title:l[3].t("System Prompt"),open:!0,buttonClassName:"w-full",$$slots:{content:[e0]},$$scope:{ctx:l}}}),h=new ro({props:{title:l[3].t("Advanced Params"),open:!0,buttonClassName:"w-full",$$slots:{content:[t0]},$$scope:{ctx:l}}}),{c(){e=V("div"),p&&p.c(),t=ee(),ne(n.$$.fragment),s=ee(),i=V("hr"),r=ee(),ne(a.$$.fragment),c=ee(),u=V("hr"),f=ee(),ne(h.$$.fragment),this.h()},l(g){e=z(g,"DIV",{class:!0});var w=M(e);p&&p.l(w),t=te(w),se(n.$$.fragment,w),s=te(w),i=z(w,"HR",{class:!0}),r=te(w),se(a.$$.fragment,w),c=te(w),u=z(w,"HR",{class:!0}),f=te(w),se(h.$$.fragment,w),w.forEach(_),this.h()},h(){m(i,"class","my-2 border-gray-50 dark:border-gray-700/10"),m(u,"class","my-2 border-gray-50 dark:border-gray-700/10"),m(e,"class","dark:text-gray-200 text-sm font-primary py-0.5 px-0.5")},m(g,w){A(g,e,w),p&&p.m(e,null),k(e,t),le(n,e,null),k(e,s),k(e,i),k(e,r),le(a,e,null),k(e,c),k(e,u),k(e,f),le(h,e,null),d=!0},p(g,w){g[0].length>0?p?(p.p(g,w),w&1&&D(p,1)):(p=gi(g),p.c(),D(p,1),p.m(e,t)):p&&(He(),P(p,1,1,()=>{p=null}),Be());const y={};w&8&&(y.title=g[3].t("Valves")),w&131076&&(y.$$scope={dirty:w,ctx:g}),!o&&w&4&&(o=!0,y.open=g[2],qe(()=>o=!1)),n.$set(y);const I={};w&8&&(I.title=g[3].t("System Prompt")),w&131082&&(I.$$scope={dirty:w,ctx:g}),a.$set(I);const S={};w&8&&(S.title=g[3].t("Advanced Params")),w&131090&&(S.$$scope={dirty:w,ctx:g}),h.$set(S)},i(g){d||(D(p),D(n.$$.fragment,g),D(a.$$.fragment,g),D(h.$$.fragment,g),d=!0)},o(g){P(p),P(n.$$.fragment,g),P(a.$$.fragment,g),P(h.$$.fragment,g),d=!1},d(g){g&&_(e),p&&p.d(),oe(n),oe(a),oe(h)}}}function gi(l){let e,t,n,o;return e=new ro({props:{title:l[3].t("Files"),open:!0,buttonClassName:"w-full",$$slots:{content:[x1]},$$scope:{ctx:l}}}),{c(){ne(e.$$.fragment),t=ee(),n=V("hr"),this.h()},l(s){se(e.$$.fragment,s),t=te(s),n=z(s,"HR",{class:!0}),this.h()},h(){m(n,"class","my-2 border-gray-50 dark:border-gray-700/10")},m(s,i){le(e,s,i),A(s,t,i),A(s,n,i),o=!0},p(s,i){const r={};i&8&&(r.title=s[3].t("Files")),i&131073&&(r.$$scope={dirty:i,ctx:s}),e.$set(r)},i(s){o||(D(e.$$.fragment,s),o=!0)},o(s){P(e.$$.fragment,s),o=!1},d(s){s&&(_(t),_(n)),oe(e,s)}}}function _i(l){var s,i;let e,t;function n(){return l[9](l[16])}function o(){return l[10](l[14])}return e=new qi({props:{className:"w-full",item:l[14],edit:!0,url:(s=l[14])!=null&&s.url?l[14].url:null,name:l[14].name,type:l[14].type,size:(i=l[14])==null?void 0:i.size,dismissible:!0}}),e.$on("dismiss",n),e.$on("click",o),{c(){ne(e.$$.fragment)},l(r){se(e.$$.fragment,r)},m(r,a){le(e,r,a),t=!0},p(r,a){var u,f;l=r;const c={};a&1&&(c.item=l[14]),a&1&&(c.url=(u=l[14])!=null&&u.url?l[14].url:null),a&1&&(c.name=l[14].name),a&1&&(c.type=l[14].type),a&1&&(c.size=(f=l[14])==null?void 0:f.size),e.$set(c)},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){oe(e,r)}}}function x1(l){let e,t,n=vt(l[0]),o=[];for(let i=0;i<n.length;i+=1)o[i]=_i(mi(l,n,i));const s=i=>P(o[i],1,1,()=>{o[i]=null});return{c(){e=V("div");for(let i=0;i<o.length;i+=1)o[i].c();this.h()},l(i){e=z(i,"DIV",{class:!0,slot:!0});var r=M(e);for(let a=0;a<o.length;a+=1)o[a].l(r);r.forEach(_),this.h()},h(){m(e,"class","flex flex-col gap-1 mt-1.5"),m(e,"slot","content")},m(i,r){A(i,e,r);for(let a=0;a<o.length;a+=1)o[a]&&o[a].m(e,null);t=!0},p(i,r){if(r&1){n=vt(i[0]);let a;for(a=0;a<n.length;a+=1){const c=mi(i,n,a);o[a]?(o[a].p(c,r),D(o[a],1)):(o[a]=_i(c),o[a].c(),D(o[a],1),o[a].m(e,null))}for(He(),a=n.length;a<o.length;a+=1)s(a);Be()}},i(i){if(!t){for(let r=0;r<n.length;r+=1)D(o[r]);t=!0}},o(i){o=o.filter(Boolean);for(let r=0;r<o.length;r+=1)P(o[r]);t=!1},d(i){i&&_(e),Dn(o,i)}}}function $1(l){let e,t,n;return t=new q1({props:{show:l[2]}}),{c(){e=V("div"),ne(t.$$.fragment),this.h()},l(o){e=z(o,"DIV",{class:!0,slot:!0});var s=M(e);se(t.$$.fragment,s),s.forEach(_),this.h()},h(){m(e,"class","text-sm"),m(e,"slot","content")},m(o,s){A(o,e,s),le(t,e,null),n=!0},p(o,s){const i={};s&4&&(i.show=o[2]),t.$set(i)},i(o){n||(D(t.$$.fragment,o),n=!0)},o(o){P(t.$$.fragment,o),n=!1},d(o){o&&_(e),oe(t)}}}function e0(l){let e,t,n,o,s;return{c(){e=V("div"),t=V("textarea"),this.h()},l(i){e=z(i,"DIV",{class:!0,slot:!0});var r=M(e);t=z(r,"TEXTAREA",{class:!0,rows:!0,placeholder:!0}),M(t).forEach(_),r.forEach(_),this.h()},h(){m(t,"class","w-full text-xs py-1.5 bg-transparent outline-hidden resize-none"),m(t,"rows","4"),m(t,"placeholder",n=l[3].t("Enter system prompt")),m(e,"class",""),m(e,"slot","content")},m(i,r){A(i,e,r),k(e,t),Sn(t,l[1].system),o||(s=ke(t,"input",l[12]),o=!0)},p(i,r){r&8&&n!==(n=i[3].t("Enter system prompt"))&&m(t,"placeholder",n),r&2&&Sn(t,i[1].system)},d(i){i&&_(e),o=!1,s()}}}function t0(l){var a;let e,t,n,o,s;function i(c){l[13](c)}let r={admin:((a=l[4])==null?void 0:a.role)==="admin"};return l[1]!==void 0&&(r.params=l[1]),n=new cu({props:r}),We.push(()=>Je(n,"params",i)),{c(){e=V("div"),t=V("div"),ne(n.$$.fragment),this.h()},l(c){e=z(c,"DIV",{class:!0,slot:!0});var u=M(e);t=z(u,"DIV",{});var f=M(t);se(n.$$.fragment,f),f.forEach(_),u.forEach(_),this.h()},h(){m(e,"class","text-sm mt-1.5"),m(e,"slot","content")},m(c,u){A(c,e,u),k(e,t),le(n,t,null),s=!0},p(c,u){var h;const f={};u&16&&(f.admin=((h=c[4])==null?void 0:h.role)==="admin"),!o&&u&2&&(o=!0,f.params=c[1],qe(()=>o=!1)),n.$set(f)},i(c){s||(D(n.$$.fragment,c),s=!0)},o(c){P(n.$$.fragment,c),s=!1},d(c){c&&_(e),oe(n)}}}function n0(l){let e,t,n,o=l[3].t("Chat Controls")+"",s,i,r,a,c,u,f,h,d,p;a=new So({props:{className:"size-3.5"}});const b=[Q1,J1],v=[];function g(w,y){var I,S;return w[4].role==="admin"||(S=(I=w[4])==null?void 0:I.permissions.chat)!=null&&S.controls?0:1}return u=g(l),f=v[u]=b[u](l),{c(){e=V("div"),t=V("div"),n=V("div"),s=Ie(o),i=ee(),r=V("button"),ne(a.$$.fragment),c=ee(),f.c(),this.h()},l(w){e=z(w,"DIV",{class:!0});var y=M(e);t=z(y,"DIV",{class:!0});var I=M(t);n=z(I,"DIV",{class:!0});var S=M(n);s=Se(S,o),S.forEach(_),i=te(I),r=z(I,"BUTTON",{class:!0});var T=M(r);se(a.$$.fragment,T),T.forEach(_),I.forEach(_),c=te(y),f.l(y),y.forEach(_),this.h()},h(){m(n,"class","text-lg font-medium self-center font-primary"),m(r,"class","self-center"),m(t,"class","flex items-center justify-between dark:text-gray-100 mb-2"),m(e,"class","dark:text-white")},m(w,y){A(w,e,y),k(e,t),k(t,n),k(n,s),k(t,i),k(t,r),le(a,r,null),k(e,c),v[u].m(e,null),h=!0,d||(p=ke(r,"click",l[8]),d=!0)},p(w,[y]){(!h||y&8)&&o!==(o=w[3].t("Chat Controls")+"")&&Te(s,o);let I=u;u=g(w),u===I?v[u].p(w,y):(He(),P(v[I],1,1,()=>{v[I]=null}),Be(),f=v[u],f?f.p(w,y):(f=v[u]=b[u](w),f.c()),D(f,1),f.m(e,null))},i(w){h||(D(a.$$.fragment,w),D(f),h=!0)},o(w){P(a.$$.fragment,w),P(f),h=!1},d(w){w&&_(e),oe(a),v[u].d(),d=!1,p()}}}function l0(l,e,t){let n,o;ae(l,Qn,g=>t(4,o=g));const s=cn(),i=Ft("i18n");ae(l,i,g=>t(3,n=g));let{models:r=[]}=e,{chatFiles:a=[]}=e,{params:c={}}=e,u=!1;const f=()=>{s("close")},h=g=>{a.splice(g,1),t(0,a)},d=g=>{console.log(g)};function p(g){u=g,t(2,u)}function b(){c.system=this.value,t(1,c)}function v(g){c=g,t(1,c)}return l.$$set=g=>{"models"in g&&t(7,r=g.models),"chatFiles"in g&&t(0,a=g.chatFiles),"params"in g&&t(1,c=g.params)},[a,c,u,n,o,s,i,r,f,h,d,p,b,v]}class Ha extends Re{constructor(e){super(),Ue(this,e,l0,n0,Fe,{models:7,chatFiles:0,params:1})}}function pi(l,e,t){const n=l.slice();return n[10]=e[t],n}function o0(l){let e;const t=l[4].default,n=Qt(t,l,l[8],null);return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&256)&&xt(n,t,o,o[8],e?en(t,o[8],s,null):$t(o[8]),null)},i(o){e||(D(n,o),e=!0)},o(o){P(n,o),e=!1},d(o){n&&n.d(o)}}}function s0(l){var i;let e,t,n=(((i=l[10])==null?void 0:i.label)??"Camera")+"",o,s;return{c(){e=V("div"),t=V("div"),o=Ie(n),s=ee(),this.h()},l(r){e=z(r,"DIV",{class:!0});var a=M(e);t=z(a,"DIV",{class:!0});var c=M(t);o=Se(c,n),c.forEach(_),a.forEach(_),s=te(r),this.h()},h(){m(t,"class","line-clamp-1"),m(e,"class","flex items-center")},m(r,a){A(r,e,a),k(e,t),k(t,o),A(r,s,a)},p(r,a){var c;a&2&&n!==(n=(((c=r[10])==null?void 0:c.label)??"Camera")+"")&&Te(o,n)},d(r){r&&(_(e),_(s))}}}function bi(l){let e,t;function n(){return l[5](l[10])}return e=new _n({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[s0]},$$scope:{ctx:l}}}),e.$on("click",n),{c(){ne(e.$$.fragment)},l(o){se(e.$$.fragment,o)},m(o,s){le(e,o,s),t=!0},p(o,s){l=o;const i={};s&258&&(i.$$scope={dirty:s,ctx:l}),e.$set(i)},i(o){t||(D(e.$$.fragment,o),t=!0)},o(o){P(e.$$.fragment,o),t=!1},d(o){oe(e,o)}}}function r0(l){let e,t,n=vt(l[1]),o=[];for(let i=0;i<n.length;i+=1)o[i]=bi(pi(l,n,i));const s=i=>P(o[i],1,1,()=>{o[i]=null});return{c(){for(let i=0;i<o.length;i+=1)o[i].c();e=Ae()},l(i){for(let r=0;r<o.length;r+=1)o[r].l(i);e=Ae()},m(i,r){for(let a=0;a<o.length;a+=1)o[a]&&o[a].m(i,r);A(i,e,r),t=!0},p(i,r){if(r&10){n=vt(i[1]);let a;for(a=0;a<n.length;a+=1){const c=pi(i,n,a);o[a]?(o[a].p(c,r),D(o[a],1)):(o[a]=bi(c),o[a].c(),D(o[a],1),o[a].m(e.parentNode,e))}for(He(),a=n.length;a<o.length;a+=1)s(a);Be()}},i(i){if(!t){for(let r=0;r<n.length;r+=1)D(o[r]);t=!0}},o(i){o=o.filter(Boolean);for(let r=0;r<o.length;r+=1)P(o[r]);t=!1},d(i){i&&_(e),Dn(o,i)}}}function i0(l){let e,t,n;return t=new Eo({props:{class:"w-full max-w-[180px] rounded-lg px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-9999 bg-white dark:bg-gray-900 dark:text-white shadow-xs",sideOffset:6,side:"top",align:"start",transition:Xl,$$slots:{default:[r0]},$$scope:{ctx:l}}}),{c(){e=V("div"),ne(t.$$.fragment),this.h()},l(o){e=z(o,"DIV",{slot:!0});var s=M(e);se(t.$$.fragment,s),s.forEach(_),this.h()},h(){m(e,"slot","content")},m(o,s){A(o,e,s),le(t,e,null),n=!0},p(o,s){const i={};s&258&&(i.$$scope={dirty:s,ctx:o}),t.$set(i)},i(o){n||(D(t.$$.fragment,o),n=!0)},o(o){P(t.$$.fragment,o),n=!1},d(o){o&&_(e),oe(t)}}}function a0(l){let e,t,n;function o(i){l[6](i)}let s={$$slots:{content:[i0],default:[o0]},$$scope:{ctx:l}};return l[2]!==void 0&&(s.show=l[2]),e=new ko({props:s}),We.push(()=>Je(e,"show",o)),e.$on("change",l[7]),{c(){ne(e.$$.fragment)},l(i){se(e.$$.fragment,i)},m(i,r){le(e,i,r),n=!0},p(i,[r]){const a={};r&258&&(a.$$scope={dirty:r,ctx:i}),!t&&r&4&&(t=!0,a.show=i[2],qe(()=>t=!1)),e.$set(a)},i(i){n||(D(e.$$.fragment,i),n=!0)},o(i){P(e.$$.fragment,i),n=!1},d(i){oe(e,i)}}}function c0(l,e,t){let{$$slots:n={},$$scope:o}=e;Ft("i18n");const s=cn();let{onClose:i=()=>{}}=e,{devices:r}=e,a=!1;const c=h=>{s("change",h.deviceId)};function u(h){a=h,t(2,a)}const f=h=>{h.detail===!1&&i()};return l.$$set=h=>{"onClose"in h&&t(0,i=h.onClose),"devices"in h&&t(1,r=h.devices),"$$scope"in h&&t(8,o=h.$$scope)},[i,r,a,s,n,c,u,f,o]}class u0 extends Re{constructor(e){super(),Ue(this,e,c0,a0,Fe,{onClose:0,devices:1})}}function vi(l){let e,t,n,o,s,i,r,a,c,u,f,h,d,p,b,v='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5"><path d="M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z"></path></svg>',g,w,y,I=l[4]&&wi(l);function S(C,Y){return C[4]?m0:g0}let T=S(l),E=T(l);const H=[w0,v0],O=[];function B(C,Y){return C[4]?0:1}r=B(l),a=O[r]=H[r](l);function j(C,Y){return C[1]?S0:C[2]?I0:E0}let Z=j(l),R=Z(l);return{c(){e=V("div"),I&&I.c(),t=ee(),n=V("div"),E.c(),o=ee(),s=V("div"),i=V("div"),a.c(),c=ee(),u=V("div"),f=V("button"),h=V("div"),R.c(),d=ee(),p=V("div"),b=V("button"),b.innerHTML=v,this.h()},l(C){e=z(C,"DIV",{class:!0});var Y=M(e);I&&I.l(Y),t=te(Y),n=z(Y,"DIV",{class:!0});var N=M(n);E.l(N),N.forEach(_),o=te(Y),s=z(Y,"DIV",{class:!0});var F=M(s);i=z(F,"DIV",{});var G=M(i);a.l(G),G.forEach(_),c=te(F),u=z(F,"DIV",{});var K=M(u);f=z(K,"BUTTON",{type:!0});var X=M(f);h=z(X,"DIV",{class:!0});var Q=M(h);R.l(Q),Q.forEach(_),X.forEach(_),K.forEach(_),d=te(F),p=z(F,"DIV",{});var U=M(p);b=z(U,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),ut(b)!=="svelte-1k5eavb"&&(b.innerHTML=v),U.forEach(_),F.forEach(_),Y.forEach(_),this.h()},h(){m(n,"class","flex justify-center items-center flex-1 h-full w-full max-h-full"),m(h,"class","line-clamp-1 text-sm font-medium"),m(f,"type","button"),m(b,"class","p-3 rounded-full bg-gray-50 dark:bg-gray-900"),m(b,"type","button"),m(s,"class","flex justify-between items-center pb-2 w-full"),m(e,"class","max-w-lg w-full h-full max-h-[100dvh] flex flex-col justify-between p-3 md:p-6")},m(C,Y){A(C,e,Y),I&&I.m(e,null),k(e,t),k(e,n),E.m(n,null),k(e,o),k(e,s),k(s,i),O[r].m(i,null),k(s,c),k(s,u),k(u,f),k(f,h),R.m(h,null),k(s,d),k(s,p),k(p,b),g=!0,w||(y=[ke(f,"click",l[31]),ke(b,"click",l[32])],w=!0)},p(C,Y){C[4]?I?I.p(C,Y):(I=wi(C),I.c(),I.m(e,t)):I&&(I.d(1),I=null),T===(T=S(C))&&E?E.p(C,Y):(E.d(1),E=T(C),E&&(E.c(),E.m(n,null)));let N=r;r=B(C),r===N?O[r].p(C,Y):(He(),P(O[N],1,1,()=>{O[N]=null}),Be(),a=O[r],a?a.p(C,Y):(a=O[r]=H[r](C),a.c()),D(a,1),a.m(i,null)),Z===(Z=j(C))&&R?R.p(C,Y):(R.d(1),R=Z(C),R&&(R.c(),R.m(h,null)))},i(C){g||(D(a),g=!0)},o(C){P(a),g=!1},d(C){C&&_(e),I&&I.d(),E.d(),O[r].d(),R.d(),w=!1,on(y)}}}function wi(l){let e,t,n;function o(r,a){return r[3]?h0:r[1]||r[2]?d0:f0}let s=o(l),i=s(l);return{c(){e=V("button"),i.c(),this.h()},l(r){e=z(r,"BUTTON",{type:!0,class:!0});var a=M(e);i.l(a),a.forEach(_),this.h()},h(){m(e,"type","button"),m(e,"class","flex justify-center items-center w-full h-20 min-h-20")},m(r,a){A(r,e,a),i.m(e,null),t||(n=ke(e,"click",l[26]),t=!0)},p(r,a){s===(s=o(r))&&i?i.p(r,a):(i.d(1),i=s(r),i&&(i.c(),i.m(e,null)))},d(r){r&&_(e),i.d(),t=!1,n()}}}function f0(l){let e,t,n;return{c(){e=V("div"),this.h()},l(o){e=z(o,"DIV",{class:!0,style:!0}),M(e).forEach(_),this.h()},h(){var o,s,i,r,a,c,u,f,h;m(e,"class",t=(l[6]*100>4?" size-[4.5rem]":l[6]*100>2?" size-16":l[6]*100>1?"size-14":"size-12")+" transition-all rounded-full "+((((i=(s=(o=l[0])==null?void 0:o.info)==null?void 0:s.meta)==null?void 0:i.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white")+" bg-black dark:bg-white"),m(e,"style",n=(((c=(a=(r=l[0])==null?void 0:r.info)==null?void 0:a.meta)==null?void 0:c.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?`background-image: url('${(h=(f=(u=l[0])==null?void 0:u.info)==null?void 0:f.meta)==null?void 0:h.profile_image_url}');`:"")},m(o,s){A(o,e,s)},p(o,s){var i,r,a,c,u,f,h,d,p;s[0]&65&&t!==(t=(o[6]*100>4?" size-[4.5rem]":o[6]*100>2?" size-16":o[6]*100>1?"size-14":"size-12")+" transition-all rounded-full "+((((a=(r=(i=o[0])==null?void 0:i.info)==null?void 0:r.meta)==null?void 0:a.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white")+" bg-black dark:bg-white")&&m(e,"class",t),s[0]&1&&n!==(n=(((f=(u=(c=o[0])==null?void 0:c.info)==null?void 0:u.meta)==null?void 0:f.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?`background-image: url('${(p=(d=(h=o[0])==null?void 0:h.info)==null?void 0:d.meta)==null?void 0:p.profile_image_url}');`:"")&&m(e,"style",n)},d(o){o&&_(e)}}}function d0(l){let e,t,n,o,s,i;return{c(){e=Ne("svg"),t=Ne("style"),n=Ie(`.spinner_qM83 {
								animation: spinner_8HQG 1.05s infinite;
							}
							.spinner_oXPr {
								animation-delay: 0.1s;
							}
							.spinner_ZTLf {
								animation-delay: 0.2s;
							}
							@keyframes spinner_8HQG {
								0%,
								57.14% {
									animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
									transform: translate(0);
								}
								28.57% {
									animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
									transform: translateY(-6px);
								}
								100% {
									transform: translate(0);
								}
							}
						`),o=Ne("circle"),s=Ne("circle"),i=Ne("circle"),this.h()},l(r){e=Pe(r,"svg",{class:!0,viewBox:!0,fill:!0,xmlns:!0});var a=M(e);t=Pe(a,"style",{});var c=M(t);n=Se(c,`.spinner_qM83 {
								animation: spinner_8HQG 1.05s infinite;
							}
							.spinner_oXPr {
								animation-delay: 0.1s;
							}
							.spinner_ZTLf {
								animation-delay: 0.2s;
							}
							@keyframes spinner_8HQG {
								0%,
								57.14% {
									animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
									transform: translate(0);
								}
								28.57% {
									animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
									transform: translateY(-6px);
								}
								100% {
									transform: translate(0);
								}
							}
						`),c.forEach(_),o=Pe(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),M(o).forEach(_),s=Pe(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),M(s).forEach(_),i=Pe(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),M(i).forEach(_),a.forEach(_),this.h()},h(){m(o,"class","spinner_qM83"),m(o,"cx","4"),m(o,"cy","12"),m(o,"r","3"),m(s,"class","spinner_qM83 spinner_oXPr"),m(s,"cx","12"),m(s,"cy","12"),m(s,"r","3"),m(i,"class","spinner_qM83 spinner_ZTLf"),m(i,"cx","20"),m(i,"cy","12"),m(i,"r","3"),m(e,"class","size-12 text-gray-900 dark:text-gray-400"),m(e,"viewBox","0 0 24 24"),m(e,"fill","currentColor"),m(e,"xmlns","http://www.w3.org/2000/svg")},m(r,a){A(r,e,a),k(e,t),k(t,n),k(e,o),k(e,s),k(e,i)},p:we,d(r){r&&_(e)}}}function h0(l){let e,t;return{c(){e=V("div"),t=Ie(l[3]),this.h()},l(n){e=z(n,"DIV",{class:!0,style:!0});var o=M(e);t=Se(o,l[3]),o.forEach(_),this.h()},h(){m(e,"class","transition-all rounded-full"),$e(e,"font-size",(l[6]*100>4?"4.5":l[6]*100>2?"4.25":l[6]*100>1?"3.75":"3.5")+"rem"),$e(e,"width","100%"),$e(e,"text-align","center")},m(n,o){A(n,e,o),k(e,t)},p(n,o){o[0]&8&&Te(t,n[3]),o[0]&64&&$e(e,"font-size",(n[6]*100>4?"4.5":n[6]*100>2?"4.25":n[6]*100>1?"3.75":"3.5")+"rem")},d(n){n&&_(e)}}}function m0(l){let e,t,n,o,s,i,r,a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-6"><path d="M5.28 4.22a.75.75 0 0 0-1.06 1.06L6.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L8 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L9.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L8 6.94 5.28 4.22Z"></path></svg>',c,u;return{c(){e=V("div"),t=V("video"),n=ee(),o=V("canvas"),s=ee(),i=V("div"),r=V("button"),r.innerHTML=a,this.h()},l(f){e=z(f,"DIV",{class:!0});var h=M(e);t=z(h,"VIDEO",{id:!0,class:!0}),M(t).forEach(_),n=te(h),o=z(h,"CANVAS",{id:!0,style:!0}),M(o).forEach(_),s=te(h),i=z(h,"DIV",{class:!0});var d=M(i);r=z(d,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),ut(r)!=="svelte-16ul42n"&&(r.innerHTML=a),d.forEach(_),h.forEach(_),this.h()},h(){m(t,"id","camera-feed"),t.autoplay=!0,m(t,"class","rounded-2xl h-full min-w-full object-cover object-center"),t.playsInline=!0,m(o,"id","camera-canvas"),$e(o,"display","none"),m(r,"type","button"),m(r,"class","p-1.5 text-white cursor-pointer backdrop-blur-xl bg-black/10 rounded-full"),m(i,"class","absolute top-4 md:top-8 left-4"),m(e,"class","relative flex video-container w-full max-h-full pt-2 pb-4 md:py-6 px-2 h-full")},m(f,h){A(f,e,h),k(e,t),k(e,n),k(e,o),k(e,s),k(e,i),k(i,r),c||(u=ke(r,"click",l[28]),c=!0)},p:we,d(f){f&&_(e),c=!1,u()}}}function g0(l){let e,t,n;function o(r,a){return r[3]?b0:r[1]||r[2]?p0:_0}let s=o(l),i=s(l);return{c(){e=V("button"),i.c(),this.h()},l(r){e=z(r,"BUTTON",{type:!0});var a=M(e);i.l(a),a.forEach(_),this.h()},h(){m(e,"type","button")},m(r,a){A(r,e,a),i.m(e,null),t||(n=ke(e,"click",l[27]),t=!0)},p(r,a){s===(s=o(r))&&i?i.p(r,a):(i.d(1),i=s(r),i&&(i.c(),i.m(e,null)))},d(r){r&&_(e),i.d(),t=!1,n()}}}function _0(l){let e,t,n;return{c(){e=V("div"),this.h()},l(o){e=z(o,"DIV",{class:!0,style:!0}),M(e).forEach(_),this.h()},h(){var o,s,i,r,a,c,u,f,h;m(e,"class",t=(l[6]*100>4?" size-52":l[6]*100>2?"size-48":l[6]*100>1?"size-44":"size-40")+" transition-all rounded-full "+((((i=(s=(o=l[0])==null?void 0:o.info)==null?void 0:s.meta)==null?void 0:i.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white")),m(e,"style",n=(((c=(a=(r=l[0])==null?void 0:r.info)==null?void 0:a.meta)==null?void 0:c.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?`background-image: url('${(h=(f=(u=l[0])==null?void 0:u.info)==null?void 0:f.meta)==null?void 0:h.profile_image_url}');`:"")},m(o,s){A(o,e,s)},p(o,s){var i,r,a,c,u,f,h,d,p;s[0]&65&&t!==(t=(o[6]*100>4?" size-52":o[6]*100>2?"size-48":o[6]*100>1?"size-44":"size-40")+" transition-all rounded-full "+((((a=(r=(i=o[0])==null?void 0:i.info)==null?void 0:r.meta)==null?void 0:a.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white"))&&m(e,"class",t),s[0]&1&&n!==(n=(((f=(u=(c=o[0])==null?void 0:c.info)==null?void 0:u.meta)==null?void 0:f.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?`background-image: url('${(p=(d=(h=o[0])==null?void 0:h.info)==null?void 0:d.meta)==null?void 0:p.profile_image_url}');`:"")&&m(e,"style",n)},d(o){o&&_(e)}}}function p0(l){let e,t,n,o,s,i;return{c(){e=Ne("svg"),t=Ne("style"),n=Ie(`.spinner_qM83 {
									animation: spinner_8HQG 1.05s infinite;
								}
								.spinner_oXPr {
									animation-delay: 0.1s;
								}
								.spinner_ZTLf {
									animation-delay: 0.2s;
								}
								@keyframes spinner_8HQG {
									0%,
									57.14% {
										animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
										transform: translate(0);
									}
									28.57% {
										animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
										transform: translateY(-6px);
									}
									100% {
										transform: translate(0);
									}
								}
							`),o=Ne("circle"),s=Ne("circle"),i=Ne("circle"),this.h()},l(r){e=Pe(r,"svg",{class:!0,viewBox:!0,fill:!0,xmlns:!0});var a=M(e);t=Pe(a,"style",{});var c=M(t);n=Se(c,`.spinner_qM83 {
									animation: spinner_8HQG 1.05s infinite;
								}
								.spinner_oXPr {
									animation-delay: 0.1s;
								}
								.spinner_ZTLf {
									animation-delay: 0.2s;
								}
								@keyframes spinner_8HQG {
									0%,
									57.14% {
										animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
										transform: translate(0);
									}
									28.57% {
										animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
										transform: translateY(-6px);
									}
									100% {
										transform: translate(0);
									}
								}
							`),c.forEach(_),o=Pe(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),M(o).forEach(_),s=Pe(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),M(s).forEach(_),i=Pe(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),M(i).forEach(_),a.forEach(_),this.h()},h(){m(o,"class","spinner_qM83"),m(o,"cx","4"),m(o,"cy","12"),m(o,"r","3"),m(s,"class","spinner_qM83 spinner_oXPr"),m(s,"cx","12"),m(s,"cy","12"),m(s,"r","3"),m(i,"class","spinner_qM83 spinner_ZTLf"),m(i,"cx","20"),m(i,"cy","12"),m(i,"r","3"),m(e,"class","size-44 text-gray-900 dark:text-gray-400"),m(e,"viewBox","0 0 24 24"),m(e,"fill","currentColor"),m(e,"xmlns","http://www.w3.org/2000/svg")},m(r,a){A(r,e,a),k(e,t),k(t,n),k(e,o),k(e,s),k(e,i)},p:we,d(r){r&&_(e)}}}function b0(l){let e,t;return{c(){e=V("div"),t=Ie(l[3]),this.h()},l(n){e=z(n,"DIV",{class:!0,style:!0});var o=M(e);t=Se(o,l[3]),o.forEach(_),this.h()},h(){m(e,"class","transition-all rounded-full"),$e(e,"font-size",(l[6]*100>4?"13":l[6]*100>2?"12":l[6]*100>1?"11.5":"11")+"rem"),$e(e,"width","100%"),$e(e,"text-align","center")},m(n,o){A(n,e,o),k(e,t)},p(n,o){o[0]&8&&Te(t,n[3]),o[0]&64&&$e(e,"font-size",(n[6]*100>4?"13":n[6]*100>2?"12":n[6]*100>1?"11.5":"11")+"rem")},d(n){n&&_(e)}}}function v0(l){let e,t;return e=new Rt({props:{content:l[11].t("Camera"),$$slots:{default:[y0]},$$scope:{ctx:l}}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o[0]&2048&&(s.content=n[11].t("Camera")),o[2]&16&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function w0(l){let e,t;return e=new u0({props:{devices:l[8],$$slots:{default:[k0]},$$scope:{ctx:l}}}),e.$on("change",l[29]),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o[0]&256&&(s.devices=n[8]),o[2]&16&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function y0(l){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"></path></svg>',n,o;return{c(){e=V("button"),e.innerHTML=t,this.h()},l(s){e=z(s,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),ut(e)!=="svelte-1n1gs9g"&&(e.innerHTML=t),this.h()},h(){m(e,"class","p-3 rounded-full bg-gray-50 dark:bg-gray-900"),m(e,"type","button")},m(s,i){A(s,e,i),n||(o=ke(e,"click",l[30]),n=!0)},p:we,d(s){s&&_(e),n=!1,o()}}}function k0(l){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5"><path fill-rule="evenodd" d="M15.312 11.424a5.5 5.5 0 0 1-9.201 2.466l-.312-.311h2.433a.75.75 0 0 0 0-1.5H3.989a.75.75 0 0 0-.75.75v4.242a.75.75 0 0 0 1.5 0v-2.43l.31.31a7 7 0 0 0 11.712-3.138.75.75 0 0 0-1.449-.39Zm1.23-3.723a.75.75 0 0 0 .219-.53V2.929a.75.75 0 0 0-1.5 0V5.36l-.31-.31A7 7 0 0 0 3.239 8.188a.75.75 0 1 0 1.448.389A5.5 5.5 0 0 1 13.89 6.11l.311.31h-2.432a.75.75 0 0 0 0 1.5h4.243a.75.75 0 0 0 .53-.219Z" clip-rule="evenodd"></path></svg>';return{c(){e=V("button"),e.innerHTML=t,this.h()},l(n){e=z(n,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),ut(e)!=="svelte-5e0pue"&&(e.innerHTML=t),this.h()},h(){m(e,"class","p-3 rounded-full bg-gray-50 dark:bg-gray-900"),m(e,"type","button")},m(n,o){A(n,e,o)},p:we,d(n){n&&_(e)}}}function E0(l){let e=l[11].t("Listening...")+"",t;return{c(){t=Ie(e)},l(n){t=Se(n,e)},m(n,o){A(n,t,o)},p(n,o){o[0]&2048&&e!==(e=n[11].t("Listening...")+"")&&Te(t,e)},d(n){n&&_(t)}}}function I0(l){let e=l[11].t("Tap to interrupt")+"",t;return{c(){t=Ie(e)},l(n){t=Se(n,e)},m(n,o){A(n,t,o)},p(n,o){o[0]&2048&&e!==(e=n[11].t("Tap to interrupt")+"")&&Te(t,e)},d(n){n&&_(t)}}}function S0(l){let e=l[11].t("Thinking...")+"",t;return{c(){t=Ie(e)},l(n){t=Se(n,e)},m(n,o){A(n,t,o)},p(n,o){o[0]&2048&&e!==(e=n[11].t("Thinking...")+"")&&Te(t,e)},d(n){n&&_(t)}}}function D0(l){let e,t,n=l[10]&&vi(l);return{c(){n&&n.c(),e=Ae()},l(o){n&&n.l(o),e=Ae()},m(o,s){n&&n.m(o,s),A(o,e,s),t=!0},p(o,s){o[10]?n?(n.p(o,s),s[0]&1024&&D(n,1)):(n=vi(o),n.c(),D(n,1),n.m(e.parentNode,e)):n&&(He(),P(n,1,1,()=>{n=null}),Be())},i(o){t||(D(n),t=!0)},o(o){P(n),t=!1},d(o){o&&_(e),n&&n.d(o)}}}function C0(l,e,t){let n,o,s,i,r,a;ae(l,dl,de=>t(45,n=de)),ae(l,Yl,de=>t(46,o=de)),ae(l,Kn,de=>t(47,s=de)),ae(l,xa,de=>t(48,i=de)),ae(l,In,de=>t(10,r=de));const c=cn(),u=Ft("i18n");ae(l,u,de=>t(11,a=de));let{eventTarget:f}=e,{submitPrompt:h}=e,{stopResponse:d}=e,{files:p}=e,{chatId:b}=e,{modelId:v}=e,g=null,w=null,y=!1,I=!1,S=!1,T=null,E=!1,H=null,O=!1,B=0,j=!1,Z,R=null,C=[],Y=[],N=null;const F=async()=>{const de=await navigator.mediaDevices.enumerateDevices();t(8,Y=de.filter(De=>De.kind==="videoinput")),navigator.mediaDevices.getDisplayMedia&&t(8,Y=[...Y,{deviceId:"screen",label:"Screen Share"}]),console.log(Y),N===null&&Y.length>0&&t(9,N=Y[0].deviceId)},G=async()=>{if(await F(),H===null){t(4,E=!0),await xe();try{await K()}catch(de){console.error("Error accessing webcam: ",de)}}},K=async()=>{const de=document.getElementById("camera-feed");de&&(N==="screen"?t(5,H=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:!1})):t(5,H=await navigator.mediaDevices.getUserMedia({video:{deviceId:N?{exact:N}:void 0}})),H&&(await F(),de.srcObject=H,await de.play()))},X=async()=>{H&&H.getTracks().forEach(De=>De.stop()),t(5,H=null)},Q=()=>{const de=document.getElementById("camera-feed"),De=document.getElementById("camera-canvas");if(!De)return;const Ve=De.getContext("2d");De.width=de.videoWidth,De.height=de.videoHeight,Ve.drawImage(de,0,0,de.videoWidth,de.videoHeight);const Ge=De.toDataURL("image/png");return console.log(Ge),Ge},U=async()=>{await X(),t(4,E=!1)},J=-55,q=async de=>{await xe();const De=Ki(de,"recording.wav"),Ve=await Zi(localStorage.token,De).catch(Ge=>(nt.error(`${Ge}`),null));if(Ve&&(console.log(Ve.text),Ve.text!=="")){const Ge=await h(Ve.text,{_raw:!0});console.log(Ge)}},ce=async(de=!0)=>{if(r){console.log("%c%s","color: red; font-size: 20px;","ðŸš¨ stopRecordingCallback ðŸš¨");const De=C.slice(0);if(C=[],Z=!1,de&&ge(),I){if(t(1,y=!0),t(3,T=null),H){const Ge=Q();t(20,p=[{type:"image",url:Ge}])}const Ve=new Blob(De,{type:"audio/wav"});await q(Ve),I=!1,t(1,y=!1)}}else C=[],Z=!1,R&&R.getTracks().forEach(Ve=>Ve.stop()),t(7,R=null)},ge=async()=>{r&&(R||t(7,R=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}})),Z=new MediaRecorder(R),Z.onstart=()=>{console.log("Recording started"),C=[],x(R)},Z.ondataavailable=de=>{j&&C.push(de.data)},Z.onstop=de=>{console.log("Recording stopped",R,de),ce()},Z.start())},re=async()=>{try{Z&&Z.stop()}catch(de){console.log("Error stopping audio stream:",de)}R&&(R.getAudioTracks().forEach(function(de){de.stop()}),t(7,R=null))},Oe=de=>{let De=0;for(let Ve=0;Ve<de.length;Ve++){const Ge=(de[Ve]-128)/128;De+=Ge*Ge}return Math.sqrt(De/de.length)},x=de=>{const De=new AudioContext,Ve=De.createMediaStreamSource(de),Ge=De.createAnalyser();Ge.minDecibels=J,Ve.connect(Ge);const It=Ge.frequencyBinCount,kt=new Uint8Array(It),Mt=new Uint8Array(Ge.fftSize);let Tt=Date.now();j=!1,console.log("ðŸ”Š Sound detection started",Tt,j),(()=>{const Bt=()=>{if(!Z||!r)return;if(S&&!((s==null?void 0:s.voiceInterruption)??!1)?(Ge.maxDecibels=0,Ge.minDecibels=-1):(Ge.minDecibels=J,Ge.maxDecibels=-30),Ge.getByteTimeDomainData(Mt),Ge.getByteFrequencyData(kt),t(6,B=Oe(Mt)),kt.some(Kt=>Kt>0)&&(console.log("%c%s","color: red; font-size: 20px;","ðŸ”Š Sound detected"),j||(j=!0,lt()),Tt=Date.now()),j&&Date.now()-Tt>2e3&&(I=!0,Z)){console.log("%c%s","color: red; font-size: 20px;","ðŸ”‡ Silence detected"),Z.stop();return}window.requestAnimationFrame(Bt)};window.requestAnimationFrame(Bt)})()};let ue={},Ee=null,Xe=null;const Ke=de=>r?new Promise(De=>{let Ve=[];const Ge=setInterval(async()=>{var It,kt,Mt;if(Ve=await speechSynthesis.getVoices(),Ve.length>0){clearInterval(Ge);const Tt=((It=Ve==null?void 0:Ve.filter(sn=>{var Bt,At,Kt,Gt;return sn.voiceURI===(((At=(Bt=s==null?void 0:s.audio)==null?void 0:Bt.tts)==null?void 0:At.voice)??((Gt=(Kt=o==null?void 0:o.audio)==null?void 0:Kt.tts)==null?void 0:Gt.voice))}))==null?void 0:It.at(0))??void 0;Xe=new SpeechSynthesisUtterance(de),Xe.rate=((Mt=(kt=s.audio)==null?void 0:kt.tts)==null?void 0:Mt.playbackRate)??1,Tt&&(Xe.voice=Tt),speechSynthesis.speak(Xe),Xe.onend=async sn=>{await new Promise(Bt=>setTimeout(Bt,200)),De(sn)}}},100)}):Promise.resolve(),fe=de=>r?new Promise(De=>{var Ge,It;const Ve=document.getElementById("audioElement");Ve&&(Ve.src=de.src,Ve.muted=!0,Ve.playbackRate=((It=(Ge=s.audio)==null?void 0:Ge.tts)==null?void 0:It.playbackRate)??1,Ve.play().then(()=>{Ve.muted=!1}).catch(kt=>{console.error(kt)}),Ve.onended=async kt=>{await new Promise(Mt=>setTimeout(Mt,100)),De(kt)})}):Promise.resolve(),lt=async()=>{t(2,S=!1),O&&d(),Xe&&(speechSynthesis.cancel(),Xe=null);const de=document.getElementById("audioElement");de&&(de.muted=!0,de.pause(),de.currentTime=0)};let it=new AbortController;const Nt=new Map,Dt=new Map,Ht=async de=>{var De,Ve,Ge,It,kt,Mt,Tt,sn,Bt,At,Kt,Gt,tn,rn;if(!Nt.has(de))try{if((s==null?void 0:s.showEmojiInCall)??!1){const Wt=await Vc(localStorage.token,v,de,b);Wt&&Dt.set(de,Wt)}if(((Ve=(De=s.audio)==null?void 0:De.tts)==null?void 0:Ve.engine)==="browser-kokoro"){const Wt=await i.generate({text:de,voice:((It=(Ge=s==null?void 0:s.audio)==null?void 0:Ge.tts)==null?void 0:It.voice)??((Mt=(kt=o==null?void 0:o.audio)==null?void 0:kt.tts)==null?void 0:Mt.voice)}).catch(_t=>{console.error(_t),nt.error(`${_t}`)});Wt&&Nt.set(de,new Audio(Wt))}else if(o.audio.tts.engine!==""){const Wt=await Lc(localStorage.token,((sn=(Tt=s==null?void 0:s.audio)==null?void 0:Tt.tts)==null?void 0:sn.defaultVoice)===o.audio.tts.voice?((At=(Bt=s==null?void 0:s.audio)==null?void 0:Bt.tts)==null?void 0:At.voice)??((Gt=(Kt=o==null?void 0:o.audio)==null?void 0:Kt.tts)==null?void 0:Gt.voice):(rn=(tn=o==null?void 0:o.audio)==null?void 0:tn.tts)==null?void 0:rn.voice,de).catch(_t=>(console.error(_t),null));if(Wt){const _t=await Wt.blob(),W=URL.createObjectURL(_t);Nt.set(de,new Audio(W))}}else Nt.set(de,!0)}catch(Wt){console.error("Error synthesizing speech:",Wt)}return Nt.get(de)};let wt={};const Ut=async(de,De)=>{for(;!De.aborted;)if(wt[de]&&wt[de].length>0){const Ve=wt[de].shift();if(Nt.has(Ve))if(((s==null?void 0:s.showEmojiInCall)??!1)&&Dt.has(Ve)?t(3,T=Dt.get(Ve)):t(3,T=null),o.audio.tts.engine!=="")try{console.log("%c%s","color: red; font-size: 20px;",`Playing audio for content: ${Ve}`);const Ge=Nt.get(Ve);await fe(Ge),console.log(`Played audio for content: ${Ve}`),await new Promise(It=>setTimeout(It,200))}catch(Ge){console.error("Error playing audio:",Ge)}else await Ke(Ve);else wt[de].unshift(Ve),console.log(`Audio for "${Ve}" not yet available in the cache, re-queued...`),await new Promise(Ge=>setTimeout(Ge,200))}else if(ue[de]&&wt[de]&&wt[de].length===0){t(2,S=!1);break}else await new Promise(Ve=>setTimeout(Ve,200));console.log(`Audio monitoring and playing stopped for message ID ${de}`)},pe=async de=>{const{id:De}=de.detail;O=!0,Ee!==De&&(console.log(`Received chat start event for message ID ${De}`),Ee=De,it&&it.abort(),it=new AbortController,t(2,S=!0),Ut(De,it.signal))},Ye=async de=>{const{id:De,content:Ve}=de.detail;if(Ee===De){console.log(`Received chat event for message ID ${De}: ${Ve}`);try{wt[De]===void 0?wt[De]=[Ve]:wt[De].push(Ve),console.log(Ve),Ht(Ve)}catch(Ge){console.error("Failed to fetch or play audio:",Ge)}}},ot=async de=>{const{id:De,content:Ve}=de.detail;ue[De]=!0,O=!1};pn(async()=>{const de=async()=>{try{g=await navigator.wakeLock.request("screen")}catch(De){console.log(De)}g&&g.addEventListener("release",()=>{console.log("Wake Lock released")})};return"wakeLock"in navigator&&(await de(),document.addEventListener("visibilitychange",async()=>{g!==null&&document.visibilityState==="visible"&&await de()})),t(0,w=n.find(De=>De.id===v)),ge(),f.addEventListener("chat:start",pe),f.addEventListener("chat",Ye),f.addEventListener("chat:finish",ot),async()=>{await lt(),re(),f.removeEventListener("chat:start",pe),f.removeEventListener("chat",Ye),f.removeEventListener("chat:finish",ot),it.abort(),await xe(),await lt(),await ce(!1),await U()}}),nl(async()=>{await lt(),await ce(!1),await U(),await re(),f.removeEventListener("chat:start",pe),f.removeEventListener("chat",Ye),f.removeEventListener("chat:finish",ot),it.abort(),await xe(),await lt()});const he=()=>{S&&lt()},yt=()=>{S&&lt()},ht=()=>{U()},bt=async de=>{console.log(de.detail),t(9,N=de.detail),await X(),await K()},Ce=async()=>{await navigator.mediaDevices.getUserMedia({video:!0}),G()},Pt=()=>{S&&lt()},mt=async()=>{await re(),await X(),console.log(R),console.log(H),In.set(!1),c("close")};return l.$$set=de=>{"eventTarget"in de&&t(21,f=de.eventTarget),"submitPrompt"in de&&t(22,h=de.submitPrompt),"stopResponse"in de&&t(23,d=de.stopResponse),"files"in de&&t(20,p=de.files),"chatId"in de&&t(24,b=de.chatId),"modelId"in de&&t(25,v=de.modelId)},[w,y,S,T,E,H,B,R,Y,N,r,a,c,u,G,K,X,U,re,lt,p,f,h,d,b,v,he,yt,ht,bt,Ce,Pt,mt]}class Ba extends Re{constructor(e){super(),Ue(this,e,C0,D0,Fe,{eventTarget:21,submitPrompt:22,stopResponse:23,files:20,chatId:24,modelId:25},null,[-1,-1,-1])}}function M0(l){var I,S,T,E,H,O,B,j,Z,R;let e,t,n,o,s,i,r=(((S=(I=l[0])==null?void 0:I.model)==null?void 0:S.name)??((E=(T=l[0])==null?void 0:T.message)==null?void 0:E.model)??"Assistant")+"",a,c,u,f,h,d,p,b,v;t=new Qi({props:{src:((j=(B=(O=(H=l[0])==null?void 0:H.model)==null?void 0:O.info)==null?void 0:B.meta)==null?void 0:j.profile_image_url)??"",className:"size-5 -translate-y-[1px]"}}),f=new gu({props:{className:"size-3 "+((R=(Z=l[0])==null?void 0:Z.message)!=null&&R.favorite?"fill-red-500 stroke-red-500":"hover:fill-red-500 hover:stroke-red-500")+" ",strokeWidth:"2.5"}});function g(C,Y){var N,F;return(F=(N=C[0])==null?void 0:N.message)!=null&&F.error?z0:V0}let w=g(l),y=w(l);return{c(){e=V("div"),ne(t.$$.fragment),n=ee(),o=V("div"),s=V("div"),i=V("div"),a=Ie(r),c=ee(),u=V("button"),ne(f.$$.fragment),d=ee(),y.c(),this.h()},l(C){e=z(C,"DIV",{class:!0});var Y=M(e);se(t.$$.fragment,Y),n=te(Y),o=z(Y,"DIV",{class:!0});var N=M(o);s=z(N,"DIV",{class:!0});var F=M(s);i=z(F,"DIV",{class:!0});var G=M(i);a=Se(G,r),G.forEach(_),c=te(F),u=z(F,"BUTTON",{class:!0});var K=M(u);se(f.$$.fragment,K),K.forEach(_),F.forEach(_),d=te(N),y.l(N),N.forEach(_),Y.forEach(_),this.h()},h(){var C,Y;m(i,"class","text-xs text-black dark:text-white font-medium line-clamp-1"),m(u,"class",h=(Y=(C=l[0])==null?void 0:C.message)!=null&&Y.favorite?"":"invisible group-hover:visible"),m(s,"class","flex justify-between items-center"),m(o,"class","ml-2"),m(e,"class","flex w-full")},m(C,Y){A(C,e,Y),le(t,e,null),k(e,n),k(e,o),k(o,s),k(s,i),k(i,a),k(s,c),k(s,u),le(f,u,null),k(o,d),y.m(o,null),p=!0,b||(v=ke(u,"click",l[1]),b=!0)},p(C,Y){var G,K,X,Q,U,J,q,ce,ge,re,Oe,x;const N={};Y&1&&(N.src=((Q=(X=(K=(G=C[0])==null?void 0:G.model)==null?void 0:K.info)==null?void 0:X.meta)==null?void 0:Q.profile_image_url)??""),t.$set(N),(!p||Y&1)&&r!==(r=(((J=(U=C[0])==null?void 0:U.model)==null?void 0:J.name)??((ce=(q=C[0])==null?void 0:q.message)==null?void 0:ce.model)??"Assistant")+"")&&Te(a,r);const F={};Y&1&&(F.className="size-3 "+((re=(ge=C[0])==null?void 0:ge.message)!=null&&re.favorite?"fill-red-500 stroke-red-500":"hover:fill-red-500 hover:stroke-red-500")+" "),f.$set(F),(!p||Y&1&&h!==(h=(x=(Oe=C[0])==null?void 0:Oe.message)!=null&&x.favorite?"":"invisible group-hover:visible"))&&m(u,"class",h),w===(w=g(C))&&y?y.p(C,Y):(y.d(1),y=w(C),y&&(y.c(),y.m(o,null)))},i(C){p||(D(t.$$.fragment,C),D(f.$$.fragment,C),p=!0)},o(C){P(t.$$.fragment,C),P(f.$$.fragment,C),p=!1},d(C){C&&_(e),oe(t),oe(f),y.d(),b=!1,v()}}}function T0(l){var p,b,v;let e,t,n,o,s,i,r=(((b=(p=l[0])==null?void 0:p.user)==null?void 0:b.name)??"User")+"",a,c,u;t=new Qi({props:{src:((v=l[0].user)==null?void 0:v.profile_image_url)??"/user.png",className:"size-5 -translate-y-[1px]"}});function f(g,w){var y,I;return(I=(y=g[0])==null?void 0:y.message)!=null&&I.error?P0:N0}let h=f(l),d=h(l);return{c(){e=V("div"),ne(t.$$.fragment),n=ee(),o=V("div"),s=V("div"),i=V("div"),a=Ie(r),c=ee(),d.c(),this.h()},l(g){e=z(g,"DIV",{class:!0});var w=M(e);se(t.$$.fragment,w),n=te(w),o=z(w,"DIV",{class:!0});var y=M(o);s=z(y,"DIV",{class:!0});var I=M(s);i=z(I,"DIV",{class:!0});var S=M(i);a=Se(S,r),S.forEach(_),I.forEach(_),c=te(y),d.l(y),y.forEach(_),w.forEach(_),this.h()},h(){m(i,"class","text-xs text-black dark:text-white font-medium line-clamp-1"),m(s,"class","flex justify-between items-center"),m(o,"class","ml-2"),m(e,"class","flex w-full")},m(g,w){A(g,e,w),le(t,e,null),k(e,n),k(e,o),k(o,s),k(s,i),k(i,a),k(o,c),d.m(o,null),u=!0},p(g,w){var I,S,T;const y={};w&1&&(y.src=((I=g[0].user)==null?void 0:I.profile_image_url)??"/user.png"),t.$set(y),(!u||w&1)&&r!==(r=(((T=(S=g[0])==null?void 0:S.user)==null?void 0:T.name)??"User")+"")&&Te(a,r),h===(h=f(g))&&d?d.p(g,w):(d.d(1),d=h(g),d&&(d.c(),d.m(o,null)))},i(g){u||(D(t.$$.fragment,g),u=!0)},o(g){P(t.$$.fragment,g),u=!1},d(g){g&&_(e),oe(t),d.d()}}}function V0(l){let e,t=l[0].message.content+"",n;return{c(){e=V("div"),n=Ie(t),this.h()},l(o){e=z(o,"DIV",{class:!0});var s=M(e);n=Se(s,t),s.forEach(_),this.h()},h(){m(e,"class","text-gray-500 line-clamp-2 text-xs mt-0.5")},m(o,s){A(o,e,s),k(e,n)},p(o,s){s&1&&t!==(t=o[0].message.content+"")&&Te(n,t)},d(o){o&&_(e)}}}function z0(l){let e,t=l[0].message.error.content+"",n;return{c(){e=V("div"),n=Ie(t),this.h()},l(o){e=z(o,"DIV",{class:!0});var s=M(e);n=Se(s,t),s.forEach(_),this.h()},h(){m(e,"class","text-red-500 line-clamp-2 text-xs mt-0.5")},m(o,s){A(o,e,s),k(e,n)},p(o,s){s&1&&t!==(t=o[0].message.error.content+"")&&Te(n,t)},d(o){o&&_(e)}}}function N0(l){let e,t=l[0].message.content+"",n;return{c(){e=V("div"),n=Ie(t),this.h()},l(o){e=z(o,"DIV",{class:!0});var s=M(e);n=Se(s,t),s.forEach(_),this.h()},h(){m(e,"class","text-gray-500 line-clamp-2 text-xs mt-0.5")},m(o,s){A(o,e,s),k(e,n)},p(o,s){s&1&&t!==(t=o[0].message.content+"")&&Te(n,t)},d(o){o&&_(e)}}}function P0(l){let e,t=l[0].message.error.content+"",n;return{c(){e=V("div"),n=Ie(t),this.h()},l(o){e=z(o,"DIV",{class:!0});var s=M(e);n=Se(s,t),s.forEach(_),this.h()},h(){m(e,"class","text-red-500 line-clamp-2 text-xs mt-0.5")},m(o,s){A(o,e,s),k(e,n)},p(o,s){s&1&&t!==(t=o[0].message.error.content+"")&&Te(n,t)},d(o){o&&_(e)}}}function O0(l){let e,t,n,o;const s=[T0,M0],i=[];function r(a,c){return a[0].message.role==="user"?0:1}return e=r(l),t=i[e]=s[e](l),{c(){t.c(),n=Ae()},l(a){t.l(a),n=Ae()},m(a,c){i[e].m(a,c),A(a,n,c),o=!0},p(a,c){let u=e;e=r(a),e===u?i[e].p(a,c):(He(),P(i[u],1,1,()=>{i[u]=null}),Be(),t=i[e],t?t.p(a,c):(t=i[e]=s[e](a),t.c()),D(t,1),t.m(n.parentNode,n))},i(a){o||(D(t),o=!0)},o(a){P(t),o=!1},d(a){a&&_(n),i[e].d(a)}}}function H0(l){var a,c;let e,t,n,o,s,i,r;return t=new Rt({props:{content:(c=(a=l[0])==null?void 0:a.message)!=null&&c.error?l[0].message.error.content:l[0].message.content,class:"w-full",allowHTML:!1,$$slots:{default:[O0]},$$scope:{ctx:l}}}),o=new Tl({props:{type:"target",position:rt.Top,class:"w-2 rounded-full dark:bg-gray-900"}}),i=new Tl({props:{type:"source",position:rt.Bottom,class:"w-2 rounded-full dark:bg-gray-900"}}),{c(){e=V("div"),ne(t.$$.fragment),n=ee(),ne(o.$$.fragment),s=ee(),ne(i.$$.fragment),this.h()},l(u){e=z(u,"DIV",{class:!0});var f=M(e);se(t.$$.fragment,f),n=te(f),se(o.$$.fragment,f),s=te(f),se(i.$$.fragment,f),f.forEach(_),this.h()},h(){m(e,"class","px-4 py-3 shadow-md rounded-xl dark:bg-black bg-white border dark:border-gray-900 w-60 h-20 group")},m(u,f){A(u,e,f),le(t,e,null),k(e,n),le(o,e,null),k(e,s),le(i,e,null),r=!0},p(u,[f]){var d,p;const h={};f&1&&(h.content=(p=(d=u[0])==null?void 0:d.message)!=null&&p.error?u[0].message.error.content:u[0].message.content),f&5&&(h.$$scope={dirty:f,ctx:u}),t.$set(h)},i(u){r||(D(t.$$.fragment,u),D(o.$$.fragment,u),D(i.$$.fragment,u),r=!0)},o(u){P(t.$$.fragment,u),P(o.$$.fragment,u),P(i.$$.fragment,u),r=!1},d(u){u&&_(e),oe(t),oe(o),oe(i)}}}function B0(l,e,t){let{data:n}=e;const o=()=>{var s;t(0,n.message.favorite=!(((s=n==null?void 0:n.message)==null?void 0:s.favorite)??!1),n)};return l.$$set=s=>{"data"in s&&t(0,n=s.data)},[n,o]}class A0 extends Re{constructor(e){super(),Ue(this,e,B0,H0,Fe,{data:0})}}function L0(l){let e,t,n,o;return e=new D1({props:{showLock:!1}}),n=new L1({props:{variant:qn.Dots}}),{c(){ne(e.$$.fragment),t=ee(),ne(n.$$.fragment)},l(s){se(e.$$.fragment,s),t=te(s),se(n.$$.fragment,s)},m(s,i){le(e,s,i),A(s,t,i),le(n,s,i),o=!0},p:we,i(s){o||(D(e.$$.fragment,s),D(n.$$.fragment,s),o=!0)},o(s){P(e.$$.fragment,s),P(n.$$.fragment,s),o=!1},d(s){s&&_(t),oe(e,s),oe(n,s)}}}function R0(l){let e,t;return e=new xg({props:{nodes:l[0],nodeTypes:l[1],edges:l[2],fitView:!0,minZoom:.001,colorMode:l[3].includes("dark")||l[3]==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",nodesConnectable:!1,nodesDraggable:!1,oninit:l[5],$$slots:{default:[L0]},$$scope:{ctx:l}}}),e.$on("nodeclick",l[6]),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,[o]){const s={};o&1&&(s.nodes=n[0]),o&2&&(s.nodeTypes=n[1]),o&4&&(s.edges=n[2]),o&8&&(s.colorMode=n[3].includes("dark")||n[3]==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),o&128&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function U0(l,e,t){let n;ae(l,$a,u=>t(3,n=u));const o=cn();let{nodes:s}=e,{nodeTypes:i}=e,{edges:r}=e;const a=()=>{console.log("Flow initialized")},c=u=>o("nodeclick",u.detail);return l.$$set=u=>{"nodes"in u&&t(0,s=u.nodes),"nodeTypes"in u&&t(1,i=u.nodeTypes),"edges"in u&&t(2,r=u.edges)},[s,i,r,n,o,a,c]}class W0 extends Re{constructor(e){super(),Ue(this,e,U0,R0,Fe,{nodes:0,nodeTypes:1,edges:2})}}function F0(l){let e,t;return{c(){e=Ne("svg"),t=Ne("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var o=M(e);t=Pe(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),M(t).forEach(_),o.forEach(_),this.h()},h(){m(t,"stroke-linecap","round"),m(t,"stroke-linejoin","round"),m(t,"d","M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","none"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width",l[1]),m(e,"stroke","currentColor"),m(e,"class",l[0])},m(n,o){A(n,e,o),k(e,t)},p(n,[o]){o&2&&m(e,"stroke-width",n[1]),o&1&&m(e,"class",n[0])},i:we,o:we,d(n){n&&_(e)}}}function j0(l,e,t){let{className:n="size-4"}=e,{strokeWidth:o="1.5"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}class Aa extends Re{constructor(e){super(),Ue(this,e,j0,F0,Fe,{className:0,strokeWidth:1})}}function yi(l){let e,t;return e=new W0({props:{nodes:l[6],nodeTypes:l[8],edges:l[7]}}),e.$on("nodeclick",l[12]),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p:we,i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function Y0(l){let e,t,n,o,s,i,r,a=l[1].t("Chat Overview")+"",c,u,f,h,d,p,b,v;s=new Aa({props:{className:"size-3.5"}}),h=new So({props:{className:"size-3.5"}});let g=l[2].length>0&&yi(l);return{c(){e=V("div"),t=V("div"),n=V("div"),o=V("button"),ne(s.$$.fragment),i=ee(),r=V("div"),c=Ie(a),u=ee(),f=V("button"),ne(h.$$.fragment),d=ee(),g&&g.c(),this.h()},l(w){e=z(w,"DIV",{class:!0});var y=M(e);t=z(y,"DIV",{class:!0});var I=M(t);n=z(I,"DIV",{class:!0});var S=M(n);o=z(S,"BUTTON",{class:!0});var T=M(o);se(s.$$.fragment,T),T.forEach(_),i=te(S),r=z(S,"DIV",{class:!0});var E=M(r);c=Se(E,a),E.forEach(_),S.forEach(_),u=te(I),f=z(I,"BUTTON",{class:!0});var H=M(f);se(h.$$.fragment,H),H.forEach(_),I.forEach(_),d=te(y),g&&g.l(y),y.forEach(_),this.h()},h(){m(o,"class","self-center p-0.5"),m(r,"class","text-lg font-medium self-center font-primary"),m(n,"class","flex items-center gap-2.5"),m(f,"class","self-center p-0.5"),m(t,"class","absolute z-50 w-full flex justify-between dark:text-gray-100 px-4 py-3.5"),m(e,"class","w-full h-full relative")},m(w,y){A(w,e,y),k(e,t),k(t,n),k(n,o),le(s,o,null),k(n,i),k(n,r),k(r,c),k(t,u),k(t,f),le(h,f,null),k(e,d),g&&g.m(e,null),p=!0,b||(v=[ke(o,"click",l[10]),ke(f,"click",l[11])],b=!0)},p(w,[y]){(!p||y&2)&&a!==(a=w[1].t("Chat Overview")+"")&&Te(c,a),w[2].length>0?g?(g.p(w,y),y&4&&D(g,1)):(g=yi(w),g.c(),D(g,1),g.m(e,null)):g&&(He(),P(g,1,1,()=>{g=null}),Be())},i(w){p||(D(s.$$.fragment,w),D(h.$$.fragment,w),D(g),p=!0)},o(w){P(s.$$.fragment,w),P(h.$$.fragment,w),P(g),p=!1},d(w){w&&_(e),oe(s),oe(h),g&&g.d(),b=!1,on(v)}}}function X0(l,e,t){let n,o,s,i;ae(l,dl,O=>t(13,n=O)),ae(l,Qn,O=>t(14,o=O));const r=cn(),a=Ft("i18n");ae(l,a,O=>t(1,s=O));const{width:c,height:u}=Xt(),{fitView:f,getViewport:h}=R1(),d=U1();let{history:p}=e,b=null;const v=Qe([]);ae(l,v,O=>t(2,i=O));const g=Qe([]),w={custom:A0},y=async()=>{b===null?await f({nodes:[{id:p.currentId}]}):await f({nodes:[{id:b}]}),t(0,b=null)},I=async()=>{const O=[],B=[];let R=new Map,C={};Object.keys(p.messages).forEach(Y=>{var G;const N=p.messages[Y],F=N.parentId?(((G=R.get(N.parentId))==null?void 0:G.level)??-1)+1:0;C[F]||(C[F]=0),R.set(Y,{id:N.id,level:F,position:C[F]++})}),Object.keys(p.messages).forEach(Y=>{const N=R.get(Y),F=N.position*250,G=N.level*150,K=F;O.push({id:N.id,type:"custom",data:{user:o,message:p.messages[Y],model:n.find(Q=>Q.id===p.messages[Y].model)},position:{x:K,y:G}});const X=p.messages[Y].parentId;X&&B.push({id:X+"-"+N.id,source:X,target:N.id,selectable:!1,class:" dark:fill-gray-300 fill-gray-300",type:"smoothstep",animated:p.currentId===Y||S(Y,p.currentId)})}),await g.set([...B]),await v.set([...O])},S=(O,B)=>{const j=p.messages[O];return j.childrenIds&&j.childrenIds.some(Z=>Z===B||S(Z,B))};pn(()=>{I(),d.subscribe(async O=>{O&&(await xe(),await f({nodes:[{id:p.currentId}]}))}),c.subscribe(O=>{O&&f({nodes:[{id:p.currentId}]})}),u.subscribe(O=>{O&&f({nodes:[{id:p.currentId}]})})}),nl(()=>{console.log("Overview destroyed"),v.set([]),g.set([])});const T=()=>{Zn.set(!1)},E=()=>{r("close"),Zn.set(!1)},H=O=>{console.log(O.detail.node.data),r("nodeclick",O.detail),t(0,b=O.detail.node.data.message.id),f({nodes:[{id:b}]})};return l.$$set=O=>{"history"in O&&t(9,p=O.history)},l.$$.update=()=>{l.$$.dirty&512&&p&&I(),l.$$.dirty&512&&p&&p.currentId&&y()},[b,s,i,r,a,f,v,g,w,p,T,E,H]}class La extends Re{constructor(e){super(),Ue(this,e,X0,Y0,Fe,{history:9})}}function K0(l){let e,t;return{c(){e=Ne("svg"),t=Ne("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var o=M(e);t=Pe(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),M(t).forEach(_),o.forEach(_),this.h()},h(){m(t,"stroke-linecap","round"),m(t,"stroke-linejoin","round"),m(t,"d","M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","none"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width",l[1]),m(e,"stroke","currentColor"),m(e,"class",l[0])},m(n,o){A(n,e,o),k(e,t)},p(n,[o]){o&2&&m(e,"stroke-width",n[1]),o&1&&m(e,"class",n[0])},i:we,o:we,d(n){n&&_(e)}}}function Z0(l,e,t){let{className:n="size-4"}=e,{strokeWidth:o="1.5"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}class G0 extends Re{constructor(e){super(),Ue(this,e,Z0,K0,Fe,{className:0,strokeWidth:1})}}function ki(l){let e;return{c(){e=V("div"),this.h()},l(t){e=z(t,"DIV",{class:!0}),M(e).forEach(_),this.h()},h(){m(e,"class","absolute top-0 left-0 right-0 bottom-0 z-10")},m(t,n){A(t,e,n)},d(t){t&&_(e)}}}function q0(l){let e,t=l[5].t("No HTML, CSS, or JavaScript content found.")+"",n;return{c(){e=V("div"),n=Ie(t),this.h()},l(o){e=z(o,"DIV",{class:!0});var s=M(e);n=Se(s,t),s.forEach(_),this.h()},h(){m(e,"class","m-auto font-medium text-xs text-gray-900 dark:text-white")},m(o,s){A(o,e,s),k(e,n)},p(o,s){s&32&&t!==(t=o[5].t("No HTML, CSS, or JavaScript content found.")+"")&&Te(n,t)},i:we,o:we,d(o){o&&_(e)}}}function J0(l){let e,t,n,o;const s=[x0,Q0],i=[];function r(a,c){return a[1][a[2]].type==="iframe"?0:a[1][a[2]].type==="svg"?1:-1}return~(t=r(l))&&(n=i[t]=s[t](l)),{c(){e=V("div"),n&&n.c(),this.h()},l(a){e=z(a,"DIV",{class:!0});var c=M(e);n&&n.l(c),c.forEach(_),this.h()},h(){m(e,"class","max-w-full w-full h-full")},m(a,c){A(a,e,c),~t&&i[t].m(e,null),o=!0},p(a,c){let u=t;t=r(a),t===u?~t&&i[t].p(a,c):(n&&(He(),P(i[u],1,1,()=>{i[u]=null}),Be()),~t?(n=i[t],n?n.p(a,c):(n=i[t]=s[t](a),n.c()),D(n,1),n.m(e,null)):n=null)},i(a){o||(D(n),o=!0)},o(a){P(n),o=!1},d(a){a&&_(e),~t&&i[t].d()}}}function Q0(l){let e,t;return e=new xc({props:{className:" w-full h-full max-h-full overflow-hidden",svg:l[1][l[2]].content}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o&6&&(s.svg=n[1][n[2]].content),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function x0(l){let e,t,n,o;return{c(){e=V("iframe"),this.h()},l(s){e=z(s,"IFRAME",{title:!0,srcdoc:!0,class:!0,sandbox:!0}),M(e).forEach(_),this.h()},h(){m(e,"title","Content"),m(e,"srcdoc",t=l[1][l[2]].content),m(e,"class","w-full border-0 h-full rounded-none"),m(e,"sandbox","allow-scripts allow-forms allow-same-origin")},m(s,i){A(s,e,i),l[14](e),n||(o=ke(e,"load",l[9]),n=!0)},p(s,i){i&6&&t!==(t=s[1][s[2]].content)&&m(e,"srcdoc",t)},i:we,o:we,d(s){s&&_(e),l[14](null),n=!1,o()}}}function Ei(l){let e,t,n,o,s,i,r,a,c,u=l[5].t("Version {{selectedVersion}} of {{totalVersions}}",{selectedVersion:l[2]+1,totalVersions:l[1].length})+"",f,h,d,p,b,v,g,w,y,I=(l[3]?l[5].t("Copied"):l[5].t("Copy"))+"",S,T,E,H,O,B=l[1][l[2]].type==="iframe"&&Ii(l);return{c(){e=V("div"),t=V("div"),n=V("div"),o=V("button"),s=Ne("svg"),i=Ne("path"),a=ee(),c=V("div"),f=Ie(u),h=ee(),d=V("button"),p=Ne("svg"),b=Ne("path"),g=ee(),w=V("div"),y=V("button"),S=Ie(I),T=ee(),B&&B.c(),this.h()},l(j){e=z(j,"DIV",{class:!0});var Z=M(e);t=z(Z,"DIV",{class:!0});var R=M(t);n=z(R,"DIV",{class:!0,dir:!0});var C=M(n);o=z(C,"BUTTON",{class:!0});var Y=M(o);s=Pe(Y,"svg",{xmlns:!0,fill:!0,viewBox:!0,stroke:!0,"stroke-width":!0,class:!0});var N=M(s);i=Pe(N,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),M(i).forEach(_),N.forEach(_),Y.forEach(_),a=te(C),c=z(C,"DIV",{class:!0});var F=M(c);f=Se(F,u),F.forEach(_),h=te(C),d=z(C,"BUTTON",{class:!0});var G=M(d);p=Pe(G,"svg",{xmlns:!0,fill:!0,viewBox:!0,stroke:!0,"stroke-width":!0,class:!0});var K=M(p);b=Pe(K,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),M(b).forEach(_),K.forEach(_),G.forEach(_),C.forEach(_),R.forEach(_),g=te(Z),w=z(Z,"DIV",{class:!0});var X=M(w);y=z(X,"BUTTON",{class:!0});var Q=M(y);S=Se(Q,I),Q.forEach(_),T=te(X),B&&B.l(X),X.forEach(_),Z.forEach(_),this.h()},h(){m(i,"stroke-linecap","round"),m(i,"stroke-linejoin","round"),m(i,"d","M15.75 19.5 8.25 12l7.5-7.5"),m(s,"xmlns","http://www.w3.org/2000/svg"),m(s,"fill","none"),m(s,"viewBox","0 0 24 24"),m(s,"stroke","currentColor"),m(s,"stroke-width","2.5"),m(s,"class","size-3.5"),m(o,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition disabled:cursor-not-allowed"),o.disabled=r=l[1].length<=1,m(c,"class","text-xs self-center dark:text-gray-100 min-w-fit"),m(b,"stroke-linecap","round"),m(b,"stroke-linejoin","round"),m(b,"d","m8.25 4.5 7.5 7.5-7.5 7.5"),m(p,"xmlns","http://www.w3.org/2000/svg"),m(p,"fill","none"),m(p,"viewBox","0 0 24 24"),m(p,"stroke","currentColor"),m(p,"stroke-width","2.5"),m(p,"class","size-3.5"),m(d,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition disabled:cursor-not-allowed"),d.disabled=v=l[1].length<=1,m(n,"class","flex items-center gap-0.5 self-center min-w-fit"),m(n,"dir","ltr"),m(t,"class","flex items-center space-x-2"),m(y,"class","copy-code-button bg-none border-none text-xs bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-md px-1.5 py-0.5"),m(w,"class","flex items-center gap-1"),m(e,"class","flex justify-between items-center p-2.5 font-primar text-gray-900 dark:text-white")},m(j,Z){A(j,e,Z),k(e,t),k(t,n),k(n,o),k(o,s),k(s,i),k(n,a),k(n,c),k(c,f),k(n,h),k(n,d),k(d,p),k(p,b),k(e,g),k(e,w),k(w,y),k(y,S),k(w,T),B&&B.m(w,null),E=!0,H||(O=[ke(o,"click",l[15]),ke(d,"click",l[16]),ke(y,"click",l[17])],H=!0)},p(j,Z){(!E||Z&2&&r!==(r=j[1].length<=1))&&(o.disabled=r),(!E||Z&38)&&u!==(u=j[5].t("Version {{selectedVersion}} of {{totalVersions}}",{selectedVersion:j[2]+1,totalVersions:j[1].length})+"")&&Te(f,u),(!E||Z&2&&v!==(v=j[1].length<=1))&&(d.disabled=v),(!E||Z&40)&&I!==(I=(j[3]?j[5].t("Copied"):j[5].t("Copy"))+"")&&Te(S,I),j[1][j[2]].type==="iframe"?B?(B.p(j,Z),Z&6&&D(B,1)):(B=Ii(j),B.c(),D(B,1),B.m(w,null)):B&&(He(),P(B,1,1,()=>{B=null}),Be())},i(j){E||(D(B),E=!0)},o(j){P(B),E=!1},d(j){j&&_(e),B&&B.d(),H=!1,on(O)}}}function Ii(l){let e,t;return e=new Rt({props:{content:l[5].t("Open in full screen"),$$slots:{default:[$0]},$$scope:{ctx:l}}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o&32&&(s.content=n[5].t("Open in full screen")),o&1048576&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function $0(l){let e,t,n,o,s;return t=new G0({props:{className:"size-3.5"}}),{c(){e=V("button"),ne(t.$$.fragment),this.h()},l(i){e=z(i,"BUTTON",{class:!0});var r=M(e);se(t.$$.fragment,r),r.forEach(_),this.h()},h(){m(e,"class","bg-none border-none text-xs bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-md p-0.5")},m(i,r){A(i,e,r),le(t,e,null),n=!0,o||(s=ke(e,"click",l[10]),o=!0)},p:we,i(i){n||(D(t.$$.fragment,i),n=!0)},o(i){P(t.$$.fragment,i),n=!1},d(i){i&&_(e),oe(t),o=!1,s()}}}function e_(l){let e,t,n,o,s,i,r,a,c,u,f,h,d,p,b,v,g,w,y,I=l[0]&&ki();i=new Aa({props:{className:"size-3.5  text-gray-900 dark:text-white"}}),u=new So({props:{className:"size-3.5 text-gray-900 dark:text-white"}});const S=[J0,q0],T=[];function E(O,B){return O[1].length>0?0:1}p=E(l),b=T[p]=S[p](l);let H=l[1].length>0&&Ei(l);return{c(){e=V("div"),t=V("div"),I&&I.c(),n=ee(),o=V("div"),s=V("button"),ne(i.$$.fragment),r=ee(),a=V("div"),c=V("button"),ne(u.$$.fragment),f=ee(),h=V("div"),d=V("div"),b.c(),v=ee(),H&&H.c(),this.h()},l(O){e=z(O,"DIV",{class:!0});var B=M(e);t=z(B,"DIV",{class:!0});var j=M(t);I&&I.l(j),n=te(j),o=z(j,"DIV",{class:!0});var Z=M(o);s=z(Z,"BUTTON",{class:!0});var R=M(s);se(i.$$.fragment,R),R.forEach(_),Z.forEach(_),r=te(j),a=z(j,"DIV",{class:!0});var C=M(a);c=z(C,"BUTTON",{class:!0});var Y=M(c);se(u.$$.fragment,Y),Y.forEach(_),C.forEach(_),f=te(j),h=z(j,"DIV",{class:!0});var N=M(h);d=z(N,"DIV",{class:!0});var F=M(d);b.l(F),F.forEach(_),N.forEach(_),j.forEach(_),v=te(B),H&&H.l(B),B.forEach(_),this.h()},h(){m(s,"class","self-center pointer-events-auto p-1 rounded-full bg-white dark:bg-gray-850"),m(o,"class","absolute pointer-events-none z-50 w-full flex items-center justify-start p-4"),m(c,"class","self-center pointer-events-auto p-1 rounded-full bg-white dark:bg-gray-850"),m(a,"class","absolute pointer-events-none z-50 w-full flex items-center justify-end p-4"),m(d,"class","h-full flex flex-col"),m(h,"class","flex-1 w-full h-full"),m(t,"class","w-full h-full flex-1 relative"),m(e,"class","w-full h-full relative flex flex-col bg-gray-50 dark:bg-gray-850")},m(O,B){A(O,e,B),k(e,t),I&&I.m(t,null),k(t,n),k(t,o),k(o,s),le(i,s,null),k(t,r),k(t,a),k(a,c),le(u,c,null),k(t,f),k(t,h),k(h,d),T[p].m(d,null),k(e,v),H&&H.m(e,null),g=!0,w||(y=[ke(s,"click",l[12]),ke(c,"click",l[13])],w=!0)},p(O,[B]){O[0]?I||(I=ki(),I.c(),I.m(t,n)):I&&(I.d(1),I=null);let j=p;p=E(O),p===j?T[p].p(O,B):(He(),P(T[j],1,1,()=>{T[j]=null}),Be(),b=T[p],b?b.p(O,B):(b=T[p]=S[p](O),b.c()),D(b,1),b.m(d,null)),O[1].length>0?H?(H.p(O,B),B&2&&D(H,1)):(H=Ei(O),H.c(),D(H,1),H.m(e,null)):H&&(He(),P(H,1,1,()=>{H=null}),Be())},i(O){g||(D(i.$$.fragment,O),D(u.$$.fragment,O),D(b),D(H),g=!0)},o(O){P(i.$$.fragment,O),P(u.$$.fragment,O),P(b),P(H),g=!1},d(O){O&&_(e),I&&I.d(),oe(i),oe(u),T[p].d(),H&&H.d(),w=!1,on(y)}}}function t_(l,e,t){let n;const o=Ft("i18n");ae(l,o,E=>t(5,n=E));const s=cn();let{overlay:i=!1}=e,{history:r}=e,a=[],c=[],u=0,f=!1,h;const d=()=>{t(1,c=[]),a.forEach(E=>{if((E==null?void 0:E.role)!=="user"&&(E!=null&&E.content)){const H=E.content.match(/```[\s\S]*?```/g);let O=[];H&&H.forEach(N=>{const F=N.split(`
`)[0].replace("```","").trim().toLowerCase(),G=N.replace(/```[\s\S]*?\n/,"").replace(/```$/,"");O.push({lang:F,code:G})});let B="",j="",Z="";O.forEach(N=>{const{lang:F,code:G}=N;F==="html"?B+=G+`
`:F==="css"?j+=G+`
`:(F==="javascript"||F==="js")&&(Z+=G+`
`)});const R=E.content.match(/<html>[\s\S]*?<\/html>/gi),C=E.content.match(/<style>[\s\S]*?<\/style>/gi),Y=E.content.match(/<script>[\s\S]*?<\/script>/gi);if(R&&R.forEach(N=>{const F=N.replace(/<\/?html>/gi,"");B+=F+`
`}),C&&C.forEach(N=>{const F=N.replace(/<\/?style>/gi,"");j+=F+`
`}),Y&&Y.forEach(N=>{const F=N.replace(/<\/?script>/gi,"");Z+=F+`
`}),B||j||Z){const N=`
                        <!DOCTYPE html>
                        <html lang="en">
                        <head>
                            <meta charset="UTF-8">
                            <meta name="viewport" content="width=device-width, initial-scale=1.0">
							<style>
								body {
									background-color: white; /* Ensure the iframe has a white background */
								}

								${j}
							</style>
                        </head>
                        <body>
                            ${B}

							<script>
                            	${Z}
							<\/script>
                        </body>
                        </html>
                    `;t(1,c=[...c,{type:"iframe",content:N}])}else for(const N of O)(N.lang==="svg"||N.lang==="xml"&&N.code.includes("<svg"))&&t(1,c=[...c,{type:"svg",content:N.code}])}}),c.length===0&&(jt.set(!1),Fn.set(!1)),t(2,u=c?c.length-1:0)};function p(E){console.log(u),t(2,u=E==="prev"?Math.max(u-1,0):Math.min(u+1,c.length-1)),console.log(u)}const b=()=>{h.contentWindow.addEventListener("click",function(E){const H=E.target.closest("a");if(H&&H.href){E.preventDefault();const O=new URL(H.href,h.baseURI);O.origin===window.location.origin?h.contentWindow.history.pushState(null,"",O.pathname+O.search+O.hash):console.log("External navigation blocked:",O.href)}},!0),h.contentWindow.addEventListener("mouseenter",function(E){E.preventDefault(),h.contentWindow.addEventListener("dragstart",H=>{H.preventDefault()})})},v=()=>{h.requestFullscreen?h.requestFullscreen():h.webkitRequestFullscreen?h.webkitRequestFullscreen():h.msRequestFullscreen&&h.msRequestFullscreen()};pn(()=>{});const g=()=>{Fn.set(!1)},w=()=>{s("close"),jt.set(!1),Fn.set(!1)};function y(E){We[E?"unshift":"push"](()=>{h=E,t(4,h)})}const I=()=>p("prev"),S=()=>p("next"),T=()=>{xo(c[u].content),t(3,f=!0),setTimeout(()=>{t(3,f=!1)},2e3)};return l.$$set=E=>{"overlay"in E&&t(0,i=E.overlay),"history"in E&&t(11,r=E.history)},l.$$.update=()=>{l.$$.dirty&2048&&(r?(a=yn(r,r.currentId),d()):(a=[],d()))},[i,c,u,f,h,n,o,s,p,b,v,r,g,w,y,I,S,T]}class Ra extends Re{constructor(e){super(),Ue(this,e,t_,e_,Fe,{overlay:0,history:11})}}function n_(l){let e,t,n,o,s=l[16]&&Si(l);function i(a){l[37](a)}let r={defaultSize:0,onResize:l[35],onCollapse:l[36],collapsible:!0,class:"pt-8",$$slots:{default:[c_]},$$scope:{ctx:l}};return l[4]!==void 0&&(r.pane=l[4]),t=new Fi({props:r}),We.push(()=>Je(t,"pane",i)),{c(){s&&s.c(),e=ee(),ne(t.$$.fragment)},l(a){s&&s.l(a),e=te(a),se(t.$$.fragment,a)},m(a,c){s&&s.m(a,c),A(a,e,c),le(t,a,c),o=!0},p(a,c){a[16]?s?c[0]&65536&&D(s,1):(s=Si(a),s.c(),D(s,1),s.m(e.parentNode,e)):s&&(He(),P(s,1,1,()=>{s=null}),Be());const u={};c[0]&81936&&(u.onResize=a[35]),c[0]&503791|c[1]&4096&&(u.$$scope={dirty:c,ctx:a}),!n&&c[0]&16&&(n=!0,u.pane=a[4],qe(()=>n=!1)),t.$set(u)},i(a){o||(D(s),D(t.$$.fragment,a),o=!0)},o(a){P(s),P(t.$$.fragment,a),o=!1},d(a){a&&_(e),s&&s.d(a),oe(t,a)}}}function l_(l){let e,t,n=l[16]&&Ci(l);return{c(){n&&n.c(),e=Ae()},l(o){n&&n.l(o),e=Ae()},m(o,s){n&&n.m(o,s),A(o,e,s),t=!0},p(o,s){o[16]?n?(n.p(o,s),s[0]&65536&&D(n,1)):(n=Ci(o),n.c(),D(n,1),n.m(e.parentNode,e)):n&&(He(),P(n,1,1,()=>{n=null}),Be())},i(o){t||(D(n),t=!0)},o(o){P(n),t=!1},d(o){o&&_(e),n&&n.d(o)}}}function Si(l){let e,t;return e=new Za({props:{class:"relative flex w-2 items-center justify-center bg-background group",$$slots:{default:[o_]},$$scope:{ctx:l}}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function o_(l){let e,t,n;return t=new pu({props:{className:"size-4 invisible group-hover:visible"}}),{c(){e=V("div"),ne(t.$$.fragment),this.h()},l(o){e=z(o,"DIV",{class:!0});var s=M(e);se(t.$$.fragment,s),s.forEach(_),this.h()},h(){m(e,"class","z-10 flex h-7 w-5 items-center justify-center rounded-xs")},m(o,s){A(o,e,s),le(t,e,null),n=!0},p:we,i(o){n||(D(t.$$.fragment,o),n=!0)},o(o){P(t.$$.fragment,o),n=!1},d(o){o&&_(e),oe(t)}}}function Di(l){let e,t,n,o,s,i;const r=[a_,i_,r_,s_],a=[];function c(u,f){return u[15]?0:u[18]?1:u[17]?2:3}return n=c(l),o=a[n]=r[n](l),{c(){e=V("div"),t=V("div"),o.c(),this.h()},l(u){e=z(u,"DIV",{class:!0});var f=M(e);t=z(f,"DIV",{class:!0});var h=M(t);o.l(h),h.forEach(_),f.forEach(_),this.h()},h(){m(t,"class",s="w-full "+((l[17]||l[18])&&!l[15]?" ":"px-4 py-4 bg-white dark:shadow-lg dark:bg-gray-850  border border-gray-100 dark:border-gray-850")+" rounded-xl z-40 pointer-events-auto overflow-y-auto scrollbar-hidden"),m(e,"class","pr-4 pb-8 flex max-h-full min-h-full")},m(u,f){A(u,e,f),k(e,t),a[n].m(t,null),i=!0},p(u,f){let h=n;n=c(u),n===h?a[n].p(u,f):(He(),P(a[h],1,1,()=>{a[h]=null}),Be(),o=a[n],o?o.p(u,f):(o=a[n]=r[n](u),o.c()),D(o,1),o.m(t,null)),(!i||f[0]&425984&&s!==(s="w-full "+((u[17]||u[18])&&!u[15]?" ":"px-4 py-4 bg-white dark:shadow-lg dark:bg-gray-850  border border-gray-100 dark:border-gray-850")+" rounded-xl z-40 pointer-events-auto overflow-y-auto scrollbar-hidden"))&&m(t,"class",s)},i(u){i||(D(o),i=!0)},o(u){P(o),i=!1},d(u){u&&_(e),a[n].d()}}}function s_(l){let e,t,n,o;function s(a){l[32](a)}function i(a){l[33](a)}let r={models:l[5]};return l[1]!==void 0&&(r.chatFiles=l[1]),l[2]!==void 0&&(r.params=l[2]),e=new Ha({props:r}),We.push(()=>Je(e,"chatFiles",s)),We.push(()=>Je(e,"params",i)),e.$on("close",l[34]),{c(){ne(e.$$.fragment)},l(a){se(e.$$.fragment,a)},m(a,c){le(e,a,c),o=!0},p(a,c){const u={};c[0]&32&&(u.models=a[5]),!t&&c[0]&2&&(t=!0,u.chatFiles=a[1],qe(()=>t=!1)),!n&&c[0]&4&&(n=!0,u.params=a[2],qe(()=>n=!1)),e.$set(u)},i(a){o||(D(e.$$.fragment,a),o=!0)},o(a){P(e.$$.fragment,a),o=!1},d(a){oe(e,a)}}}function r_(l){let e,t;return e=new La({props:{history:l[0]}}),e.$on("nodeclick",l[30]),e.$on("close",l[31]),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o[0]&1&&(s.history=n[0]),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function i_(l){let e,t;return e=new Ra({props:{history:l[0],overlay:l[13]}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o[0]&1&&(s.history=n[0]),o[0]&8192&&(s.overlay=n[13]),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function a_(l){let e,t,n,o;function s(r){l[28](r)}let i={submitPrompt:l[8],stopResponse:l[9],modelId:l[11],chatId:l[6],eventTarget:l[7]};return l[3]!==void 0&&(i.files=l[3]),t=new Ba({props:i}),We.push(()=>Je(t,"files",s)),t.$on("close",l[29]),{c(){e=V("div"),ne(t.$$.fragment),this.h()},l(r){e=z(r,"DIV",{class:!0});var a=M(e);se(t.$$.fragment,a),a.forEach(_),this.h()},h(){m(e,"class","w-full h-full flex justify-center")},m(r,a){A(r,e,a),le(t,e,null),o=!0},p(r,a){const c={};a[0]&256&&(c.submitPrompt=r[8]),a[0]&512&&(c.stopResponse=r[9]),a[0]&2048&&(c.modelId=r[11]),a[0]&64&&(c.chatId=r[6]),a[0]&128&&(c.eventTarget=r[7]),!n&&a[0]&8&&(n=!0,c.files=r[3],qe(()=>n=!1)),t.$set(c)},i(r){o||(D(t.$$.fragment,r),o=!0)},o(r){P(t.$$.fragment,r),o=!1},d(r){r&&_(e),oe(t)}}}function c_(l){let e,t,n=l[16]&&Di(l);return{c(){n&&n.c(),e=Ae()},l(o){n&&n.l(o),e=Ae()},m(o,s){n&&n.m(o,s),A(o,e,s),t=!0},p(o,s){o[16]?n?(n.p(o,s),s[0]&65536&&D(n,1)):(n=Di(o),n.c(),D(n,1),n.m(e.parentNode,e)):n&&(He(),P(n,1,1,()=>{n=null}),Be())},i(o){t||(D(n),t=!0)},o(o){P(n),t=!1},d(o){o&&_(e),n&&n.d(o)}}}function Ci(l){let e,t;return e=new _u({props:{show:l[16],$$slots:{default:[m_]},$$scope:{ctx:l}}}),e.$on("close",l[27]),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o[0]&65536&&(s.show=n[16]),o[0]&430063|o[1]&4096&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function u_(l){let e,t,n,o;function s(a){l[24](a)}function i(a){l[25](a)}let r={models:l[5]};return l[1]!==void 0&&(r.chatFiles=l[1]),l[2]!==void 0&&(r.params=l[2]),e=new Ha({props:r}),We.push(()=>Je(e,"chatFiles",s)),We.push(()=>Je(e,"params",i)),e.$on("close",l[26]),{c(){ne(e.$$.fragment)},l(a){se(e.$$.fragment,a)},m(a,c){le(e,a,c),o=!0},p(a,c){const u={};c[0]&32&&(u.models=a[5]),!t&&c[0]&2&&(t=!0,u.chatFiles=a[1],qe(()=>t=!1)),!n&&c[0]&4&&(n=!0,u.params=a[2],qe(()=>n=!1)),e.$set(u)},i(a){o||(D(e.$$.fragment,a),o=!0)},o(a){P(e.$$.fragment,a),o=!1},d(a){oe(e,a)}}}function f_(l){let e,t;return e=new La({props:{history:l[0]}}),e.$on("nodeclick",l[22]),e.$on("close",l[23]),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o[0]&1&&(s.history=n[0]),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function d_(l){let e,t;return e=new Ra({props:{history:l[0]}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o[0]&1&&(s.history=n[0]),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function h_(l){let e,t,n,o;function s(r){l[20](r)}let i={submitPrompt:l[8],stopResponse:l[9],modelId:l[11],chatId:l[6],eventTarget:l[7]};return l[3]!==void 0&&(i.files=l[3]),t=new Ba({props:i}),We.push(()=>Je(t,"files",s)),t.$on("close",l[21]),{c(){e=V("div"),ne(t.$$.fragment),this.h()},l(r){e=z(r,"DIV",{class:!0});var a=M(e);se(t.$$.fragment,a),a.forEach(_),this.h()},h(){m(e,"class","h-full max-h-[100dvh] bg-white text-gray-700 dark:bg-black dark:text-gray-300 flex justify-center")},m(r,a){A(r,e,a),le(t,e,null),o=!0},p(r,a){const c={};a[0]&256&&(c.submitPrompt=r[8]),a[0]&512&&(c.stopResponse=r[9]),a[0]&2048&&(c.modelId=r[11]),a[0]&64&&(c.chatId=r[6]),a[0]&128&&(c.eventTarget=r[7]),!n&&a[0]&8&&(n=!0,c.files=r[3],qe(()=>n=!1)),t.$set(c)},i(r){o||(D(t.$$.fragment,r),o=!0)},o(r){P(t.$$.fragment,r),o=!1},d(r){r&&_(e),oe(t)}}}function m_(l){let e,t,n,o,s;const i=[h_,d_,f_,u_],r=[];function a(c,u){return c[15]?0:c[18]?1:c[17]?2:3}return t=a(l),n=r[t]=i[t](l),{c(){e=V("div"),n.c(),this.h()},l(c){e=z(c,"DIV",{class:!0});var u=M(e);n.l(u),u.forEach(_),this.h()},h(){m(e,"class",o=(l[15]||l[17]||l[18]?" h-screen  w-full":"px-6 py-4")+" h-full")},m(c,u){A(c,e,u),r[t].m(e,null),s=!0},p(c,u){let f=t;t=a(c),t===f?r[t].p(c,u):(He(),P(r[f],1,1,()=>{r[f]=null}),Be(),n=r[t],n?n.p(c,u):(n=r[t]=i[t](c),n.c()),D(n,1),n.m(e,null)),(!s||u[0]&425984&&o!==(o=(c[15]||c[17]||c[18]?" h-screen  w-full":"px-6 py-4")+" h-full"))&&m(e,"class",o)},i(c){s||(D(n),s=!0)},o(c){P(n),s=!1},d(c){c&&_(e),r[t].d()}}}function g_(l){let e,t,n,o;const s=[l_,n_],i=[];function r(a,c){return a[12]?1:0}return e=r(l),t=i[e]=s[e](l),{c(){t.c(),n=Ae()},l(a){t.l(a),n=Ae()},m(a,c){i[e].m(a,c),A(a,n,c),o=!0},p(a,c){let u=e;e=r(a),e===u?i[e].p(a,c):(He(),P(i[u],1,1,()=>{i[u]=null}),Be(),t=i[e],t?t.p(a,c):(t=i[e]=s[e](a),t.c()),D(t,1),t.m(n.parentNode,n))},i(a){o||(D(t),o=!0)},o(a){P(t),o=!1},d(a){a&&_(n),i[e].d(a)}}}function __(l){let e,t;return e=new t1({props:{$$slots:{default:[g_]},$$scope:{ctx:l}}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o[0]&524287|o[1]&4096&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function p_(l,e,t){let n,o,s,i;ae(l,In,ue=>t(15,n=ue)),ae(l,jt,ue=>t(16,o=ue)),ae(l,Zn,ue=>t(17,s=ue)),ae(l,Fn,ue=>t(18,i=ue));let{history:r}=e,{models:a=[]}=e,{chatId:c=null}=e,{chatFiles:u=[]}=e,{params:f={}}=e,{eventTarget:h}=e,{submitPrompt:d}=e,{stopResponse:p}=e,{showMessage:b}=e,{files:v}=e,{modelId:g}=e,{pane:w}=e,y,I=!1,S=!1,T=0;const E=()=>{parseInt(localStorage==null?void 0:localStorage.chatControlsSize)?w.resize(parseInt(localStorage==null?void 0:localStorage.chatControlsSize)):w.resize(T)},H=async ue=>{ue.matches?(t(12,I=!0),n&&(In.set(!1),await xe(),In.set(!0))):(t(12,I=!1),n&&(In.set(!1),await xe(),In.set(!0)),t(4,w=null))},O=ue=>{t(13,S=!0)},B=ue=>{t(13,S=!1)};pn(()=>{y=window.matchMedia("(min-width: 1024px)"),y.addEventListener("change",H),H(y);const ue=document.getElementById("chat-container");t(14,T=Math.floor(350/ue.clientWidth*100)),new ResizeObserver(Xe=>{for(let Ke of Xe){const lt=350/Ke.contentRect.width*100;t(14,T=Math.floor(lt)),o&&w&&w.isExpanded()&&w.getSize()<T&&w.resize(T)}}).observe(ue),document.addEventListener("mousedown",O),document.addEventListener("mouseup",B)}),nl(()=>{jt.set(!1),y.removeEventListener("change",H),document.removeEventListener("mousedown",O),document.removeEventListener("mouseup",B)});const j=()=>{jt.set(!1),Zn.set(!1),Fn.set(!1),n&&In.set(!1)};function Z(ue){v=ue,t(3,v)}const R=()=>{jt.set(!1)},C=ue=>{b(ue.detail.node.data.message)},Y=()=>{jt.set(!1)};function N(ue){u=ue,t(1,u)}function F(ue){f=ue,t(2,f)}const G=()=>{jt.set(!1)},K=()=>{jt.set(!1)};function X(ue){v=ue,t(3,v)}const Q=()=>{jt.set(!1)},U=ue=>{ue.detail.node.data.message.favorite?t(0,r.messages[ue.detail.node.data.message.id].favorite=!0,r):t(0,r.messages[ue.detail.node.data.message.id].favorite=null,r),b(ue.detail.node.data.message)},J=()=>{jt.set(!1)};function q(ue){u=ue,t(1,u)}function ce(ue){f=ue,t(2,f)}const ge=()=>{jt.set(!1)},re=ue=>{console.log("size",ue,T),o&&w.isExpanded()&&(ue<T&&w.resize(T),ue<T?localStorage.chatControlsSize=0:localStorage.chatControlsSize=ue)},Oe=()=>{jt.set(!1)};function x(ue){w=ue,t(4,w)}return l.$$set=ue=>{"history"in ue&&t(0,r=ue.history),"models"in ue&&t(5,a=ue.models),"chatId"in ue&&t(6,c=ue.chatId),"chatFiles"in ue&&t(1,u=ue.chatFiles),"params"in ue&&t(2,f=ue.params),"eventTarget"in ue&&t(7,h=ue.eventTarget),"submitPrompt"in ue&&t(8,d=ue.submitPrompt),"stopResponse"in ue&&t(9,p=ue.stopResponse),"showMessage"in ue&&t(10,b=ue.showMessage),"files"in ue&&t(3,v=ue.files),"modelId"in ue&&t(11,g=ue.modelId),"pane"in ue&&t(4,w=ue.pane)},l.$$.update=()=>{l.$$.dirty[0]&64&&(c||j())},[r,u,f,v,w,a,c,h,d,p,b,g,I,S,T,n,o,s,i,E,Z,R,C,Y,N,F,G,K,X,Q,U,J,q,ce,ge,re,Oe,x]}class b_ extends Re{constructor(e){super(),Ue(this,e,p_,__,Fe,{history:0,models:5,chatId:6,chatFiles:1,params:2,eventTarget:7,submitPrompt:8,stopResponse:9,showMessage:10,files:3,modelId:11,pane:4,openPane:19},null,[-1,-1])}get openPane(){return this.$$.ctx[19]}}function Mi(l,e,t){const n=l.slice();return n[35]=e[t],n[37]=t,n}function Ti(l){let e,t;return e=new Rt({props:{content:"This chat won't appear in history and your messages will not be saved.",className:"w-full flex justify-center mb-0.5",placement:"top",$$slots:{default:[v_]},$$scope:{ctx:l}}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function v_(l){let e,t,n,o;return t=new tu({props:{strokeWidth:"2.5",className:"size-5"}}),{c(){e=V("div"),ne(t.$$.fragment),n=Ie(" Temporary Chat"),this.h()},l(s){e=z(s,"DIV",{class:!0});var i=M(e);se(t.$$.fragment,i),n=Se(i," Temporary Chat"),i.forEach(_),this.h()},h(){m(e,"class","flex items-center gap-2 text-gray-500 font-medium text-lg my-2 w-fit")},m(s,i){A(s,e,i),le(t,e,null),k(e,n),o=!0},p:we,i(s){o||(D(t.$$.fragment,s),o=!0)},o(s){P(t.$$.fragment,s),o=!1},d(s){s&&_(e),oe(t)}}}function w_(l){let e,t,n,o,s,i;function r(){return l[23](l[37])}return{c(){e=V("button"),t=V("img"),o=ee(),this.h()},l(a){e=z(a,"BUTTON",{});var c=M(e);t=z(c,"IMG",{crossorigin:!0,src:!0,class:!0,alt:!0,draggable:!0}),c.forEach(_),o=te(a),this.h()},h(){var a,c,u;m(t,"crossorigin","anonymous"),Jn(t.src,n=((u=(c=(a=l[35])==null?void 0:a.info)==null?void 0:c.meta)==null?void 0:u.profile_image_url)??(l[15].language==="dg-DG"?"/doge.png":`${Hl}/static/favicon.png`))||m(t,"src",n),m(t,"class","size-9 @sm:size-10 rounded-full border-[1px] border-gray-200 dark:border-none"),m(t,"alt","logo"),m(t,"draggable","false")},m(a,c){A(a,e,c),k(e,t),A(a,o,c),s||(i=ke(e,"click",r),s=!0)},p(a,c){var u,f,h;l=a,c[0]&40960&&!Jn(t.src,n=((h=(f=(u=l[35])==null?void 0:u.info)==null?void 0:f.meta)==null?void 0:h.profile_image_url)??(l[15].language==="dg-DG"?"/doge.png":`${Hl}/static/favicon.png`))&&m(t,"src",n)},d(a){a&&(_(e),_(o)),s=!1,i()}}}function Vi(l){var n,o,s;let e,t;return e=new Rt({props:{content:(((s=(o=(n=l[13][l[37]])==null?void 0:n.info)==null?void 0:o.meta)==null?void 0:s.tags)??[]).map(Pi).join(", "),placement:"top",$$slots:{default:[w_]},$$scope:{ctx:l}}}),{c(){ne(e.$$.fragment)},l(i){se(e.$$.fragment,i)},m(i,r){le(e,i,r),t=!0},p(i,r){var c,u,f;const a={};r[0]&8192&&(a.content=(((f=(u=(c=i[13][i[37]])==null?void 0:c.info)==null?void 0:u.meta)==null?void 0:f.tags)??[]).map(Pi).join(", ")),r[0]&57344|r[1]&128&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(D(e.$$.fragment,i),t=!0)},o(i){P(e.$$.fragment,i),t=!1},d(i){oe(e,i)}}}function y_(l){let e=l[15].t("Hello, {{name}}",{name:l[17].name})+"",t;return{c(){t=Ie(e)},l(n){t=Se(n,e)},m(n,o){A(n,t,o)},p(n,o){o[0]&163840&&e!==(e=n[15].t("Hello, {{name}}",{name:n[17].name})+"")&&Te(t,e)},d(n){n&&_(t)}}}function k_(l){var n;let e=((n=l[13][l[14]])==null?void 0:n.name)+"",t;return{c(){t=Ie(e)},l(o){t=Se(o,e)},m(o,s){A(o,t,s)},p(o,s){var i;s[0]&24576&&e!==(e=((i=o[13][o[14]])==null?void 0:i.name)+"")&&Te(t,e)},d(o){o&&_(t)}}}function zi(l){var i,r,a,c,u,f;let e,t,n,o;e=new Rt({props:{className:" w-fit",content:Sl.parse(co(((a=(r=(i=l[13][l[14]])==null?void 0:i.info)==null?void 0:r.meta)==null?void 0:a.description)??"")),placement:"top",$$slots:{default:[E_]},$$scope:{ctx:l}}});let s=((f=(u=(c=l[13][l[14]])==null?void 0:c.info)==null?void 0:u.meta)==null?void 0:f.user)&&Ni(l);return{c(){ne(e.$$.fragment),t=ee(),s&&s.c(),n=Ae()},l(h){se(e.$$.fragment,h),t=te(h),s&&s.l(h),n=Ae()},m(h,d){le(e,h,d),A(h,t,d),s&&s.m(h,d),A(h,n,d),o=!0},p(h,d){var b,v,g,w,y,I;const p={};d[0]&24576&&(p.content=Sl.parse(co(((g=(v=(b=h[13][h[14]])==null?void 0:b.info)==null?void 0:v.meta)==null?void 0:g.description)??""))),d[0]&24576|d[1]&128&&(p.$$scope={dirty:d,ctx:h}),e.$set(p),(I=(y=(w=h[13][h[14]])==null?void 0:w.info)==null?void 0:y.meta)!=null&&I.user?s?s.p(h,d):(s=Ni(h),s.c(),s.m(n.parentNode,n)):s&&(s.d(1),s=null)},i(h){o||(D(e.$$.fragment,h),o=!0)},o(h){P(e.$$.fragment,h),o=!1},d(h){h&&(_(t),_(n)),oe(e,h),s&&s.d(h)}}}function E_(l){var o,s,i;let e,t,n=Sl.parse(co((i=(s=(o=l[13][l[14]])==null?void 0:o.info)==null?void 0:s.meta)==null?void 0:i.description))+"";return{c(){e=V("div"),t=new Li(!1),this.h()},l(r){e=z(r,"DIV",{class:!0});var a=M(e);t=Ri(a,!1),a.forEach(_),this.h()},h(){t.a=null,m(e,"class","mt-0.5 px-2 text-sm font-normal text-gray-500 dark:text-gray-400 line-clamp-2 max-w-xl markdown")},m(r,a){A(r,e,a),t.m(n,e)},p(r,a){var c,u,f;a[0]&24576&&n!==(n=Sl.parse(co((f=(u=(c=r[13][r[14]])==null?void 0:c.info)==null?void 0:u.meta)==null?void 0:f.description))+"")&&t.p(n)},d(r){r&&_(e)}}}function Ni(l){let e,t;function n(i,r){var a,c,u;return(u=(c=(a=i[13][i[14]])==null?void 0:a.info)==null?void 0:c.meta)!=null&&u.user.community?S_:I_}let o=n(l),s=o(l);return{c(){e=V("div"),t=Ie(`By\r
								`),s.c(),this.h()},l(i){e=z(i,"DIV",{class:!0});var r=M(e);t=Se(r,`By\r
								`),s.l(r),r.forEach(_),this.h()},h(){m(e,"class","mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500")},m(i,r){A(i,e,r),k(e,t),s.m(e,null)},p(i,r){o===(o=n(i))&&s?s.p(i,r):(s.d(1),s=o(i),s&&(s.c(),s.m(e,null)))},d(i){i&&_(e),s.d()}}}function I_(l){var n,o,s;let e=((s=(o=(n=l[13][l[14]])==null?void 0:n.info)==null?void 0:o.meta)==null?void 0:s.user.name)+"",t;return{c(){t=Ie(e)},l(i){t=Se(i,e)},m(i,r){A(i,t,r)},p(i,r){var a,c,u;r[0]&24576&&e!==(e=((u=(c=(a=i[13][i[14]])==null?void 0:a.info)==null?void 0:c.meta)==null?void 0:u.user.name)+"")&&Te(t,e)},d(i){i&&_(t)}}}function S_(l){var s,i,r,a,c,u,f,h,d;let e,t=((r=(i=(s=l[13][l[14]])==null?void 0:s.info)==null?void 0:i.meta)!=null&&r.user.name?(u=(c=(a=l[13][l[14]])==null?void 0:a.info)==null?void 0:c.meta)==null?void 0:u.user.name:`@${(d=(h=(f=l[13][l[14]])==null?void 0:f.info)==null?void 0:h.meta)==null?void 0:d.user.username}`)+"",n,o;return{c(){e=V("a"),n=Ie(t),this.h()},l(p){e=z(p,"A",{href:!0});var b=M(e);n=Se(b,t),b.forEach(_),this.h()},h(){var p,b,v;m(e,"href",o="https://openwebui.com/m/"+((v=(b=(p=l[13][l[14]])==null?void 0:p.info)==null?void 0:b.meta)==null?void 0:v.user.username))},m(p,b){A(p,e,b),k(e,n)},p(p,b){var v,g,w,y,I,S,T,E,H,O,B,j;b[0]&24576&&t!==(t=((w=(g=(v=p[13][p[14]])==null?void 0:v.info)==null?void 0:g.meta)!=null&&w.user.name?(S=(I=(y=p[13][p[14]])==null?void 0:y.info)==null?void 0:I.meta)==null?void 0:S.user.name:`@${(H=(E=(T=p[13][p[14]])==null?void 0:T.info)==null?void 0:E.meta)==null?void 0:H.user.username}`)+"")&&Te(n,t),b[0]&24576&&o!==(o="https://openwebui.com/m/"+((j=(B=(O=p[13][p[14]])==null?void 0:O.info)==null?void 0:B.meta)==null?void 0:j.user.username))&&m(e,"href",o)},d(p){p&&_(e)}}}function D_(l){var lt,it,Nt,Dt,Ht,wt,Ut;let e,t,n,o,s,i,r,a,c,u,f,h,d,p,b,v,g,w,y,I,S,T,E,H,O,B,j,Z,R,C,Y,N,F,G=l[16]&&Ti(l),K=vt(l[13]),X=[];for(let pe=0;pe<K.length;pe+=1)X[pe]=Vi(Mi(l,K,pe));const Q=pe=>P(X[pe],1,1,()=>{X[pe]=null});function U(pe,Ye){var ot;return(ot=pe[13][pe[14]])!=null&&ot.name?k_:y_}let J=U(l),q=J(l),ce=(((Nt=(it=(lt=l[13][l[14]])==null?void 0:lt.info)==null?void 0:it.meta)==null?void 0:Nt.description)??null)&&zi(l);function ge(pe){l[24](pe)}function re(pe){l[25](pe)}function Oe(pe){l[26](pe)}function x(pe){l[27](pe)}function ue(pe){l[28](pe)}function Ee(pe){l[29](pe)}function Xe(pe){l[30](pe)}function Ke(pe){l[31](pe)}let fe={history:l[12],selectedModels:l[11],transparentBackground:l[8],stopResponse:l[10],createMessagePair:l[9],placeholder:l[15].t("How can I help you today?")};return l[3]!==void 0&&(fe.files=l[3]),l[2]!==void 0&&(fe.prompt=l[2]),l[0]!==void 0&&(fe.autoScroll=l[0]),l[4]!==void 0&&(fe.selectedToolIds=l[4]),l[5]!==void 0&&(fe.imageGenerationEnabled=l[5]),l[6]!==void 0&&(fe.codeInterpreterEnabled=l[6]),l[7]!==void 0&&(fe.webSearchEnabled=l[7]),l[1]!==void 0&&(fe.atSelectedModel=l[1]),w=new ta({props:fe}),We.push(()=>Je(w,"files",ge)),We.push(()=>Je(w,"prompt",re)),We.push(()=>Je(w,"autoScroll",Oe)),We.push(()=>Je(w,"selectedToolIds",x)),We.push(()=>Je(w,"imageGenerationEnabled",ue)),We.push(()=>Je(w,"codeInterpreterEnabled",Ee)),We.push(()=>Je(w,"webSearchEnabled",Xe)),We.push(()=>Je(w,"atSelectedModel",Ke)),w.$on("upload",l[32]),w.$on("submit",l[33]),Y=new eu({props:{suggestionPrompts:((wt=(Ht=(Dt=l[13][l[14]])==null?void 0:Dt.info)==null?void 0:Ht.meta)==null?void 0:wt.suggestion_prompts)??((Ut=l[18])==null?void 0:Ut.default_prompt_suggestions)??[],inputValue:l[2]}}),Y.$on("select",l[34]),{c(){e=V("div"),G&&G.c(),t=ee(),n=V("div"),o=V("div"),s=V("div"),i=V("div"),r=V("div");for(let pe=0;pe<X.length;pe+=1)X[pe].c();c=ee(),u=V("div"),q.c(),h=ee(),d=V("div"),p=V("div"),ce&&ce.c(),v=ee(),g=V("div"),ne(w.$$.fragment),Z=ee(),R=V("div"),C=V("div"),ne(Y.$$.fragment),this.h()},l(pe){e=z(pe,"DIV",{class:!0});var Ye=M(e);G&&G.l(Ye),t=te(Ye),n=z(Ye,"DIV",{class:!0});var ot=M(n);o=z(ot,"DIV",{class:!0});var he=M(o);s=z(he,"DIV",{class:!0});var yt=M(s);i=z(yt,"DIV",{class:!0});var ht=M(i);r=z(ht,"DIV",{class:!0});var bt=M(r);for(let Ge=0;Ge<X.length;Ge+=1)X[Ge].l(bt);bt.forEach(_),ht.forEach(_),c=te(yt),u=z(yt,"DIV",{class:!0});var Ce=M(u);q.l(Ce),Ce.forEach(_),yt.forEach(_),h=te(he),d=z(he,"DIV",{class:!0});var Pt=M(d);p=z(Pt,"DIV",{});var mt=M(p);ce&&ce.l(mt),mt.forEach(_),Pt.forEach(_),v=te(he),g=z(he,"DIV",{class:!0});var de=M(g);se(w.$$.fragment,de),de.forEach(_),he.forEach(_),ot.forEach(_),Z=te(Ye),R=z(Ye,"DIV",{class:!0});var De=M(R);C=z(De,"DIV",{class:!0});var Ve=M(C);se(Y.$$.fragment,Ve),Ve.forEach(_),De.forEach(_),Ye.forEach(_),this.h()},h(){m(r,"class","flex -space-x-4 mb-0.5"),m(i,"class","flex shrink-0 justify-center"),m(u,"class","text-3xl @sm:text-4xl line-clamp-1"),m(s,"class","flex flex-row justify-center gap-3 @sm:gap-3.5 w-fit px-5"),m(d,"class","flex mt-1 mb-2"),m(g,"class",j="text-base font-normal @md:max-w-3xl w-full py-3 "+(l[1]?"mt-2":"")),m(o,"class","w-full flex flex-col justify-center items-center"),m(n,"class","w-full text-3xl text-gray-800 dark:text-gray-100 font-medium text-center flex items-center gap-4 font-primary"),m(C,"class","mx-5"),m(R,"class","mx-auto max-w-2xl font-primary"),m(e,"class","m-auto w-full max-w-6xl px-2 @2xl:px-20 translate-y-6 py-24 text-center")},m(pe,Ye){A(pe,e,Ye),G&&G.m(e,null),k(e,t),k(e,n),k(n,o),k(o,s),k(s,i),k(i,r);for(let ot=0;ot<X.length;ot+=1)X[ot]&&X[ot].m(r,null);k(s,c),k(s,u),q.m(u,null),k(o,h),k(o,d),k(d,p),ce&&ce.m(p,null),k(o,v),k(o,g),le(w,g,null),k(e,Z),k(e,R),k(R,C),le(Y,C,null),F=!0},p(pe,Ye){var yt,ht,bt,Ce,Pt,mt,de;if(pe[16]?G?Ye[0]&65536&&D(G,1):(G=Ti(pe),G.c(),D(G,1),G.m(e,t)):G&&(He(),P(G,1,1,()=>{G=null}),Be()),Ye[0]&57344){K=vt(pe[13]);let De;for(De=0;De<K.length;De+=1){const Ve=Mi(pe,K,De);X[De]?(X[De].p(Ve,Ye),D(X[De],1)):(X[De]=Vi(Ve),X[De].c(),D(X[De],1),X[De].m(r,null))}for(He(),De=K.length;De<X.length;De+=1)Q(De);Be()}J===(J=U(pe))&&q?q.p(pe,Ye):(q.d(1),q=J(pe),q&&(q.c(),q.m(u,null))),((bt=(ht=(yt=pe[13][pe[14]])==null?void 0:yt.info)==null?void 0:ht.meta)==null?void 0:bt.description)??null?ce?(ce.p(pe,Ye),Ye[0]&24576&&D(ce,1)):(ce=zi(pe),ce.c(),D(ce,1),ce.m(p,null)):ce&&(He(),P(ce,1,1,()=>{ce=null}),Be());const ot={};Ye[0]&4096&&(ot.history=pe[12]),Ye[0]&2048&&(ot.selectedModels=pe[11]),Ye[0]&256&&(ot.transparentBackground=pe[8]),Ye[0]&1024&&(ot.stopResponse=pe[10]),Ye[0]&512&&(ot.createMessagePair=pe[9]),Ye[0]&32768&&(ot.placeholder=pe[15].t("How can I help you today?")),!y&&Ye[0]&8&&(y=!0,ot.files=pe[3],qe(()=>y=!1)),!I&&Ye[0]&4&&(I=!0,ot.prompt=pe[2],qe(()=>I=!1)),!S&&Ye[0]&1&&(S=!0,ot.autoScroll=pe[0],qe(()=>S=!1)),!T&&Ye[0]&16&&(T=!0,ot.selectedToolIds=pe[4],qe(()=>T=!1)),!E&&Ye[0]&32&&(E=!0,ot.imageGenerationEnabled=pe[5],qe(()=>E=!1)),!H&&Ye[0]&64&&(H=!0,ot.codeInterpreterEnabled=pe[6],qe(()=>H=!1)),!O&&Ye[0]&128&&(O=!0,ot.webSearchEnabled=pe[7],qe(()=>O=!1)),!B&&Ye[0]&2&&(B=!0,ot.atSelectedModel=pe[1],qe(()=>B=!1)),w.$set(ot),(!F||Ye[0]&2&&j!==(j="text-base font-normal @md:max-w-3xl w-full py-3 "+(pe[1]?"mt-2":"")))&&m(g,"class",j);const he={};Ye[0]&286720&&(he.suggestionPrompts=((mt=(Pt=(Ce=pe[13][pe[14]])==null?void 0:Ce.info)==null?void 0:Pt.meta)==null?void 0:mt.suggestion_prompts)??((de=pe[18])==null?void 0:de.default_prompt_suggestions)??[]),Ye[0]&4&&(he.inputValue=pe[2]),Y.$set(he)},i(pe){if(!F){D(G);for(let Ye=0;Ye<K.length;Ye+=1)D(X[Ye]);pe&&(a||el(()=>{a=xl(r,vl,{duration:100}),a.start()})),pe&&(f||el(()=>{f=xl(u,vl,{duration:100}),f.start()})),D(ce),pe&&(b||el(()=>{b=xl(p,vl,{duration:100,delay:50}),b.start()})),D(w.$$.fragment,pe),D(Y.$$.fragment,pe),pe&&(N||el(()=>{N=xl(R,vl,{duration:200,delay:200}),N.start()})),F=!0}},o(pe){P(G),X=X.filter(Boolean);for(let Ye=0;Ye<X.length;Ye+=1)P(X[Ye]);P(ce),P(w.$$.fragment,pe),P(Y.$$.fragment,pe),F=!1},d(pe){pe&&_(e),G&&G.d(),Dn(X,pe),q.d(),ce&&ce.d(),oe(w),oe(Y)}}}const Pi=l=>l.name.toUpperCase();function C_(l,e,t){let n,o,s,i,r;ae(l,dl,U=>t(22,n=U)),ae(l,yo,U=>t(16,s=U)),ae(l,Qn,U=>t(17,i=U)),ae(l,Yl,U=>t(18,r=U));const a=cn(),c=Ft("i18n");ae(l,c,U=>t(15,o=U));let{transparentBackground:u=!1}=e,{createMessagePair:f}=e,{stopResponse:h}=e,{autoScroll:d=!1}=e,{atSelectedModel:p}=e,{selectedModels:b}=e,{history:v}=e,{prompt:g=""}=e,{files:w=[]}=e,{selectedToolIds:y=[]}=e,{imageGenerationEnabled:I=!1}=e,{codeInterpreterEnabled:S=!1}=e,{webSearchEnabled:T=!1}=e,E=[];const H=async U=>{let J=U;if(U.includes("{{CLIPBOARD}}")){const ge=await navigator.clipboard.readText().catch(re=>(nt.error(o.t("Failed to read clipboard contents")),"{{CLIPBOARD}}"));J=U.replaceAll("{{CLIPBOARD}}",ge),console.log("Clipboard text:",ge,J)}t(2,g=J),console.log(g),await xe();const q=document.getElementById("chat-input-container"),ce=document.getElementById("chat-input");q&&(q.style.height="",q.style.height=Math.min(q.scrollHeight,200)+"px"),await xe(),ce&&(ce.focus(),ce.dispatchEvent(new Event("input"))),await xe()};let O=0;pn(()=>{});const B=U=>{t(14,O=U)};function j(U){w=U,t(3,w)}function Z(U){g=U,t(2,g)}function R(U){d=U,t(0,d)}function C(U){y=U,t(4,y)}function Y(U){I=U,t(5,I)}function N(U){S=U,t(6,S)}function F(U){T=U,t(7,T)}function G(U){p=U,t(1,p)}const K=U=>{a("upload",U.detail)},X=U=>{a("submit",U.detail)},Q=U=>{H(U.detail)};return l.$$set=U=>{"transparentBackground"in U&&t(8,u=U.transparentBackground),"createMessagePair"in U&&t(9,f=U.createMessagePair),"stopResponse"in U&&t(10,h=U.stopResponse),"autoScroll"in U&&t(0,d=U.autoScroll),"atSelectedModel"in U&&t(1,p=U.atSelectedModel),"selectedModels"in U&&t(11,b=U.selectedModels),"history"in U&&t(12,v=U.history),"prompt"in U&&t(2,g=U.prompt),"files"in U&&t(3,w=U.files),"selectedToolIds"in U&&t(4,y=U.selectedToolIds),"imageGenerationEnabled"in U&&t(5,I=U.imageGenerationEnabled),"codeInterpreterEnabled"in U&&t(6,S=U.codeInterpreterEnabled),"webSearchEnabled"in U&&t(7,T=U.webSearchEnabled)},l.$$.update=()=>{l.$$.dirty[0]&4196352&&t(13,E=b.map(U=>n.find(J=>J.id===U))),l.$$.dirty[0]&10240&&b.length>0&&t(14,O=E.length-1)},[d,p,g,w,y,I,S,T,u,f,h,b,v,E,O,o,s,i,r,a,c,H,n,B,j,Z,R,C,Y,N,F,G,K,X,Q]}class M_ extends Re{constructor(e){super(),Ue(this,e,C_,D_,Fe,{transparentBackground:8,createMessagePair:9,stopResponse:10,autoScroll:0,atSelectedModel:1,selectedModels:11,history:12,prompt:2,files:3,selectedToolIds:4,imageGenerationEnabled:5,codeInterpreterEnabled:6,webSearchEnabled:7},null,[-1,-1])}}const{document:Yo}=Wi;function Oi(l,e,t){const n=l.slice();return n[117]=e[t],n}function T_(l){let e,t,n,o;return n=new Io({}),{c(){e=V("div"),t=V("div"),ne(n.$$.fragment),this.h()},l(s){e=z(s,"DIV",{class:!0});var i=M(e);t=z(i,"DIV",{class:!0});var r=M(t);se(n.$$.fragment,r),r.forEach(_),i.forEach(_),this.h()},h(){m(t,"class","m-auto"),m(e,"class","flex items-center justify-center h-full w-full")},m(s,i){A(s,e,i),k(e,t),le(n,t,null),o=!0},p:we,i(s){o||(D(n.$$.fragment,s),o=!0)},o(s){P(n.$$.fragment,s),o=!1},d(s){s&&_(e),oe(n)}}}function V_(l){var u;let e,t,n,o,s,i,r=(((u=l[27])==null?void 0:u.backgroundImageUrl)??null)&&Hi(l);function a(f){l[54](f)}let c={chat:{id:l[26],chat:{title:l[29],models:l[1],system:l[27].system??void 0,params:l[25],history:l[21],timestamp:Date.now()}},title:l[29],shareEnabled:!!l[21].currentId,initNewChat:l[39]};return l[1]!==void 0&&(c.selectedModels=l[1]),t=new th({props:c}),l[53](t),We.push(()=>Je(t,"selectedModels",a)),s=new Ga({props:{direction:"horizontal",class:"w-full h-full",$$slots:{default:[O_]},$$scope:{ctx:l}}}),{c(){r&&r.c(),e=ee(),ne(t.$$.fragment),o=ee(),ne(s.$$.fragment)},l(f){r&&r.l(f),e=te(f),se(t.$$.fragment,f),o=te(f),se(s.$$.fragment,f)},m(f,h){r&&r.m(f,h),A(f,e,h),le(t,f,h),A(f,o,h),le(s,f,h),i=!0},p(f,h){var b;((b=f[27])==null?void 0:b.backgroundImageUrl)??null?r?r.p(f,h):(r=Hi(f),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null);const d={};h[0]&773849090&&(d.chat={id:f[26],chat:{title:f[29],models:f[1],system:f[27].system??void 0,params:f[25],history:f[21],timestamp:Date.now()}}),h[0]&536870912&&(d.title=f[29]),h[0]&2097152&&(d.shareEnabled=!!f[21].currentId),!n&&h[0]&2&&(n=!0,d.selectedModels=f[1],qe(()=>n=!1)),t.$set(d);const p={};h[0]&536805622|h[1]&2|h[3]&134217728&&(p.$$scope={dirty:h,ctx:f}),s.$set(p)},i(f){i||(D(t.$$.fragment,f),D(s.$$.fragment,f),i=!0)},o(f){P(t.$$.fragment,f),P(s.$$.fragment,f),i=!1},d(f){f&&(_(e),_(o)),r&&r.d(f),l[53](null),oe(t,f),oe(s,f)}}}function Hi(l){let e,t,n,o;return{c(){e=V("div"),n=ee(),o=V("div"),this.h()},l(s){e=z(s,"DIV",{class:!0,style:!0}),M(e).forEach(_),n=te(s),o=z(s,"DIV",{class:!0}),M(o).forEach(_),this.h()},h(){m(e,"class",t="absolute "+(l[31]?"md:max-w-[calc(100%-260px)] md:translate-x-[260px]":"")+" top-0 left-0 w-full h-full bg-cover bg-center bg-no-repeat"),$e(e,"background-image","url("+l[27].backgroundImageUrl+")"),m(o,"class","absolute top-0 left-0 w-full h-full bg-linear-to-t from-white to-white/85 dark:from-gray-900 dark:to-gray-900/90 z-0")},m(s,i){A(s,e,i),A(s,n,i),A(s,o,i)},p(s,i){i[1]&1&&t!==(t="absolute "+(s[31]?"md:max-w-[calc(100%-260px)] md:translate-x-[260px]":"")+" top-0 left-0 w-full h-full bg-cover bg-center bg-no-repeat")&&m(e,"class",t),i[0]&134217728&&$e(e,"background-image","url("+s[27].backgroundImageUrl+")")},d(s){s&&(_(e),_(n),_(o))}}}function Bi(l){let e,t,n,o=vt(l[32].filter(l[55])),s=[];for(let r=0;r<o.length;r+=1)s[r]=Ai(Oi(l,o,r));const i=r=>P(s[r],1,1,()=>{s[r]=null});return{c(){e=V("div"),t=V("div");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=z(r,"DIV",{class:!0});var a=M(e);t=z(a,"DIV",{class:!0});var c=M(t);for(let u=0;u<s.length;u+=1)s[u].l(c);c.forEach(_),a.forEach(_),this.h()},h(){m(t,"class","flex flex-col gap-1 w-full"),m(e,"class","absolute top-12 left-0 right-0 w-full z-30")},m(r,a){A(r,e,a),k(e,t);for(let c=0;c<s.length;c+=1)s[c]&&s[c].m(t,null);n=!0},p(r,a){if(a[1]&2){o=vt(r[32].filter(r[55]));let c;for(c=0;c<o.length;c+=1){const u=Oi(r,o,c);s[c]?(s[c].p(u,a),D(s[c],1)):(s[c]=Ai(u),s[c].c(),D(s[c],1),s[c].m(t,null))}for(He(),c=o.length;c<s.length;c+=1)i(c);Be()}},i(r){if(!n){for(let a=0;a<o.length;a+=1)D(s[a]);n=!0}},o(r){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)P(s[a]);n=!1},d(r){r&&_(e),Dn(s,r)}}}function Ai(l){let e,t;return e=new Ku({props:{banner:l[117]}}),e.$on("dismiss",l[56]),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o[1]&2&&(s.banner=n[117]),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function z_(l){var S;let e,t,n,o,s,i,r,a,c,u,f;function h(T){l[73](T)}function d(T){l[74](T)}function p(T){l[75](T)}function b(T){l[76](T)}function v(T){l[77](T)}function g(T){l[78](T)}function w(T){l[79](T)}function y(T){l[80](T)}let I={history:l[21],selectedModels:l[1],transparentBackground:((S=l[27])==null?void 0:S.backgroundImageUrl)??!1,stopResponse:l[45],createMessagePair:l[41]};return l[24]!==void 0&&(I.files=l[24]),l[22]!==void 0&&(I.prompt=l[22]),l[6]!==void 0&&(I.autoScroll=l[6]),l[17]!==void 0&&(I.selectedToolIds=l[17]),l[18]!==void 0&&(I.imageGenerationEnabled=l[18]),l[20]!==void 0&&(I.codeInterpreterEnabled=l[20]),l[19]!==void 0&&(I.webSearchEnabled=l[19]),l[2]!==void 0&&(I.atSelectedModel=l[2]),t=new M_({props:I}),We.push(()=>Je(t,"files",h)),We.push(()=>Je(t,"prompt",d)),We.push(()=>Je(t,"autoScroll",p)),We.push(()=>Je(t,"selectedToolIds",b)),We.push(()=>Je(t,"imageGenerationEnabled",v)),We.push(()=>Je(t,"codeInterpreterEnabled",g)),We.push(()=>Je(t,"webSearchEnabled",w)),We.push(()=>Je(t,"atSelectedModel",y)),t.$on("upload",l[81]),t.$on("submit",l[82]),{c(){e=V("div"),ne(t.$$.fragment),this.h()},l(T){e=z(T,"DIV",{class:!0});var E=M(e);se(t.$$.fragment,E),E.forEach(_),this.h()},h(){m(e,"class","overflow-auto w-full h-full flex items-center")},m(T,E){A(T,e,E),le(t,e,null),f=!0},p(T,E){var O;const H={};E[0]&2097152&&(H.history=T[21]),E[0]&2&&(H.selectedModels=T[1]),E[0]&134217728&&(H.transparentBackground=((O=T[27])==null?void 0:O.backgroundImageUrl)??!1),!n&&E[0]&16777216&&(n=!0,H.files=T[24],qe(()=>n=!1)),!o&&E[0]&4194304&&(o=!0,H.prompt=T[22],qe(()=>o=!1)),!s&&E[0]&64&&(s=!0,H.autoScroll=T[6],qe(()=>s=!1)),!i&&E[0]&131072&&(i=!0,H.selectedToolIds=T[17],qe(()=>i=!1)),!r&&E[0]&262144&&(r=!0,H.imageGenerationEnabled=T[18],qe(()=>r=!1)),!a&&E[0]&1048576&&(a=!0,H.codeInterpreterEnabled=T[20],qe(()=>a=!1)),!c&&E[0]&524288&&(c=!0,H.webSearchEnabled=T[19],qe(()=>c=!1)),!u&&E[0]&4&&(u=!0,H.atSelectedModel=T[2],qe(()=>u=!1)),t.$set(H)},i(T){f||(D(t.$$.fragment,T),f=!0)},o(T){P(t.$$.fragment,T),f=!1},d(T){T&&_(e),oe(t)}}}function N_(l){var Q;let e,t,n,o,s,i,r,a,c,u,f,h,d,p,b,v,g,w,y,I="",S,T,E;function H(U){l[57](U)}function O(U){l[58](U)}function B(U){l[59](U)}let j={chatId:l[26],selectedModels:l[1],sendPrompt:l[44],showMessage:l[35],submitMessage:l[46],continueResponse:l[48],regenerateResponse:l[47],mergeResponses:l[49],chatActionHandler:l[40],addMessages:l[42],bottomPadding:l[24].length>0};l[21]!==void 0&&(j.history=l[21]),l[6]!==void 0&&(j.autoScroll=l[6]),l[22]!==void 0&&(j.prompt=l[22]),n=new nu({props:j}),We.push(()=>Je(n,"history",H)),We.push(()=>Je(n,"autoScroll",O)),We.push(()=>Je(n,"prompt",B));function Z(U){l[63](U)}function R(U){l[64](U)}function C(U){l[65](U)}function Y(U){l[66](U)}function N(U){l[67](U)}function F(U){l[68](U)}function G(U){l[69](U)}function K(U){l[70](U)}let X={history:l[21],selectedModels:l[1],transparentBackground:((Q=l[27])==null?void 0:Q.backgroundImageUrl)??!1,stopResponse:l[45],createMessagePair:l[41],onChange:l[62]};return l[24]!==void 0&&(X.files=l[24]),l[22]!==void 0&&(X.prompt=l[22]),l[6]!==void 0&&(X.autoScroll=l[6]),l[17]!==void 0&&(X.selectedToolIds=l[17]),l[18]!==void 0&&(X.imageGenerationEnabled=l[18]),l[20]!==void 0&&(X.codeInterpreterEnabled=l[20]),l[19]!==void 0&&(X.webSearchEnabled=l[19]),l[2]!==void 0&&(X.atSelectedModel=l[2]),c=new ta({props:X}),We.push(()=>Je(c,"files",Z)),We.push(()=>Je(c,"prompt",R)),We.push(()=>Je(c,"autoScroll",C)),We.push(()=>Je(c,"selectedToolIds",Y)),We.push(()=>Je(c,"imageGenerationEnabled",N)),We.push(()=>Je(c,"codeInterpreterEnabled",F)),We.push(()=>Je(c,"webSearchEnabled",G)),We.push(()=>Je(c,"atSelectedModel",K)),c.$on("upload",l[71]),c.$on("submit",l[72]),{c(){e=V("div"),t=V("div"),ne(n.$$.fragment),r=ee(),a=V("div"),ne(c.$$.fragment),w=ee(),y=V("div"),y.innerHTML=I,this.h()},l(U){e=z(U,"DIV",{class:!0,id:!0});var J=M(e);t=z(J,"DIV",{class:!0});var q=M(t);se(n.$$.fragment,q),q.forEach(_),J.forEach(_),r=te(U),a=z(U,"DIV",{class:!0});var ce=M(a);se(c.$$.fragment,ce),w=te(ce),y=z(ce,"DIV",{class:!0,"data-svelte-h":!0}),ut(y)!=="svelte-1t2gtm5"&&(y.innerHTML=I),ce.forEach(_),this.h()},h(){m(t,"class","h-full w-full flex flex-col"),m(e,"class","pb-2.5 flex flex-col justify-between w-full flex-auto overflow-auto h-0 max-w-full z-10 scrollbar-hidden"),m(e,"id","messages-container"),m(y,"class","absolute bottom-1 text-xs text-gray-500 text-center line-clamp-1 right-0 left-0"),m(a,"class","pb-[1rem]")},m(U,J){A(U,e,J),k(e,t),le(n,t,null),l[60](e),A(U,r,J),A(U,a,J),le(c,a,null),k(a,w),k(a,y),S=!0,T||(E=ke(e,"scroll",l[61]),T=!0)},p(U,J){var ge;const q={};J[0]&67108864&&(q.chatId=U[26]),J[0]&2&&(q.selectedModels=U[1]),J[0]&16777216&&(q.bottomPadding=U[24].length>0),!o&&J[0]&2097152&&(o=!0,q.history=U[21],qe(()=>o=!1)),!s&&J[0]&64&&(s=!0,q.autoScroll=U[6],qe(()=>s=!1)),!i&&J[0]&4194304&&(i=!0,q.prompt=U[22],qe(()=>i=!1)),n.$set(q);const ce={};J[0]&2097152&&(ce.history=U[21]),J[0]&2&&(ce.selectedModels=U[1]),J[0]&134217728&&(ce.transparentBackground=((ge=U[27])==null?void 0:ge.backgroundImageUrl)??!1),J[0]&67108864&&(ce.onChange=U[62]),!u&&J[0]&16777216&&(u=!0,ce.files=U[24],qe(()=>u=!1)),!f&&J[0]&4194304&&(f=!0,ce.prompt=U[22],qe(()=>f=!1)),!h&&J[0]&64&&(h=!0,ce.autoScroll=U[6],qe(()=>h=!1)),!d&&J[0]&131072&&(d=!0,ce.selectedToolIds=U[17],qe(()=>d=!1)),!p&&J[0]&262144&&(p=!0,ce.imageGenerationEnabled=U[18],qe(()=>p=!1)),!b&&J[0]&1048576&&(b=!0,ce.codeInterpreterEnabled=U[20],qe(()=>b=!1)),!v&&J[0]&524288&&(v=!0,ce.webSearchEnabled=U[19],qe(()=>v=!1)),!g&&J[0]&4&&(g=!0,ce.atSelectedModel=U[2],qe(()=>g=!1)),c.$set(ce)},i(U){S||(D(n.$$.fragment,U),D(c.$$.fragment,U),S=!0)},o(U){P(n.$$.fragment,U),P(c.$$.fragment,U),S=!1},d(U){U&&(_(e),_(r),_(a)),oe(n),l[60](null),oe(c),T=!1,E()}}}function P_(l){let e,t,n,o,s,i,r=l[32].length>0&&!l[21].currentId&&!l[26]&&l[1].length<=1&&Bi(l);const a=[N_,z_],c=[];function u(f,h){var d;return h[0]&136314880&&(n=null),n==null&&(n=((d=f[27])==null?void 0:d.landingPageMode)==="chat"||yn(f[21],f[21].currentId).length>0),n?0:1}return o=u(l,[-1,-1,-1,-1]),s=c[o]=a[o](l),{c(){r&&r.c(),e=ee(),t=V("div"),s.c(),this.h()},l(f){r&&r.l(f),e=te(f),t=z(f,"DIV",{class:!0});var h=M(t);s.l(h),h.forEach(_),this.h()},h(){m(t,"class","flex flex-col flex-auto z-10 w-full @container")},m(f,h){r&&r.m(f,h),A(f,e,h),A(f,t,h),c[o].m(t,null),i=!0},p(f,h){f[32].length>0&&!f[21].currentId&&!f[26]&&f[1].length<=1?r?(r.p(f,h),h[0]&69206018|h[1]&2&&D(r,1)):(r=Bi(f),r.c(),D(r,1),r.m(e.parentNode,e)):r&&(He(),P(r,1,1,()=>{r=null}),Be());let d=o;o=u(f,h),o===d?c[o].p(f,h):(He(),P(c[d],1,1,()=>{c[d]=null}),Be(),s=c[o],s?s.p(f,h):(s=c[o]=a[o](f),s.c()),D(s,1),s.m(t,null))},i(f){i||(D(r),D(s),i=!0)},o(f){P(r),P(s),i=!1},d(f){f&&(_(e),_(t)),r&&r.d(f),c[o].d()}}}function O_(l){var v;let e,t,n,o,s,i,r,a,c;e=new Fi({props:{defaultSize:50,class:"h-full flex w-full relative",$$slots:{default:[P_]},$$scope:{ctx:l}}});function u(g){l[85](g)}function f(g){l[86](g)}function h(g){l[87](g)}function d(g){l[88](g)}function p(g){l[89](g)}let b={chatId:l[26],modelId:((v=l[16])==null?void 0:v.at(0))??null,models:l[16].reduce(l[83],[]),submitPrompt:l[43],stopResponse:l[45],showMessage:l[35],eventTarget:l[34]};return l[21]!==void 0&&(b.history=l[21]),l[23]!==void 0&&(b.chatFiles=l[23]),l[25]!==void 0&&(b.params=l[25]),l[24]!==void 0&&(b.files=l[24]),l[4]!==void 0&&(b.pane=l[4]),n=new b_({props:b}),l[84](n),We.push(()=>Je(n,"history",u)),We.push(()=>Je(n,"chatFiles",f)),We.push(()=>Je(n,"params",h)),We.push(()=>Je(n,"files",d)),We.push(()=>Je(n,"pane",p)),{c(){ne(e.$$.fragment),t=ee(),ne(n.$$.fragment)},l(g){se(e.$$.fragment,g),t=te(g),se(n.$$.fragment,g)},m(g,w){le(e,g,w),A(g,t,w),le(n,g,w),c=!0},p(g,w){var S;const y={};w[0]&226361542|w[1]&2|w[3]&134217728&&(y.$$scope={dirty:w,ctx:g}),e.$set(y);const I={};w[0]&67108864&&(I.chatId=g[26]),w[0]&65536&&(I.modelId=((S=g[16])==null?void 0:S.at(0))??null),w[0]&268500992&&(I.models=g[16].reduce(g[83],[])),!o&&w[0]&2097152&&(o=!0,I.history=g[21],qe(()=>o=!1)),!s&&w[0]&8388608&&(s=!0,I.chatFiles=g[23],qe(()=>s=!1)),!i&&w[0]&33554432&&(i=!0,I.params=g[25],qe(()=>i=!1)),!r&&w[0]&16777216&&(r=!0,I.files=g[24],qe(()=>r=!1)),!a&&w[0]&16&&(a=!0,I.pane=g[4],qe(()=>a=!1)),n.$set(I)},i(g){c||(D(e.$$.fragment,g),D(n.$$.fragment,g),c=!0)},o(g){P(e.$$.fragment,g),P(n.$$.fragment,g),c=!1},d(g){g&&_(t),oe(e,g),l[84](null),oe(n,g)}}}function H_(l){let e,t,n,o,s,i,r,a,c,u,f,h,d;Yo.title=e=`
		`+(l[29]?`${l[29].length>30?`${l[29].slice(0,30)}...`:l[29]} | ${l[30]}`:`${l[30]}`)+`
	`;function p(y){l[50](y)}let b={title:l[10],message:l[11],input:l[12],inputPlaceholder:l[13],inputValue:l[14]};l[9]!==void 0&&(b.show=l[9]),i=new bu({props:b}),We.push(()=>Je(i,"show",p)),i.$on("confirm",l[51]),i.$on("cancel",l[52]);const v=[V_,T_],g=[];function w(y,I){return y[0]===""||!y[3]&&y[0]?0:y[3]?1:-1}return~(u=w(l))&&(f=g[u]=v[u](l)),{c(){t=ee(),n=V("audio"),s=ee(),ne(i.$$.fragment),a=ee(),c=V("div"),f&&f.c(),this.h()},l(y){ja("svelte-8uu834",Yo.head).forEach(_),t=te(y),n=z(y,"AUDIO",{id:!0,src:!0,style:!0}),M(n).forEach(_),s=te(y),se(i.$$.fragment,y),a=te(y),c=z(y,"DIV",{class:!0,id:!0});var S=M(c);f&&f.l(S),S.forEach(_),this.h()},h(){m(n,"id","audioElement"),Jn(n.src,o="")||m(n,"src",o),$e(n,"display","none"),m(c,"class",h="h-screen max-h-[100dvh] transition-width duration-200 ease-in-out "+(l[31]?"  md:max-w-[calc(100%-260px)]":" ")+" w-full max-w-full flex flex-col"),m(c,"id","chat-container")},m(y,I){A(y,t,I),A(y,n,I),A(y,s,I),le(i,y,I),A(y,a,I),A(y,c,I),~u&&g[u].m(c,null),d=!0},p(y,I){(!d||I[0]&1610612736)&&e!==(e=`
		`+(y[29]?`${y[29].length>30?`${y[29].slice(0,30)}...`:y[29]} | ${y[30]}`:`${y[30]}`)+`
	`)&&(Yo.title=e);const S={};I[0]&1024&&(S.title=y[10]),I[0]&2048&&(S.message=y[11]),I[0]&4096&&(S.input=y[12]),I[0]&8192&&(S.inputPlaceholder=y[13]),I[0]&16384&&(S.inputValue=y[14]),!r&&I[0]&512&&(r=!0,S.show=y[9],qe(()=>r=!1)),i.$set(S);let T=u;u=w(y),u===T?~u&&g[u].p(y,I):(f&&(He(),P(g[T],1,1,()=>{g[T]=null}),Be()),~u?(f=g[u],f?f.p(y,I):(f=g[u]=v[u](y),f.c()),D(f,1),f.m(c,null)):f=null),(!d||I[1]&1&&h!==(h="h-screen max-h-[100dvh] transition-width duration-200 ease-in-out "+(y[31]?"  md:max-w-[calc(100%-260px)]":" ")+" w-full max-w-full flex flex-col"))&&m(c,"class",h)},i(y){d||(D(i.$$.fragment,y),D(f),d=!0)},o(y){P(i.$$.fragment,y),P(f),d=!1},d(y){y&&(_(t),_(n),_(s),_(a),_(c)),oe(i,y),~u&&g[u].d()}}}function B_(l,e,t){let n,o,s,i,r,a,c,u,f,h,d,p,b,v,g,w,y;ae(l,il,L=>t(94,n=L)),ae(l,yo,L=>t(95,o=L)),ae(l,cl,L=>t(26,s=L)),ae(l,Kn,L=>t(27,i=L)),ae(l,dl,L=>t(28,a=L)),ae(l,ec,L=>t(97,c=L)),ae(l,Qn,L=>t(98,u=L)),ae(l,Yl,L=>t(99,f=L)),ae(l,In,L=>t(100,h=L)),ae(l,qa,L=>t(101,d=L)),ae(l,wo,L=>t(102,p=L)),ae(l,ul,L=>t(103,b=L)),ae(l,$l,L=>t(29,v=L)),ae(l,Xi,L=>t(30,g=L)),ae(l,Xo,L=>t(31,w=L)),ae(l,tc,L=>t(32,y=L));const I=Ft("i18n");ae(l,I,L=>t(96,r=L));let{chatIdProp:S=""}=e,T=!1;const E=new EventTarget;let H,O,B=!0,j,Z,R=!1,C="",Y="",N=!1,F="",G="",K=null,X,Q=[""],U,J=[],q=[],ce=!1,ge=!1,re=!1,Oe=null,x={messages:{},currentId:null},ue=null,Ee="",Xe=[],Ke=[],fe={};const lt=()=>{Q.length===0||Q.length===1&&Q[0]===""||(sessionStorage.selectedModels=JSON.stringify(Q),console.log("saveSessionSelectedModels",Q,sessionStorage.selectedModels))},it=async()=>{var ie,be;if(b||ul.set(await $o(localStorage.token)),Q.length!==1)return;const L=a.find(ze=>ze.id===Q[0]);L&&t(17,q=(((be=(ie=L==null?void 0:L.info)==null?void 0:ie.meta)==null?void 0:be.toolIds)??[]).filter(ze=>b.find(_e=>_e.id===ze)))},Nt=async L=>{const ie=JSON.parse(JSON.stringify(s));let be=JSON.parse(JSON.stringify(L.id)),ze=x.messages[be].childrenIds;for(;ze.length!==0;)be=ze.at(-1),ze=x.messages[be].childrenIds;t(21,x.currentId=be,x),await xe(),await xe(),await xe();const _e=document.getElementById(`message-${L.id}`);_e&&_e.scrollIntoView({behavior:"smooth"}),await xe(),At(ie,x)},Dt=async(L,ie)=>{var be,ze;if(console.log(L),L.chat_id===s){await xe();let _e=x.messages[L.message_id];if(_e){const ye=((be=L==null?void 0:L.data)==null?void 0:be.type)??null,ve=((ze=L==null?void 0:L.data)==null?void 0:ze.data)??null;if(ye==="status")_e!=null&&_e.statusHistory?_e.statusHistory.push(ve):_e.statusHistory=[ve];else if(ye==="source"||ye==="citation")if((ve==null?void 0:ve.type)==="code_execution"){_e!=null&&_e.code_executions||(_e.code_executions=[]);const Le=_e.code_executions.findIndex(et=>et.id===ve.id);Le!==-1?_e.code_executions[Le]=ve:_e.code_executions.push(ve),_e.code_executions=_e.code_executions}else _e!=null&&_e.sources?_e.sources.push(ve):_e.sources=[ve];else if(ye==="chat:completion")mt(ve,_e,L.chat_id);else if(ye==="chat:title")$l.set(ve),il.set(1),await al.set(await bl(localStorage.token,n));else if(ye==="chat:tags")Oe=await Ko(localStorage.token,s),nc.set(await _c(localStorage.token));else if(ye==="message")_e.content+=ve.content;else if(ye==="replace")_e.content=ve.content;else if(ye==="action"){if(ve.action==="continue"){const Le=document.getElementById("continue-response-button");Le&&Le.click()}}else if(ye==="confirmation")t(15,K=ie),t(12,N=!1),t(9,R=!0),t(10,C=ve.title),t(11,Y=ve.message);else if(ye==="execute"){t(15,K=ie);try{const et=await new Function(`return (async () => { ${ve.code} })()`)();ie&&ie(et)}catch(Le){console.error("Error executing code:",Le)}}else if(ye==="input")t(15,K=ie),t(12,N=!0),t(9,R=!0),t(10,C=ve.title),t(11,Y=ve.message),t(13,F=ve.placeholder),t(14,G=(ve==null?void 0:ve.value)??"");else if(ye==="notification"){const Le=(ve==null?void 0:ve.type)??"info",et=(ve==null?void 0:ve.content)??"";Le==="success"?nt.success(et):Le==="error"?nt.error(et):Le==="warning"?nt.warning(et):nt.info(et)}else console.log("Unknown message type",ve);t(21,x.messages[L.message_id]=_e,x)}}},Ht=async L=>{if(L.origin===window.origin){if(L.data.type==="input:prompt"){console.debug(L.data.text);const ie=document.getElementById("chat-input");ie&&(t(22,Ee=L.data.text),ie.focus())}L.data.type==="action:submit"&&(console.debug(L.data.text),Ee!==""&&(await xe(),de(Ee))),L.data.type==="input:prompt:submit"&&(console.debug(L.data.text),Ee!==""&&(await xe(),de(L.data.text)))}};pn(async()=>{if(console.log("mounted"),window.addEventListener("message",Ht),c==null||c.on("chat-events",Dt),s?o&&await Po("/"):X=cl.subscribe(async ie=>{ie||await Ye()}),localStorage.getItem(`chat-input-${S}`))try{const ie=JSON.parse(localStorage.getItem(`chat-input-${S}`));t(22,Ee=ie.prompt),t(24,Ke=ie.files),t(17,q=ie.selectedToolIds),t(19,ge=ie.webSearchEnabled),t(18,ce=ie.imageGenerationEnabled)}catch{t(22,Ee=""),t(24,Ke=[]),t(17,q=[]),t(19,ge=!1),t(18,ce=!1)}jt.subscribe(async ie=>{if(H&&!p)try{ie?O.openPane():H.collapse()}catch{}ie||(In.set(!1),Zn.set(!1),Fn.set(!1))});const L=document.getElementById("chat-input");L==null||L.focus(),al.subscribe(()=>{})}),nl(()=>{X==null||X(),window.removeEventListener("message",Ht),c==null||c.off("chat-events",Dt)});const wt=async L=>{var ze,_e;if(console.log("Starting uploadGoogleDriveFile with:",{id:L.id,name:L.name,url:L.url,headers:{Authorization:`Bearer ${token}`}}),!(L!=null&&L.id)||!(L!=null&&L.name)||!(L!=null&&L.url)||!((ze=L==null?void 0:L.headers)!=null&&ze.Authorization))throw new Error("Invalid file data provided");const ie=$n(),be={type:"file",file:"",id:null,url:L.url,name:L.name,collection_name:"",status:"uploading",error:"",itemId:ie,size:0};try{t(24,Ke=[...Ke,be]),console.log("Processing web file with URL:",L.url);const ye={headers:{Authorization:L.headers.Authorization,Accept:"*/*"},method:"GET"};console.log("Fetching file content from Google Drive...");const ve=await fetch(L.url,ye);if(!ve.ok){const zt=await ve.text();throw new Error(`Failed to fetch file (${ve.status}): ${zt}`)}const Le=ve.headers.get("content-type")||"application/octet-stream";console.log("Response received with content-type:",Le),console.log("Converting response to blob...");const et=await ve.blob();if(et.size===0)throw new Error("Retrieved file is empty");console.log("Blob created:",{size:et.size,type:et.type||Le});const ft=new File([et],L.name,{type:et.type||Le});if(console.log("File object created:",{name:ft.name,size:ft.size,type:ft.type}),ft.size===0)throw new Error("Created file is empty");console.log("Uploading file to server...");const St=await uploadFile(localStorage.token,ft);if(!St)throw new Error("Server returned null response for file upload");console.log("File uploaded successfully:",St),be.status="uploaded",be.file=St,be.id=St.id,be.size=ft.size,be.collection_name=(_e=St==null?void 0:St.meta)==null?void 0:_e.collection_name,be.url=`${WEBUI_API_BASE_URL}/files/${St.id}`,t(24,Ke),t(0,S),nt.success(r.t("File uploaded successfully"))}catch(ye){console.error("Error uploading file:",ye),t(24,Ke=Ke.filter(ve=>ve.itemId!==ie)),nt.error(r.t("Error uploading file: {{error}}",{error:ye.message||"Unknown error"}))}},Ut=async L=>{console.log(L);const ie={type:"doc",name:L,collection_name:"",status:"uploading",url:L,error:""};try{t(24,Ke=[...Ke,ie]);const be=await vc(localStorage.token,"",L);be&&(ie.status="uploaded",ie.collection_name=be.collection_name,ie.file={...be.file,...ie.file},t(24,Ke),t(0,S))}catch(be){t(24,Ke=Ke.filter(ze=>ze.name!==L)),nt.error(JSON.stringify(be))}},pe=async L=>{console.log(L);const ie={type:"doc",name:L,collection_name:"",status:"uploading",context:"full",url:L,error:""};try{t(24,Ke=[...Ke,ie]);const be=await wc(localStorage.token,L);be&&(ie.status="uploaded",ie.collection_name=be.collection_name,ie.file={...be.file,...ie.file},t(24,Ke),t(0,S))}catch(be){t(24,Ke=Ke.filter(ze=>ze.name!==L)),nt.error(`${be}`)}},Ye=async()=>{var be,ze,_e,ye;if(d.url.searchParams.get("models"))t(1,Q=(be=d.url.searchParams.get("models"))==null?void 0:be.split(","));else if(d.url.searchParams.get("model")){const ve=(ze=d.url.searchParams.get("model"))==null?void 0:ze.split(",");if(ve.length===1)if(a.find(et=>et.id===ve[0]))t(1,Q=ve);else{const et=document.getElementById("model-selector-0-button");if(et){et.click(),await xe();const ft=document.getElementById("model-search-input");ft&&(ft.focus(),ft.value=ve[0],ft.dispatchEvent(new Event("input")))}}else t(1,Q=ve)}else sessionStorage.selectedModels?(t(1,Q=JSON.parse(sessionStorage.selectedModels)),sessionStorage.removeItem("selectedModels")):i!=null&&i.models?t(1,Q=i==null?void 0:i.models):f!=null&&f.default_models&&(console.log((f==null?void 0:f.default_models.split(","))??""),t(1,Q=f==null?void 0:f.default_models.split(",")));t(1,Q=Q.filter(ve=>a.map(Le=>Le.id).includes(ve))),(Q.length===0||Q.length===1&&Q[0]==="")&&(a.length>0?t(1,Q=[a[0].id]):t(1,Q=[""])),await jt.set(!1),await In.set(!1),await Zn.set(!1),await Fn.set(!1),d.url.pathname.includes("/c/")&&window.history.replaceState(x.state,"","/"),t(6,B=!0),await cl.set(""),await $l.set(""),t(21,x={messages:{},currentId:null}),t(23,Xe=[]),t(25,fe={}),d.url.searchParams.get("youtube")&&pe(`https://www.youtube.com/watch?v=${d.url.searchParams.get("youtube")}`),d.url.searchParams.get("web-search")==="true"&&t(19,ge=!0),d.url.searchParams.get("image-generation")==="true"&&t(18,ce=!0),d.url.searchParams.get("tools")?t(17,q=(_e=d.url.searchParams.get("tools"))==null?void 0:_e.split(",").map(ve=>ve.trim()).filter(ve=>ve)):d.url.searchParams.get("tool-ids")&&t(17,q=(ye=d.url.searchParams.get("tool-ids"))==null?void 0:ye.split(",").map(ve=>ve.trim()).filter(ve=>ve)),d.url.searchParams.get("call")==="true"&&(In.set(!0),jt.set(!0)),d.url.searchParams.get("q")&&(t(22,Ee=d.url.searchParams.get("q")??""),Ee&&(await xe(),de(Ee))),t(1,Q=Q.map(ve=>a.map(Le=>Le.id).includes(ve)?ve:""));const L=await ps(localStorage.token);L?Kn.set(L.ui):Kn.set(JSON.parse(localStorage.getItem("settings")??"{}"));const ie=document.getElementById("chat-input");setTimeout(()=>ie==null?void 0:ie.focus(),0)},ot=async()=>{if(cl.set(S),Oe=await Ko(localStorage.token,s).catch(async L=>(await Po("/"),null)),Oe){await pc(localStorage.token,s).catch(async ie=>[]);const L=Oe.chat;if(L){console.log(L),t(1,Q=((L==null?void 0:L.models)??void 0)!==void 0?L.models:[L.models??""]),t(21,x=((L==null?void 0:L.history)??void 0)!==void 0?L.history:mc(L.messages)),$l.set(L.title);const ie=await ps(localStorage.token);return ie?await Kn.set(ie.ui):await Kn.set(JSON.parse(localStorage.getItem("settings")??"{}")),t(25,fe=(L==null?void 0:L.params)??{}),t(23,Xe=(L==null?void 0:L.files)??[]),t(6,B=!0),await xe(),x.currentId&&t(21,x.messages[x.currentId].done=!0,x),await xe(),!0}else return null}},he=async()=>{await xe(),j&&t(7,j.scrollTop=j.scrollHeight,j)},yt=async(L,ie,be,ze)=>{const _e=await Oc(localStorage.token,{model:ie,messages:ze.map(ye=>({id:ye.id,role:ye.role,content:ye.content,info:ye.info?ye.info:void 0,timestamp:ye.timestamp,...ye.sources?{sources:ye.sources}:{}})),model_item:a.find(ye=>ye.id===ie),chat_id:L,session_id:c==null?void 0:c.id,id:be}).catch(ye=>(nt.error(`${ye}`),ze.at(-1).error={content:ye},null));if(_e!==null&&_e.messages)for(const ye of _e.messages)ye!=null&&ye.id&&t(21,x.messages[ye.id]={...x.messages[ye.id],...x.messages[ye.id].content!==ye.content?{originalContent:x.messages[ye.id].content}:{},...ye},x);await xe(),s==L&&(o||(Oe=await Ho(localStorage.token,L,{models:Q,messages:ze,history:x,params:fe,files:Xe}),il.set(1),await al.set(await bl(localStorage.token,n))))},ht=async(L,ie,be,ze,_e=null)=>{const ye=yn(x,ze),ve=await zc(localStorage.token,ie,{model:be,messages:ye.map(Le=>({id:Le.id,role:Le.role,content:Le.content,info:Le.info?Le.info:void 0,timestamp:Le.timestamp,...Le.sources?{sources:Le.sources}:{}})),..._e?{event:_e}:{},model_item:a.find(Le=>Le.id===be),chat_id:L,session_id:c==null?void 0:c.id,id:ze}).catch(Le=>(nt.error(`${Le}`),ye.at(-1).error={content:Le},null));if(ve!==null&&ve.messages)for(const Le of ve.messages)t(21,x.messages[Le.id]={...x.messages[Le.id],...x.messages[Le.id].content!==Le.content?{originalContent:x.messages[Le.id].content}:{},...Le},x);s==L&&(o||(Oe=await Ho(localStorage.token,L,{models:Q,messages:ye,history:x,params:fe,files:Xe}),il.set(1),await al.set(await bl(localStorage.token,n))))},bt=async(L,ie="")=>setInterval(()=>{c==null||c.emit("usage",{action:"chat",model:L,chat_id:ie})},1e3),Ce=async L=>{if(t(22,Ee=""),Q.length===0)nt.error(r.t("Model not selected"));else{const ie=Q[0],be=a.filter(ft=>ft.id===ie).at(0),ze=yn(x,x.currentId),_e=ze.length!==0?ze.at(-1):null,ye=$n(),ve=$n(),Le={id:ye,parentId:_e?_e.id:null,childrenIds:[ve],role:"user",content:L||`[PROMPT] ${ye}`,timestamp:Math.floor(Date.now()/1e3)},et={id:ve,parentId:ye,childrenIds:[],role:"assistant",content:`[RESPONSE] ${ve}`,done:!0,model:ie,modelName:be.name??be.id,modelIdx:0,timestamp:Math.floor(Date.now()/1e3)};_e&&(_e.childrenIds.push(ye),t(21,x.messages[_e.id]=_e,x)),t(21,x.messages[ye]=Le,x),t(21,x.messages[ve]=et,x),t(21,x.currentId=ve,x),await xe(),B&&he(),ze.length===0?await Bt(x):await At(s,x)}},Pt=async({modelId:L,parentId:ie,messages:be})=>{const ze=a.filter(ve=>ve.id===L).at(0);let _e=x.messages[ie],ye=_e?_e.id:null;for(const ve of be){let Le=$n();if(ve.role==="user"){const et={id:Le,parentId:ye,childrenIds:[],timestamp:Math.floor(Date.now()/1e3),...ve};_e&&(_e.childrenIds.push(Le),t(21,x.messages[_e.id]=_e,x)),t(21,x.messages[Le]=et,x),_e=et,ye=Le}else{const et={id:Le,parentId:ye,childrenIds:[],done:!0,model:ze.id,modelName:ze.name??ze.id,modelIdx:0,timestamp:Math.floor(Date.now()/1e3),...ve};_e&&(_e.childrenIds.push(Le),t(21,x.messages[_e.id]=_e,x)),t(21,x.messages[Le]=et,x),_e=et,ye=Le}}t(21,x.currentId=ye,x),await xe(),B&&he(),be.length===0?await Bt(x):await At(s,x)},mt=async(L,ie,be)=>{var zt,pt,nn,fn,vn,Xn,zn,Rn,wn,dn,an,hn,mn,Nn;const{id:ze,done:_e,choices:ye,content:ve,sources:Le,selected_model_id:et,error:ft,usage:St}=L;if(ft&&await Ge(ft,ie),Le&&(ie.sources=Le),ye)if((pt=(zt=ye[0])==null?void 0:zt.message)!=null&&pt.content)ie.content+=(fn=(nn=ye[0])==null?void 0:nn.message)==null?void 0:fn.content;else{let Lt=((Xn=(vn=ye[0])==null?void 0:vn.delta)==null?void 0:Xn.content)??"";if(ie.content==""&&Lt==`
`)console.log("Empty response");else{ie.content+=Lt,navigator.vibrate&&((i==null?void 0:i.hapticFeedback)??!1)&&navigator.vibrate(5);const un=Oo(ie.content,((Rn=(zn=f==null?void 0:f.audio)==null?void 0:zn.tts)==null?void 0:Rn.split_on)??"punctuation");un.pop(),un.length>0&&un[un.length-1]!==ie.lastSentence&&(ie.lastSentence=un[un.length-1],E.dispatchEvent(new CustomEvent("chat",{detail:{id:ie.id,content:un[un.length-1]}})))}}if(ve){ie.content=ve,navigator.vibrate&&((i==null?void 0:i.hapticFeedback)??!1)&&navigator.vibrate(5);const Lt=Oo(ie.content,((dn=(wn=f==null?void 0:f.audio)==null?void 0:wn.tts)==null?void 0:dn.split_on)??"punctuation");Lt.pop(),Lt.length>0&&Lt[Lt.length-1]!==ie.lastSentence&&(ie.lastSentence=Lt[Lt.length-1],E.dispatchEvent(new CustomEvent("chat",{detail:{id:ie.id,content:Lt[Lt.length-1]}})))}if(et&&(ie.selectedModelId=et,ie.arena=!0),St&&(ie.usage=St),t(21,x.messages[ie.id]=ie,x),_e){ie.done=!0,i.responseAutoCopy&&xo(ie.content),i.responseAutoPlayback&&!h&&(await xe(),(an=document.getElementById(`speak-button-${ie.id}`))==null||an.click());let Lt=((Nn=Oo(ie.content,((mn=(hn=f==null?void 0:f.audio)==null?void 0:hn.tts)==null?void 0:mn.split_on)??"punctuation"))==null?void 0:Nn.at(-1))??"";Lt&&E.dispatchEvent(new CustomEvent("chat",{detail:{id:ie.id,content:Lt}})),E.dispatchEvent(new CustomEvent("chat:finish",{detail:{id:ie.id,content:ie.content}})),t(21,x.messages[ie.id]=ie,x),await yt(be,ie.model,ie.id,yn(x,ie.id))}console.log(L),B&&he()},de=async(L,{_raw:ie=!1}={})=>{var ft,St,zt;console.log("submitPrompt",L,s);const be=yn(x,x.currentId),ze=Q.map(pt=>a.map(nn=>nn.id).includes(pt)?pt:"");if(JSON.stringify(Q)!==JSON.stringify(ze)&&t(1,Q=ze),L===""&&Ke.length===0){nt.error(r.t("Please enter a prompt"));return}if(Q.includes("")){nt.error(r.t("Model not selected"));return}if(be.length!=0&&be.at(-1).done!=!0)return;if(be.length!=0&&be.at(-1).error&&!be.at(-1).content){nt.error(r.t("Oops! There was an error in the previous response."));return}if(Ke.length>0&&Ke.filter(pt=>pt.type!=="image"&&pt.status==="uploading").length>0){nt.error(r.t("Oops! There are files still uploading. Please wait for the upload to complete."));return}if((((ft=f==null?void 0:f.file)==null?void 0:ft.max_count)??null)!==null&&Ke.length+Xe.length>((St=f==null?void 0:f.file)==null?void 0:St.max_count)){nt.error(r.t("You can only chat with a maximum of {{maxCount}} file(s) at a time.",{maxCount:(zt=f==null?void 0:f.file)==null?void 0:zt.max_count}));return}t(22,Ee="");const _e=document.getElementById("chat-input");_e&&(_e.style.height="");const ye=JSON.parse(JSON.stringify(Ke));Xe.push(...ye.filter(pt=>["doc","file","collection"].includes(pt.type))),t(23,Xe=Xe.filter((pt,nn,fn)=>fn.findIndex(vn=>JSON.stringify(vn)===JSON.stringify(pt))===nn)),t(24,Ke=[]),t(22,Ee="");let ve=$n(),Le={id:ve,parentId:be.length!==0?be.at(-1).id:null,childrenIds:[],role:"user",content:L,files:ye.length>0?ye:void 0,timestamp:Math.floor(Date.now()/1e3),models:Q};t(21,x.messages[ve]=Le,x),t(21,x.currentId=ve,x),be.length!==0&&x.messages[be.at(-1).id].childrenIds.push(ve);const et=document.getElementById("chat-input");et==null||et.focus(),lt(),await De(x,L,ve,{newChat:!0})},De=async(L,ie,be,{modelId:ze=null,modelIdx:_e=null,newChat:ye=!1}={})=>{let ve=JSON.parse(JSON.stringify(s));L=JSON.parse(JSON.stringify(L));const Le={};let et=ze?[ze]:U!==void 0?[U.id]:Q;for(const[ft,St]of et.entries()){const zt=a.filter(pt=>pt.id===St).at(0);if(zt){let pt=$n(),nn={parentId:be,id:pt,childrenIds:[],role:"assistant",content:"",model:zt.id,modelName:zt.name??zt.id,modelIdx:_e||ft,userContext:null,timestamp:Math.floor(Date.now()/1e3)};t(21,x.messages[pt]=nn,x),t(21,x.currentId=pt,x),be!==null&&x.messages[be]&&t(21,x.messages[be].childrenIds=[...x.messages[be].childrenIds,pt],x),Le[`${St}-${_e||ft}`]=pt}}t(21,x),ye&&L.messages[L.currentId].parentId===null&&(ve=await Bt(L)),await xe(),L=JSON.parse(JSON.stringify(x)),await At(ve,L),await Promise.all(et.map(async(ft,St)=>{var pt,nn,fn;console.log("modelId",ft);const zt=a.filter(vn=>vn.id===ft).at(0);if(zt){yn(L,be).some(an=>{var hn;return(hn=an.files)==null?void 0:hn.some(mn=>mn.type==="image")})&&!(((fn=(nn=(pt=zt.info)==null?void 0:pt.meta)==null?void 0:nn.capabilities)==null?void 0:fn.vision)??!0)&&nt.error(r.t("Model {{modelName}} is not vision capable",{modelName:zt.name??zt.id}));let zn=Le[`${ft}-${_e||St}`],Rn=L.messages[zn],wn=null;if(((i==null?void 0:i.memory)??!1)&&wn===null){const an=await Cc(localStorage.token,ie).catch(hn=>(nt.error(`${hn}`),null));an&&(an.documents[0].length>0&&(wn=an.documents[0].reduce((hn,mn,Nn)=>{const Lt=an.metadatas[0][Nn].created_at,un=new Date(Lt*1e3).toISOString().split("T")[0];return`${hn}${Nn+1}. [${un}]. ${mn}
`},"")),console.log(wn))}Rn.userContext=wn;const dn=await bt(zt.id,ve);he(),await Ve(L,zt,zn),dn&&clearInterval(dn)}else nt.error(r.t("Model {{modelId}} not found",{modelId:ft}))})),il.set(1),al.set(await bl(localStorage.token,n))},Ve=async(L,ie,be,ze)=>{var St,zt,pt,nn,fn,vn,Xn,zn,Rn,wn,dn,an,hn,mn,Nn,Lt,un,ss,rs;const _e=L.messages[be],ye=L.messages[_e.parentId];let ve=JSON.parse(JSON.stringify(Xe));ve.push(...((ye==null?void 0:ye.files)??[]).filter(ct=>["doc","file","collection"].includes(ct.type)),...((_e==null?void 0:_e.files)??[]).filter(ct=>["web_search_results"].includes(ct.type))),ve=ve.filter((ct,zl,is)=>is.findIndex(Jl=>JSON.stringify(Jl)===JSON.stringify(ct))===zl),he(),E.dispatchEvent(new CustomEvent("chat:start",{detail:{id:be}})),await xe();const Le=((zt=(St=ie==null?void 0:ie.info)==null?void 0:St.params)==null?void 0:zt.stream_response)??((pt=i==null?void 0:i.params)==null?void 0:pt.stream_response)??(fe==null?void 0:fe.stream_response)??!0;let et=[fe!=null&&fe.system||i.system||((_e==null?void 0:_e.userContext)??null)?{role:"system",content:`${fc((fe==null?void 0:fe.system)??(i==null?void 0:i.system)??"",u.name,i!=null&&i.userLocation?await bs(localStorage.token):void 0)}${(_e==null?void 0:_e.userContext)??null?`

User Context:
${(_e==null?void 0:_e.userContext)??""}`:""}`}:void 0,...yn(L,be).map(ct=>({...ct,content:dc(ct.content,["reasoning","code_interpreter"])}))].filter(ct=>ct);et=et.map((ct,zl,is)=>{var Jl,as,cs;return{role:ct.role,...((Jl=ct.files)==null?void 0:Jl.filter(Nl=>Nl.type==="image").length)>0&&ct.role==="user"?{content:[{type:"text",text:((as=ct==null?void 0:ct.merged)==null?void 0:as.content)??ct.content},...ct.files.filter(Nl=>Nl.type==="image").map(Nl=>({type:"image_url",image_url:{url:Nl.url}}))]}:{content:((cs=ct==null?void 0:ct.merged)==null?void 0:cs.content)??ct.content}}}).filter(ct=>{var zl;return(ct==null?void 0:ct.role)==="user"||((zl=ct==null?void 0:ct.content)==null?void 0:zl.trim())});const ft=await bc(localStorage.token,{stream:Le,model:ie.id,messages:et,params:{...i==null?void 0:i.params,...fe,format:i.requestFormat??void 0,keep_alive:i.keepAlive??void 0,stop:(fe==null?void 0:fe.stop)??((nn=i==null?void 0:i.params)==null?void 0:nn.stop)??void 0?((fe==null?void 0:fe.stop.split(",").map(ct=>ct.trim()))??i.params.stop).map(ct=>decodeURIComponent(JSON.parse('"'+ct.replace(/\"/g,'\\"')+'"'))):void 0},files:((ve==null?void 0:ve.length)??0)>0?ve:void 0,tool_ids:q.length>0?q:void 0,features:{image_generation:(fn=f==null?void 0:f.features)!=null&&fn.enable_image_generation&&(u.role==="admin"||(Xn=(vn=u==null?void 0:u.permissions)==null?void 0:vn.features)!=null&&Xn.image_generation)?ce:!1,code_interpreter:(zn=f==null?void 0:f.features)!=null&&zn.enable_code_interpreter&&(u.role==="admin"||(wn=(Rn=u==null?void 0:u.permissions)==null?void 0:Rn.features)!=null&&wn.code_interpreter)?re:!1,web_search:(dn=f==null?void 0:f.features)!=null&&dn.enable_web_search&&(u.role==="admin"||(hn=(an=u==null?void 0:u.permissions)==null?void 0:an.features)!=null&&hn.web_search)?ge||((i==null?void 0:i.webSearch)??!1)==="always":!1},variables:{...hc(u.name,i!=null&&i.userLocation?await bs(localStorage.token):void 0)},model_item:a.find(ct=>ct.id===ie.id),session_id:c==null?void 0:c.id,chat_id:s,id:be,...!o&&(et.length==1||et.length==2&&((mn=et.at(0))==null?void 0:mn.role)==="system"&&((Nn=et.at(1))==null?void 0:Nn.role)==="user")&&(Q[0]===ie.id||U!==void 0)?{background_tasks:{title_generation:((Lt=i==null?void 0:i.title)==null?void 0:Lt.auto)??!0,tags_generation:(i==null?void 0:i.autoTags)??!0}}:{},...Le&&(((rs=(ss=(un=ie.info)==null?void 0:un.meta)==null?void 0:ss.capabilities)==null?void 0:rs.usage)??!1)?{stream_options:{include_usage:!0}}:{}},`${Hl}/api`).catch(ct=>(nt.error(`${ct}`),_e.error={content:ct},_e.done=!0,t(21,x.messages[be]=_e,x),t(21,x.currentId=be,x),null));console.log(ft),ft&&(ue=ft.task_id),await xe(),he()},Ge=async(L,ie)=>{let be="",ze;L&&(ze=L),console.error(ze),"detail"in ze?(nt.error(ze.detail),be=ze.detail):"error"in ze?"message"in ze.error?(nt.error(ze.error.message),be=ze.error.message):(nt.error(ze.error),be=ze.error):"message"in ze&&(nt.error(ze.message),be=ze.message),ie.error={content:r.t("Uh-oh! There was an issue with the response.")+`
`+be},ie.done=!0,ie.statusHistory&&(ie.statusHistory=ie.statusHistory.filter(_e=>_e.action!=="knowledge_search")),t(21,x.messages[ie.id]=ie,x)},It=()=>{if(ue&&Nc(localStorage.token,ue).catch(ie=>null)){ue=null;const ie=x.messages[x.currentId];ie.done=!0,t(21,x.messages[x.currentId]=ie,x),B&&he()}},kt=async(L,ie)=>{let be=ie,ze=$n(),_e={id:ze,parentId:L,childrenIds:[],role:"user",content:be,models:Q};L!==null&&t(21,x.messages[L].childrenIds=[...x.messages[L].childrenIds,ze],x),t(21,x.messages[ze]=_e,x),t(21,x.currentId=ze,x),await xe(),await De(x,be,ze)},Mt=async L=>{if(console.log("regenerateResponse"),x.currentId){let ie=x.messages[L.parentId],be=ie.content;((ie==null?void 0:ie.models)??[...Q]).length==1?await De(x,be,ie.id):await De(x,be,ie.id,{modelId:L.model,modelIdx:L.modelIdx})}},Tt=async()=>{if(console.log("continueResponse"),JSON.parse(JSON.stringify(s)),x.currentId&&x.messages[x.currentId].done==!0){const L=x.messages[x.currentId];L.done=!1,await xe();const ie=a.filter(be=>be.id===((L==null?void 0:L.selectedModelId)??L.model)).at(0);ie&&await Ve(x,ie,L.id)}},sn=async(L,ie,be)=>{console.log("mergeResponses",L,ie);const ze=x.messages[L],_e={status:!0,content:""};ze.merged=_e,t(21,x.messages[L]=ze,x);try{const[ye,ve]=await Pc(localStorage.token,ze.model,x.messages[ze.parentId].content,ie);if(ye&&ye.ok&&ye.body){const Le=await Uu(ye.body,i.splitLargeChunks);for await(const et of Le){const{value:ft,done:St,sources:zt,error:pt,usage:nn}=et;if(pt||St)break;_e.content==""&&ft==`
`||(_e.content+=ft,t(21,x.messages[L]=ze,x),B&&he())}await At(be,x)}else console.error(ye)}catch(ye){console.error(ye)}},Bt=async L=>{let ie=s;return o?(ie="local",await cl.set("local")):(Oe=await gc(localStorage.token,{id:ie,title:r.t("New Chat"),models:Q,system:i.system??void 0,params:fe,history:L,messages:yn(L,L.currentId),tags:[],timestamp:Date.now()}),ie=Oe.id,await cl.set(ie),await al.set(await bl(localStorage.token,n)),il.set(1),window.history.replaceState(L.state,"",`/c/${ie}`)),await xe(),ie},At=async(L,ie)=>{s==L&&(o||(Oe=await Ho(localStorage.token,L,{models:Q,history:ie,messages:yn(ie,ie.currentId),params:fe,files:Xe}),il.set(1),await al.set(await bl(localStorage.token,n))))};function Kt(L){R=L,t(9,R)}const Gt=L=>{L.detail?K(L.detail):K(!0)},tn=()=>{K(!1)};function rn(L){We[L?"unshift":"push"](()=>{Z=L,t(8,Z)})}function Wt(L){Q=L,t(1,Q)}const _t=L=>L.dismissible?!JSON.parse(localStorage.getItem("dismissedBannerIds")??"[]").includes(L.id):!0,W=L=>{const ie=L.detail;localStorage.setItem("dismissedBannerIds",JSON.stringify([ie,...JSON.parse(localStorage.getItem("dismissedBannerIds")??"[]")].filter(be=>y.find(ze=>ze.id===be))))};function Me(L){x=L,t(21,x)}function Ze(L){B=L,t(6,B)}function tt(L){Ee=L,t(22,Ee),t(0,S)}function je(L){We[L?"unshift":"push"](()=>{j=L,t(7,j)})}const at=L=>{t(6,B=j.scrollHeight-j.scrollTop<=j.clientHeight+5)},Jt=L=>{L.prompt?localStorage.setItem(`chat-input-${s}`,JSON.stringify(L)):localStorage.removeItem(`chat-input-${s}`)};function Cn(L){Ke=L,t(24,Ke),t(0,S)}function dt(L){Ee=L,t(22,Ee),t(0,S)}function Ct(L){B=L,t(6,B)}function bn(L){q=L,t(17,q),t(0,S)}function kn(L){ce=L,t(18,ce),t(0,S)}function Mn(L){re=L,t(20,re)}function ll(L){ge=L,t(19,ge),t(0,S)}function Tn(L){U=L,t(2,U)}const hl=async L=>{const{type:ie,data:be}=L.detail;ie==="web"?await Ut(be):ie==="youtube"?await pe(be):ie==="google-drive"&&await wt(be)},ol=async L=>{(L.detail||Ke.length>0)&&(await xe(),de((i==null?void 0:i.richTextInput)??!0?L.detail.replaceAll(`

`,`
`):L.detail))};function En(L){Ke=L,t(24,Ke),t(0,S)}function An(L){Ee=L,t(22,Ee),t(0,S)}function Yn(L){B=L,t(6,B)}function xn(L){q=L,t(17,q),t(0,S)}function sl(L){ce=L,t(18,ce),t(0,S)}function Vn(L){re=L,t(20,re)}function ml(L){ge=L,t(19,ge),t(0,S)}function rl(L){U=L,t(2,U)}const $=async L=>{const{type:ie,data:be}=L.detail;ie==="web"?await Ut(be):ie==="youtube"&&await pe(be)},Zt=async L=>{(L.detail||Ke.length>0)&&(await xe(),de((i==null?void 0:i.richTextInput)??!0?L.detail.replaceAll(`

`,`
`):L.detail))},Vt=(L,ie,be,ze)=>{const _e=a.find(ye=>ye.id===ie);return _e?[...L,_e]:L};function gl(L){We[L?"unshift":"push"](()=>{O=L,t(5,O)})}function Gl(L){x=L,t(21,x)}function ql(L){Xe=L,t(23,Xe)}function _l(L){fe=L,t(25,fe)}function Ln(L){Ke=L,t(24,Ke),t(0,S)}function pl(L){H=L,t(4,H)}return l.$$set=L=>{"chatIdProp"in L&&t(0,S=L.chatIdProp)},l.$$.update=()=>{l.$$.dirty[0]&6&&t(16,J=U!==void 0?[U.id]:Q),l.$$.dirty[0]&1&&S&&(async()=>{if(t(3,T=!0),console.log(S),t(22,Ee=""),t(24,Ke=[]),t(17,q=[]),t(19,ge=!1),t(18,ce=!1),S&&await ot()){if(await xe(),t(3,T=!1),localStorage.getItem(`chat-input-${S}`))try{const ie=JSON.parse(localStorage.getItem(`chat-input-${S}`));t(22,Ee=ie.prompt),t(24,Ke=ie.files),t(17,q=ie.selectedToolIds),t(19,ge=ie.webSearchEnabled),t(18,ce=ie.imageGenerationEnabled)}catch{}window.setTimeout(()=>he(),0);const L=document.getElementById("chat-input");L==null||L.focus()}else await Po("/")})(),l.$$.dirty[0]&3&&Q&&S!==""&&lt(),l.$$.dirty[0]&2&&Q&&it()},[S,Q,U,T,H,O,B,j,Z,R,C,Y,N,F,G,K,J,q,ce,ge,re,x,Ee,Xe,Ke,fe,s,i,a,v,g,w,y,I,E,Nt,wt,Ut,pe,Ye,ht,Ce,Pt,de,De,It,kt,Mt,Tt,sn,Kt,Gt,tn,rn,Wt,_t,W,Me,Ze,tt,je,at,Jt,Cn,dt,Ct,bn,kn,Mn,ll,Tn,hl,ol,En,An,Yn,xn,sl,Vn,ml,rl,$,Zt,Vt,gl,Gl,ql,_l,Ln,pl]}class i2 extends Re{constructor(e){super(),Ue(this,e,B_,H_,Fe,{chatIdProp:0},null,[-1,-1,-1,-1])}}function A_(l){let e,t,n,o=l[1].t("Keyboard shortcuts")+"",s,i,r,a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',c,u,f,h,d,p,b=l[1].t("Open new chat")+"",v,g,w,y='<div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Shift</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">O</div>',I,S,T,E=l[1].t("Focus chat input")+"",H,O,B,j='<div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Shift</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Esc</div>',Z,R,C,Y=l[1].t("Copy last code block")+"",N,F,G,K='<div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Shift</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">;</div>',X,Q,U,J=l[1].t("Copy last response")+"",q,ce,ge,re='<div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Shift</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">C</div>',Oe,x,ue,Ee,Xe=l[1].t("Toggle settings")+"",Ke,fe,lt,it='<div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">.</div>',Nt,Dt,Ht,wt=l[1].t("Toggle sidebar")+"",Ut,pe,Ye,ot='<div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Shift</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">S</div>',he,yt,ht,bt=l[1].t("Delete chat")+"",Ce,Pt,mt,de='<div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Shift</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">âŒ«/Delete</div>',De,Ve,Ge,It=l[1].t("Show shortcuts")+"",kt,Mt,Tt,sn='<div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">/</div>',Bt,At,Kt,Gt=l[1].t("Input commands")+"",tn,rn,Wt,_t,W,Me,Ze,tt=l[1].t("Attach file")+"",je,at,Jt,Cn='<div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">#</div>',dt,Ct,bn,kn=l[1].t("Add custom prompt")+"",Mn,ll,Tn,hl='<div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">/</div>',ol,En,An,Yn=l[1].t("Select model")+"",xn,sl,Vn,ml='<div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">@</div>',rl,$;return{c(){e=V("div"),t=V("div"),n=V("div"),s=Ie(o),i=ee(),r=V("button"),r.innerHTML=a,c=ee(),u=V("div"),f=V("div"),h=V("div"),d=V("div"),p=V("div"),v=Ie(b),g=ee(),w=V("div"),w.innerHTML=y,I=ee(),S=V("div"),T=V("div"),H=Ie(E),O=ee(),B=V("div"),B.innerHTML=j,Z=ee(),R=V("div"),C=V("div"),N=Ie(Y),F=ee(),G=V("div"),G.innerHTML=K,X=ee(),Q=V("div"),U=V("div"),q=Ie(J),ce=ee(),ge=V("div"),ge.innerHTML=re,Oe=ee(),x=V("div"),ue=V("div"),Ee=V("div"),Ke=Ie(Xe),fe=ee(),lt=V("div"),lt.innerHTML=it,Nt=ee(),Dt=V("div"),Ht=V("div"),Ut=Ie(wt),pe=ee(),Ye=V("div"),Ye.innerHTML=ot,he=ee(),yt=V("div"),ht=V("div"),Ce=Ie(bt),Pt=ee(),mt=V("div"),mt.innerHTML=de,De=ee(),Ve=V("div"),Ge=V("div"),kt=Ie(It),Mt=ee(),Tt=V("div"),Tt.innerHTML=sn,Bt=ee(),At=V("div"),Kt=V("div"),tn=Ie(Gt),rn=ee(),Wt=V("div"),_t=V("div"),W=V("div"),Me=V("div"),Ze=V("div"),je=Ie(tt),at=ee(),Jt=V("div"),Jt.innerHTML=Cn,dt=ee(),Ct=V("div"),bn=V("div"),Mn=Ie(kn),ll=ee(),Tn=V("div"),Tn.innerHTML=hl,ol=ee(),En=V("div"),An=V("div"),xn=Ie(Yn),sl=ee(),Vn=V("div"),Vn.innerHTML=ml,this.h()},l(Zt){e=z(Zt,"DIV",{class:!0});var Vt=M(e);t=z(Vt,"DIV",{class:!0});var gl=M(t);n=z(gl,"DIV",{class:!0});var Gl=M(n);s=Se(Gl,o),Gl.forEach(_),i=te(gl),r=z(gl,"BUTTON",{class:!0,"data-svelte-h":!0}),ut(r)!=="svelte-745w2y"&&(r.innerHTML=a),gl.forEach(_),c=te(Vt),u=z(Vt,"DIV",{class:!0});var ql=M(u);f=z(ql,"DIV",{class:!0});var _l=M(f);h=z(_l,"DIV",{class:!0});var Ln=M(h);d=z(Ln,"DIV",{class:!0});var pl=M(d);p=z(pl,"DIV",{class:!0});var L=M(p);v=Se(L,b),L.forEach(_),g=te(pl),w=z(pl,"DIV",{class:!0,"data-svelte-h":!0}),ut(w)!=="svelte-1ykt4pq"&&(w.innerHTML=y),pl.forEach(_),I=te(Ln),S=z(Ln,"DIV",{class:!0});var ie=M(S);T=z(ie,"DIV",{class:!0});var be=M(T);H=Se(be,E),be.forEach(_),O=te(ie),B=z(ie,"DIV",{class:!0,"data-svelte-h":!0}),ut(B)!=="svelte-9s7il5"&&(B.innerHTML=j),ie.forEach(_),Z=te(Ln),R=z(Ln,"DIV",{class:!0});var ze=M(R);C=z(ze,"DIV",{class:!0});var _e=M(C);N=Se(_e,Y),_e.forEach(_),F=te(ze),G=z(ze,"DIV",{class:!0,"data-svelte-h":!0}),ut(G)!=="svelte-1rhjj6y"&&(G.innerHTML=K),ze.forEach(_),X=te(Ln),Q=z(Ln,"DIV",{class:!0});var ye=M(Q);U=z(ye,"DIV",{class:!0});var ve=M(U);q=Se(ve,J),ve.forEach(_),ce=te(ye),ge=z(ye,"DIV",{class:!0,"data-svelte-h":!0}),ut(ge)!=="svelte-88t2mq"&&(ge.innerHTML=re),ye.forEach(_),Ln.forEach(_),Oe=te(_l),x=z(_l,"DIV",{class:!0});var Le=M(x);ue=z(Le,"DIV",{class:!0});var et=M(ue);Ee=z(et,"DIV",{class:!0});var ft=M(Ee);Ke=Se(ft,Xe),ft.forEach(_),fe=te(et),lt=z(et,"DIV",{class:!0,"data-svelte-h":!0}),ut(lt)!=="svelte-sstb0e"&&(lt.innerHTML=it),et.forEach(_),Nt=te(Le),Dt=z(Le,"DIV",{class:!0});var St=M(Dt);Ht=z(St,"DIV",{class:!0});var zt=M(Ht);Ut=Se(zt,wt),zt.forEach(_),pe=te(St),Ye=z(St,"DIV",{class:!0,"data-svelte-h":!0}),ut(Ye)!=="svelte-shqiv6"&&(Ye.innerHTML=ot),St.forEach(_),he=te(Le),yt=z(Le,"DIV",{class:!0});var pt=M(yt);ht=z(pt,"DIV",{class:!0});var nn=M(ht);Ce=Se(nn,bt),nn.forEach(_),Pt=te(pt),mt=z(pt,"DIV",{class:!0,"data-svelte-h":!0}),ut(mt)!=="svelte-1czc2xm"&&(mt.innerHTML=de),pt.forEach(_),De=te(Le),Ve=z(Le,"DIV",{class:!0});var fn=M(Ve);Ge=z(fn,"DIV",{class:!0});var vn=M(Ge);kt=Se(vn,It),vn.forEach(_),Mt=te(fn),Tt=z(fn,"DIV",{class:!0,"data-svelte-h":!0}),ut(Tt)!=="svelte-10s6aob"&&(Tt.innerHTML=sn),fn.forEach(_),Le.forEach(_),_l.forEach(_),ql.forEach(_),Bt=te(Vt),At=z(Vt,"DIV",{class:!0});var Xn=M(At);Kt=z(Xn,"DIV",{class:!0});var zn=M(Kt);tn=Se(zn,Gt),zn.forEach(_),Xn.forEach(_),rn=te(Vt),Wt=z(Vt,"DIV",{class:!0});var Rn=M(Wt);_t=z(Rn,"DIV",{class:!0});var wn=M(_t);W=z(wn,"DIV",{class:!0});var dn=M(W);Me=z(dn,"DIV",{class:!0});var an=M(Me);Ze=z(an,"DIV",{class:!0});var hn=M(Ze);je=Se(hn,tt),hn.forEach(_),at=te(an),Jt=z(an,"DIV",{class:!0,"data-svelte-h":!0}),ut(Jt)!=="svelte-npid8c"&&(Jt.innerHTML=Cn),an.forEach(_),dt=te(dn),Ct=z(dn,"DIV",{class:!0});var mn=M(Ct);bn=z(mn,"DIV",{class:!0});var Nn=M(bn);Mn=Se(Nn,kn),Nn.forEach(_),ll=te(mn),Tn=z(mn,"DIV",{class:!0,"data-svelte-h":!0}),ut(Tn)!=="svelte-1x4z9aw"&&(Tn.innerHTML=hl),mn.forEach(_),ol=te(dn),En=z(dn,"DIV",{class:!0});var Lt=M(En);An=z(Lt,"DIV",{class:!0});var un=M(An);xn=Se(un,Yn),un.forEach(_),sl=te(Lt),Vn=z(Lt,"DIV",{class:!0,"data-svelte-h":!0}),ut(Vn)!=="svelte-1ia95ih"&&(Vn.innerHTML=ml),Lt.forEach(_),dn.forEach(_),wn.forEach(_),Rn.forEach(_),Vt.forEach(_),this.h()},h(){m(n,"class","text-lg font-medium self-center"),m(r,"class","self-center"),m(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4"),m(p,"class","text-sm"),m(w,"class","flex space-x-1 text-xs"),m(d,"class","w-full flex justify-between items-center"),m(T,"class","text-sm"),m(B,"class","flex space-x-1 text-xs"),m(S,"class","w-full flex justify-between items-center"),m(C,"class","text-sm"),m(G,"class","flex space-x-1 text-xs"),m(R,"class","w-full flex justify-between items-center"),m(U,"class","text-sm"),m(ge,"class","flex space-x-1 text-xs"),m(Q,"class","w-full flex justify-between items-center"),m(h,"class","flex flex-col space-y-3 w-full self-start"),m(Ee,"class","text-sm"),m(lt,"class","flex space-x-1 text-xs"),m(ue,"class","w-full flex justify-between items-center"),m(Ht,"class","text-sm"),m(Ye,"class","flex space-x-1 text-xs"),m(Dt,"class","w-full flex justify-between items-center"),m(ht,"class","text-sm"),m(mt,"class","flex space-x-1 text-xs"),m(yt,"class","w-full flex justify-between items-center"),m(Ge,"class","text-sm"),m(Tt,"class","flex space-x-1 text-xs"),m(Ve,"class","w-full flex justify-between items-center"),m(x,"class","flex flex-col space-y-3 w-full self-start"),m(f,"class","flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6"),m(u,"class","flex flex-col md:flex-row w-full p-5 md:space-x-4 dark:text-gray-200"),m(Kt,"class","text-lg font-medium self-center"),m(At,"class","flex justify-between dark:text-gray-300 px-5"),m(Ze,"class","text-sm"),m(Jt,"class","flex space-x-1 text-xs"),m(Me,"class","w-full flex justify-between items-center"),m(bn,"class","text-sm"),m(Tn,"class","flex space-x-1 text-xs"),m(Ct,"class","w-full flex justify-between items-center"),m(An,"class","text-sm"),m(Vn,"class","flex space-x-1 text-xs"),m(En,"class","w-full flex justify-between items-center"),m(W,"class","flex flex-col space-y-3 w-full self-start"),m(_t,"class","flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6"),m(Wt,"class","flex flex-col md:flex-row w-full p-5 md:space-x-4 dark:text-gray-200"),m(e,"class","text-gray-700 dark:text-gray-100")},m(Zt,Vt){A(Zt,e,Vt),k(e,t),k(t,n),k(n,s),k(t,i),k(t,r),k(e,c),k(e,u),k(u,f),k(f,h),k(h,d),k(d,p),k(p,v),k(d,g),k(d,w),k(h,I),k(h,S),k(S,T),k(T,H),k(S,O),k(S,B),k(h,Z),k(h,R),k(R,C),k(C,N),k(R,F),k(R,G),k(h,X),k(h,Q),k(Q,U),k(U,q),k(Q,ce),k(Q,ge),k(f,Oe),k(f,x),k(x,ue),k(ue,Ee),k(Ee,Ke),k(ue,fe),k(ue,lt),k(x,Nt),k(x,Dt),k(Dt,Ht),k(Ht,Ut),k(Dt,pe),k(Dt,Ye),k(x,he),k(x,yt),k(yt,ht),k(ht,Ce),k(yt,Pt),k(yt,mt),k(x,De),k(x,Ve),k(Ve,Ge),k(Ge,kt),k(Ve,Mt),k(Ve,Tt),k(e,Bt),k(e,At),k(At,Kt),k(Kt,tn),k(e,rn),k(e,Wt),k(Wt,_t),k(_t,W),k(W,Me),k(Me,Ze),k(Ze,je),k(Me,at),k(Me,Jt),k(W,dt),k(W,Ct),k(Ct,bn),k(bn,Mn),k(Ct,ll),k(Ct,Tn),k(W,ol),k(W,En),k(En,An),k(An,xn),k(En,sl),k(En,Vn),rl||($=ke(r,"click",l[3]),rl=!0)},p(Zt,Vt){Vt&2&&o!==(o=Zt[1].t("Keyboard shortcuts")+"")&&Te(s,o),Vt&2&&b!==(b=Zt[1].t("Open new chat")+"")&&Te(v,b),Vt&2&&E!==(E=Zt[1].t("Focus chat input")+"")&&Te(H,E),Vt&2&&Y!==(Y=Zt[1].t("Copy last code block")+"")&&Te(N,Y),Vt&2&&J!==(J=Zt[1].t("Copy last response")+"")&&Te(q,J),Vt&2&&Xe!==(Xe=Zt[1].t("Toggle settings")+"")&&Te(Ke,Xe),Vt&2&&wt!==(wt=Zt[1].t("Toggle sidebar")+"")&&Te(Ut,wt),Vt&2&&bt!==(bt=Zt[1].t("Delete chat")+"")&&Te(Ce,bt),Vt&2&&It!==(It=Zt[1].t("Show shortcuts")+"")&&Te(kt,It),Vt&2&&Gt!==(Gt=Zt[1].t("Input commands")+"")&&Te(tn,Gt),Vt&2&&tt!==(tt=Zt[1].t("Attach file")+"")&&Te(je,tt),Vt&2&&kn!==(kn=Zt[1].t("Add custom prompt")+"")&&Te(Mn,kn),Vt&2&&Yn!==(Yn=Zt[1].t("Select model")+"")&&Te(xn,Yn)},d(Zt){Zt&&_(e),rl=!1,$()}}}function L_(l){let e,t,n;function o(i){l[4](i)}let s={$$slots:{default:[A_]},$$scope:{ctx:l}};return l[0]!==void 0&&(s.show=l[0]),e=new au({props:s}),We.push(()=>Je(e,"show",o)),{c(){ne(e.$$.fragment)},l(i){se(e.$$.fragment,i)},m(i,r){le(e,i,r),n=!0},p(i,[r]){const a={};r&35&&(a.$$scope={dirty:r,ctx:i}),!t&&r&1&&(t=!0,a.show=i[0],qe(()=>t=!1)),e.$set(a)},i(i){n||(D(e.$$.fragment,i),n=!0)},o(i){P(e.$$.fragment,i),n=!1},d(i){oe(e,i)}}}function R_(l,e,t){let n;const o=Ft("i18n");ae(l,o,a=>t(1,n=a));let{show:s=!1}=e;const i=()=>{t(0,s=!1)};function r(a){s=a,t(0,s)}return l.$$set=a=>{"show"in a&&t(0,s=a.show)},[s,n,o,i,r]}class U_ extends Re{constructor(e){super(),Ue(this,e,R_,L_,Fe,{show:0})}}function W_(l){let e,t;return{c(){e=Ne("svg"),t=Ne("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var o=M(e);t=Pe(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),M(t).forEach(_),o.forEach(_),this.h()},h(){m(t,"stroke-linecap","round"),m(t,"stroke-linejoin","round"),m(t,"d","M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","none"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width",l[1]),m(e,"stroke","currentColor"),m(e,"class",l[0])},m(n,o){A(n,e,o),k(e,t)},p(n,[o]){o&2&&m(e,"stroke-width",n[1]),o&1&&m(e,"class",n[0])},i:we,o:we,d(n){n&&_(e)}}}function F_(l,e,t){let{className:n="w-4 h-4"}=e,{strokeWidth:o="2"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}class j_ extends Re{constructor(e){super(),Ue(this,e,F_,W_,Fe,{className:0,strokeWidth:1})}}function Y_(l){let e,t;return{c(){e=Ne("svg"),t=Ne("path"),this.h()},l(n){e=Pe(n,"svg",{"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,class:!0});var o=M(e);t=Pe(o,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),M(t).forEach(_),o.forEach(_),this.h()},h(){m(t,"fill-rule","evenodd"),m(t,"d","M2 7a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V7Zm5.01 1H5v2.01h2.01V8Zm3 0H8v2.01h2.01V8Zm3 0H11v2.01h2.01V8Zm3 0H14v2.01h2.01V8Zm3 0H17v2.01h2.01V8Zm-12 3H5v2.01h2.01V11Zm3 0H8v2.01h2.01V11Zm3 0H11v2.01h2.01V11Zm3 0H14v2.01h2.01V11Zm3 0H17v2.01h2.01V11Zm-12 3H5v2.01h2.01V14ZM8 14l-.001 2 8.011.01V14H8Zm11.01 0H17v2.01h2.01V14Z"),m(t,"clip-rule","evenodd"),m(e,"aria-hidden","true"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","currentColor"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width",l[1]),m(e,"class",l[0])},m(n,o){A(n,e,o),k(e,t)},p(n,[o]){o&2&&m(e,"stroke-width",n[1]),o&1&&m(e,"class",n[0])},i:we,o:we,d(n){n&&_(e)}}}function X_(l,e,t){let{className:n="size-4"}=e,{strokeWidth:o="2"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}class K_ extends Re{constructor(e){super(),Ue(this,e,X_,Y_,Fe,{className:0,strokeWidth:1})}}function Z_(l){let e;const t=l[5].default,n=Qt(t,l,l[9],null);return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&512)&&xt(n,t,o,o[9],e?en(t,o[9],s,null):$t(o[9]),null)},i(o){e||(D(n,o),e=!0)},o(o){P(n,o),e=!1},d(o){n&&n.d(o)}}}function G_(l){let e,t,n,o=l[2].t("Documentation")+"",s,i;return e=new j_({props:{className:"size-5"}}),{c(){ne(e.$$.fragment),t=ee(),n=V("div"),s=Ie(o),this.h()},l(r){se(e.$$.fragment,r),t=te(r),n=z(r,"DIV",{class:!0});var a=M(n);s=Se(a,o),a.forEach(_),this.h()},h(){m(n,"class","flex items-center")},m(r,a){le(e,r,a),A(r,t,a),A(r,n,a),k(n,s),i=!0},p(r,a){(!i||a&4)&&o!==(o=r[2].t("Documentation")+"")&&Te(s,o)},i(r){i||(D(e.$$.fragment,r),i=!0)},o(r){P(e.$$.fragment,r),i=!1},d(r){r&&(_(t),_(n)),oe(e,r)}}}function q_(l){let e,t,n,o=l[2].t("Keyboard shortcuts")+"",s,i;return e=new K_({props:{className:"size-5"}}),{c(){ne(e.$$.fragment),t=ee(),n=V("div"),s=Ie(o),this.h()},l(r){se(e.$$.fragment,r),t=te(r),n=z(r,"DIV",{class:!0});var a=M(n);s=Se(a,o),a.forEach(_),this.h()},h(){m(n,"class","flex items-center")},m(r,a){le(e,r,a),A(r,t,a),A(r,n,a),k(n,s),i=!0},p(r,a){(!i||a&4)&&o!==(o=r[2].t("Keyboard shortcuts")+"")&&Te(s,o)},i(r){i||(D(e.$$.fragment,r),i=!0)},o(r){P(e.$$.fragment,r),i=!1},d(r){r&&(_(t),_(n)),oe(e,r)}}}function J_(l){let e,t,n,o;return e=new _n({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-share-button",$$slots:{default:[G_]},$$scope:{ctx:l}}}),e.$on("click",l[6]),n=new _n({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-share-button",$$slots:{default:[q_]},$$scope:{ctx:l}}}),n.$on("click",l[7]),{c(){ne(e.$$.fragment),t=ee(),ne(n.$$.fragment)},l(s){se(e.$$.fragment,s),t=te(s),se(n.$$.fragment,s)},m(s,i){le(e,s,i),A(s,t,i),le(n,s,i),o=!0},p(s,i){const r={};i&516&&(r.$$scope={dirty:i,ctx:s}),e.$set(r);const a={};i&516&&(a.$$scope={dirty:i,ctx:s}),n.$set(a)},i(s){o||(D(e.$$.fragment,s),D(n.$$.fragment,s),o=!0)},o(s){P(e.$$.fragment,s),P(n.$$.fragment,s),o=!1},d(s){s&&_(t),oe(e,s),oe(n,s)}}}function Q_(l){let e,t,n;return t=new Eo({props:{class:"w-full max-w-[200px] rounded-xl px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",sideOffset:4,side:"top",align:"end",transition:Xl,$$slots:{default:[J_]},$$scope:{ctx:l}}}),{c(){e=V("div"),ne(t.$$.fragment),this.h()},l(o){e=z(o,"DIV",{slot:!0});var s=M(e);se(t.$$.fragment,s),s.forEach(_),this.h()},h(){m(e,"slot","content")},m(o,s){A(o,e,s),le(t,e,null),n=!0},p(o,s){const i={};s&517&&(i.$$scope={dirty:s,ctx:o}),t.$set(i)},i(o){n||(D(t.$$.fragment,o),n=!0)},o(o){P(t.$$.fragment,o),n=!1},d(o){o&&_(e),oe(t)}}}function x_(l){let e,t;return e=new ko({props:{$$slots:{content:[Q_],default:[Z_]},$$scope:{ctx:l}}}),e.$on("change",l[8]),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,[o]){const s={};o&517&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function $_(l,e,t){let n,{$$slots:o={},$$scope:s}=e;const i=Ft("i18n");ae(l,i,d=>t(2,n=d));let{showDocsHandler:r}=e,{showShortcutsHandler:a}=e,{onClose:c=()=>{}}=e;const u=()=>{window.open("https://docs.openwebui.com","_blank")},f=()=>{a()},h=d=>{d.detail===!1&&c()};return l.$$set=d=>{"showDocsHandler"in d&&t(4,r=d.showDocsHandler),"showShortcutsHandler"in d&&t(0,a=d.showShortcutsHandler),"onClose"in d&&t(1,c=d.onClose),"$$scope"in d&&t(9,s=d.$$scope)},[a,c,n,i,r,o,u,f,h,s]}class ep extends Re{constructor(e){super(),Ue(this,e,$_,x_,Fe,{showDocsHandler:4,showShortcutsHandler:0,onClose:1})}}function tp(l){let e,t="?";return{c(){e=V("button"),e.textContent=t,this.h()},l(n){e=z(n,"BUTTON",{class:!0,"data-svelte-h":!0}),ut(e)!=="svelte-141cz2e"&&(e.textContent=t),this.h()},h(){m(e,"class","text-gray-600 dark:text-gray-300 bg-gray-300/20 size-4 flex items-center justify-center text-[0.7rem] rounded-full")},m(n,o){A(n,e,o)},p:we,d(n){n&&_(e)}}}function np(l){let e,t;return e=new Rt({props:{content:l[1].t("Help"),placement:"left",$$slots:{default:[tp]},$$scope:{ctx:l}}}),{c(){ne(e.$$.fragment)},l(n){se(e.$$.fragment,n)},m(n,o){le(e,n,o),t=!0},p(n,o){const s={};o&2&&(s.content=n[1].t("Help")),o&128&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function lp(l){let e,t,n,o,s,i,r,a,c,u;o=new ep({props:{showDocsHandler:l[4],showShortcutsHandler:l[5],$$slots:{default:[np]},$$scope:{ctx:l}}});function f(d){l[6](d)}let h={};return l[0]!==void 0&&(h.show=l[0]),i=new U_({props:h}),We.push(()=>Je(i,"show",f)),{c(){e=V("div"),t=V("button"),n=ee(),ne(o.$$.fragment),s=ee(),ne(i.$$.fragment),this.h()},l(d){e=z(d,"DIV",{class:!0});var p=M(e);t=z(p,"BUTTON",{id:!0,class:!0}),M(t).forEach(_),n=te(p),se(o.$$.fragment,p),p.forEach(_),s=te(d),se(i.$$.fragment,d),this.h()},h(){m(t,"id","show-shortcuts-button"),m(t,"class","hidden"),m(e,"class","hidden lg:flex fixed bottom-0 right-0 px-1 py-1 z-20")},m(d,p){A(d,e,p),k(e,t),k(e,n),le(o,e,null),A(d,s,p),le(i,d,p),a=!0,c||(u=ke(t,"click",l[3]),c=!0)},p(d,[p]){const b={};p&1&&(b.showDocsHandler=d[4]),p&1&&(b.showShortcutsHandler=d[5]),p&130&&(b.$$scope={dirty:p,ctx:d}),o.$set(b);const v={};!r&&p&1&&(r=!0,v.show=d[0],qe(()=>r=!1)),i.$set(v)},i(d){a||(D(o.$$.fragment,d),D(i.$$.fragment,d),a=!0)},o(d){P(o.$$.fragment,d),P(i.$$.fragment,d),a=!1},d(d){d&&(_(e),_(s)),oe(o),oe(i,d),c=!1,u()}}}function op(l,e,t){let n;const o=Ft("i18n");ae(l,o,u=>t(1,n=u));let s=!1;const i=()=>{t(0,s=!s)},r=()=>{t(0,s=!s)},a=()=>{t(0,s=!s)};function c(u){s=u,t(0,s)}return[s,n,o,i,r,a,c]}class a2 extends Re{constructor(e){super(),Ue(this,e,op,lp,Fe,{})}}export{i2 as C,a2 as H};
//# sourceMappingURL=Help.WY82pESo.js.map
