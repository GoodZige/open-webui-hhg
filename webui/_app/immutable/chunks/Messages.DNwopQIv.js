var Qn=Object.defineProperty;var Xn=(n,e,t)=>e in n?Qn(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var vt=(n,e,t)=>Xn(n,typeof e!="symbol"?e+"":e,t);import{s as Ve,e as M,k as j,c as N,a as k,d as m,o as H,f as d,i as V,g as _,n as ve,t as U,b as q,N as Ae,C as rt,u as _e,h as K,Q as Ue,H as et,j as Ie,p as qe,B as gt,q as bt,y as je,A as Ze,r as Yn,v as $n,w as xn,x as er,E as be,F as ke,l as fe,S as St,D as Ne,M as tr,ak as ul,T as Ot,P as Tt,al as lr,am as sr}from"./scheduler.CHqjxavM.js";import{S as Te,i as Be,b as X,d as Y,m as $,t as b,a as D,e as x,f as Ke,g as le,c as se,h as Bt}from"./index.Cjx-5OY6.js";import{e as Ee,u as Gt,o as In,d as nr}from"./each.CCRIbD_e.js";import{m as jt,d as cl,i as En,h as rr,C as ir,D as or,a as Ht,c as Mn,T as dl,u as zt,l as Zt,e as Lt,W as ar,b as hl,E as ml,F as fr}from"./index.H8ql2Fza.js";import{t as Pe}from"./Toaster.svelte_svelte_type_style_lang.NefCtMfx.js";import{f as ur,u as cr,l as dr}from"./index.DW-BGSg-.js";import{b as Jt,m as Nn,t as hr,f as pt,q as Pt,l as Dn,v as gl}from"./index.Bl8AKUxi.js";import{d as it}from"./relativeTime.BDz4fsXT.js";import{b as _l,c as mr}from"./index.CL2TbLLq.js";import{o as gr}from"./index.BE_TS0KQ.js";import{s as _r}from"./index.NRlecBS4.js";import{i as vr}from"./index.C36D-7Z7.js";import{ai as pr,ag as yt,af as Vn,ae as Kt,ah as Cn}from"./Markdown.Bvd8YfbN.js";import{T as Re}from"./Tooltip.Ckuvvm8c.js";import{T as br}from"./Tags.DpqRxueV.js";import{S as Wt}from"./Spinner.BnJ9ysqs.js";import{C as Tn}from"./ChevronDown.BIPeklLG.js";import{C as Bn}from"./ChevronUp.xZZ1rZA6.js";import{M as kr}from"./MagnifyingGlass.BTWF-r7T.js";import{C as Rn}from"./Collapsible.C8XZLfiq.js";import{C as Sn}from"./ConfirmDialog.BkASNw-x.js";import{I as wr,F as yr}from"./FileItem.BzjBLAVY.js";import{M as On}from"./Modal.BTvzYrvL.js";import{B as Qt}from"./Badge.CU1X267a.js";import{C as Ir}from"./Check.CSMENzYa.js";import{X as Er}from"./XMark.C3tTP9TD.js";import{E as Mr}from"./EllipsisHorizontal.OLIxA_ZF.js";import{m as At}from"./marked.esm._0_gBwjO.js";import{c as vl}from"./index.E8y8d-Yv.js";import{L as Nr}from"./Loader.BoqFte86.js";import{f as Rt}from"./index.DzgXSuqr.js";import{F as Dr}from"./fuse.CU2r43ac.js";function Vr(n){return new Worker(""+new URL("../workers/kokoro.worker-Cev3ZHQt.js",import.meta.url).href,{type:"module",name:n==null?void 0:n.name})}class Cr{constructor(e="fp32"){vt(this,"worker",null);vt(this,"initialized",!1);vt(this,"dtype");vt(this,"requestQueue",[]);vt(this,"processing",!1);this.dtype=e}async init(){if(this.worker){console.warn("KokoroWorker is already initialized.");return}return this.worker=new Vr,this.worker.onmessage=e=>{const{status:t,error:l,audioUrl:s}=e.data;if(t==="init:complete")this.initialized=!0;else if(t==="init:error")console.error(l),this.initialized=!1;else if(t==="generate:complete"){const r=this.requestQueue.shift();r&&(r.resolve(s),this.processNextRequest())}else if(t==="generate:error"){const r=this.requestQueue.shift();r&&(r.reject(new Error(l)),this.processNextRequest())}},new Promise((e,t)=>{this.worker.postMessage({type:"init",payload:{dtype:this.dtype}});const l=s=>{s.data.status==="init:complete"?(this.worker.removeEventListener("message",l),this.initialized=!0,e()):s.data.status==="init:error"&&(this.worker.removeEventListener("message",l),t(new Error(s.data.error)))};this.worker.addEventListener("message",l)})}async generate({text:e,voice:t}){if(!this.initialized||!this.worker)throw new Error("KokoroTTS Worker is not initialized yet.");return new Promise((l,s)=>{this.requestQueue.push({text:e,voice:t,resolve:l,reject:s}),this.processing||this.processNextRequest()})}processNextRequest(){if(this.requestQueue.length===0){this.processing=!1;return}this.processing=!0;const{text:e,voice:t}=this.requestQueue[0];this.worker.postMessage({type:"generate",payload:{text:e,voice:t}})}terminate(){this.worker&&(this.worker.terminate(),this.worker=null,this.initialized=!1,this.requestQueue=[],this.processing=!1)}}function Tr(n){let e,t,l,s,r,i,o,a,f,u,c,g,h,p,w,v,E,y,B,L,T,I,R,O,C,P;return{c(){e=M("div"),t=M("div"),l=M("div"),s=M("div"),i=j(),o=M("div"),a=M("div"),u=j(),c=M("div"),h=j(),p=M("div"),w=M("div"),E=j(),y=M("div"),L=j(),T=M("div"),R=j(),O=M("div"),this.h()},l(S){e=N(S,"DIV",{class:!0});var W=k(e);t=N(W,"DIV",{class:!0});var ne=k(t);l=N(ne,"DIV",{class:!0});var ue=k(l);s=N(ue,"DIV",{class:!0}),k(s).forEach(m),i=H(ue),o=N(ue,"DIV",{class:!0});var te=k(o);a=N(te,"DIV",{class:!0}),k(a).forEach(m),u=H(te),c=N(te,"DIV",{class:!0}),k(c).forEach(m),te.forEach(m),h=H(ue),p=N(ue,"DIV",{class:!0});var ie=k(p);w=N(ie,"DIV",{class:!0}),k(w).forEach(m),E=H(ie),y=N(ie,"DIV",{class:!0}),k(y).forEach(m),L=H(ie),T=N(ie,"DIV",{class:!0}),k(T).forEach(m),ie.forEach(m),R=H(ue),O=N(ue,"DIV",{class:!0}),k(O).forEach(m),ue.forEach(m),ne.forEach(m),W.forEach(m),this.h()},h(){d(s,"class",r=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm mr-14"),d(a,"class",f=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2"),d(c,"class",g=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1"),d(o,"class","grid grid-cols-3 gap-4"),d(w,"class",v=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1"),d(y,"class",B=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2"),d(T,"class",I=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1 mr-4"),d(p,"class","grid grid-cols-4 gap-4"),d(O,"class",C=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm"),d(l,"class",P=(n[0]==="md"?"space-y-2":"space-y-1.5")+" w-full"),d(t,"class","animate-pulse flex w-full"),d(e,"class","w-full mt-2 mb-2")},m(S,W){V(S,e,W),_(e,t),_(t,l),_(l,s),_(l,i),_(l,o),_(o,a),_(o,u),_(o,c),_(l,h),_(l,p),_(p,w),_(p,E),_(p,y),_(p,L),_(p,T),_(l,R),_(l,O)},p(S,[W]){W&1&&r!==(r=(S[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm mr-14")&&d(s,"class",r),W&1&&f!==(f=(S[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2")&&d(a,"class",f),W&1&&g!==(g=(S[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1")&&d(c,"class",g),W&1&&v!==(v=(S[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1")&&d(w,"class",v),W&1&&B!==(B=(S[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2")&&d(y,"class",B),W&1&&I!==(I=(S[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1 mr-4")&&d(T,"class",I),W&1&&C!==(C=(S[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm")&&d(O,"class",C),W&1&&P!==(P=(S[0]==="md"?"space-y-2":"space-y-1.5")+" w-full")&&d(l,"class",P)},i:ve,o:ve,d(S){S&&m(e)}}}function Br(n,e,t){let{size:l="md"}=e;return n.$$set=s=>{"size"in s&&t(0,l=s.size)},[l]}class Xt extends Te{constructor(e){super(),Be(this,e,Br,Tr,Ve,{size:0})}}function pl(n,e,t){const l=n.slice();return l[23]=e[t],l}function bl(n,e,t){const l=n.slice();return l[26]=e[t],l}function kl(n){var s;let e,t=n[8].t('This response was generated by "{{model}}"',{model:n[7]?((s=n[7])==null?void 0:s.name)??n[7].id:n[1].selectedModelId})+"",l;return{c(){e=M("div"),l=U(t),this.h()},l(r){e=N(r,"DIV",{class:!0});var i=k(e);l=q(i,t),i.forEach(m),this.h()},h(){d(e,"class","text-xs font-medium pt-1.5 -mb-0.5")},m(r,i){V(r,e,i),_(e,l)},p(r,i){var o;i&386&&t!==(t=r[8].t('This response was generated by "{{model}}"',{model:r[7]?((o=r[7])==null?void 0:o.name)??r[7].id:r[1].selectedModelId})+"")&&K(l,t)},d(r){r&&m(e)}}}function wl(n){let e,t=n[26]+"",l,s,r,i,o,a;function f(){return n[12](n[26])}return{c(){e=M("button"),l=U(t),s=j(),this.h()},l(u){e=N(u,"BUTTON",{class:!0});var c=k(e);l=q(c,t),s=H(c),c.forEach(m),this.h()},h(){var u,c;d(e,"class",r="size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[6]===n[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900"),e.disabled=i=((c=(u=n[1])==null?void 0:u.annotation)==null?void 0:c.rating)===-1?n[26]>5:n[26]<6},m(u,c){V(u,e,c),_(e,l),_(e,s),o||(a=_e(e,"click",f),o=!0)},p(u,c){var g,h;n=u,c&64&&r!==(r="size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[6]===n[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900")&&d(e,"class",r),c&2&&i!==(i=((h=(g=n[1])==null?void 0:g.annotation)==null?void 0:h.rating)===-1?n[26]>5:n[26]<6)&&(e.disabled=i)},d(u){u&&m(e),o=!1,a()}}}function yl(n){let e,t=n[8].t("Why?")+"",l,s,r,i=Ee(n[3]),o=[];for(let a=0;a<i.length;a+=1)o[a]=Il(pl(n,i,a));return{c(){e=M("div"),l=U(t),s=j(),r=M("div");for(let a=0;a<o.length;a+=1)o[a].c();this.h()},l(a){e=N(a,"DIV",{class:!0});var f=k(e);l=q(f,t),f.forEach(m),s=H(a),r=N(a,"DIV",{class:!0});var u=k(r);for(let c=0;c<o.length;c+=1)o[c].l(u);u.forEach(m),this.h()},h(){d(e,"class","text-sm mt-1.5 font-medium"),d(r,"class","flex flex-wrap gap-1.5 text-sm mt-1.5")},m(a,f){V(a,e,f),_(e,l),V(a,s,f),V(a,r,f);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(r,null)},p(a,f){if(f&256&&t!==(t=a[8].t("Why?")+"")&&K(l,t),f&280){i=Ee(a[3]);let u;for(u=0;u<i.length;u+=1){const c=pl(a,i,u);o[u]?o[u].p(c,f):(o[u]=Il(c),o[u].c(),o[u].m(r,null))}for(;u<o.length;u+=1)o[u].d(1);o.length=i.length}},d(a){a&&(m(e),m(s),m(r)),Ue(o,a)}}}function Rr(n){let e=n[23]+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&8&&e!==(e=l[23]+"")&&K(t,e)},d(l){l&&m(t)}}}function Sr(n){let e=n[8].t("Other")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Other")+"")&&K(t,e)},d(l){l&&m(t)}}}function Or(n){let e=n[8].t("Being lazy")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Being lazy")+"")&&K(t,e)},d(l){l&&m(t)}}}function Lr(n){let e=n[8].t("Refused when it shouldn't have")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Refused when it shouldn't have")+"")&&K(t,e)},d(l){l&&m(t)}}}function Pr(n){let e=n[8].t("Didn't fully follow instructions")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Didn't fully follow instructions")+"")&&K(t,e)},d(l){l&&m(t)}}}function Ar(n){let e=n[8].t("Not factually correct")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not factually correct")+"")&&K(t,e)},d(l){l&&m(t)}}}function jr(n){let e=n[8].t("Not helpful")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not helpful")+"")&&K(t,e)},d(l){l&&m(t)}}}function Hr(n){let e=n[8].t("Too verbose")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Too verbose")+"")&&K(t,e)},d(l){l&&m(t)}}}function zr(n){let e=n[8].t("Don't like the style")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Don't like the style")+"")&&K(t,e)},d(l){l&&m(t)}}}function Wr(n){let e=n[8].t("Thorough explanation")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Thorough explanation")+"")&&K(t,e)},d(l){l&&m(t)}}}function Ur(n){let e=n[8].t("Attention to detail")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Attention to detail")+"")&&K(t,e)},d(l){l&&m(t)}}}function qr(n){let e=n[8].t("Positive attitude")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Positive attitude")+"")&&K(t,e)},d(l){l&&m(t)}}}function Fr(n){let e=n[8].t("Showcased creativity")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Showcased creativity")+"")&&K(t,e)},d(l){l&&m(t)}}}function Jr(n){let e=n[8].t("Followed instructions perfectly")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Followed instructions perfectly")+"")&&K(t,e)},d(l){l&&m(t)}}}function Gr(n){let e=n[8].t("Accurate information")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Accurate information")+"")&&K(t,e)},d(l){l&&m(t)}}}function Il(n){let e,t,l,s,r;function i(u,c){return u[23]==="accurate_information"?Gr:u[23]==="followed_instructions_perfectly"?Jr:u[23]==="showcased_creativity"?Fr:u[23]==="positive_attitude"?qr:u[23]==="attention_to_detail"?Ur:u[23]==="thorough_explanation"?Wr:u[23]==="dont_like_the_style"?zr:u[23]==="too_verbose"?Hr:u[23]==="not_helpful"?jr:u[23]==="not_factually_correct"?Ar:u[23]==="didnt_fully_follow_instructions"?Pr:u[23]==="refused_when_it_shouldnt_have"?Lr:u[23]==="being_lazy"?Or:u[23]==="other"?Sr:Rr}let o=i(n),a=o(n);function f(){return n[13](n[23])}return{c(){e=M("button"),a.c(),t=j(),this.h()},l(u){e=N(u,"BUTTON",{class:!0});var c=k(e);a.l(c),t=H(c),c.forEach(m),this.h()},h(){d(e,"class",l="px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[4]===n[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")},m(u,c){V(u,e,c),a.m(e,null),_(e,t),s||(r=_e(e,"click",f),s=!0)},p(u,c){n=u,o===(o=i(n))&&a?a.p(n,c):(a.d(1),a=o(n),a&&(a.c(),a.m(e,t))),c&24&&l!==(l="px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[4]===n[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")&&d(e,"class",l)},d(u){u&&m(e),a.d(),s=!1,r()}}}function Zr(n){var ce;let e,t,l,s,r=n[8].t("How would you rate this response?")+"",i,o,a,f='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"></path></svg>',u,c,g,h,p,w,v,E,y=n[8].t("Awful")+"",B,L,T,I,R=n[8].t("Amazing")+"",O,C,P,S,W,ne,ue,te,ie,G,Q,he,de,Z=n[8].t("Save")+"",z,ae,re,pe,ye,A=((ce=n[1])==null?void 0:ce.arena)&&kl(n),F=Ee(Array.from({length:10}).map(El)),oe=[];for(let ee=0;ee<F.length;ee+=1)oe[ee]=wl(bl(n,F,ee));let me=n[3].length>0&&yl(n);return Q=new br({props:{tags:n[2]}}),Q.$on("delete",n[15]),Q.$on("add",n[16]),{c(){A&&A.c(),e=j(),t=M("div"),l=M("div"),s=M("div"),i=U(r),o=j(),a=M("button"),a.innerHTML=f,u=j(),c=M("div"),g=M("div"),h=M("div");for(let ee=0;ee<oe.length;ee+=1)oe[ee].c();p=j(),w=M("div"),v=M("div"),E=U("1 - "),B=U(y),L=j(),T=M("div"),I=U("10 - "),O=U(R),C=j(),P=M("div"),me&&me.c(),S=j(),W=M("div"),ne=M("textarea"),te=j(),ie=M("div"),G=M("div"),X(Q.$$.fragment),he=j(),de=M("button"),z=U(Z),this.h()},l(ee){A&&A.l(ee),e=H(ee),t=N(ee,"DIV",{class:!0,id:!0});var ge=k(t);l=N(ge,"DIV",{class:!0});var De=k(l);s=N(De,"DIV",{class:!0});var Le=k(s);i=q(Le,r),Le.forEach(m),o=H(De),a=N(De,"BUTTON",{"data-svelte-h":!0}),Ae(a)!=="svelte-1ew22ui"&&(a.innerHTML=f),De.forEach(m),u=H(ge),c=N(ge,"DIV",{class:!0});var Ce=k(c);g=N(Ce,"DIV",{class:!0});var He=k(g);h=N(He,"DIV",{class:!0});var ze=k(h);for(let st=0;st<oe.length;st+=1)oe[st].l(ze);ze.forEach(m),p=H(He),w=N(He,"DIV",{class:!0});var Fe=k(w);v=N(Fe,"DIV",{});var tt=k(v);E=q(tt,"1 - "),B=q(tt,y),tt.forEach(m),L=H(Fe),T=N(Fe,"DIV",{});var lt=k(T);I=q(lt,"10 - "),O=q(lt,R),lt.forEach(m),Fe.forEach(m),He.forEach(m),Ce.forEach(m),C=H(ge),P=N(ge,"DIV",{});var ot=k(P);me&&me.l(ot),ot.forEach(m),S=H(ge),W=N(ge,"DIV",{class:!0});var at=k(W);ne=N(at,"TEXTAREA",{class:!0,placeholder:!0,rows:!0}),k(ne).forEach(m),at.forEach(m),te=H(ge),ie=N(ge,"DIV",{class:!0});var xe=k(ie);G=N(xe,"DIV",{class:!0});var ft=k(G);Y(Q.$$.fragment,ft),ft.forEach(m),he=H(xe),de=N(xe,"BUTTON",{class:!0});var ut=k(de);z=q(ut,Z),ut.forEach(m),xe.forEach(m),ge.forEach(m),this.h()},h(){d(s,"class","text-sm font-medium"),d(l,"class","flex justify-between items-center"),d(h,"class","mt-1.5 w-fit flex gap-1 pb-5"),d(w,"class","absolute bottom-0 left-0 right-0 flex justify-between text-xs"),d(g,"class","relative w-fit"),d(c,"class","w-full flex justify-center"),d(ne,"class","w-full text-sm px-1 py-2 bg-transparent outline-hidden resize-none rounded-xl"),d(ne,"placeholder",ue=n[8].t("Feel free to add specific details")),d(ne,"rows","3"),d(W,"class","mt-2"),d(G,"class","flex items-end group"),d(de,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),d(ie,"class","mt-2 gap-1.5 flex justify-between"),d(t,"class","my-2.5 rounded-xl px-4 py-3 border border-gray-100 dark:border-gray-850"),d(t,"id",ae="message-feedback-"+n[1].id)},m(ee,ge){A&&A.m(ee,ge),V(ee,e,ge),V(ee,t,ge),_(t,l),_(l,s),_(s,i),_(l,o),_(l,a),_(t,u),_(t,c),_(c,g),_(g,h);for(let De=0;De<oe.length;De+=1)oe[De]&&oe[De].m(h,null);_(g,p),_(g,w),_(w,v),_(v,E),_(v,B),_(w,L),_(w,T),_(T,I),_(T,O),_(t,C),_(t,P),me&&me.m(P,null),_(t,S),_(t,W),_(W,ne),rt(ne,n[5]),_(t,te),_(t,ie),_(ie,G),$(Q,G,null),_(ie,he),_(ie,de),_(de,z),re=!0,pe||(ye=[_e(a,"click",n[11]),_e(ne,"input",n[14]),_e(de,"click",n[17])],pe=!0)},p(ee,[ge]){var Le;if((Le=ee[1])!=null&&Le.arena?A?A.p(ee,ge):(A=kl(ee),A.c(),A.m(e.parentNode,e)):A&&(A.d(1),A=null),(!re||ge&256)&&r!==(r=ee[8].t("How would you rate this response?")+"")&&K(i,r),ge&66){F=Ee(Array.from({length:10}).map(El));let Ce;for(Ce=0;Ce<F.length;Ce+=1){const He=bl(ee,F,Ce);oe[Ce]?oe[Ce].p(He,ge):(oe[Ce]=wl(He),oe[Ce].c(),oe[Ce].m(h,null))}for(;Ce<oe.length;Ce+=1)oe[Ce].d(1);oe.length=F.length}(!re||ge&256)&&y!==(y=ee[8].t("Awful")+"")&&K(B,y),(!re||ge&256)&&R!==(R=ee[8].t("Amazing")+"")&&K(O,R),ee[3].length>0?me?me.p(ee,ge):(me=yl(ee),me.c(),me.m(P,null)):me&&(me.d(1),me=null),(!re||ge&256&&ue!==(ue=ee[8].t("Feel free to add specific details")))&&d(ne,"placeholder",ue),ge&32&&rt(ne,ee[5]);const De={};ge&4&&(De.tags=ee[2]),Q.$set(De),(!re||ge&256)&&Z!==(Z=ee[8].t("Save")+"")&&K(z,Z),(!re||ge&2&&ae!==(ae="message-feedback-"+ee[1].id))&&d(t,"id",ae)},i(ee){re||(b(Q.$$.fragment,ee),re=!0)},o(ee){D(Q.$$.fragment,ee),re=!1},d(ee){ee&&(m(e),m(t)),A&&A.d(ee),Ue(oe,ee),me&&me.d(),x(Q),pe=!1,et(ye)}}}const El=(n,e)=>e+1;function Kr(n,e,t){let l,s;Ie(n,jt,P=>t(18,s=P));const r=qe("i18n");Ie(n,r,P=>t(8,l=P));const i=gt();let{message:o}=e,{show:a=!1}=e,f=["accurate_information","followed_instructions_perfectly","showcased_creativity","positive_attitude","attention_to_detail","thorough_explanation","other"],u=["dont_like_the_style","too_verbose","not_helpful","not_factually_correct","didnt_fully_follow_instructions","refused_when_it_shouldnt_have","being_lazy","other"],c=[],g=[],h=null,p="",w=null,v=null;const E=()=>{var P,S,W,ne,ue;h||t(4,h=((P=o==null?void 0:o.annotation)==null?void 0:P.reason)??""),p||t(5,p=((S=o==null?void 0:o.annotation)==null?void 0:S.comment)??""),t(2,c=(((W=o==null?void 0:o.annotation)==null?void 0:W.tags)??[]).map(te=>({name:te}))),w||t(6,w=((ue=(ne=o==null?void 0:o.annotation)==null?void 0:ne.details)==null?void 0:ue.rating)??null)};bt(()=>{o!=null&&o.arena&&(t(7,v=s.find(P=>P.id===o.selectedModelId)),Pe.success(l.t('This response was generated by "{{model}}"',{model:v?(v==null?void 0:v.name)??v.id:o.selectedModelId})))});const y=()=>{console.log("saveHandler"),i("save",{reason:h,comment:p,tags:c.map(P=>P.name),details:{rating:w}}),Pe.success(l.t("Thanks for your feedback!")),t(0,a=!1)},B=()=>{t(0,a=!1)},L=P=>{t(6,w=P)},T=P=>{t(4,h=P)};function I(){p=this.value,t(5,p)}const R=P=>{t(2,c=c.filter(S=>S.name.replaceAll(" ","_").toLowerCase()!==P.detail.replaceAll(" ","_").toLowerCase()))},O=P=>{t(2,c=[...c,{name:P.detail}])},C=()=>{y()};return n.$$set=P=>{"message"in P&&t(1,o=P.message),"show"in P&&t(0,a=P.show)},n.$$.update=()=>{var P,S;n.$$.dirty&2&&(((P=o==null?void 0:o.annotation)==null?void 0:P.rating)===1?t(3,g=f):((S=o==null?void 0:o.annotation)==null?void 0:S.rating)===-1&&t(3,g=u)),n.$$.dirty&2&&o&&E()},[a,o,c,g,h,p,w,v,l,r,y,B,L,T,I,R,O,C]}class Qr extends Te{constructor(e){super(),Be(this,e,Kr,Zr,Ve,{message:1,show:0})}}function Ml(n,e,t){const l=n.slice();return l[5]=e[t],l[7]=t,l}function Xr(n){let e,t;return e=new Tn({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Yr(n){let e,t;return e=new Bn({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function $r(n){let e,t,l,s,r;const i=n[2].default,o=Yn(i,n,n[4],null),a=[Yr,Xr],f=[];function u(c,g){return c[1]?0:1}return l=u(n),s=f[l]=a[l](n),{c(){e=M("div"),o&&o.c(),t=j(),s.c(),this.h()},l(c){e=N(c,"DIV",{class:!0});var g=k(e);o&&o.l(g),t=H(g),s.l(g),g.forEach(m),this.h()},h(){d(e,"class","flex items-center gap-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition")},m(c,g){V(c,e,g),o&&o.m(e,null),_(e,t),f[l].m(e,null),r=!0},p(c,g){o&&o.p&&(!r||g&16)&&$n(o,i,c,c[4],r?er(i,c[4],g,null):xn(c[4]),null);let h=l;l=u(c),l!==h&&(le(),D(f[h],1,1,()=>{f[h]=null}),se(),s=f[l],s||(s=f[l]=a[l](c),s.c()),b(s,1),s.m(e,null))},i(c){r||(b(o,c),b(s),r=!0)},o(c){D(o,c),D(s),r=!1},d(c){c&&m(e),o&&o.d(c),f[l].d()}}}function Nl(n){let e,t,l,s,r,i=n[0].query+"",o,a,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',c,g;return l=new kr({}),{c(){e=M("a"),t=M("div"),X(l.$$.fragment),s=j(),r=M("div"),o=U(i),a=j(),f=M("div"),f.innerHTML=u,this.h()},l(h){e=N(h,"A",{href:!0,target:!0,class:!0});var p=k(e);t=N(p,"DIV",{class:!0});var w=k(t);Y(l.$$.fragment,w),s=H(w),r=N(w,"DIV",{class:!0});var v=k(r);o=q(v,i),v.forEach(m),w.forEach(m),a=H(p),f=N(p,"DIV",{class:!0,"data-svelte-h":!0}),Ae(f)!=="svelte-14xjows"&&(f.innerHTML=u),p.forEach(m),this.h()},h(){d(r,"class","line-clamp-1"),d(t,"class","flex gap-2 items-center"),d(f,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),d(e,"href",c="https://www.google.com/search?q="+n[0].query),d(e,"target","_blank"),d(e,"class","flex w-full items-center p-3 px-4 border-b border-gray-300/30 dark:border-gray-700/50 group/item justify-between font-normal text-gray-800 dark:text-gray-300 no-underline")},m(h,p){V(h,e,p),_(e,t),$(l,t,null),_(t,s),_(t,r),_(r,o),_(e,a),_(e,f),g=!0},p(h,p){(!g||p&1)&&i!==(i=h[0].query+"")&&K(o,i),(!g||p&1&&c!==(c="https://www.google.com/search?q="+h[0].query))&&d(e,"href",c)},i(h){g||(b(l.$$.fragment,h),g=!0)},o(h){D(l.$$.fragment,h),g=!1},d(h){h&&m(e),x(l)}}}function Dl(n){let e,t,l=n[5]+"",s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',a,f,u;return{c(){e=M("a"),t=M("div"),s=U(l),r=j(),i=M("div"),i.innerHTML=o,a=j(),this.h()},l(c){e=N(c,"A",{href:!0,target:!0,class:!0});var g=k(e);t=N(g,"DIV",{class:!0});var h=k(t);s=q(h,l),h.forEach(m),r=H(g),i=N(g,"DIV",{class:!0,"data-svelte-h":!0}),Ae(i)!=="svelte-14xjows"&&(i.innerHTML=o),a=H(g),g.forEach(m),this.h()},h(){d(t,"class","line-clamp-1"),d(i,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),d(e,"href",f=n[5]),d(e,"target","_blank"),d(e,"class",u="flex w-full items-center p-3 px-4 "+(n[7]===n[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")},m(c,g){V(c,e,g),_(e,t),_(t,s),_(e,r),_(e,i),_(e,a)},p(c,g){g&1&&l!==(l=c[5]+"")&&K(s,l),g&1&&f!==(f=c[5])&&d(e,"href",f),g&1&&u!==(u="flex w-full items-center p-3 px-4 "+(c[7]===c[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")&&d(e,"class",u)},d(c){c&&m(e)}}}function xr(n){var o;let e,t,l,s=((o=n[0])==null?void 0:o.query)&&Nl(n),r=Ee(n[0].urls),i=[];for(let a=0;a<r.length;a+=1)i[a]=Dl(Ml(n,r,a));return{c(){e=M("div"),s&&s.c(),t=j();for(let a=0;a<i.length;a+=1)i[a].c();this.h()},l(a){e=N(a,"DIV",{class:!0,slot:!0});var f=k(e);s&&s.l(f),t=H(f);for(let u=0;u<i.length;u+=1)i[u].l(f);f.forEach(m),this.h()},h(){d(e,"class","text-sm border border-gray-300/30 dark:border-gray-700/50 rounded-xl mb-1.5"),d(e,"slot","content")},m(a,f){V(a,e,f),s&&s.m(e,null),_(e,t);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(e,null);l=!0},p(a,f){var u;if((u=a[0])!=null&&u.query?s?(s.p(a,f),f&1&&b(s,1)):(s=Nl(a),s.c(),b(s,1),s.m(e,t)):s&&(le(),D(s,1,1,()=>{s=null}),se()),f&1){r=Ee(a[0].urls);let c;for(c=0;c<r.length;c+=1){const g=Ml(a,r,c);i[c]?i[c].p(g,f):(i[c]=Dl(g),i[c].c(),i[c].m(e,null))}for(;c<i.length;c+=1)i[c].d(1);i.length=r.length}},i(a){l||(b(s),l=!0)},o(a){D(s),l=!1},d(a){a&&m(e),s&&s.d(),Ue(i,a)}}}function ei(n){let e,t,l;function s(i){n[3](i)}let r={className:"w-full space-y-1",$$slots:{content:[xr],default:[$r]},$$scope:{ctx:n}};return n[1]!==void 0&&(r.open=n[1]),e=new Rn({props:r}),je.push(()=>Ke(e,"open",s)),{c(){X(e.$$.fragment)},l(i){Y(e.$$.fragment,i)},m(i,o){$(e,i,o),l=!0},p(i,[o]){const a={};o&19&&(a.$$scope={dirty:o,ctx:i}),!t&&o&2&&(t=!0,a.open=i[1],Ze(()=>t=!1)),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){x(e,i)}}}function ti(n,e,t){let{$$slots:l={},$$scope:s}=e,{status:r={urls:[],query:""}}=e,i=!1;function o(a){i=a,t(1,i)}return n.$$set=a=>{"status"in a&&t(0,r=a.status),"$$scope"in a&&t(4,s=a.$$scope)},[r,i,l,o,s]}class li extends Te{constructor(e){super(),Be(this,e,ti,ei,Ve,{status:0})}}function si(n){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width",n[1]),d(e,"stroke","currentColor"),d(e,"class",n[0])},m(l,s){V(l,e,s),_(e,t)},p(l,[s]){s&2&&d(e,"stroke-width",l[1]),s&1&&d(e,"class",l[0])},i:ve,o:ve,d(l){l&&m(e)}}}function ni(n,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class ri extends Te{constructor(e){super(),Be(this,e,ni,si,Ve,{className:0,strokeWidth:1})}}function ii(n){let e,t,l,s,r,i=(typeof n[0]=="string"?n[0]:JSON.stringify(n[0]))+"",o,a;return l=new wr({props:{className:"size-5 text-red-700 dark:text-red-400"}}),{c(){e=M("div"),t=M("div"),X(l.$$.fragment),s=j(),r=M("div"),o=U(i),this.h()},l(f){e=N(f,"DIV",{class:!0});var u=k(e);t=N(u,"DIV",{class:!0});var c=k(t);Y(l.$$.fragment,c),c.forEach(m),s=H(u),r=N(u,"DIV",{class:!0});var g=k(r);o=q(g,i),g.forEach(m),u.forEach(m),this.h()},h(){d(t,"class","self-start mt-0.5"),d(r,"class","self-center text-sm"),d(e,"class","flex my-2 gap-2.5 border px-4 py-3 border-red-600/10 bg-red-600/10 rounded-lg")},m(f,u){V(f,e,u),_(e,t),$(l,t,null),_(e,s),_(e,r),_(r,o),a=!0},p(f,[u]){(!a||u&1)&&i!==(i=(typeof f[0]=="string"?f[0]:JSON.stringify(f[0]))+"")&&K(o,i)},i(f){a||(b(l.$$.fragment,f),a=!0)},o(f){D(l.$$.fragment,f),a=!1},d(f){f&&m(e),x(l)}}}function oi(n,e,t){let{content:l=""}=e;return n.$$set=s=>{"content"in s&&t(0,l=s.content)},[l]}let ai=class extends Te{constructor(e){super(),Be(this,e,oi,ii,Ve,{content:0})}};function Vl(n,e,t){const l=n.slice();return l[9]=e[t],l[11]=t,l}function fi(n){const e=n.slice(),t=wi(e[9].distance);return e[12]=t,e}function ui(n){let e,t=n[4].t("No source available")+"",l;return{c(){e=M("div"),l=U(t),this.h()},l(s){e=N(s,"DIV",{class:!0});var r=k(e);l=q(r,t),r.forEach(m),this.h()},h(){d(e,"class","text-sm dark:text-gray-400")},m(s,r){V(s,e,r),_(e,l)},p(s,r){r&16&&t!==(t=s[4].t("No source available")+"")&&K(l,t)},i:ve,o:ve,d(s){s&&m(e)}}}function ci(n){let e,t,l,s;e=new Re({props:{className:"w-fit",content:n[4].t("Open file"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[di]},$$scope:{ctx:n}}});let r=n[2]&&Tl(n);return{c(){X(e.$$.fragment),t=j(),r&&r.c(),l=fe()},l(i){Y(e.$$.fragment,i),t=H(i),r&&r.l(i),l=fe()},m(i,o){$(e,i,o),V(i,t,o),r&&r.m(i,o),V(i,l,o),s=!0},p(i,o){const a={};o&16&&(a.content=i[4].t("Open file")),o&8216&&(a.$$scope={dirty:o,ctx:i}),e.$set(a),i[2]?r?(r.p(i,o),o&4&&b(r,1)):(r=Tl(i),r.c(),b(r,1),r.m(l.parentNode,l)):r&&(le(),D(r,1,1,()=>{r=null}),se())},i(i){s||(b(e.$$.fragment,i),b(r),s=!0)},o(i){D(e.$$.fragment,i),D(r),s=!1},d(i){i&&(m(t),m(l)),x(e,i),r&&r.d(i)}}}function Cl(n){let e,t,l=n[4].t("page")+"",s,r,i=n[9].metadata.page+1+"",o,a;return{c(){e=M("span"),t=U("("),s=U(l),r=j(),o=U(i),a=U(")"),this.h()},l(f){e=N(f,"SPAN",{class:!0});var u=k(e);t=q(u,"("),s=q(u,l),r=H(u),o=q(u,i),a=q(u,")"),u.forEach(m),this.h()},h(){d(e,"class","text-xs text-gray-500 dark:text-gray-400")},m(f,u){V(f,e,u),_(e,t),_(e,s),_(e,r),_(e,o),_(e,a)},p(f,u){u&16&&l!==(l=f[4].t("page")+"")&&K(s,l),u&8&&i!==(i=f[9].metadata.page+1+"")&&K(o,i)},d(f){f&&m(e)}}}function di(n){var a,f,u,c;let e,t,l=(((f=(a=n[9])==null?void 0:a.metadata)==null?void 0:f.name)??n[9].source.name)+"",s,r,i,o=((c=(u=n[9])==null?void 0:u.metadata)==null?void 0:c.page)&&Cl(n);return{c(){e=M("div"),t=M("a"),s=U(l),i=j(),o&&o.c(),this.h()},l(g){e=N(g,"DIV",{class:!0});var h=k(e);t=N(h,"A",{class:!0,href:!0,target:!0});var p=k(t);s=q(p,l),p.forEach(m),i=H(h),o&&o.l(h),h.forEach(m),this.h()},h(){var g,h,p,w,v,E,y,B;d(t,"class","hover:text-gray-500 dark:hover:text-gray-100 underline grow"),d(t,"href",r=(h=(g=n[9])==null?void 0:g.metadata)!=null&&h.file_id?`${cl}/files/${(w=(p=n[9])==null?void 0:p.metadata)==null?void 0:w.file_id}/content${((E=(v=n[9])==null?void 0:v.metadata)==null?void 0:E.page)!==void 0?`#page=${n[9].metadata.page+1}`:""}`:(B=(y=n[9].source)==null?void 0:y.url)!=null&&B.includes("http")?n[9].source.url:"#"),d(t,"target","_blank"),d(e,"class","text-sm dark:text-gray-400 flex items-center gap-2 w-fit")},m(g,h){V(g,e,h),_(e,t),_(t,s),_(e,i),o&&o.m(e,null)},p(g,h){var p,w,v,E,y,B,L,T,I,R,O,C;h&8&&l!==(l=(((w=(p=g[9])==null?void 0:p.metadata)==null?void 0:w.name)??g[9].source.name)+"")&&K(s,l),h&8&&r!==(r=(E=(v=g[9])==null?void 0:v.metadata)!=null&&E.file_id?`${cl}/files/${(B=(y=g[9])==null?void 0:y.metadata)==null?void 0:B.file_id}/content${((T=(L=g[9])==null?void 0:L.metadata)==null?void 0:T.page)!==void 0?`#page=${g[9].metadata.page+1}`:""}`:(R=(I=g[9].source)==null?void 0:I.url)!=null&&R.includes("http")?g[9].source.url:"#")&&d(t,"href",r),(C=(O=g[9])==null?void 0:O.metadata)!=null&&C.page?o?o.p(g,h):(o=Cl(g),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(g){g&&m(e),o&&o.d()}}}function Tl(n){let e,t=n[4].t("Relevance")+"",l,s,r,i,o,a;const f=[mi,hi],u=[];function c(g,h){return g[9].distance!==void 0?0:1}return r=c(n),i=u[r]=f[r](n),{c(){e=M("div"),l=U(t),s=j(),i.c(),o=fe(),this.h()},l(g){e=N(g,"DIV",{class:!0});var h=k(e);l=q(h,t),h.forEach(m),s=H(g),i.l(g),o=fe(),this.h()},h(){d(e,"class","text-sm font-medium dark:text-gray-300 mt-2")},m(g,h){V(g,e,h),_(e,l),V(g,s,h),u[r].m(g,h),V(g,o,h),a=!0},p(g,h){(!a||h&16)&&t!==(t=g[4].t("Relevance")+"")&&K(l,t);let p=r;r=c(g),r===p?u[r].p(g,h):(le(),D(u[p],1,1,()=>{u[p]=null}),se(),i=u[r],i?i.p(g,h):(i=u[r]=f[r](g),i.c()),b(i,1),i.m(o.parentNode,o))},i(g){a||(b(i),a=!0)},o(g){D(i),a=!1},d(g){g&&(m(e),m(s),m(o)),u[r].d(g)}}}function hi(n){let e,t=n[4].t("No distance available")+"",l;return{c(){e=M("div"),l=U(t),this.h()},l(s){e=N(s,"DIV",{class:!0});var r=k(e);l=q(r,t),r.forEach(m),this.h()},h(){d(e,"class","text-sm dark:text-gray-400")},m(s,r){V(s,e,r),_(e,l)},p(s,r){r&16&&t!==(t=s[4].t("No distance available")+"")&&K(l,t)},i:ve,o:ve,d(s){s&&m(e)}}}function mi(n){let e,t;return e=new Re({props:{className:"w-fit",content:n[4].t("Semantic distance to query"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[_i]},$$scope:{ctx:n}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s&16&&(r.content=l[4].t("Semantic distance to query")),s&8202&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function gi(n){let e,t=n[9].distance.toFixed(4)+"",l;return{c(){e=M("span"),l=U(t),this.h()},l(s){e=N(s,"SPAN",{class:!0});var r=k(e);l=q(r,t),r.forEach(m),this.h()},h(){d(e,"class","text-gray-500 dark:text-gray-500")},m(s,r){V(s,e,r),_(e,l)},p(s,r){r&8&&t!==(t=s[9].distance.toFixed(4)+"")&&K(l,t)},d(s){s&&m(e)}}}function Bl(n){let e,t=n[12].toFixed(2)+"",l,s,r,i,o,a,f=n[9].distance.toFixed(4)+"",u,c;return{c(){e=M("span"),l=U(t),s=U("%"),i=j(),o=M("span"),a=U("("),u=U(f),c=U(")"),this.h()},l(g){e=N(g,"SPAN",{class:!0});var h=k(e);l=q(h,t),s=q(h,"%"),h.forEach(m),i=H(g),o=N(g,"SPAN",{class:!0});var p=k(o);a=q(p,"("),u=q(p,f),c=q(p,")"),p.forEach(m),this.h()},h(){d(e,"class",r=`px-1 rounded-sm font-medium ${Ol(n[12])}`),d(o,"class","text-gray-500 dark:text-gray-500")},m(g,h){V(g,e,h),_(e,l),_(e,s),V(g,i,h),V(g,o,h),_(o,a),_(o,u),_(o,c)},p(g,h){h&8&&t!==(t=g[12].toFixed(2)+"")&&K(l,t),h&8&&r!==(r=`px-1 rounded-sm font-medium ${Ol(g[12])}`)&&d(e,"class",r),h&8&&f!==(f=g[9].distance.toFixed(4)+"")&&K(u,f)},d(g){g&&(m(e),m(i),m(o))}}}function _i(n){let e;function t(i,o){return i[1]?Bl:gi}function l(i,o){return o===Bl?fi(i):i}let s=t(n),r=s(l(n,s));return{c(){e=M("div"),r.c(),this.h()},l(i){e=N(i,"DIV",{class:!0});var o=k(e);r.l(o),o.forEach(m),this.h()},h(){d(e,"class","text-sm my-1 dark:text-gray-400 flex items-center gap-2 w-fit")},m(i,o){V(i,e,o),r.m(e,null)},p(i,o){s===(s=t(i))&&r?r.p(l(i,s),o):(r.d(1),r=s(l(i,s)),r&&(r.c(),r.m(e,null)))},d(i){i&&m(e),r.d()}}}function vi(n){let e,t,l=n[9].document+"",s,r;return{c(){e=M("pre"),t=U("                "),s=U(l),r=U(`
              `),this.h()},l(i){e=N(i,"PRE",{class:!0});var o=k(e);t=q(o,"                "),s=q(o,l),r=q(o,`
              `),o.forEach(m),this.h()},h(){d(e,"class","text-sm dark:text-gray-400 whitespace-pre-line")},m(i,o){V(i,e,o),_(e,t),_(e,s),_(e,r)},p(i,o){o&8&&l!==(l=i[9].document+"")&&K(s,l)},d(i){i&&m(e)}}}function pi(n){let e,t,l;return{c(){e=M("iframe"),this.h()},l(s){e=N(s,"IFRAME",{class:!0,sandbox:!0,srcdoc:!0,title:!0}),k(e).forEach(m),this.h()},h(){d(e,"class","w-full border-0 h-auto rounded-none"),d(e,"sandbox","allow-scripts allow-forms allow-same-origin"),d(e,"srcdoc",t=n[9].document),d(e,"title",l=n[4].t("Content"))},m(s,r){V(s,e,r)},p(s,r){r&8&&t!==(t=s[9].document)&&d(e,"srcdoc",t),r&16&&l!==(l=s[4].t("Content"))&&d(e,"title",l)},d(s){s&&m(e)}}}function Rl(n){let e;return{c(){e=M("hr"),this.h()},l(t){e=N(t,"HR",{class:!0}),this.h()},h(){d(e,"class","border-gray-100 dark:border-gray-850 my-3")},m(t,l){V(t,e,l)},d(t){t&&m(e)}}}function Sl(n){let e,t,l=n[4].t("Source")+"",s,r,i,o,a,f,u,c=n[4].t("Content")+"",g,h,p,w,v;const E=[ci,ui],y=[];function B(O,C){var P;return(P=O[9].source)!=null&&P.name?0:1}i=B(n),o=y[i]=E[i](n);function L(O,C){var P;return(P=O[9].metadata)!=null&&P.html?pi:vi}let T=L(n),I=T(n),R=n[11]!==n[3].length-1&&Rl();return{c(){e=M("div"),t=M("div"),s=U(l),r=j(),o.c(),a=j(),f=M("div"),u=M("div"),g=U(c),h=j(),I.c(),p=j(),R&&R.c(),w=fe(),this.h()},l(O){e=N(O,"DIV",{class:!0});var C=k(e);t=N(C,"DIV",{class:!0});var P=k(t);s=q(P,l),P.forEach(m),r=H(C),o.l(C),C.forEach(m),a=H(O),f=N(O,"DIV",{class:!0});var S=k(f);u=N(S,"DIV",{class:!0});var W=k(u);g=q(W,c),W.forEach(m),h=H(S),I.l(S),S.forEach(m),p=H(O),R&&R.l(O),w=fe(),this.h()},h(){d(t,"class","text-sm font-medium dark:text-gray-300"),d(e,"class","flex flex-col w-full"),d(u,"class","text-sm font-medium dark:text-gray-300 mt-2"),d(f,"class","flex flex-col w-full")},m(O,C){V(O,e,C),_(e,t),_(t,s),_(e,r),y[i].m(e,null),V(O,a,C),V(O,f,C),_(f,u),_(u,g),_(f,h),I.m(f,null),V(O,p,C),R&&R.m(O,C),V(O,w,C),v=!0},p(O,C){(!v||C&16)&&l!==(l=O[4].t("Source")+"")&&K(s,l);let P=i;i=B(O),i===P?y[i].p(O,C):(le(),D(y[P],1,1,()=>{y[P]=null}),se(),o=y[i],o?o.p(O,C):(o=y[i]=E[i](O),o.c()),b(o,1),o.m(e,null)),(!v||C&16)&&c!==(c=O[4].t("Content")+"")&&K(g,c),T===(T=L(O))&&I?I.p(O,C):(I.d(1),I=T(O),I&&(I.c(),I.m(f,null))),O[11]!==O[3].length-1?R||(R=Rl(),R.c(),R.m(w.parentNode,w)):R&&(R.d(1),R=null)},i(O){v||(b(o),v=!0)},o(O){D(o),v=!1},d(O){O&&(m(e),m(a),m(f),m(p),m(w)),y[i].d(),I.d(),R&&R.d(O)}}}function bi(n){let e,t,l,s=n[4].t("Citation")+"",r,i,o,a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',f,u,c,g,h,p,w=Ee(n[3]),v=[];for(let y=0;y<w.length;y+=1)v[y]=Sl(Vl(n,w,y));const E=y=>D(v[y],1,1,()=>{v[y]=null});return{c(){e=M("div"),t=M("div"),l=M("div"),r=U(s),i=j(),o=M("button"),o.innerHTML=a,f=j(),u=M("div"),c=M("div");for(let y=0;y<v.length;y+=1)v[y].c();this.h()},l(y){e=N(y,"DIV",{});var B=k(e);t=N(B,"DIV",{class:!0});var L=k(t);l=N(L,"DIV",{class:!0});var T=k(l);r=q(T,s),T.forEach(m),i=H(L),o=N(L,"BUTTON",{class:!0,"data-svelte-h":!0}),Ae(o)!=="svelte-745w2y"&&(o.innerHTML=a),L.forEach(m),f=H(B),u=N(B,"DIV",{class:!0});var I=k(u);c=N(I,"DIV",{class:!0});var R=k(c);for(let O=0;O<v.length;O+=1)v[O].l(R);R.forEach(m),I.forEach(m),B.forEach(m),this.h()},h(){d(l,"class","text-lg font-medium self-center capitalize"),d(o,"class","self-center"),d(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),d(c,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),d(u,"class","flex flex-col md:flex-row w-full px-6 pb-5 md:space-x-4")},m(y,B){V(y,e,B),_(e,t),_(t,l),_(l,r),_(t,i),_(t,o),_(e,f),_(e,u),_(u,c);for(let L=0;L<v.length;L+=1)v[L]&&v[L].m(c,null);g=!0,h||(p=_e(o,"click",n[7]),h=!0)},p(y,B){if((!g||B&16)&&s!==(s=y[4].t("Citation")+"")&&K(r,s),B&30){w=Ee(y[3]);let L;for(L=0;L<w.length;L+=1){const T=Vl(y,w,L);v[L]?(v[L].p(T,B),b(v[L],1)):(v[L]=Sl(T),v[L].c(),b(v[L],1),v[L].m(c,null))}for(le(),L=w.length;L<v.length;L+=1)E(L);se()}},i(y){if(!g){for(let B=0;B<w.length;B+=1)b(v[B]);g=!0}},o(y){v=v.filter(Boolean);for(let B=0;B<v.length;B+=1)D(v[B]);g=!1},d(y){y&&m(e),Ue(v,y),h=!1,p()}}}function ki(n){let e,t,l;function s(i){n[8](i)}let r={size:"lg",$$slots:{default:[bi]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new On({props:r}),je.push(()=>Ke(e,"show",s)),{c(){X(e.$$.fragment)},l(i){Y(e.$$.fragment,i)},m(i,o){$(e,i,o),l=!0},p(i,[o]){const a={};o&8223&&(a.$$scope={dirty:o,ctx:i}),!t&&o&1&&(t=!0,a.show=i[0],Ze(()=>t=!1)),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){x(e,i)}}}function wi(n){return n<0?0:n>1?100:Math.round(n*1e4)/100}function Ol(n){return n>=80?"bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200":n>=60?"bg-yellow-200 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200":n>=40?"bg-orange-200 dark:bg-orange-800 text-orange-800 dark:text-orange-200":"bg-red-200 dark:bg-red-800 text-red-800 dark:text-red-200"}function yi(n,e,t){let l;const s=qe("i18n");Ie(n,s,g=>t(4,l=g));let{show:r=!1}=e,{citation:i}=e,{showPercentage:o=!1}=e,{showRelevance:a=!0}=e,f=[];const u=()=>{t(0,r=!1)};function c(g){r=g,t(0,r)}return n.$$set=g=>{"show"in g&&t(0,r=g.show),"citation"in g&&t(6,i=g.citation),"showPercentage"in g&&t(1,o=g.showPercentage),"showRelevance"in g&&t(2,a=g.showRelevance)},n.$$.update=()=>{var g;n.$$.dirty&72&&i&&(t(3,f=(g=i.document)==null?void 0:g.map((h,p)=>{var w,v;return{source:i.source,document:h,metadata:(w=i.metadata)==null?void 0:w[p],distance:(v=i.distances)==null?void 0:v[p]}})),f.every(h=>h.distance!==void 0)&&t(3,f=f.sort((h,p)=>(p.distance??1/0)-(h.distance??1/0))))},[r,o,a,f,l,s,i,u,c]}class Ii extends Te{constructor(e){super(),Be(this,e,yi,ki,Ve,{show:0,citation:6,showPercentage:1,showRelevance:2})}}function Ll(n,e,t){const l=n.slice();return l[18]=e[t],l[20]=t,l}function Pl(n,e,t){const l=n.slice();return l[18]=e[t],l[20]=t,l}function Al(n,e,t){const l=n.slice();return l[18]=e[t],l[20]=t,l}function jl(n){let e,t,l,s;const r=[Mi,Ei],i=[];function o(a,f){return a[1].length<=3?0:1}return t=o(n),l=i[t]=r[t](n),{c(){e=M("div"),l.c(),this.h()},l(a){e=N(a,"DIV",{class:!0});var f=k(e);l.l(f),f.forEach(m),this.h()},h(){d(e,"class","py-0.5 -mx-0.5 w-full flex gap-1 items-center flex-wrap")},m(a,f){V(a,e,f),i[t].m(e,null),s=!0},p(a,f){let u=t;t=o(a),t===u?i[t].p(a,f):(le(),D(i[u],1,1,()=>{i[u]=null}),se(),l=i[t],l?l.p(a,f):(l=i[t]=r[t](a),l.c()),b(l,1),l.m(e,null))},i(a){s||(b(l),s=!0)},o(a){D(l),s=!1},d(a){a&&m(e),i[t].d()}}}function Ei(n){let e,t,l;function s(i){n[17](i)}let r={id:"collapsible-sources",className:"w-full max-w-full ",buttonClassName:"w-fit max-w-full",$$slots:{content:[Ci],default:[Vi]},$$scope:{ctx:n}};return n[6]!==void 0&&(r.open=n[6]),e=new Rn({props:r}),je.push(()=>Ke(e,"open",s)),{c(){X(e.$$.fragment)},l(i){Y(e.$$.fragment,i)},m(i,o){$(e,i,o),l=!0},p(i,o){const a={};o&8388851&&(a.$$scope={dirty:o,ctx:i}),!t&&o&64&&(t=!0,a.open=i[6],Ze(()=>t=!1)),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){x(e,i)}}}function Mi(n){let e,t=Ee(n[1]),l=[];for(let s=0;s<t.length;s+=1)l[s]=Fl(Al(n,t,s));return{c(){e=M("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=N(s,"DIV",{class:!0});var r=k(e);for(let i=0;i<l.length;i+=1)l[i].l(r);r.forEach(m),this.h()},h(){d(e,"class","flex text-xs font-medium flex-wrap")},m(s,r){V(s,e,r);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(e,null)},p(s,r){if(r&51){t=Ee(s[1]);let i;for(i=0;i<t.length;i+=1){const o=Al(s,t,i);l[i]?l[i].p(o,r):(l[i]=Fl(o),l[i].c(),l[i].m(e,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=t.length}},i:ve,o:ve,d(s){s&&m(e),Ue(l,s)}}}function Hl(n){let e,t=n[20]+1+"",l;return{c(){e=M("div"),l=U(t),this.h()},l(s){e=N(s,"DIV",{class:!0});var r=k(e);l=q(r,t),r.forEach(m),this.h()},h(){d(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){V(s,e,r),_(e,l)},d(s){s&&m(e)}}}function zl(n){let e,t=n[1].every(n[12]),l,s,r=n[18].source.name+"",i,o,a,f,u=t&&Hl(n);function c(){return n[16](n[18])}return{c(){e=M("button"),u&&u.c(),l=j(),s=M("div"),i=U(r),o=j(),this.h()},l(g){e=N(g,"BUTTON",{class:!0});var h=k(e);u&&u.l(h),l=H(h),s=N(h,"DIV",{class:!0});var p=k(s);i=q(p,r),p.forEach(m),o=H(h),h.forEach(m),this.h()},h(){d(s,"class","flex-1 mx-1 truncate"),d(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(g,h){V(g,e,h),u&&u.m(e,null),_(e,l),_(e,s),_(s,i),_(e,o),a||(f=[_e(e,"click",c),_e(e,"pointerup",Si)],a=!0)},p(g,h){n=g,h&2&&(t=n[1].every(n[12])),t?u||(u=Hl(n),u.c(),u.m(e,l)):u&&(u.d(1),u=null),h&2&&r!==(r=n[18].source.name+"")&&K(i,r)},d(g){g&&m(e),u&&u.d(),a=!1,et(f)}}}function Ni(n){let e,t;return e=new Tn({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Di(n){let e,t;return e=new Bn({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Vi(n){let e,t,l,s=n[7].t("References from")+"",r,i,o,a,f,u,c,g=n[7].t("and")+"",h,p,w=n[1].length-2+"",v,E,y,B=n[7].t("more")+"",L,T,I,R,O,C,P=Ee(n[1].slice(0,2)),S=[];for(let te=0;te<P.length;te+=1)S[te]=zl(Ll(n,P,te));const W=[Di,Ni],ne=[];function ue(te,ie){return te[6]?0:1}return R=ue(n),O=ne[R]=W[R](n),{c(){e=M("div"),t=M("div"),l=M("span"),r=U(s),i=j(),o=M("div"),a=M("div");for(let te=0;te<S.length;te+=1)S[te].c();f=j(),u=M("div"),c=M("span"),h=U(g),p=j(),v=U(w),E=j(),y=M("span"),L=U(B),T=j(),I=M("div"),O.c(),this.h()},l(te){e=N(te,"DIV",{class:!0});var ie=k(e);t=N(ie,"DIV",{class:!0});var G=k(t);l=N(G,"SPAN",{class:!0});var Q=k(l);r=q(Q,s),Q.forEach(m),i=H(G),o=N(G,"DIV",{class:!0});var he=k(o);a=N(he,"DIV",{class:!0});var de=k(a);for(let pe=0;pe<S.length;pe+=1)S[pe].l(de);de.forEach(m),he.forEach(m),f=H(G),u=N(G,"DIV",{class:!0});var Z=k(u);c=N(Z,"SPAN",{class:!0});var z=k(c);h=q(z,g),z.forEach(m),p=H(Z),v=q(Z,w),E=H(Z),y=N(Z,"SPAN",{});var ae=k(y);L=q(ae,B),ae.forEach(m),Z.forEach(m),G.forEach(m),T=H(ie),I=N(ie,"DIV",{class:!0});var re=k(I);O.l(re),re.forEach(m),ie.forEach(m),this.h()},h(){d(l,"class","whitespace-nowrap hidden sm:inline shrink-0"),d(a,"class","flex text-xs font-medium items-center"),d(o,"class","flex items-center overflow-auto scrollbar-none w-full max-w-full flex-1"),d(c,"class","hidden sm:inline"),d(u,"class","flex items-center gap-1 whitespace-nowrap shrink-0"),d(t,"class","flex-1 flex items-center gap-1 overflow-auto scrollbar-none w-full max-w-full"),d(I,"class","shrink-0"),d(e,"class","flex w-full overflow-auto items-center gap-2 text-gray-500 hover:text-gray-600 dark:hover:text-gray-400 transition cursor-pointer")},m(te,ie){V(te,e,ie),_(e,t),_(t,l),_(l,r),_(t,i),_(t,o),_(o,a);for(let G=0;G<S.length;G+=1)S[G]&&S[G].m(a,null);_(t,f),_(t,u),_(u,c),_(c,h),_(u,p),_(u,v),_(u,E),_(u,y),_(y,L),_(e,T),_(e,I),ne[R].m(I,null),C=!0},p(te,ie){if((!C||ie&128)&&s!==(s=te[7].t("References from")+"")&&K(r,s),ie&50){P=Ee(te[1].slice(0,2));let Q;for(Q=0;Q<P.length;Q+=1){const he=Ll(te,P,Q);S[Q]?S[Q].p(he,ie):(S[Q]=zl(he),S[Q].c(),S[Q].m(a,null))}for(;Q<S.length;Q+=1)S[Q].d(1);S.length=P.length}(!C||ie&128)&&g!==(g=te[7].t("and")+"")&&K(h,g),(!C||ie&2)&&w!==(w=te[1].length-2+"")&&K(v,w),(!C||ie&128)&&B!==(B=te[7].t("more")+"")&&K(L,B);let G=R;R=ue(te),R!==G&&(le(),D(ne[G],1,1,()=>{ne[G]=null}),se(),O=ne[R],O||(O=ne[R]=W[R](te),O.c()),b(O,1),O.m(I,null))},i(te){C||(b(O),C=!0)},o(te){D(O),C=!1},d(te){te&&m(e),Ue(S,te),ne[R].d()}}}function Wl(n){let e,t=n[20]+1+"",l;return{c(){e=M("div"),l=U(t),this.h()},l(s){e=N(s,"DIV",{class:!0});var r=k(e);l=q(r,t),r.forEach(m),this.h()},h(){d(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){V(s,e,r),_(e,l)},d(s){s&&m(e)}}}function Ul(n){let e,t=n[1].every(n[11]),l,s,r=n[18].source.name+"",i,o,a,f,u,c=t&&Wl(n);function g(){return n[15](n[18])}return{c(){e=M("button"),c&&c.c(),l=j(),s=M("div"),i=U(r),o=j(),this.h()},l(h){e=N(h,"BUTTON",{id:!0,class:!0});var p=k(e);c&&c.l(p),l=H(p),s=N(p,"DIV",{class:!0});var w=k(s);i=q(w,r),w.forEach(m),o=H(p),p.forEach(m),this.h()},h(){d(s,"class","flex-1 mx-1 truncate"),d(e,"id",a=`source-${n[0]}-${n[20]}`),d(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(h,p){V(h,e,p),c&&c.m(e,null),_(e,l),_(e,s),_(s,i),_(e,o),f||(u=_e(e,"click",g),f=!0)},p(h,p){n=h,p&2&&(t=n[1].every(n[11])),t?c||(c=Wl(n),c.c(),c.m(e,l)):c&&(c.d(1),c=null),p&2&&r!==(r=n[18].source.name+"")&&K(i,r),p&1&&a!==(a=`source-${n[0]}-${n[20]}`)&&d(e,"id",a)},d(h){h&&m(e),c&&c.d(),f=!1,u()}}}function Ci(n){let e,t,l=Ee(n[1]),s=[];for(let r=0;r<l.length;r+=1)s[r]=Ul(Pl(n,l,r));return{c(){e=M("div"),t=M("div");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=N(r,"DIV",{slot:!0});var i=k(e);t=N(i,"DIV",{class:!0});var o=k(t);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),i.forEach(m),this.h()},h(){d(t,"class","flex text-xs font-medium flex-wrap"),d(e,"slot","content")},m(r,i){V(r,e,i),_(e,t);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(t,null)},p(r,i){if(i&51){l=Ee(r[1]);let o;for(o=0;o<l.length;o+=1){const a=Pl(r,l,o);s[o]?s[o].p(a,i):(s[o]=Ul(a),s[o].c(),s[o].m(t,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=l.length}},d(r){r&&m(e),Ue(s,r)}}}function ql(n){let e,t=n[20]+1+"",l;return{c(){e=M("div"),l=U(t),this.h()},l(s){e=N(s,"DIV",{class:!0});var r=k(e);l=q(r,t),r.forEach(m),this.h()},h(){d(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){V(s,e,r),_(e,l)},d(s){s&&m(e)}}}function Fl(n){let e,t=n[1].every(n[10]),l,s,r=n[18].source.name+"",i,o,a,f,u,c=t&&ql(n);function g(){return n[14](n[18])}return{c(){e=M("button"),c&&c.c(),l=j(),s=M("div"),i=U(r),o=j(),this.h()},l(h){e=N(h,"BUTTON",{id:!0,class:!0});var p=k(e);c&&c.l(p),l=H(p),s=N(p,"DIV",{class:!0});var w=k(s);i=q(w,r),w.forEach(m),o=H(p),p.forEach(m),this.h()},h(){d(s,"class","flex-1 mx-1 truncate text-black/60 hover:text-black dark:text-white/60 dark:hover:text-white transition"),d(e,"id",a=`source-${n[0]}-${n[20]}`),d(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-white dark:bg-gray-900 rounded-xl max-w-96")},m(h,p){V(h,e,p),c&&c.m(e,null),_(e,l),_(e,s),_(s,i),_(e,o),f||(u=_e(e,"click",g),f=!0)},p(h,p){n=h,p&2&&(t=n[1].every(n[10])),t?c||(c=ql(n),c.c(),c.m(e,l)):c&&(c.d(1),c=null),p&2&&r!==(r=n[18].source.name+"")&&K(i,r),p&1&&a!==(a=`source-${n[0]}-${n[20]}`)&&d(e,"id",a)},d(h){h&&m(e),c&&c.d(),f=!1,u()}}}function Ti(n){let e,t,l,s,r;function i(f){n[13](f)}let o={citation:n[5],showPercentage:n[2],showRelevance:n[3]};n[4]!==void 0&&(o.show=n[4]),e=new Ii({props:o}),je.push(()=>Ke(e,"show",i));let a=n[1].length>0&&jl(n);return{c(){X(e.$$.fragment),l=j(),a&&a.c(),s=fe()},l(f){Y(e.$$.fragment,f),l=H(f),a&&a.l(f),s=fe()},m(f,u){$(e,f,u),V(f,l,u),a&&a.m(f,u),V(f,s,u),r=!0},p(f,[u]){const c={};u&32&&(c.citation=f[5]),u&4&&(c.showPercentage=f[2]),u&8&&(c.showRelevance=f[3]),!t&&u&16&&(t=!0,c.show=f[4],Ze(()=>t=!1)),e.$set(c),f[1].length>0?a?(a.p(f,u),u&2&&b(a,1)):(a=jl(f),a.c(),b(a,1),a.m(s.parentNode,s)):a&&(le(),D(a,1,1,()=>{a=null}),se())},i(f){r||(b(e.$$.fragment,f),b(a),r=!0)},o(f){D(e.$$.fragment,f),D(a),r=!1},d(f){f&&(m(l),m(s)),x(e,f),a&&a.d(f)}}}function Bi(n){const e=n.flatMap(s=>s.distances??[]),t=e.filter(s=>s!==void 0&&s>=-1&&s<=1).length,l=e.filter(s=>s!==void 0&&(s<-1||s>1)).length;return!(e.length===0||t===e.length-1&&l===1||l===e.length-1&&t===1)}function Ri(n){return n.flatMap(t=>t.distances??[]).every(t=>t!==void 0&&t>=-1&&t<=1)}const Si=n=>{n.stopPropagation()};function Oi(n,e,t){let l;const s=qe("i18n");Ie(n,s,T=>t(7,l=T));let{id:r=""}=e,{sources:i=[]}=e,o=[],a=!1,f=!0,u=!1,c=null,g=!1;const h=T=>T.distances!==void 0,p=T=>T.distances!==void 0,w=T=>T.distances!==void 0;function v(T){u=T,t(4,u)}const E=T=>{t(4,u=!0),t(5,c=T)},y=T=>{t(4,u=!0),t(5,c=T)},B=T=>{t(4,u=!0),t(5,c=T)};function L(T){g=T,t(6,g)}return n.$$set=T=>{"id"in T&&t(0,r=T.id),"sources"in T&&t(9,i=T.sources)},n.$$.update=()=>{n.$$.dirty&514&&(t(1,o=i.reduce((T,I)=>(Object.keys(I).length===0||I.document.forEach((R,O)=>{var ue,te;const C=(ue=I.metadata)==null?void 0:ue[O],P=(te=I.distances)==null?void 0:te[O],S=(C==null?void 0:C.source)??"N/A";let W=I==null?void 0:I.source;C!=null&&C.name&&(W={...W,name:C.name}),(S.startsWith("http://")||S.startsWith("https://"))&&(W={...W,name:S,url:S});const ne=T.find(ie=>ie.id===S);ne?(ne.document.push(R),ne.metadata.push(C),P!==void 0&&ne.distances.push(P)):T.push({id:S,source:W,document:[R],metadata:C?[C]:[],distances:P!==void 0?[P]:void 0})}),T),[])),t(3,f=Bi(o)),t(2,a=Ri(o)))},[r,o,a,f,u,c,g,l,s,i,h,p,w,v,E,y,B,L]}class Li extends Te{constructor(e){super(),Be(this,e,Oi,Ti,Ve,{id:0,sources:9})}}function Jl(n,e,t){const l=n.slice();return l[6]=e[t],l}function Gl(n){let e,t,l,s;const r=[ji,Ai,Pi],i=[];function o(a,f){var u,c;return(u=a[1].result)!=null&&u.error?0:(c=a[1].result)!=null&&c.output?1:2}return t=o(n),l=i[t]=r[t](n),{c(){e=M("div"),l.c()},l(a){e=N(a,"DIV",{});var f=k(e);l.l(f),f.forEach(m)},m(a,f){V(a,e,f),i[t].m(e,null),s=!0},p(a,f){let u=t;t=o(a),t!==u&&(le(),D(i[u],1,1,()=>{i[u]=null}),se(),l=i[t],l||(l=i[t]=r[t](a),l.c()),b(l,1),l.m(e,null))},i(a){s||(b(l),s=!0)},o(a){D(l),s=!1},d(a){a&&m(e),i[t].d()}}}function Pi(n){let e,t;return e=new Qt({props:{type:"warning",content:"incomplete"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ai(n){let e,t;return e=new Qt({props:{type:"success",content:"success"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function ji(n){let e,t;return e=new Qt({props:{type:"error",content:"error"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Zl(n){let e,t,l;return t=new Wt({props:{className:"size-4"}}),{c(){e=M("div"),X(t.$$.fragment)},l(s){e=N(s,"DIV",{});var r=k(e);Y(t.$$.fragment,r),r.forEach(m)},m(s,r){V(s,e,r),$(t,e,null),l=!0},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),x(t)}}}function Hi(n){let e=n[2].t("Code execution")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&4&&e!==(e=l[2].t("Code execution")+"")&&K(t,e)},d(l){l&&m(t)}}}function zi(n){var i;let e=n[2].t("Code execution")+"",t,l,s=((i=n[1])==null?void 0:i.name)+"",r;return{c(){t=U(e),l=U(": "),r=U(s)},l(o){t=q(o,e),l=q(o,": "),r=q(o,s)},m(o,a){V(o,t,a),V(o,l,a),V(o,r,a)},p(o,a){var f;a&4&&e!==(e=o[2].t("Code execution")+"")&&K(t,e),a&2&&s!==(s=((f=o[1])==null?void 0:f.name)+"")&&K(r,s)},d(o){o&&(m(t),m(l),m(r))}}}function Kl(n){var r,i,o,a;let e,t,l=((i=(r=n[1])==null?void 0:r.result)==null?void 0:i.error)&&Ql(n),s=((a=(o=n[1])==null?void 0:o.result)==null?void 0:a.output)&&Xl(n);return{c(){e=M("div"),l&&l.c(),t=j(),s&&s.c(),this.h()},l(f){e=N(f,"DIV",{class:!0});var u=k(e);l&&l.l(u),t=H(u),s&&s.l(u),u.forEach(m),this.h()},h(){d(e,"class","dark:bg-[#202123] dark:text-white px-4 py-4 rounded-b-lg flex flex-col gap-3")},m(f,u){V(f,e,u),l&&l.m(e,null),_(e,t),s&&s.m(e,null)},p(f,u){var c,g,h,p;(g=(c=f[1])==null?void 0:c.result)!=null&&g.error?l?l.p(f,u):(l=Ql(f),l.c(),l.m(e,t)):l&&(l.d(1),l=null),(p=(h=f[1])==null?void 0:h.result)!=null&&p.output?s?s.p(f,u):(s=Xl(f),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},d(f){f&&m(e),l&&l.d(),s&&s.d()}}}function Ql(n){var f,u;let e,t,l=n[2].t("ERROR")+"",s,r,i,o=((u=(f=n[1])==null?void 0:f.result)==null?void 0:u.error)+"",a;return{c(){e=M("div"),t=M("div"),s=U(l),r=j(),i=M("div"),a=U(o),this.h()},l(c){e=N(c,"DIV",{});var g=k(e);t=N(g,"DIV",{class:!0});var h=k(t);s=q(h,l),h.forEach(m),r=H(g),i=N(g,"DIV",{class:!0});var p=k(i);a=q(p,o),p.forEach(m),g.forEach(m),this.h()},h(){d(t,"class","text-gray-500 text-xs mb-1"),d(i,"class","text-sm")},m(c,g){V(c,e,g),_(e,t),_(t,s),_(e,r),_(e,i),_(i,a)},p(c,g){var h,p;g&4&&l!==(l=c[2].t("ERROR")+"")&&K(s,l),g&2&&o!==(o=((p=(h=c[1])==null?void 0:h.result)==null?void 0:p.error)+"")&&K(a,o)},d(c){c&&m(e)}}}function Xl(n){var f,u;let e,t,l=n[2].t("OUTPUT")+"",s,r,i,o=((u=(f=n[1])==null?void 0:f.result)==null?void 0:u.output)+"",a;return{c(){e=M("div"),t=M("div"),s=U(l),r=j(),i=M("div"),a=U(o),this.h()},l(c){e=N(c,"DIV",{});var g=k(e);t=N(g,"DIV",{class:!0});var h=k(t);s=q(h,l),h.forEach(m),r=H(g),i=N(g,"DIV",{class:!0});var p=k(i);a=q(p,o),p.forEach(m),g.forEach(m),this.h()},h(){d(t,"class","text-gray-500 text-xs mb-1"),d(i,"class","text-sm")},m(c,g){V(c,e,g),_(e,t),_(t,s),_(e,r),_(e,i),_(i,a)},p(c,g){var h,p;g&4&&l!==(l=c[2].t("OUTPUT")+"")&&K(s,l),g&2&&o!==(o=((p=(h=c[1])==null?void 0:h.result)==null?void 0:p.output)+"")&&K(a,o)},d(c){c&&m(e)}}}function Yl(n){var c,g;let e,t,l,s,r=n[2].t("Files")+"",i,o,a,f=Ee((g=(c=n[1])==null?void 0:c.result)==null?void 0:g.files),u=[];for(let h=0;h<f.length;h+=1)u[h]=$l(Jl(n,f,h));return{c(){e=M("div"),t=M("hr"),l=j(),s=M("div"),i=U(r),o=j(),a=M("ul");for(let h=0;h<u.length;h+=1)u[h].c();this.h()},l(h){e=N(h,"DIV",{class:!0});var p=k(e);t=N(p,"HR",{class:!0}),l=H(p),s=N(p,"DIV",{class:!0});var w=k(s);i=q(w,r),w.forEach(m),o=H(p),a=N(p,"UL",{class:!0});var v=k(a);for(let E=0;E<u.length;E+=1)u[E].l(v);v.forEach(m),p.forEach(m),this.h()},h(){d(t,"class","border-gray-100 dark:border-gray-850 my-2"),d(s,"class","text-sm font-medium dark:text-gray-300"),d(a,"class","mt-1 list-disc pl-4 text-xs"),d(e,"class","flex flex-col w-full")},m(h,p){V(h,e,p),_(e,t),_(e,l),_(e,s),_(s,i),_(e,o),_(e,a);for(let w=0;w<u.length;w+=1)u[w]&&u[w].m(a,null)},p(h,p){var w,v;if(p&4&&r!==(r=h[2].t("Files")+"")&&K(i,r),p&2){f=Ee((v=(w=h[1])==null?void 0:w.result)==null?void 0:v.files);let E;for(E=0;E<f.length;E+=1){const y=Jl(h,f,E);u[E]?u[E].p(y,p):(u[E]=$l(y),u[E].c(),u[E].m(a,null))}for(;E<u.length;E+=1)u[E].d(1);u.length=f.length}},d(h){h&&m(e),Ue(u,h)}}}function $l(n){let e,t,l=n[6].name+"",s,r,i;return{c(){e=M("li"),t=M("a"),s=U(l),i=j(),this.h()},l(o){e=N(o,"LI",{});var a=k(e);t=N(a,"A",{href:!0,target:!0});var f=k(t);s=q(f,l),f.forEach(m),i=H(a),a.forEach(m),this.h()},h(){d(t,"href",r=n[6].url),d(t,"target","_blank")},m(o,a){V(o,e,a),_(e,t),_(t,s),_(e,i)},p(o,a){a&2&&l!==(l=o[6].name+"")&&K(s,l),a&2&&r!==(r=o[6].url)&&d(t,"href",r)},d(o){o&&m(e)}}}function Wi(n){var W,ne,ue,te,ie,G,Q,he,de,Z,z,ae,re,pe,ye,A,F,oe,me;let e,t,l,s,r,i,o,a,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',c,g,h,p,w,v,E,y,B,L,T=((W=n[1])==null?void 0:W.result)&&Gl(n),I=!((ne=n[1])!=null&&ne.result)&&Zl();function R(ce,ee){var ge;return(ge=ce[1])!=null&&ge.name?zi:Hi}let O=R(n),C=O(n);w=new pr({props:{id:"code-exec-"+((ue=n[1])==null?void 0:ue.id)+"-code",lang:((te=n[1])==null?void 0:te.language)??"",code:((ie=n[1])==null?void 0:ie.code)??"",className:"",editorClassName:(G=n[1])!=null&&G.result&&((he=(Q=n[1])==null?void 0:Q.result)!=null&&he.error||(Z=(de=n[1])==null?void 0:de.result)!=null&&Z.output)?"rounded-b-none":"",stickyButtonsClassName:"top-0",run:!1}});let P=((z=n[1])==null?void 0:z.result)&&(((re=(ae=n[1])==null?void 0:ae.result)==null?void 0:re.error)||((ye=(pe=n[1])==null?void 0:pe.result)==null?void 0:ye.output))&&Kl(n),S=((F=(A=n[1])==null?void 0:A.result)==null?void 0:F.files)&&((me=(oe=n[1])==null?void 0:oe.result)==null?void 0:me.files.length)>0&&Yl(n);return{c(){e=M("div"),t=M("div"),l=M("div"),T&&T.c(),s=j(),r=M("div"),I&&I.c(),i=j(),o=M("div"),C.c(),a=j(),f=M("button"),f.innerHTML=u,c=j(),g=M("div"),h=M("div"),p=M("div"),X(w.$$.fragment),v=j(),P&&P.c(),E=j(),S&&S.c(),this.h()},l(ce){e=N(ce,"DIV",{});var ee=k(e);t=N(ee,"DIV",{class:!0});var ge=k(t);l=N(ge,"DIV",{class:!0});var De=k(l);T&&T.l(De),s=H(De),r=N(De,"DIV",{class:!0});var Le=k(r);I&&I.l(Le),i=H(Le),o=N(Le,"DIV",{});var Ce=k(o);C.l(Ce),Ce.forEach(m),Le.forEach(m),De.forEach(m),a=H(ge),f=N(ge,"BUTTON",{class:!0,"data-svelte-h":!0}),Ae(f)!=="svelte-vnrwun"&&(f.innerHTML=u),ge.forEach(m),c=H(ee),g=N(ee,"DIV",{class:!0});var He=k(g);h=N(He,"DIV",{class:!0});var ze=k(h);p=N(ze,"DIV",{class:!0});var Fe=k(p);Y(w.$$.fragment,Fe),Fe.forEach(m),v=H(ze),P&&P.l(ze),E=H(ze),S&&S.l(ze),ze.forEach(m),He.forEach(m),ee.forEach(m),this.h()},h(){d(r,"class","flex gap-2 items-center"),d(l,"class","text-lg font-medium self-center flex flex-col gap-0.5 capitalize"),d(f,"class","self-center"),d(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),d(p,"class","flex flex-col w-full"),d(h,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),d(g,"class","flex flex-col md:flex-row w-full px-4 pb-5")},m(ce,ee){V(ce,e,ee),_(e,t),_(t,l),T&&T.m(l,null),_(l,s),_(l,r),I&&I.m(r,null),_(r,i),_(r,o),C.m(o,null),_(t,a),_(t,f),_(e,c),_(e,g),_(g,h),_(h,p),$(w,p,null),_(h,v),P&&P.m(h,null),_(h,E),S&&S.m(h,null),y=!0,B||(L=_e(f,"click",n[4]),B=!0)},p(ce,ee){var De,Le,Ce,He,ze,Fe,tt,lt,ot,at,xe,ft,ut,st,It,Et,Mt,Nt,Dt;(De=ce[1])!=null&&De.result?T?(T.p(ce,ee),ee&2&&b(T,1)):(T=Gl(ce),T.c(),b(T,1),T.m(l,s)):T&&(le(),D(T,1,1,()=>{T=null}),se()),(Le=ce[1])!=null&&Le.result?I&&(le(),D(I,1,1,()=>{I=null}),se()):I?ee&2&&b(I,1):(I=Zl(),I.c(),b(I,1),I.m(r,i)),O===(O=R(ce))&&C?C.p(ce,ee):(C.d(1),C=O(ce),C&&(C.c(),C.m(o,null)));const ge={};ee&2&&(ge.id="code-exec-"+((Ce=ce[1])==null?void 0:Ce.id)+"-code"),ee&2&&(ge.lang=((He=ce[1])==null?void 0:He.language)??""),ee&2&&(ge.code=((ze=ce[1])==null?void 0:ze.code)??""),ee&2&&(ge.editorClassName=(Fe=ce[1])!=null&&Fe.result&&((lt=(tt=ce[1])==null?void 0:tt.result)!=null&&lt.error||(at=(ot=ce[1])==null?void 0:ot.result)!=null&&at.output)?"rounded-b-none":""),w.$set(ge),(xe=ce[1])!=null&&xe.result&&((ut=(ft=ce[1])==null?void 0:ft.result)!=null&&ut.error||(It=(st=ce[1])==null?void 0:st.result)!=null&&It.output)?P?P.p(ce,ee):(P=Kl(ce),P.c(),P.m(h,E)):P&&(P.d(1),P=null),(Mt=(Et=ce[1])==null?void 0:Et.result)!=null&&Mt.files&&((Dt=(Nt=ce[1])==null?void 0:Nt.result)==null?void 0:Dt.files.length)>0?S?S.p(ce,ee):(S=Yl(ce),S.c(),S.m(h,null)):S&&(S.d(1),S=null)},i(ce){y||(b(T),b(I),b(w.$$.fragment,ce),y=!0)},o(ce){D(T),D(I),D(w.$$.fragment,ce),y=!1},d(ce){ce&&m(e),T&&T.d(),I&&I.d(),C.d(),x(w),P&&P.d(),S&&S.d(),B=!1,L()}}}function Ui(n){let e,t,l;function s(i){n[5](i)}let r={size:"lg",$$slots:{default:[Wi]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new On({props:r}),je.push(()=>Ke(e,"show",s)),{c(){X(e.$$.fragment)},l(i){Y(e.$$.fragment,i)},m(i,o){$(e,i,o),l=!0},p(i,[o]){const a={};o&519&&(a.$$scope={dirty:o,ctx:i}),!t&&o&1&&(t=!0,a.show=i[0],Ze(()=>t=!1)),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){x(e,i)}}}function qi(n,e,t){let l;const s=qe("i18n");Ie(n,s,f=>t(2,l=f));let{show:r=!1}=e,{codeExecution:i=null}=e;const o=()=>{t(0,r=!1),t(1,i=null)};function a(f){r=f,t(0,r)}return n.$$set=f=>{"show"in f&&t(0,r=f.show),"codeExecution"in f&&t(1,i=f.codeExecution)},[r,i,l,s,o,a]}class Fi extends Te{constructor(e){super(),Be(this,e,qi,Ui,Ve,{show:0,codeExecution:1})}}function xl(n,e,t){const l=n.slice();return l[6]=e[t],l}function es(n){let e,t=[],l=new Map,s,r=Ee(n[0]);const i=o=>o[6].id;for(let o=0;o<r.length;o+=1){let a=xl(n,r,o),f=i(a);l.set(f,t[o]=ts(f,a))}return{c(){e=M("div");for(let o=0;o<t.length;o+=1)t[o].c();this.h()},l(o){e=N(o,"DIV",{class:!0});var a=k(e);for(let f=0;f<t.length;f+=1)t[f].l(a);a.forEach(m),this.h()},h(){d(e,"class","mt-1 mb-2 w-full flex gap-1 items-center flex-wrap")},m(o,a){V(o,e,a);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null);s=!0},p(o,a){a&7&&(r=Ee(o[0]),le(),t=Gt(t,a,i,1,o,r,l,e,In,ts,null,xl),se())},i(o){if(!s){for(let a=0;a<r.length;a+=1)b(t[a]);s=!0}},o(o){for(let a=0;a<t.length;a+=1)D(t[a]);s=!1},d(o){o&&m(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function Ji(n){let e,t;return e=new Wt({props:{className:"size-4"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Gi(n){let e,t,l,s;const r=[Qi,Ki,Zi],i=[];function o(a,f){var u,c;return(u=a[6].result)!=null&&u.error?0:(c=a[6].result)!=null&&c.output?1:2}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=fe()},l(a){t.l(a),l=fe()},m(a,f){i[e].m(a,f),V(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e!==u&&(le(),D(i[u],1,1,()=>{i[u]=null}),se(),t=i[e],t||(t=i[e]=r[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){s||(b(t),s=!0)},o(a){D(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function Zi(n){let e,t;return e=new Mr({}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ki(n){let e,t;return e=new Ir({props:{strokeWidth:"3",className:"size-3"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Qi(n){let e,t;return e=new Er({}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function ts(n,e){let t,l,s,r,i,o,a,f=e[6].name+"",u,c,g,h,p,w;const v=[Gi,Ji],E=[];function y(L,T){var I;return(I=L[6])!=null&&I.result?0:1}r=y(e),i=E[r]=v[r](e);function B(){return e[4](e[6])}return{key:n,first:null,c(){t=M("div"),l=M("button"),s=M("div"),i.c(),o=j(),a=M("div"),u=U(f),g=j(),this.h()},l(L){t=N(L,"DIV",{class:!0});var T=k(t);l=N(T,"BUTTON",{class:!0});var I=k(l);s=N(I,"DIV",{class:!0});var R=k(s);i.l(R),R.forEach(m),o=H(I),a=N(I,"DIV",{class:!0});var O=k(a);u=q(O,f),O.forEach(m),I.forEach(m),g=H(T),T.forEach(m),this.h()},h(){var L;d(s,"class","bg-white dark:bg-gray-700 rounded-full size-4 flex items-center justify-center"),d(a,"class",c="flex-1 mx-2 line-clamp-1 code-execution-name "+((L=e[6])!=null&&L.result?"":"pulse")+" svelte-1gvtig2"),d(l,"class","flex dark:text-gray-300 py-1 px-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-xl max-w-96"),d(t,"class","flex gap-1 text-xs font-semibold"),this.first=t},m(L,T){V(L,t,T),_(t,l),_(l,s),E[r].m(s,null),_(l,o),_(l,a),_(a,u),_(t,g),h=!0,p||(w=_e(l,"click",B),p=!0)},p(L,T){var R;e=L;let I=r;r=y(e),r===I?E[r].p(e,T):(le(),D(E[I],1,1,()=>{E[I]=null}),se(),i=E[r],i?i.p(e,T):(i=E[r]=v[r](e),i.c()),b(i,1),i.m(s,null)),(!h||T&1)&&f!==(f=e[6].name+"")&&K(u,f),(!h||T&1&&c!==(c="flex-1 mx-2 line-clamp-1 code-execution-name "+((R=e[6])!=null&&R.result?"":"pulse")+" svelte-1gvtig2"))&&d(a,"class",c)},i(L){h||(b(i),h=!0)},o(L){D(i),h=!1},d(L){L&&m(t),E[r].d(),p=!1,w()}}}function Xi(n){let e,t,l,s,r;function i(f){n[3](f)}let o={codeExecution:n[1]};n[2]!==void 0&&(o.show=n[2]),e=new Fi({props:o}),je.push(()=>Ke(e,"show",i));let a=n[0].length>0&&es(n);return{c(){X(e.$$.fragment),l=j(),a&&a.c(),s=fe()},l(f){Y(e.$$.fragment,f),l=H(f),a&&a.l(f),s=fe()},m(f,u){$(e,f,u),V(f,l,u),a&&a.m(f,u),V(f,s,u),r=!0},p(f,[u]){const c={};u&2&&(c.codeExecution=f[1]),!t&&u&4&&(t=!0,c.show=f[2],Ze(()=>t=!1)),e.$set(c),f[0].length>0?a?(a.p(f,u),u&1&&b(a,1)):(a=es(f),a.c(),b(a,1),a.m(s.parentNode,s)):a&&(le(),D(a,1,1,()=>{a=null}),se())},i(f){r||(b(e.$$.fragment,f),b(a),r=!0)},o(f){D(e.$$.fragment,f),D(a),r=!1},d(f){f&&(m(l),m(s)),x(e,f),a&&a.d(f)}}}function Yi(n,e,t){let{codeExecutions:l=[]}=e,s=null,r=!1;const i=()=>{s&&t(1,s=l.find(f=>f.id===s.id))};function o(f){r=f,t(2,r)}const a=f=>{t(1,s=f),t(2,r=!0)};return n.$$set=f=>{"codeExecutions"in f&&t(0,l=f.codeExecutions)},n.$$.update=()=>{n.$$.dirty&1&&l&&i()},[l,s,r,o,a]}class $i extends Te{constructor(e){super(),Be(this,e,Yi,Xi,Ve,{codeExecutions:0})}}function xi(n){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 0 1-2.555-.337A5.972 5.972 0 0 1 5.41 20.97a5.969 5.969 0 0 1-.474-.065 4.48 4.48 0 0 0 .978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25Z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width",n[1]),d(e,"stroke","currentColor"),d(e,"class",n[0])},m(l,s){V(l,e,s),_(e,t)},p(l,[s]){s&2&&d(e,"stroke-width",l[1]),s&1&&d(e,"class",l[0])},i:ve,o:ve,d(l){l&&m(e)}}}function eo(n,e,t){let{className:l="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class to extends Te{constructor(e){super(),Be(this,e,eo,xi,Ve,{className:0,strokeWidth:1})}}function lo(n){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width",n[1]),d(e,"stroke","currentColor"),d(e,"class",n[0])},m(l,s){V(l,e,s),_(e,t)},p(l,[s]){s&2&&d(e,"stroke-width",l[1]),s&1&&d(e,"class",l[0])},i:ve,o:ve,d(l){l&&m(e)}}}function so(n,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class no extends Te{constructor(e){super(),Be(this,e,so,lo,Ve,{className:0,strokeWidth:1})}}function ro(n){let e,t,l,s,r,i,o,a,f,u,c,g;s=new yt({props:{id:`${n[0]}-float-prompt`,content:n[4]}});const h=[ao,oo],p=[];function w(E,y){return y&32&&(a=null),a==null&&(a=E[5].trim()===""),a?0:1}f=w(n,-1),u=p[f]=h[f](n);let v=n[6]&&ls(n);return{c(){e=M("div"),t=M("div"),l=M("div"),X(s.$$.fragment),r=j(),i=M("div"),o=M("div"),u.c(),c=j(),v&&v.c(),this.h()},l(E){e=N(E,"DIV",{class:!0});var y=k(e);t=N(y,"DIV",{class:!0});var B=k(t);l=N(B,"DIV",{class:!0});var L=k(l);Y(s.$$.fragment,L),L.forEach(m),B.forEach(m),r=H(y),i=N(y,"DIV",{class:!0});var T=k(i);o=N(T,"DIV",{class:!0,id:!0});var I=k(o);u.l(I),c=H(I),v&&v.l(I),I.forEach(m),T.forEach(m),y.forEach(m),this.h()},h(){d(l,"class","font-medium"),d(t,"class","bg-gray-50/50 dark:bg-gray-800 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),d(o,"class","max-h-80 overflow-y-auto w-full markdown-prose-xs"),d(o,"id","response-container"),d(i,"class","bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),d(e,"class","bg-white dark:bg-gray-850 dark:text-gray-100 rounded-xl shadow-xl w-80 max-w-full")},m(E,y){V(E,e,y),_(e,t),_(t,l),$(s,l,null),_(e,r),_(e,i),_(i,o),p[f].m(o,null),_(o,c),v&&v.m(o,null),g=!0},p(E,y){const B={};y&1&&(B.id=`${E[0]}-float-prompt`),y&16&&(B.content=E[4]),s.$set(B);let L=f;f=w(E,y),f===L?p[f].p(E,y):(le(),D(p[L],1,1,()=>{p[L]=null}),se(),u=p[f],u?u.p(E,y):(u=p[f]=h[f](E),u.c()),b(u,1),u.m(o,c)),E[6]?v?v.p(E,y):(v=ls(E),v.c(),v.m(o,null)):v&&(v.d(1),v=null)},i(E){g||(b(s.$$.fragment,E),b(u),g=!0)},o(E){D(s.$$.fragment,E),D(u),g=!1},d(E){E&&m(e),x(s),p[f].d(),v&&v.d()}}}function io(n){let e,t,l,s;const r=[uo,fo],i=[];function o(a,f){return a[1]?1:0}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=fe()},l(a){t.l(a),l=fe()},m(a,f){i[e].m(a,f),V(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(le(),D(i[u],1,1,()=>{i[u]=null}),se(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){s||(b(t),s=!0)},o(a){D(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function oo(n){let e,t;return e=new yt({props:{id:`${n[0]}-float-response`,content:n[5]}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s&1&&(r.id=`${l[0]}-float-response`),s&32&&(r.content=l[5]),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function ao(n){let e,t;return e=new Xt({props:{size:"sm"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function ls(n){let e,t,l=n[7].t("Add")+"",s,r,i;return{c(){e=M("div"),t=M("button"),s=U(l),this.h()},l(o){e=N(o,"DIV",{class:!0});var a=k(e);t=N(a,"BUTTON",{class:!0});var f=k(t);s=q(f,l),f.forEach(m),a.forEach(m),this.h()},h(){d(t,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),d(e,"class","flex justify-end pt-3 text-sm font-medium")},m(o,a){V(o,e,a),_(e,t),_(t,s),r||(i=_e(t,"click",n[11]),r=!0)},p(o,a){a&128&&l!==(l=o[7].t("Add")+"")&&K(s,l)},d(o){o&&m(e),r=!1,i()}}}function fo(n){let e,t,l,s,r,i,o,a,f,u,c;return{c(){e=M("div"),t=M("input"),s=j(),r=M("div"),i=M("button"),o=be("svg"),a=be("path"),this.h()},l(g){e=N(g,"DIV",{class:!0});var h=k(e);t=N(h,"INPUT",{type:!0,id:!0,class:!0,placeholder:!0}),s=H(h),r=N(h,"DIV",{class:!0});var p=k(r);i=N(p,"BUTTON",{class:!0});var w=k(i);o=ke(w,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var v=k(o);a=ke(v,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),k(a).forEach(m),v.forEach(m),w.forEach(m),p.forEach(m),h.forEach(m),this.h()},h(){d(t,"type","text"),d(t,"id","floating-message-input"),d(t,"class","ml-5 bg-transparent outline-hidden w-full flex-1 text-sm"),d(t,"placeholder",l=n[7].t("Ask a question")),d(a,"fill-rule","evenodd"),d(a,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),d(a,"clip-rule","evenodd"),d(o,"xmlns","http://www.w3.org/2000/svg"),d(o,"viewBox","0 0 16 16"),d(o,"fill","currentColor"),d(o,"class","size-4"),d(i,"class",f=(n[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center"),d(r,"class","ml-1 mr-2"),d(e,"class","py-1 flex dark:text-gray-100 bg-gray-50 dark:bg-gray-800 border dark:border-gray-850 w-72 rounded-full shadow-xl")},m(g,h){V(g,e,h),_(e,t),rt(t,n[3]),_(e,s),_(e,r),_(r,i),_(i,o),_(o,a),u||(c=[_e(t,"input",n[18]),_e(t,"keydown",n[19]),_e(i,"click",n[20])],u=!0)},p(g,h){h&128&&l!==(l=g[7].t("Ask a question"))&&d(t,"placeholder",l),h&8&&t.value!==g[3]&&rt(t,g[3]),h&8&&f!==(f=(g[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center")&&d(i,"class",f)},i:ve,o:ve,d(g){g&&m(e),u=!1,et(c)}}}function uo(n){let e,t,l,s,r,i="Ask",o,a,f,u,c,g="Explain",h,p,w;return l=new to({props:{className:"size-3 shrink-0"}}),f=new no({props:{className:"size-3 shrink-0"}}),{c(){e=M("div"),t=M("button"),X(l.$$.fragment),s=j(),r=M("div"),r.textContent=i,o=j(),a=M("button"),X(f.$$.fragment),u=j(),c=M("div"),c.textContent=g,this.h()},l(v){e=N(v,"DIV",{class:!0});var E=k(e);t=N(E,"BUTTON",{class:!0});var y=k(t);Y(l.$$.fragment,y),s=H(y),r=N(y,"DIV",{class:!0,"data-svelte-h":!0}),Ae(r)!=="svelte-1ugwo9q"&&(r.textContent=i),y.forEach(m),o=H(E),a=N(E,"BUTTON",{class:!0});var B=k(a);Y(f.$$.fragment,B),u=H(B),c=N(B,"DIV",{class:!0,"data-svelte-h":!0}),Ae(c)!=="svelte-1sxc82g"&&(c.textContent=g),B.forEach(m),E.forEach(m),this.h()},h(){d(r,"class","shrink-0"),d(t,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-sm flex items-center gap-1 min-w-fit"),d(c,"class","shrink-0"),d(a,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-sm flex items-center gap-1 min-w-fit"),d(e,"class","flex flex-row gap-0.5 shrink-0 p-1 bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-lg shadow-xl")},m(v,E){V(v,e,E),_(e,t),$(l,t,null),_(t,s),_(t,r),_(e,o),_(e,a),$(f,a,null),_(a,u),_(a,c),h=!0,p||(w=[_e(t,"click",n[16]),_e(a,"click",n[17])],p=!0)},p:ve,i(v){h||(b(l.$$.fragment,v),b(f.$$.fragment,v),h=!0)},o(v){D(l.$$.fragment,v),D(f.$$.fragment,v),h=!1},d(v){v&&m(e),x(l),x(f),p=!1,et(w)}}}function co(n){let e,t,l,s,r;const i=[io,ro],o=[];function a(f,u){return f[5]===null?0:1}return t=a(n),l=o[t]=i[t](n),{c(){e=M("div"),l.c(),this.h()},l(f){e=N(f,"DIV",{id:!0,class:!0,style:!0});var u=k(e);l.l(u),u.forEach(m),this.h()},h(){d(e,"id",s=`floating-buttons-${n[0]}`),d(e,"class","absolute rounded-lg mt-1 text-xs z-9999"),St(e,"display","none")},m(f,u){V(f,e,u),o[t].m(e,null),r=!0},p(f,[u]){let c=t;t=a(f),t===c?o[t].p(f,u):(le(),D(o[c],1,1,()=>{o[c]=null}),se(),l=o[t],l?l.p(f,u):(l=o[t]=i[t](f),l.c()),b(l,1),l.m(e,null)),(!r||u&1&&s!==(s=`floating-buttons-${f[0]}`))&&d(e,"id",s)},i(f){r||(b(l),r=!0)},o(f){D(l),r=!1},d(f){f&&m(e),o[t].d()}}}function ho(n,e,t){let l;const s=qe("i18n");Ie(n,s,C=>t(7,l=C));let{id:r=""}=e,{model:i=null}=e,{messages:o=[]}=e,{onAdd:a=()=>{}}=e,f=!1,u="",c="",g="",h=null,p=!1;const w=async()=>{const C=document.getElementById("response-container");C.scrollHeight-C.clientHeight<=C.scrollTop+50&&(C.scrollTop=C.scrollHeight)},v=async()=>{if(!i){Pe.error("Model not selected");return}t(4,g=`${c}
\`\`\`
${u}
\`\`\``),t(3,c=""),t(5,h="");const[C,P]=await vl(localStorage.token,{model:i,messages:[...o,{role:"user",content:g}].map(S=>({role:S.role,content:S.content})),stream:!0});if(C&&C.ok){const S=C.body.getReader(),W=new TextDecoder;await(async()=>{var ue,te;for(;;){const{done:ie,value:G}=await S.read();if(ie)break;const he=W.decode(G,{stream:!0}).split(`
`).filter(de=>de.trim()!=="");for(const de of he)if(de.startsWith("data: "))if(de.startsWith("data: [DONE]")){t(6,p=!0),await Ne(),w();continue}else try{const Z=JSON.parse(de.slice(6));Z.choices&&((te=(ue=Z.choices[0])==null?void 0:ue.delta)!=null&&te.content)&&(t(5,h+=Z.choices[0].delta.content),w())}catch(Z){console.error(Z)}}})()}else Pe.error("An error occurred while fetching the explanation")},E=async()=>{if(!i){Pe.error("Model not selected");return}t(4,g=`Explain this section to me in more detail

\`\`\`
${u}
\`\`\``),t(5,h="");const[C,P]=await vl(localStorage.token,{model:i,messages:[...o,{role:"user",content:g}].map(S=>({role:S.role,content:S.content})),stream:!0});if(C&&C.ok){const S=C.body.getReader(),W=new TextDecoder;await(async()=>{var ue,te;for(;;){const{done:ie,value:G}=await S.read();if(ie)break;const he=W.decode(G,{stream:!0}).split(`
`).filter(de=>de.trim()!=="");for(const de of he)if(de.startsWith("data: "))if(de.startsWith("data: [DONE]")){t(6,p=!0),await Ne(),w();continue}else try{const Z=JSON.parse(de.slice(6));Z.choices&&((te=(ue=Z.choices[0])==null?void 0:ue.delta)!=null&&te.content)&&(t(5,h+=Z.choices[0].delta.content),w())}catch(Z){console.error(Z)}}})()}else Pe.error("An error occurred while fetching the explanation")},y=async()=>{a({modelId:i,parentId:r,messages:[{role:"user",content:g},{role:"assistant",content:h}]})},B=()=>{t(5,h=null),t(6,p=!1),t(1,f=!1),t(3,c="")},L=async()=>{t(2,u=window.getSelection().toString()),t(1,f=!0),await Ne(),setTimeout(()=>{const C=document.getElementById("floating-message-input");C&&C.focus()},0)},T=()=>{t(2,u=window.getSelection().toString()),E()};function I(){c=this.value,t(3,c)}const R=C=>{C.key==="Enter"&&v()},O=()=>{v()};return n.$$set=C=>{"id"in C&&t(0,r=C.id),"model"in C&&t(12,i=C.model),"messages"in C&&t(13,o=C.messages),"onAdd"in C&&t(14,a=C.onAdd)},[r,f,u,c,g,h,p,l,s,v,E,y,i,o,a,B,L,T,I,R,O]}class mo extends Te{constructor(e){super(),Be(this,e,ho,co,Ve,{id:0,model:12,messages:13,onAdd:14,closeHandler:15})}get closeHandler(){return this.$$.ctx[15]}}function ss(n){var s;let e,t,l={id:n[0],model:(s=n[3])==null?void 0:s.id,messages:Jt(n[2],n[0]),onAdd:n[20]};return e=new mo({props:l}),n[21](e),{c(){X(e.$$.fragment)},l(r){Y(e.$$.fragment,r)},m(r,i){$(e,r,i),t=!0},p(r,i){var a;const o={};i&1&&(o.id=r[0]),i&8&&(o.model=(a=r[3])==null?void 0:a.id),i&5&&(o.messages=Jt(r[2],r[0])),i&512&&(o.onAdd=r[20]),e.$set(o)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){n[21](null),x(e,r)}}}function go(n){let e,t,l,s,r;t=new yt({props:{id:n[0],content:n[1],model:n[3],save:n[5],sourceIds:(n[4]??[]).reduce(n[16],[]),onSourceClick:n[7],onTaskClick:n[8]}}),t.$on("update",n[17]),t.$on("code",n[18]);let i=n[6]&&n[3]&&ss(n);return{c(){e=M("div"),X(t.$$.fragment),l=j(),i&&i.c(),s=fe()},l(o){e=N(o,"DIV",{});var a=k(e);Y(t.$$.fragment,a),a.forEach(m),l=H(o),i&&i.l(o),s=fe()},m(o,a){V(o,e,a),$(t,e,null),n[19](e),V(o,l,a),i&&i.m(o,a),V(o,s,a),r=!0},p(o,[a]){const f={};a&1&&(f.id=o[0]),a&2&&(f.content=o[1]),a&8&&(f.model=o[3]),a&32&&(f.save=o[5]),a&24&&(f.sourceIds=(o[4]??[]).reduce(o[16],[])),a&128&&(f.onSourceClick=o[7]),a&256&&(f.onTaskClick=o[8]),t.$set(f),o[6]&&o[3]?i?(i.p(o,a),a&72&&b(i,1)):(i=ss(o),i.c(),b(i,1),i.m(s.parentNode,s)):i&&(le(),D(i,1,1,()=>{i=null}),se())},i(o){r||(b(t.$$.fragment,o),b(i),r=!0)},o(o){D(t.$$.fragment,o),D(i),r=!1},d(o){o&&(m(e),m(l),m(s)),x(t),n[19](null),i&&i.d(o)}}}function _o(n,e,t){let l,s;Ie(n,En,S=>t(12,l=S)),Ie(n,rr,S=>t(13,s=S)),qe("i18n");const r=gt();let{id:i}=e,{content:o}=e,{history:a}=e,{model:f=null}=e,{sources:u=null}=e,{save:c=!1}=e,{floatingButtons:g=!0}=e,{onSourceClick:h=()=>{}}=e,{onTaskClick:p=()=>{}}=e,{onAddMessages:w=()=>{}}=e,v,E;const y=S=>{const W=document.getElementById(`floating-buttons-${i}`);if(!(v!=null&&v.contains(S.target))&&!(W!=null&&W.contains(S.target))){B();return}setTimeout(async()=>{if(await Ne(),!(v!=null&&v.contains(S.target)))return;let ne=window.getSelection();if(ne.toString().trim().length>0){const te=ne.getRangeAt(0).getBoundingClientRect(),ie=v.getBoundingClientRect(),G=te.bottom-ie.top,Q=te.left-ie.left;if(W){W.style.display="block";const he=ie.width-Q;let de=l?window.innerWidth/2:window.innerWidth/3;if(he<de){const Z=ie.right-te.right;W.style.right=`${Z}px`,W.style.left="auto"}else W.style.left=`${Q}px`,W.style.right="auto";W.style.top=`${G+5}px`}}else B()},0)},B=()=>{const S=document.getElementById(`floating-buttons-${i}`);S&&(S.style.display="none"),E&&E.closeHandler()},L=S=>{S.key==="Escape"&&B()};bt(()=>{g&&(v==null||v.addEventListener("mouseup",y),document.addEventListener("mouseup",y),document.addEventListener("keydown",L))}),tr(()=>{g&&(v==null||v.removeEventListener("mouseup",y),document.removeEventListener("mouseup",y),document.removeEventListener("keydown",L))});const T=(S,W)=>{let ne=[];return W.document.forEach((ue,te)=>{var Q,he,de,Z,z;if(((de=(he=(Q=f==null?void 0:f.info)==null?void 0:Q.meta)==null?void 0:he.capabilities)==null?void 0:de.citations)==!1)return ne.push("N/A"),ne;const ie=(Z=W.metadata)==null?void 0:Z[te],G=(ie==null?void 0:ie.source)??"N/A";return ie!=null&&ie.name?(ne.push(ie.name),ne):(G.startsWith("http://")||G.startsWith("https://")?ne.push(G):ne.push(((z=W==null?void 0:W.source)==null?void 0:z.name)??G),ne)}),S=[...S,...ne],S.filter((ue,te)=>S.indexOf(ue)===te)},I=S=>{r("update",S.detail)},R=S=>{const{lang:W,code:ne}=S.detail;(["html","svg"].includes(W)||W==="xml"&&ne.includes("svg"))&&!l&&s&&(ir.set(!0),or.set(!0))};function O(S){je[S?"unshift":"push"](()=>{v=S,t(10,v)})}const C=({modelId:S,parentId:W,messages:ne})=>{console.log(S,W,ne),w({modelId:S,parentId:W,messages:ne}),B()};function P(S){je[S?"unshift":"push"](()=>{E=S,t(11,E)})}return n.$$set=S=>{"id"in S&&t(0,i=S.id),"content"in S&&t(1,o=S.content),"history"in S&&t(2,a=S.history),"model"in S&&t(3,f=S.model),"sources"in S&&t(4,u=S.sources),"save"in S&&t(5,c=S.save),"floatingButtons"in S&&t(6,g=S.floatingButtons),"onSourceClick"in S&&t(7,h=S.onSourceClick),"onTaskClick"in S&&t(8,p=S.onTaskClick),"onAddMessages"in S&&t(9,w=S.onAddMessages)},[i,o,a,f,u,c,g,h,p,w,v,E,l,s,r,B,T,I,R,O,C,P]}class vo extends Te{constructor(e){super(),Be(this,e,_o,go,Ve,{id:0,content:1,history:2,model:3,sources:4,save:5,floatingButtons:6,onSourceClick:7,onTaskClick:8,onAddMessages:9})}}function ns(n,e,t){const l=n.slice();return l[79]=e[t],l}function Ut(n){var l,s,r;const e=n.slice(),t=(((l=e[12])==null?void 0:l.statusHistory)??[...(s=e[12])!=null&&s.status?[(r=e[12])==null?void 0:r.status]:[]]).at(-1);return e[82]=t,e}function rs(n,e,t){const l=n.slice();return l[83]=e[t],l}function po(n){var s;let e,t=(((s=n[15])==null?void 0:s.name)??n[12].model)+"",l;return{c(){e=M("span"),l=U(t),this.h()},l(r){e=N(r,"SPAN",{class:!0});var i=k(e);l=q(i,t),i.forEach(m),this.h()},h(){d(e,"class","line-clamp-1")},m(r,i){V(r,e,i),_(e,l)},p(r,i){var o;i[0]&36864&&t!==(t=(((o=r[15])==null?void 0:o.name)??r[12].model)+"")&&K(l,t)},d(r){r&&m(e)}}}function is(n){let e,t,l;return t=new Re({props:{content:it(n[12].timestamp*1e3).format("LLLL"),$$slots:{default:[bo]},$$scope:{ctx:n}}}),{c(){e=M("div"),X(t.$$.fragment),this.h()},l(s){e=N(s,"DIV",{class:!0});var r=k(e);Y(t.$$.fragment,r),r.forEach(m),this.h()},h(){d(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,r){V(s,e,r),$(t,e,null),l=!0},p(s,r){const i={};r[0]&4096&&(i.content=it(s[12].timestamp*1e3).format("LLLL")),r[0]&4096|r[2]&16777216&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),x(t)}}}function bo(n){let e,t=Pt(n[12].timestamp*1e3)+"",l;return{c(){e=M("span"),l=U(t),this.h()},l(s){e=N(s,"SPAN",{class:!0});var r=k(e);l=q(r,t),r.forEach(m),this.h()},h(){d(e,"class","line-clamp-1")},m(s,r){V(s,e,r),_(e,l)},p(s,r){r[0]&4096&&t!==(t=Pt(s[12].timestamp*1e3)+"")&&K(l,t)},d(s){s&&m(e)}}}function ko(n){var i;let e,t,l,s;e=new Re({props:{content:((i=n[15])==null?void 0:i.name)??n[12].model,placement:"top-start",$$slots:{default:[po]},$$scope:{ctx:n}}});let r=n[12].timestamp&&is(n);return{c(){X(e.$$.fragment),t=j(),r&&r.c(),l=fe()},l(o){Y(e.$$.fragment,o),t=H(o),r&&r.l(o),l=fe()},m(o,a){$(e,o,a),V(o,t,a),r&&r.m(o,a),V(o,l,a),s=!0},p(o,a){var u;const f={};a[0]&36864&&(f.content=((u=o[15])==null?void 0:u.name)??o[12].model),a[0]&36864|a[2]&16777216&&(f.$$scope={dirty:a,ctx:o}),e.$set(f),o[12].timestamp?r?(r.p(o,a),a[0]&4096&&b(r,1)):(r=is(o),r.c(),b(r,1),r.m(l.parentNode,l)):r&&(le(),D(r,1,1,()=>{r=null}),se())},i(o){s||(b(e.$$.fragment,o),b(r),s=!0)},o(o){D(e.$$.fragment,o),D(r),s=!1},d(o){o&&(m(t),m(l)),x(e,o),r&&r.d(o)}}}function os(n){let e,t,l=Ee(n[12].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=fs(rs(n,l,i));const r=i=>D(s[i],1,1,()=>{s[i]=null});return{c(){e=M("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=N(i,"DIV",{class:!0});var o=k(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),this.h()},h(){d(e,"class","my-2.5 w-full flex overflow-x-auto gap-2 flex-wrap")},m(i,o){V(i,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(i,o){if(o[0]&4096){l=Ee(i[12].files);let a;for(a=0;a<l.length;a+=1){const f=rs(i,l,a);s[a]?(s[a].p(f,o),b(s[a],1)):(s[a]=fs(f),s[a].c(),b(s[a],1),s[a].m(e,null))}for(le(),a=l.length;a<s.length;a+=1)r(a);se()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)b(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)D(s[o]);t=!1},d(i){i&&m(e),Ue(s,i)}}}function as(n){let e,t;return e=new Cn({props:{src:n[83].url,alt:n[12].content}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&4096&&(r.src=l[83].url),s[0]&4096&&(r.alt=l[12].content),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function fs(n){let e,t,l,s=n[83].type==="image"&&as(n);return{c(){e=M("div"),s&&s.c(),t=j()},l(r){e=N(r,"DIV",{});var i=k(e);s&&s.l(i),t=H(i),i.forEach(m)},m(r,i){V(r,e,i),s&&s.m(e,null),_(e,t),l=!0},p(r,i){r[83].type==="image"?s?(s.p(r,i),i[0]&4096&&b(s,1)):(s=as(r),s.c(),b(s,1),s.m(e,t)):s&&(le(),D(s,1,1,()=>{s=null}),se())},i(r){l||(b(s),l=!0)},o(r){D(s),l=!1},d(r){r&&m(e),s&&s.d()}}}function us(n){var s;let e,t,l=!((s=n[82])!=null&&s.hidden)&&cs(n);return{c(){l&&l.c(),e=fe()},l(r){l&&l.l(r),e=fe()},m(r,i){l&&l.m(r,i),V(r,e,i),t=!0},p(r,i){var o;(o=r[82])!=null&&o.hidden?l&&(le(),D(l,1,1,()=>{l=null}),se()):l?(l.p(r,i),i[0]&4096&&b(l,1)):(l=cs(r),l.c(),b(l,1),l.m(e.parentNode,e))},i(r){t||(b(l),t=!0)},o(r){D(l),t=!1},d(r){r&&m(e),l&&l.d(r)}}}function cs(n){var u;let e,t,l,s,r,i=((u=n[82])==null?void 0:u.done)===!1&&ds();const o=[Io,yo,wo],a=[];function f(c,g){var h,p,w;return((h=c[82])==null?void 0:h.action)==="web_search"&&((p=c[82])!=null&&p.urls)?0:((w=c[82])==null?void 0:w.action)==="knowledge_search"?1:2}return l=f(n),s=a[l]=o[l](n),{c(){e=M("div"),i&&i.c(),t=j(),s.c(),this.h()},l(c){e=N(c,"DIV",{class:!0});var g=k(e);i&&i.l(g),t=H(g),s.l(g),g.forEach(m),this.h()},h(){d(e,"class","status-description flex items-center gap-2 py-0.5")},m(c,g){V(c,e,g),i&&i.m(e,null),_(e,t),a[l].m(e,null),r=!0},p(c,g){var p;((p=c[82])==null?void 0:p.done)===!1?i?g[0]&4096&&b(i,1):(i=ds(),i.c(),b(i,1),i.m(e,t)):i&&(le(),D(i,1,1,()=>{i=null}),se());let h=l;l=f(c),l===h?a[l].p(c,g):(le(),D(a[h],1,1,()=>{a[h]=null}),se(),s=a[l],s?s.p(c,g):(s=a[l]=o[l](c),s.c()),b(s,1),s.m(e,null))},i(c){r||(b(i),b(s),r=!0)},o(c){D(i),D(s),r=!1},d(c){c&&m(e),i&&i.d(),a[l].d()}}}function ds(n){let e,t,l;return t=new Wt({props:{className:"size-4"}}),{c(){e=M("div"),X(t.$$.fragment),this.h()},l(s){e=N(s,"DIV",{class:!0});var r=k(e);Y(t.$$.fragment,r),r.forEach(m),this.h()},h(){d(e,"class","")},m(s,r){V(s,e,r),$(t,e,null),l=!0},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),x(t)}}}function wo(n){let e,t,l,s;function r(a,f){var u,c,g;return f[0]&4096&&(l=null),l==null&&(l=!!((u=a[82])!=null&&u.description.includes("{{searchQuery}}"))),l?Do:((c=a[82])==null?void 0:c.description)==="No search query generated"?No:((g=a[82])==null?void 0:g.description)==="Generating search query"?Mo:Eo}let i=r(n,[-1,-1,-1]),o=i(n);return{c(){e=M("div"),t=M("div"),o.c(),this.h()},l(a){e=N(a,"DIV",{class:!0});var f=k(e);t=N(f,"DIV",{class:!0});var u=k(t);o.l(u),u.forEach(m),f.forEach(m),this.h()},h(){var a;d(t,"class",s=(((a=n[82])==null?void 0:a.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),d(e,"class","flex flex-col justify-center -space-y-0.5")},m(a,f){V(a,e,f),_(e,t),o.m(t,null)},p(a,f){var u;i===(i=r(a,f))&&o?o.p(a,f):(o.d(1),o=i(a),o&&(o.c(),o.m(t,null))),f[0]&4096&&s!==(s=(((u=a[82])==null?void 0:u.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&d(t,"class",s)},i:ve,o:ve,d(a){a&&m(e),o.d()}}}function yo(n){let e,t,l=n[25].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:n[82].query})+"",s,r;return{c(){e=M("div"),t=M("div"),s=U(l),this.h()},l(i){e=N(i,"DIV",{class:!0});var o=k(e);t=N(o,"DIV",{class:!0});var a=k(t);s=q(a,l),a.forEach(m),o.forEach(m),this.h()},h(){var i;d(t,"class",r=(((i=n[82])==null?void 0:i.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),d(e,"class","flex flex-col justify-center -space-y-0.5")},m(i,o){V(i,e,o),_(e,t),_(t,s)},p(i,o){var a;o[0]&33558528&&l!==(l=i[25].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:i[82].query})+"")&&K(s,l),o[0]&4096&&r!==(r=(((a=i[82])==null?void 0:a.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&d(t,"class",r)},i:ve,o:ve,d(i){i&&m(e)}}}function Io(n){let e,t;return e=new li({props:{status:n[82],$$slots:{default:[Ro]},$$scope:{ctx:n}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&4096&&(r.status=l[82]),s[0]&33558528|s[2]&16777216&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Eo(n){var l;let e=((l=n[82])==null?void 0:l.description)+"",t;return{c(){t=U(e)},l(s){t=q(s,e)},m(s,r){V(s,t,r)},p(s,r){var i;r[0]&4096&&e!==(e=((i=s[82])==null?void 0:i.description)+"")&&K(t,e)},d(s){s&&m(t)}}}function Mo(n){let e=n[25].t("Generating search query")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&33554432&&e!==(e=l[25].t("Generating search query")+"")&&K(t,e)},d(l){l&&m(t)}}}function No(n){let e=n[25].t("No search query generated")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&33554432&&e!==(e=l[25].t("No search query generated")+"")&&K(t,e)},d(l){l&&m(t)}}}function Do(n){var l,s;let e=n[25].t((l=n[82])==null?void 0:l.description,{searchQuery:(s=n[82])==null?void 0:s.query})+"",t;return{c(){t=U(e)},l(r){t=q(r,e)},m(r,i){V(r,t,i)},p(r,i){var o,a;i[0]&33558528&&e!==(e=r[25].t((o=r[82])==null?void 0:o.description,{searchQuery:(a=r[82])==null?void 0:a.query})+"")&&K(t,e)},d(r){r&&m(t)}}}function Vo(n){var l;let e=((l=n[82])==null?void 0:l.description)+"",t;return{c(){t=U(e)},l(s){t=q(s,e)},m(s,r){V(s,t,r)},p(s,r){var i;r[0]&4096&&e!==(e=((i=s[82])==null?void 0:i.description)+"")&&K(t,e)},d(s){s&&m(t)}}}function Co(n){let e=n[25].t("Generating search query")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&33554432&&e!==(e=l[25].t("Generating search query")+"")&&K(t,e)},d(l){l&&m(t)}}}function To(n){let e=n[25].t("No search query generated")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&33554432&&e!==(e=l[25].t("No search query generated")+"")&&K(t,e)},d(l){l&&m(t)}}}function Bo(n){var l,s;let e=n[25].t((l=n[82])==null?void 0:l.description,{count:(s=n[82])==null?void 0:s.urls.length})+"",t;return{c(){t=U(e)},l(r){t=q(r,e)},m(r,i){V(r,t,i)},p(r,i){var o,a;i[0]&33558528&&e!==(e=r[25].t((o=r[82])==null?void 0:o.description,{count:(a=r[82])==null?void 0:a.urls.length})+"")&&K(t,e)},d(r){r&&m(t)}}}function Ro(n){let e,t,l,s;function r(a,f){var u,c,g;return f[0]&4096&&(l=null),l==null&&(l=!!((u=a[82])!=null&&u.description.includes("{{count}}"))),l?Bo:((c=a[82])==null?void 0:c.description)==="No search query generated"?To:((g=a[82])==null?void 0:g.description)==="Generating search query"?Co:Vo}let i=r(n,[-1,-1,-1]),o=i(n);return{c(){e=M("div"),t=M("div"),o.c(),this.h()},l(a){e=N(a,"DIV",{class:!0});var f=k(e);t=N(f,"DIV",{class:!0});var u=k(t);o.l(u),u.forEach(m),f.forEach(m),this.h()},h(){var a;d(t,"class",s=(((a=n[82])==null?void 0:a.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap"),d(e,"class","flex flex-col justify-center -space-y-0.5")},m(a,f){V(a,e,f),_(e,t),o.m(t,null)},p(a,f){var u;i===(i=r(a,f))&&o?o.p(a,f):(o.d(1),o=i(a),o&&(o.c(),o.m(t,null))),f[0]&4096&&s!==(s=(((u=a[82])==null?void 0:u.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap")&&d(t,"class",s)},d(a){a&&m(e),o.d()}}}function So(n){var p,w,v,E,y,B,L;let e,t,l,s,r,i,o;const a=[Po,Lo],f=[];function u(T,I){return T[12].content===""&&!T[12].error?0:T[12].content&&T[12].error!==!0?1:-1}~(t=u(n))&&(l=f[t]=a[t](n));let c=((p=n[12])==null?void 0:p.error)&&hs(n),g=(((w=n[12])==null?void 0:w.sources)||((v=n[12])==null?void 0:v.citations))&&(((L=(B=(y=(E=n[15])==null?void 0:E.info)==null?void 0:y.meta)==null?void 0:B.capabilities)==null?void 0:L.citations)??!0)&&ms(n),h=n[12].code_executions&&gs(n);return{c(){e=M("div"),l&&l.c(),s=j(),c&&c.c(),r=j(),g&&g.c(),i=j(),h&&h.c(),this.h()},l(T){e=N(T,"DIV",{class:!0,id:!0});var I=k(e);l&&l.l(I),s=H(I),c&&c.l(I),r=H(I),g&&g.l(I),i=H(I),h&&h.l(I),I.forEach(m),this.h()},h(){d(e,"class","w-full flex flex-col relative"),d(e,"id","response-content-container")},m(T,I){V(T,e,I),~t&&f[t].m(e,null),_(e,s),c&&c.m(e,null),_(e,r),g&&g.m(e,null),_(e,i),h&&h.m(e,null),o=!0},p(T,I){var O,C,P,S,W,ne,ue;let R=t;t=u(T),t===R?~t&&f[t].p(T,I):(l&&(le(),D(f[R],1,1,()=>{f[R]=null}),se()),~t?(l=f[t],l?l.p(T,I):(l=f[t]=a[t](T),l.c()),b(l,1),l.m(e,s)):l=null),(O=T[12])!=null&&O.error?c?(c.p(T,I),I[0]&4096&&b(c,1)):(c=hs(T),c.c(),b(c,1),c.m(e,r)):c&&(le(),D(c,1,1,()=>{c=null}),se()),((C=T[12])!=null&&C.sources||(P=T[12])!=null&&P.citations)&&(((ue=(ne=(W=(S=T[15])==null?void 0:S.info)==null?void 0:W.meta)==null?void 0:ne.capabilities)==null?void 0:ue.citations)??!0)?g?(g.p(T,I),I[0]&36864&&b(g,1)):(g=ms(T),g.c(),b(g,1),g.m(e,i)):g&&(le(),D(g,1,1,()=>{g=null}),se()),T[12].code_executions?h?(h.p(T,I),I[0]&4096&&b(h,1)):(h=gs(T),h.c(),b(h,1),h.m(e,null)):h&&(le(),D(h,1,1,()=>{h=null}),se())},i(T){o||(b(l),b(c),b(g),b(h),o=!0)},o(T){D(l),D(c),D(g),D(h),o=!1},d(T){T&&m(e),~t&&f[t].d(),c&&c.d(),g&&g.d(),h&&h.d()}}}function Oo(n){let e,t,l,s,r,i,o,a=n[25].t("Save As Copy")+"",f,u,c,g,h=n[25].t("Cancel")+"",p,w,v,E=n[25].t("Save")+"",y,B,L;return{c(){e=M("div"),t=M("textarea"),s=j(),r=M("div"),i=M("div"),o=M("button"),f=U(a),u=j(),c=M("div"),g=M("button"),p=U(h),w=j(),v=M("button"),y=U(E),this.h()},l(T){e=N(T,"DIV",{class:!0});var I=k(e);t=N(I,"TEXTAREA",{id:!0,class:!0}),k(t).forEach(m),s=H(I),r=N(I,"DIV",{class:!0});var R=k(r);i=N(R,"DIV",{});var O=k(i);o=N(O,"BUTTON",{id:!0,class:!0});var C=k(o);f=q(C,a),C.forEach(m),O.forEach(m),u=H(R),c=N(R,"DIV",{class:!0});var P=k(c);g=N(P,"BUTTON",{id:!0,class:!0});var S=k(g);p=q(S,h),S.forEach(m),w=H(P),v=N(P,"BUTTON",{id:!0,class:!0});var W=k(v);y=q(W,E),W.forEach(m),P.forEach(m),R.forEach(m),I.forEach(m),this.h()},h(){d(t,"id",l="message-edit-"+n[12].id),d(t,"class","bg-transparent outline-hidden w-full resize-none"),d(o,"id","save-new-message-button"),d(o,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),d(g,"id","close-edit-message-button"),d(g,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),d(v,"id","confirm-edit-message-button"),d(v,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),d(c,"class","flex space-x-1.5"),d(r,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),d(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 my-2")},m(T,I){V(T,e,I),_(e,t),n[48](t),rt(t,n[16]),_(e,s),_(e,r),_(r,i),_(i,o),_(o,f),_(r,u),_(r,c),_(c,g),_(g,p),_(c,w),_(c,v),_(v,y),B||(L=[_e(t,"input",n[49]),_e(t,"input",la),_e(t,"keydown",n[50]),_e(o,"click",n[51]),_e(g,"click",n[52]),_e(v,"click",n[53])],B=!0)},p(T,I){I[0]&4096&&l!==(l="message-edit-"+T[12].id)&&d(t,"id",l),I[0]&65536&&rt(t,T[16]),I[0]&33554432&&a!==(a=T[25].t("Save As Copy")+"")&&K(f,a),I[0]&33554432&&h!==(h=T[25].t("Cancel")+"")&&K(p,h),I[0]&33554432&&E!==(E=T[25].t("Save")+"")&&K(y,E)},i:ve,o:ve,d(T){T&&m(e),n[48](null),B=!1,et(L)}}}function Lo(n){var l;let e,t;return e=new vo({props:{id:n[12].id,history:n[0],content:n[12].content,sources:n[12].sources,floatingButtons:(l=n[12])==null?void 0:l.done,save:!n[11],model:n[15],onTaskClick:n[54],onSourceClick:n[55],onAddMessages:n[56]}}),e.$on("update",n[57]),e.$on("select",n[58]),{c(){X(e.$$.fragment)},l(s){Y(e.$$.fragment,s)},m(s,r){$(e,s,r),t=!0},p(s,r){var o;const i={};r[0]&4096&&(i.id=s[12].id),r[0]&1&&(i.history=s[0]),r[0]&4096&&(i.content=s[12].content),r[0]&4096&&(i.sources=s[12].sources),r[0]&4096&&(i.floatingButtons=(o=s[12])==null?void 0:o.done),r[0]&2048&&(i.save=!s[11]),r[0]&32768&&(i.model=s[15]),r[0]&4096&&(i.onSourceClick=s[55]),r[0]&512&&(i.onAddMessages=s[56]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){x(e,s)}}}function Po(n){let e,t;return e=new Xt({}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function hs(n){var l,s;let e,t;return e=new ai({props:{content:((s=(l=n[12])==null?void 0:l.error)==null?void 0:s.content)??n[12].content}}),{c(){X(e.$$.fragment)},l(r){Y(e.$$.fragment,r)},m(r,i){$(e,r,i),t=!0},p(r,i){var a,f;const o={};i[0]&4096&&(o.content=((f=(a=r[12])==null?void 0:a.error)==null?void 0:f.content)??r[12].content),e.$set(o)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){x(e,r)}}}function ms(n){var l,s,r;let e,t;return e=new Li({props:{id:(l=n[12])==null?void 0:l.id,sources:((s=n[12])==null?void 0:s.sources)??((r=n[12])==null?void 0:r.citations)}}),{c(){X(e.$$.fragment)},l(i){Y(e.$$.fragment,i)},m(i,o){$(e,i,o),t=!0},p(i,o){var f,u,c;const a={};o[0]&4096&&(a.id=(f=i[12])==null?void 0:f.id),o[0]&4096&&(a.sources=((u=i[12])==null?void 0:u.sources)??((c=i[12])==null?void 0:c.citations)),e.$set(a)},i(i){t||(b(e.$$.fragment,i),t=!0)},o(i){D(e.$$.fragment,i),t=!1},d(i){x(e,i)}}}function gs(n){let e,t;return e=new $i({props:{codeExecutions:n[12].code_executions}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&4096&&(r.codeExecutions=l[12].code_executions),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function _s(n){let e,t,l,s=(n[12].done||n[1].length>1)&&vs(n),r=n[12].done&&n[21]&&Ts(n);return{c(){s&&s.c(),e=j(),r&&r.c(),t=fe()},l(i){s&&s.l(i),e=H(i),r&&r.l(i),t=fe()},m(i,o){s&&s.m(i,o),V(i,e,o),r&&r.m(i,o),V(i,t,o),l=!0},p(i,o){i[12].done||i[1].length>1?s?(s.p(i,o),o[0]&4098&&b(s,1)):(s=vs(i),s.c(),b(s,1),s.m(e.parentNode,e)):s&&(le(),D(s,1,1,()=>{s=null}),se()),i[12].done&&i[21]?r?(r.p(i,o),o[0]&2101248&&b(r,1)):(r=Ts(i),r.c(),b(r,1),r.m(t.parentNode,t)):r&&(le(),D(r,1,1,()=>{r=null}),se())},i(i){l||(b(s),b(r),l=!0)},o(i){D(s),D(r),l=!1},d(i){i&&(m(e),m(t)),s&&s.d(i),r&&r.d(i)}}}function vs(n){let e,t,l,s=n[1].length>1&&ps(n),r=n[12].done&&bs(n);return{c(){e=M("div"),s&&s.c(),t=j(),r&&r.c(),this.h()},l(i){e=N(i,"DIV",{class:!0});var o=k(e);s&&s.l(o),t=H(o),r&&r.l(o),o.forEach(m),this.h()},h(){d(e,"class","flex justify-start overflow-x-auto buttons text-gray-600 dark:text-gray-500 mt-0.5 svelte-1u5gq5j")},m(i,o){V(i,e,o),s&&s.m(e,null),_(e,t),r&&r.m(e,null),l=!0},p(i,o){i[1].length>1?s?s.p(i,o):(s=ps(i),s.c(),s.m(e,t)):s&&(s.d(1),s=null),i[12].done?r?(r.p(i,o),o[0]&4096&&b(r,1)):(r=bs(i),r.c(),b(r,1),r.m(e,null)):r&&(le(),D(r,1,1,()=>{r=null}),se())},i(i){l||(b(r),l=!0)},o(i){D(r),l=!1},d(i){i&&m(e),s&&s.d(),r&&r.d()}}}function ps(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i=n[1].indexOf(n[12].id)+1+"",o,a,f=n[1].length+"",u,c,g,h='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',p,w;return{c(){e=M("div"),t=M("button"),t.innerHTML=l,s=j(),r=M("div"),o=U(i),a=U("/"),u=U(f),c=j(),g=M("button"),g.innerHTML=h,this.h()},l(v){e=N(v,"DIV",{class:!0,dir:!0});var E=k(e);t=N(E,"BUTTON",{class:!0,"data-svelte-h":!0}),Ae(t)!=="svelte-1e0chv1"&&(t.innerHTML=l),s=H(E),r=N(E,"DIV",{class:!0});var y=k(r);o=q(y,i),a=q(y,"/"),u=q(y,f),y.forEach(m),c=H(E),g=N(E,"BUTTON",{class:!0,"data-svelte-h":!0}),Ae(g)!=="svelte-107ksnk"&&(g.innerHTML=h),E.forEach(m),this.h()},h(){d(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(r,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit"),d(g,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(e,"class","flex self-center min-w-fit"),d(e,"dir","ltr")},m(v,E){V(v,e,E),_(e,t),_(e,s),_(e,r),_(r,o),_(r,a),_(r,u),_(e,c),_(e,g),p||(w=[_e(t,"click",n[59]),_e(g,"click",n[60])],p=!0)},p(v,E){E[0]&4098&&i!==(i=v[1].indexOf(v[12].id)+1+"")&&K(o,i),E[0]&2&&f!==(f=v[1].length+"")&&K(u,f)},d(v){v&&m(e),p=!1,et(w)}}}function bs(n){var p,w,v,E;let e,t,l,s,r,i,o,a,f,u=!n[11]&&ks(n);t=new Re({props:{content:n[25].t("Copy"),placement:"bottom",$$slots:{default:[jo]},$$scope:{ctx:n}}}),s=new Re({props:{content:n[25].t("Read Aloud"),placement:"bottom",$$slots:{default:[Uo]},$$scope:{ctx:n}}});let c=((p=n[24])==null?void 0:p.features.enable_image_generation)&&(n[26].role==="admin"||((E=(v=(w=n[26])==null?void 0:w.permissions)==null?void 0:v.features)==null?void 0:E.image_generation))&&!n[11]&&ys(n),g=n[12].usage&&Is(n),h=!n[11]&&Es(n);return{c(){u&&u.c(),e=j(),X(t.$$.fragment),l=j(),X(s.$$.fragment),r=j(),c&&c.c(),i=j(),g&&g.c(),o=j(),h&&h.c(),a=fe()},l(y){u&&u.l(y),e=H(y),Y(t.$$.fragment,y),l=H(y),Y(s.$$.fragment,y),r=H(y),c&&c.l(y),i=H(y),g&&g.l(y),o=H(y),h&&h.l(y),a=fe()},m(y,B){u&&u.m(y,B),V(y,e,B),$(t,y,B),V(y,l,B),$(s,y,B),V(y,r,B),c&&c.m(y,B),V(y,i,B),g&&g.m(y,B),V(y,o,B),h&&h.m(y,B),V(y,a,B),f=!0},p(y,B){var I,R,O,C;y[11]?u&&(le(),D(u,1,1,()=>{u=null}),se()):u?(u.p(y,B),B[0]&2048&&b(u,1)):(u=ks(y),u.c(),b(u,1),u.m(e.parentNode,e));const L={};B[0]&33554432&&(L.content=y[25].t("Copy")),B[0]&5120|B[2]&16777216&&(L.$$scope={dirty:B,ctx:y}),t.$set(L);const T={};B[0]&33554432&&(T.content=y[25].t("Read Aloud")),B[0]&791552|B[2]&16777216&&(T.$$scope={dirty:B,ctx:y}),s.$set(T),(I=y[24])!=null&&I.features.enable_image_generation&&(y[26].role==="admin"||(C=(O=(R=y[26])==null?void 0:R.permissions)==null?void 0:O.features)!=null&&C.image_generation)&&!y[11]?c?(c.p(y,B),B[0]&83888128&&b(c,1)):(c=ys(y),c.c(),b(c,1),c.m(i.parentNode,i)):c&&(le(),D(c,1,1,()=>{c=null}),se()),y[12].usage?g?(g.p(y,B),B[0]&4096&&b(g,1)):(g=Is(y),g.c(),b(g,1),g.m(o.parentNode,o)):g&&(le(),D(g,1,1,()=>{g=null}),se()),y[11]?h&&(le(),D(h,1,1,()=>{h=null}),se()):h?(h.p(y,B),B[0]&2048&&b(h,1)):(h=Es(y),h.c(),b(h,1),h.m(a.parentNode,a))},i(y){f||(b(u),b(t.$$.fragment,y),b(s.$$.fragment,y),b(c),b(g),b(h),f=!0)},o(y){D(u),D(t.$$.fragment,y),D(s.$$.fragment,y),D(c),D(g),D(h),f=!1},d(y){y&&(m(e),m(l),m(r),m(i),m(o),m(a)),u&&u.d(y),x(t,y),x(s,y),c&&c.d(y),g&&g.d(y),h&&h.d(y)}}}function ks(n){var s,r,i;let e,t,l=(n[26].role==="user"?((i=(r=(s=n[26])==null?void 0:s.permissions)==null?void 0:r.chat)==null?void 0:i.edit)??!0:!0)&&ws(n);return{c(){l&&l.c(),e=fe()},l(o){l&&l.l(o),e=fe()},m(o,a){l&&l.m(o,a),V(o,e,a),t=!0},p(o,a){var f,u,c;o[26].role!=="user"||(((c=(u=(f=o[26])==null?void 0:f.permissions)==null?void 0:u.chat)==null?void 0:c.edit)??!0)?l?(l.p(o,a),a[0]&67108864&&b(l,1)):(l=ws(o),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(le(),D(l,1,1,()=>{l=null}),se())},i(o){t||(b(l),t=!0)},o(o){D(l),t=!1},d(o){o&&m(e),l&&l.d(o)}}}function ws(n){let e,t;return e=new Re({props:{content:n[25].t("Edit"),placement:"bottom",$$slots:{default:[Ao]},$$scope:{ctx:n}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&33554432&&(r.content=l[25].t("Edit")),s[0]&1024|s[2]&16777216&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ao(n){let e,t,l,s,r,i;return{c(){e=M("button"),t=be("svg"),l=be("path"),this.h()},l(o){e=N(o,"BUTTON",{class:!0});var a=k(e);t=ke(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=k(t);l=ke(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),f.forEach(m),a.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(o,a){V(o,e,a),_(e,t),_(t,l),r||(i=_e(e,"click",n[61]),r=!0)},p(o,a){a[0]&1024&&s!==(s=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&d(e,"class",s)},d(o){o&&m(e),r=!1,i()}}}function jo(n){let e,t,l,s,r,i;return{c(){e=M("button"),t=be("svg"),l=be("path"),this.h()},l(o){e=N(o,"BUTTON",{class:!0});var a=k(e);t=ke(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=k(t);l=ke(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),f.forEach(m),a.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")},m(o,a){V(o,e,a),_(e,t),_(t,l),r||(i=_e(e,"click",n[62]),r=!0)},p(o,a){a[0]&1024&&s!==(s=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")&&d(e,"class",s)},d(o){o&&m(e),r=!1,i()}}}function Ho(n){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width","2.3"),d(e,"stroke","currentColor"),d(e,"class","w-4 h-4")},m(l,s){V(l,e,s),_(e,t)},d(l){l&&m(e)}}}function zo(n){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width","2.3"),d(e,"stroke","currentColor"),d(e,"class","w-4 h-4")},m(l,s){V(l,e,s),_(e,t)},d(l){l&&m(e)}}}function Wo(n){let e,t,l,s,r,i;return{c(){e=be("svg"),t=be("style"),l=U(`.spinner_S1WN {
														animation: spinner_MGfb 0.8s linear infinite;
														animation-delay: -0.8s;
													}

													.spinner_Km9P {
														animation-delay: -0.65s;
													}

													.spinner_JApP {
														animation-delay: -0.5s;
													}

													@keyframes spinner_MGfb {
														93.75%,
														100% {
															opacity: 0.2;
														}
													}
												`),s=be("circle"),r=be("circle"),i=be("circle"),this.h()},l(o){e=ke(o,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=k(e);t=ke(a,"style",{});var f=k(t);l=q(f,`.spinner_S1WN {
														animation: spinner_MGfb 0.8s linear infinite;
														animation-delay: -0.8s;
													}

													.spinner_Km9P {
														animation-delay: -0.65s;
													}

													.spinner_JApP {
														animation-delay: -0.5s;
													}

													@keyframes spinner_MGfb {
														93.75%,
														100% {
															opacity: 0.2;
														}
													}
												`),f.forEach(m),s=ke(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(s).forEach(m),r=ke(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(r).forEach(m),i=ke(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(i).forEach(m),a.forEach(m),this.h()},h(){d(s,"class","spinner_S1WN"),d(s,"cx","4"),d(s,"cy","12"),d(s,"r","3"),d(r,"class","spinner_S1WN spinner_Km9P"),d(r,"cx","12"),d(r,"cy","12"),d(r,"r","3"),d(i,"class","spinner_S1WN spinner_JApP"),d(i,"cx","20"),d(i,"cy","12"),d(i,"r","3"),d(e,"class","w-4 h-4"),d(e,"fill","currentColor"),d(e,"viewBox","0 0 24 24"),d(e,"xmlns","http://www.w3.org/2000/svg")},m(o,a){V(o,e,a),_(e,t),_(t,l),_(e,s),_(e,r),_(e,i)},d(o){o&&m(e)}}}function Uo(n){let e,t,l,s,r;function i(f,u){return f[19]?Wo:f[18]?zo:Ho}let o=i(n),a=o(n);return{c(){e=M("button"),a.c(),this.h()},l(f){e=N(f,"BUTTON",{id:!0,class:!0});var u=k(e);a.l(u),u.forEach(m),this.h()},h(){d(e,"id",t="speak-button-"+n[12].id),d(e,"class",l=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(f,u){V(f,e,u),a.m(e,null),s||(r=_e(e,"click",n[63]),s=!0)},p(f,u){o!==(o=i(f))&&(a.d(1),a=o(f),a&&(a.c(),a.m(e,null))),u[0]&4096&&t!==(t="speak-button-"+f[12].id)&&d(e,"id",t),u[0]&1024&&l!==(l=(f[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&d(e,"class",l)},d(f){f&&m(e),a.d(),s=!1,r()}}}function ys(n){let e,t;return e=new Re({props:{content:n[25].t("Generate Image"),placement:"bottom",$$slots:{default:[Jo]},$$scope:{ctx:n}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&33554432&&(r.content=l[25].t("Generate Image")),s[0]&1053696|s[2]&16777216&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function qo(n){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width","2.3"),d(e,"stroke","currentColor"),d(e,"class","w-4 h-4")},m(l,s){V(l,e,s),_(e,t)},d(l){l&&m(e)}}}function Fo(n){let e,t,l,s,r,i;return{c(){e=be("svg"),t=be("style"),l=U(`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),s=be("circle"),r=be("circle"),i=be("circle"),this.h()},l(o){e=ke(o,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=k(e);t=ke(a,"style",{});var f=k(t);l=q(f,`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),f.forEach(m),s=ke(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(s).forEach(m),r=ke(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(r).forEach(m),i=ke(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(i).forEach(m),a.forEach(m),this.h()},h(){d(s,"class","spinner_S1WN"),d(s,"cx","4"),d(s,"cy","12"),d(s,"r","3"),d(r,"class","spinner_S1WN spinner_Km9P"),d(r,"cx","12"),d(r,"cy","12"),d(r,"r","3"),d(i,"class","spinner_S1WN spinner_JApP"),d(i,"cx","20"),d(i,"cy","12"),d(i,"r","3"),d(e,"class","w-4 h-4"),d(e,"fill","currentColor"),d(e,"viewBox","0 0 24 24"),d(e,"xmlns","http://www.w3.org/2000/svg")},m(o,a){V(o,e,a),_(e,t),_(t,l),_(e,s),_(e,r),_(e,i)},d(o){o&&m(e)}}}function Jo(n){let e,t,l,s;function r(a,f){return a[20]?Fo:qo}let i=r(n),o=i(n);return{c(){e=M("button"),o.c(),this.h()},l(a){e=N(a,"BUTTON",{class:!0});var f=k(e);o.l(f),f.forEach(m),this.h()},h(){d(e,"class",t=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(a,f){V(a,e,f),o.m(e,null),l||(s=_e(e,"click",n[64]),l=!0)},p(a,f){i!==(i=r(a))&&(o.d(1),o=i(a),o&&(o.c(),o.m(e,null))),f[0]&1024&&t!==(t=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&d(e,"class",t)},d(a){a&&m(e),o.d(),l=!1,s()}}}function Is(n){let e,t;return e=new Re({props:{content:n[12].usage?`<pre>${pt(JSON.stringify(n[12].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(Ss).map(Os).join(`
`))}</pre>`:"",placement:"bottom",$$slots:{default:[Go]},$$scope:{ctx:n}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&4096&&(r.content=l[12].usage?`<pre>${pt(JSON.stringify(l[12].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(Ss).map(Os).join(`
`))}</pre>`:""),s[0]&5120|s[2]&16777216&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Go(n){let e,t,l,s,r,i,o;return{c(){e=M("button"),t=be("svg"),l=be("path"),this.h()},l(a){e=N(a,"BUTTON",{class:!0,id:!0});var f=k(e);t=ke(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=k(t);l=ke(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap"),d(e,"id",r="info-"+n[12].id)},m(a,f){V(a,e,f),_(e,t),_(t,l),i||(o=_e(e,"click",n[65]),i=!0)},p(a,f){f[0]&1024&&s!==(s=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap")&&d(e,"class",s),f[0]&4096&&r!==(r="info-"+a[12].id)&&d(e,"id",r)},d(a){a&&m(e),i=!1,o()}}}function Es(n){var g;let e,t,l,s,r,i,o,a=!n[27]&&(((g=n[24])==null?void 0:g.features.enable_message_rating)??!0)&&Ms(n),f=n[10]&&Ns(n);l=new Re({props:{content:n[25].t("Regenerate"),placement:"bottom",$$slots:{default:[Xo]},$$scope:{ctx:n}}});let u=n[1].length>1&&Ds(n),c=n[10]&&Vs(n);return{c(){a&&a.c(),e=j(),f&&f.c(),t=j(),X(l.$$.fragment),s=j(),u&&u.c(),r=j(),c&&c.c(),i=fe()},l(h){a&&a.l(h),e=H(h),f&&f.l(h),t=H(h),Y(l.$$.fragment,h),s=H(h),u&&u.l(h),r=H(h),c&&c.l(h),i=fe()},m(h,p){a&&a.m(h,p),V(h,e,p),f&&f.m(h,p),V(h,t,p),$(l,h,p),V(h,s,p),u&&u.m(h,p),V(h,r,p),c&&c.m(h,p),V(h,i,p),o=!0},p(h,p){var v;!h[27]&&(((v=h[24])==null?void 0:v.features.enable_message_rating)??!0)?a?(a.p(h,p),p[0]&150994944&&b(a,1)):(a=Ms(h),a.c(),b(a,1),a.m(e.parentNode,e)):a&&(le(),D(a,1,1,()=>{a=null}),se()),h[10]?f?(f.p(h,p),p[0]&1024&&b(f,1)):(f=Ns(h),f.c(),b(f,1),f.m(t.parentNode,t)):f&&(le(),D(f,1,1,()=>{f=null}),se());const w={};p[0]&33554432&&(w.content=h[25].t("Regenerate")),p[0]&2135296|p[2]&16777216&&(w.$$scope={dirty:p,ctx:h}),l.$set(w),h[1].length>1?u?(u.p(h,p),p[0]&2&&b(u,1)):(u=Ds(h),u.c(),b(u,1),u.m(r.parentNode,r)):u&&(le(),D(u,1,1,()=>{u=null}),se()),h[10]?c?(c.p(h,p),p[0]&1024&&b(c,1)):(c=Vs(h),c.c(),b(c,1),c.m(i.parentNode,i)):c&&(le(),D(c,1,1,()=>{c=null}),se())},i(h){o||(b(a),b(f),b(l.$$.fragment,h),b(u),b(c),o=!0)},o(h){D(a),D(f),D(l.$$.fragment,h),D(u),D(c),o=!1},d(h){h&&(m(e),m(t),m(s),m(r),m(i)),a&&a.d(h),f&&f.d(h),x(l,h),u&&u.d(h),c&&c.d(h)}}}function Ms(n){let e,t,l,s;return e=new Re({props:{content:n[25].t("Good Response"),placement:"bottom",$$slots:{default:[Zo]},$$scope:{ctx:n}}}),l=new Re({props:{content:n[25].t("Bad Response"),placement:"bottom",$$slots:{default:[Ko]},$$scope:{ctx:n}}}),{c(){X(e.$$.fragment),t=j(),X(l.$$.fragment)},l(r){Y(e.$$.fragment,r),t=H(r),Y(l.$$.fragment,r)},m(r,i){$(e,r,i),V(r,t,i),$(l,r,i),s=!0},p(r,i){const o={};i[0]&33554432&&(o.content=r[25].t("Good Response")),i[0]&4199424|i[2]&16777216&&(o.$$scope={dirty:i,ctx:r}),e.$set(o);const a={};i[0]&33554432&&(a.content=r[25].t("Bad Response")),i[0]&4199424|i[2]&16777216&&(a.$$scope={dirty:i,ctx:r}),l.$set(a)},i(r){s||(b(e.$$.fragment,r),b(l.$$.fragment,r),s=!0)},o(r){D(e.$$.fragment,r),D(l.$$.fragment,r),s=!1},d(r){r&&m(t),x(e,r),x(l,r)}}}function Zo(n){let e,t,l,s,r,i;return{c(){e=M("button"),t=be("svg"),l=be("path"),this.h()},l(o){e=N(o,"BUTTON",{class:!0});var a=k(e);t=ke(a,"svg",{stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var f=k(t);l=ke(f,"path",{d:!0}),k(l).forEach(m),f.forEach(m),a.forEach(m),this.h()},h(){var o,a;d(l,"d","M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"),d(t,"stroke","currentColor"),d(t,"fill","none"),d(t,"stroke-width","2.3"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"class","w-4 h-4"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((a=(o=n[12])==null?void 0:o.annotation)==null?void 0:a.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=n[22]},m(o,a){V(o,e,a),_(e,t),_(t,l),r||(i=_e(e,"click",n[66]),r=!0)},p(o,a){var f,u;a[0]&5120&&s!==(s=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((u=(f=o[12])==null?void 0:f.annotation)==null?void 0:u.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&d(e,"class",s),a[0]&4194304&&(e.disabled=o[22])},d(o){o&&m(e),r=!1,i()}}}function Ko(n){let e,t,l,s,r,i;return{c(){e=M("button"),t=be("svg"),l=be("path"),this.h()},l(o){e=N(o,"BUTTON",{class:!0});var a=k(e);t=ke(a,"svg",{stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var f=k(t);l=ke(f,"path",{d:!0}),k(l).forEach(m),f.forEach(m),a.forEach(m),this.h()},h(){var o,a;d(l,"d","M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"),d(t,"stroke","currentColor"),d(t,"fill","none"),d(t,"stroke-width","2.3"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"class","w-4 h-4"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((a=(o=n[12])==null?void 0:o.annotation)==null?void 0:a.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=n[22]},m(o,a){V(o,e,a),_(e,t),_(t,l),r||(i=_e(e,"click",n[67]),r=!0)},p(o,a){var f,u;a[0]&5120&&s!==(s=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((u=(f=o[12])==null?void 0:f.annotation)==null?void 0:u.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&d(e,"class",s),a[0]&4194304&&(e.disabled=o[22])},d(o){o&&m(e),r=!1,i()}}}function Ns(n){let e,t;return e=new Re({props:{content:n[25].t("Continue Response"),placement:"bottom",$$slots:{default:[Qo]},$$scope:{ctx:n}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&33554432&&(r.content=l[25].t("Continue Response")),s[0]&1152|s[2]&16777216&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Qo(n){let e,t,l,s,r,i,o;return{c(){e=M("button"),t=be("svg"),l=be("path"),s=be("path"),this.h()},l(a){e=N(a,"BUTTON",{type:!0,id:!0,class:!0});var f=k(e);t=ke(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=k(t);l=ke(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),s=ke(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(s).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),d(s,"stroke-linecap","round"),d(s,"stroke-linejoin","round"),d(s,"d","M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113a.375.375 0 0 1-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112Z"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"type","button"),d(e,"id","continue-response-button"),d(e,"class",r=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(a,f){V(a,e,f),_(e,t),_(t,l),_(t,s),i||(o=_e(e,"click",n[68]),i=!0)},p(a,f){f[0]&1024&&r!==(r=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&d(e,"class",r)},d(a){a&&m(e),i=!1,o()}}}function Xo(n){let e,t,l,s,r,i;return{c(){e=M("button"),t=be("svg"),l=be("path"),this.h()},l(o){e=N(o,"BUTTON",{type:!0,class:!0});var a=k(e);t=ke(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=k(t);l=ke(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),f.forEach(m),a.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"type","button"),d(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(o,a){V(o,e,a),_(e,t),_(t,l),r||(i=_e(e,"click",n[69]),r=!0)},p(o,a){a[0]&1024&&s!==(s=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&d(e,"class",s)},d(o){o&&m(e),r=!1,i()}}}function Ds(n){let e,t;return e=new Re({props:{content:n[25].t("Delete"),placement:"bottom",$$slots:{default:[Yo]},$$scope:{ctx:n}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&33554432&&(r.content=l[25].t("Delete")),s[0]&17408|s[2]&16777216&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Yo(n){let e,t,l,s,r,i;return{c(){e=M("button"),t=be("svg"),l=be("path"),this.h()},l(o){e=N(o,"BUTTON",{type:!0,id:!0,class:!0});var a=k(e);t=ke(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=k(t);l=ke(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),f.forEach(m),a.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"type","button"),d(e,"id","continue-response-button"),d(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(o,a){V(o,e,a),_(e,t),_(t,l),r||(i=_e(e,"click",n[70]),r=!0)},p(o,a){a[0]&1024&&s!==(s=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&d(e,"class",s)},d(o){o&&m(e),r=!1,i()}}}function Vs(n){var i;let e,t,l=Ee(((i=n[15])==null?void 0:i.actions)??[]),s=[];for(let o=0;o<l.length;o+=1)s[o]=Cs(ns(n,l,o));const r=o=>D(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=fe()},l(o){for(let a=0;a<s.length;a+=1)s[a].l(o);e=fe()},m(o,a){for(let f=0;f<s.length;f+=1)s[f]&&s[f].m(o,a);V(o,e,a),t=!0},p(o,a){var f;if(a[0]&37920){l=Ee(((f=o[15])==null?void 0:f.actions)??[]);let u;for(u=0;u<l.length;u+=1){const c=ns(o,l,u);s[u]?(s[u].p(c,a),b(s[u],1)):(s[u]=Cs(c),s[u].c(),b(s[u],1),s[u].m(e.parentNode,e))}for(le(),u=l.length;u<s.length;u+=1)r(u);se()}},i(o){if(!t){for(let a=0;a<l.length;a+=1)b(s[a]);t=!0}},o(o){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)D(s[a]);t=!1},d(o){o&&m(e),Ue(s,o)}}}function $o(n){let e,t;return e=new ri({props:{strokeWidth:"2.1",className:"size-4"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function xo(n){let e,t,l,s,r;return{c(){e=M("div"),t=M("img"),this.h()},l(i){e=N(i,"DIV",{class:!0});var o=k(e);t=N(o,"IMG",{src:!0,class:!0,style:!0,alt:!0}),o.forEach(m),this.h()},h(){Ot(t.src,l=n[79].icon_url)||d(t,"src",l),d(t,"class",s="w-4 h-4 "+(n[79].icon_url.includes("svg")?"dark:invert-[80%]":"")),St(t,"fill","currentColor"),d(t,"alt",r=n[79].name),d(e,"class","size-4")},m(i,o){V(i,e,o),_(e,t)},p(i,o){o[0]&32768&&!Ot(t.src,l=i[79].icon_url)&&d(t,"src",l),o[0]&32768&&s!==(s="w-4 h-4 "+(i[79].icon_url.includes("svg")?"dark:invert-[80%]":""))&&d(t,"class",s),o[0]&32768&&r!==(r=i[79].name)&&d(t,"alt",r)},i:ve,o:ve,d(i){i&&m(e)}}}function ea(n){let e,t,l,s,r,i,o,a;const f=[xo,$o],u=[];function c(h,p){return h[79].icon_url?0:1}t=c(n),l=u[t]=f[t](n);function g(){return n[71](n[79])}return{c(){e=M("button"),l.c(),r=j(),this.h()},l(h){e=N(h,"BUTTON",{type:!0,class:!0});var p=k(e);l.l(p),p.forEach(m),r=H(h),this.h()},h(){d(e,"type","button"),d(e,"class",s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(h,p){V(h,e,p),u[t].m(e,null),V(h,r,p),i=!0,o||(a=_e(e,"click",g),o=!0)},p(h,p){n=h;let w=t;t=c(n),t===w?u[t].p(n,p):(le(),D(u[w],1,1,()=>{u[w]=null}),se(),l=u[t],l?l.p(n,p):(l=u[t]=f[t](n),l.c()),b(l,1),l.m(e,null)),(!i||p[0]&1024&&s!==(s=(n[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition"))&&d(e,"class",s)},i(h){i||(b(l),i=!0)},o(h){D(l),i=!1},d(h){h&&(m(e),m(r)),u[t].d(),o=!1,a()}}}function Cs(n){let e,t;return e=new Re({props:{content:n[79].name,placement:"bottom",$$slots:{default:[ea]},$$scope:{ctx:n}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&32768&&(r.content=l[79].name),s[0]&37920|s[2]&16777216&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ts(n){let e,t,l,s;function r(a){n[72](a)}function i(a){n[73](a)}let o={};return n[12]!==void 0&&(o.message=n[12]),n[21]!==void 0&&(o.show=n[21]),e=new Qr({props:o}),je.push(()=>Ke(e,"message",r)),je.push(()=>Ke(e,"show",i)),e.$on("save",n[74]),{c(){X(e.$$.fragment)},l(a){Y(e.$$.fragment,a)},m(a,f){$(e,a,f),s=!0},p(a,f){const u={};!t&&f[0]&4096&&(t=!0,u.message=a[12],Ze(()=>t=!1)),!l&&f[0]&2097152&&(l=!0,u.show=a[21],Ze(()=>l=!1)),e.$set(u)},i(a){s||(b(e.$$.fragment,a),s=!0)},o(a){D(e.$$.fragment,a),s=!1},d(a){x(e,a)}}}function Bs(n){var ne,ue,te,ie,G,Q,he,de;let e,t,l,s,r,i,o,a,f,u=((ne=n[12])==null?void 0:ne.files)&&((ue=n[12].files)==null?void 0:ue.filter(Rs).length)>0,c,g,h,p,w,v,E,y,B,L,T,I;l=new Vn({props:{src:((G=(ie=(te=n[15])==null?void 0:te.info)==null?void 0:ie.meta)==null?void 0:G.profile_image_url)??(n[25].language==="dg-DG"?"/doge.png":`${Lt}/static/favicon.png`),className:"size-8"}}),o=new Kt({props:{$$slots:{default:[ko]},$$scope:{ctx:n}}});let R=u&&os(n),O=(((Q=n[12])==null?void 0:Q.statusHistory)??[...(he=n[12])!=null&&he.status?[(de=n[12])==null?void 0:de.status]:[]]).length>0&&us(Ut(n));const C=[Oo,So],P=[];function S(Z,z){return Z[13]===!0?0:1}w=S(n),v=P[w]=C[w](n);let W=!n[13]&&_s(n);return{c(){e=M("div"),t=M("div"),X(l.$$.fragment),r=j(),i=M("div"),X(o.$$.fragment),a=j(),f=M("div"),R&&R.c(),c=j(),g=M("div"),h=M("div"),O&&O.c(),p=j(),v.c(),y=j(),W&&W.c(),this.h()},l(Z){e=N(Z,"DIV",{class:!0,id:!0,dir:!0});var z=k(e);t=N(z,"DIV",{class:!0});var ae=k(t);Y(l.$$.fragment,ae),ae.forEach(m),r=H(z),i=N(z,"DIV",{class:!0});var re=k(i);Y(o.$$.fragment,re),a=H(re),f=N(re,"DIV",{});var pe=k(f);R&&R.l(pe),c=H(pe),g=N(pe,"DIV",{class:!0});var ye=k(g);h=N(ye,"DIV",{});var A=k(h);O&&O.l(A),p=H(A),v.l(A),A.forEach(m),ye.forEach(m),y=H(pe),W&&W.l(pe),pe.forEach(m),re.forEach(m),z.forEach(m),this.h()},h(){var Z;d(t,"class",s=ul(`shrink-0 ${(((Z=n[23])==null?void 0:Z.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`)+" svelte-1u5gq5j"),d(g,"class",E="chat-"+n[12].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"),d(i,"class","flex-auto w-0 pl-1"),d(e,"class",B="flex w-full message-"+n[12].id+" svelte-1u5gq5j"),d(e,"id",L="message-"+n[12].id),d(e,"dir",T=n[23].chatDirection)},m(Z,z){V(Z,e,z),_(e,t),$(l,t,null),_(e,r),_(e,i),$(o,i,null),_(i,a),_(i,f),R&&R.m(f,null),_(f,c),_(f,g),_(g,h),O&&O.m(h,null),_(h,p),P[w].m(h,null),_(f,y),W&&W.m(f,null),I=!0},p(Z,z){var ye,A,F,oe,me,ce,ee,ge,De;const ae={};z[0]&33587200&&(ae.src=((F=(A=(ye=Z[15])==null?void 0:ye.info)==null?void 0:A.meta)==null?void 0:F.profile_image_url)??(Z[25].language==="dg-DG"?"/doge.png":`${Lt}/static/favicon.png`)),l.$set(ae),(!I||z[0]&8388608&&s!==(s=ul(`shrink-0 ${(((oe=Z[23])==null?void 0:oe.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`)+" svelte-1u5gq5j"))&&d(t,"class",s);const re={};z[0]&36864|z[2]&16777216&&(re.$$scope={dirty:z,ctx:Z}),o.$set(re),z[0]&4096&&(u=((me=Z[12])==null?void 0:me.files)&&((ce=Z[12].files)==null?void 0:ce.filter(Rs).length)>0),u?R?(R.p(Z,z),z[0]&4096&&b(R,1)):(R=os(Z),R.c(),b(R,1),R.m(f,c)):R&&(le(),D(R,1,1,()=>{R=null}),se()),(((ee=Z[12])==null?void 0:ee.statusHistory)??[...(ge=Z[12])!=null&&ge.status?[(De=Z[12])==null?void 0:De.status]:[]]).length>0?O?(O.p(Ut(Z),z),z[0]&4096&&b(O,1)):(O=us(Ut(Z)),O.c(),b(O,1),O.m(h,p)):O&&(le(),D(O,1,1,()=>{O=null}),se());let pe=w;w=S(Z),w===pe?P[w].p(Z,z):(le(),D(P[pe],1,1,()=>{P[pe]=null}),se(),v=P[w],v?v.p(Z,z):(v=P[w]=C[w](Z),v.c()),b(v,1),v.m(h,null)),(!I||z[0]&4096&&E!==(E="chat-"+Z[12].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"))&&d(g,"class",E),Z[13]?W&&(le(),D(W,1,1,()=>{W=null}),se()):W?(W.p(Z,z),z[0]&8192&&b(W,1)):(W=_s(Z),W.c(),b(W,1),W.m(f,null)),(!I||z[0]&4096&&B!==(B="flex w-full message-"+Z[12].id+" svelte-1u5gq5j"))&&d(e,"class",B),(!I||z[0]&4096&&L!==(L="message-"+Z[12].id))&&d(e,"id",L),(!I||z[0]&8388608&&T!==(T=Z[23].chatDirection))&&d(e,"dir",T)},i(Z){I||(b(l.$$.fragment,Z),b(o.$$.fragment,Z),b(R),b(O),b(v),b(W),I=!0)},o(Z){D(l.$$.fragment,Z),D(o.$$.fragment,Z),D(R),D(O),D(v),D(W),I=!1},d(Z){Z&&m(e),x(l),x(o),R&&R.d(),O&&O.d(),P[w].d(),W&&W.d()}}}function ta(n){let e,t,l,s=n[12].id,r,i;function o(u){n[46](u)}let a={title:n[25].t("Delete message?")};n[14]!==void 0&&(a.show=n[14]),e=new Sn({props:a}),je.push(()=>Ke(e,"show",o)),e.$on("confirm",n[47]);let f=Bs(n);return{c(){X(e.$$.fragment),l=j(),f.c(),r=fe()},l(u){Y(e.$$.fragment,u),l=H(u),f.l(u),r=fe()},m(u,c){$(e,u,c),V(u,l,c),f.m(u,c),V(u,r,c),i=!0},p(u,c){const g={};c[0]&33554432&&(g.title=u[25].t("Delete message?")),!t&&c[0]&16384&&(t=!0,g.show=u[14],Ze(()=>t=!1)),e.$set(g),c[0]&4096&&Ve(s,s=u[12].id)?(le(),D(f,1,1,ve),se(),f=Bs(u),f.c(),b(f,1),f.m(r.parentNode,r)):f.p(u,c)},i(u){i||(b(e.$$.fragment,u),b(f),i=!0)},o(u){D(e.$$.fragment,u),D(f),i=!1},d(u){u&&(m(l),m(r)),x(e,u),f.d(u)}}}const Rs=n=>n.type==="image",la=n=>{n.target.style.height="",n.target.style.height=`${n.target.scrollHeight}px`},Ss=n=>n.slice(2),Os=n=>n.endsWith(",")?n.slice(0,-1):n;function sa(n,e,t){let l,s,r,i,o,a,f;Ie(n,jt,J=>t(45,l=J)),Ie(n,Ht,J=>t(23,s=J)),Ie(n,Mn,J=>t(24,r=J)),Ie(n,dl,J=>t(77,i=J)),Ie(n,zt,J=>t(26,a=J)),Ie(n,Zt,J=>t(27,f=J));const u=qe("i18n");Ie(n,u,J=>t(25,o=J));const c=gt();let{chatId:g=""}=e,{history:h}=e,{messageId:p}=e,w=JSON.parse(JSON.stringify(h.messages[p])),{siblings:v}=e,{showPreviousMessage:E}=e,{showNextMessage:y}=e,{updateChat:B}=e,{editMessage:L}=e,{saveMessage:T}=e,{rateMessage:I}=e,{actionMessage:R}=e,{deleteMessage:O}=e,{submitMessage:C}=e,{continueResponse:P}=e,{regenerateResponse:S}=e,{addMessages:W}=e,{isLastMessage:ne=!0}=e,{readOnly:ue=!1}=e,te=!1,ie=null,G=!1,Q="",he,de={},Z=!1,z,ae=!1,re=!1,pe=!1;const ye=async J=>{await Nn(J)&&Pe.success(o.t("Copying to clipboard was successful!"))},A=J=>new Promise(Me=>{z=J;const we=de[J];if(!we)return Me();we.play(),we.onended=async()=>{await new Promise(Oe=>setTimeout(Oe,300)),Object.keys(de).length-1===J&&t(18,Z=!1),Me()}}),F=async()=>{var J,Me,we,Oe,Je,Ye,Vt,ct,kt,Se,Ge,nt,wt,Ct,Yt,$t,xt,el,tl,ll,sl,nl,rl;if(Z){try{speechSynthesis.cancel(),z!==void 0&&de[z]&&(de[z].pause(),de[z].currentTime=0)}catch{}t(18,Z=!1),z=void 0;return}if(!((w==null?void 0:w.content)??"").trim().length){Pe.info(o.t("No content to speak"));return}if(t(18,Z=!0),r.audio.tts.engine===""){let Qe=[];const _t=setInterval(()=>{var Xe,dt,$e;if(Qe=speechSynthesis.getVoices(),Qe.length>0){clearInterval(_t);const We=((Xe=Qe==null?void 0:Qe.filter(mt=>{var il,ol,al,fl;return mt.voiceURI===(((ol=(il=s==null?void 0:s.audio)==null?void 0:il.tts)==null?void 0:ol.voice)??((fl=(al=r==null?void 0:r.audio)==null?void 0:al.tts)==null?void 0:fl.voice))}))==null?void 0:Xe.at(0))??void 0;console.log(We);const ht=new SpeechSynthesisUtterance(w.content);ht.rate=(($e=(dt=s.audio)==null?void 0:dt.tts)==null?void 0:$e.playbackRate)??1,console.log(ht),ht.onend=()=>{var mt;t(18,Z=!1),s.conversationMode&&((mt=document.getElementById("voice-input-button"))==null||mt.click())},We&&(ht.voice=We),speechSynthesis.speak(ht)}},100)}else{t(19,ae=!0);const Qe=hr(w.content,((Me=(J=r==null?void 0:r.audio)==null?void 0:J.tts)==null?void 0:Me.split_on)??"punctuation");if(!Qe.length){console.log("No content to speak"),Pe.info(o.t("No content to speak")),t(18,Z=!1),t(19,ae=!1);return}console.debug("Prepared message content for TTS",Qe),de=Qe.reduce((Xe,dt,$e)=>(Xe[$e]=null,Xe),{});let _t=Promise.resolve();if(((Oe=(we=s.audio)==null?void 0:we.tts)==null?void 0:Oe.engine)==="browser-kokoro"){i||(await dl.set(new Cr({dtype:((Vt=(Ye=(Je=s.audio)==null?void 0:Je.tts)==null?void 0:Ye.engineConfig)==null?void 0:Vt.dtype)??"fp32"})),await i.init());for(const[Xe,dt]of Qe.entries()){const $e=await i.generate({text:dt,voice:((kt=(ct=s==null?void 0:s.audio)==null?void 0:ct.tts)==null?void 0:kt.voice)??((Ge=(Se=r==null?void 0:r.audio)==null?void 0:Se.tts)==null?void 0:Ge.voice)}).catch(We=>{console.error(We),Pe.error(`${We}`),t(18,Z=!1),t(19,ae=!1)});if($e){const We=new Audio($e);We.playbackRate=((wt=(nt=s.audio)==null?void 0:nt.tts)==null?void 0:wt.playbackRate)??1,de[Xe]=We,t(19,ae=!1),_t=_t.then(()=>A(Xe))}}}else for(const[Xe,dt]of Qe.entries()){const $e=await _r(localStorage.token,((Yt=(Ct=s==null?void 0:s.audio)==null?void 0:Ct.tts)==null?void 0:Yt.defaultVoice)===r.audio.tts.voice?((xt=($t=s==null?void 0:s.audio)==null?void 0:$t.tts)==null?void 0:xt.voice)??((tl=(el=r==null?void 0:r.audio)==null?void 0:el.tts)==null?void 0:tl.voice):(sl=(ll=r==null?void 0:r.audio)==null?void 0:ll.tts)==null?void 0:sl.voice,dt).catch(We=>{console.error(We),Pe.error(`${We}`),t(18,Z=!1),t(19,ae=!1)});if($e){const We=await $e.blob(),ht=URL.createObjectURL(We),mt=new Audio(ht);mt.playbackRate=((rl=(nl=s.audio)==null?void 0:nl.tts)==null?void 0:rl.playbackRate)??1,de[Xe]=mt,t(19,ae=!1),_t=_t.then(()=>A(Xe))}}}},oe=async()=>{t(13,G=!0),t(16,Q=w.content),await Ne(),t(17,he.style.height="",he),t(17,he.style.height=`${he.scrollHeight}px`,he)},me=async()=>{L(w.id,Q||"",!1),t(13,G=!1),t(16,Q=""),await Ne()},ce=async()=>{L(w.id,Q||""),t(13,G=!1),t(16,Q=""),await Ne()},ee=async()=>{t(13,G=!1),t(16,Q=""),await Ne()},ge=async J=>{t(20,re=!0);const Me=await vr(localStorage.token,J.content).catch(we=>{Pe.error(`${we}`)});if(console.log(Me),Me){const we=Me.map(Oe=>({type:"image",url:`${Oe.url}`}));T(J.id,{...J,files:we})}t(20,re=!1)};let De=!1;const Le=async(J=null,Me=null)=>{var kt;t(22,De=!0),console.log("Feedback",J,Me);const we={...w,annotation:{...(w==null?void 0:w.annotation)??{},...J!==null?{rating:J}:{},...Me||{}}},Oe=await ur(localStorage.token,g).catch(Se=>{Pe.error(`${Se}`)});if(!Oe)return;const Je=Jt(h,w.id);let Ye={type:"rating",data:{...we!=null&&we.annotation?we.annotation:{},model_id:(w==null?void 0:w.selectedModelId)??w.model,...h.messages[w.parentId].childrenIds.length>1?{sibling_model_ids:h.messages[w.parentId].childrenIds.filter(Se=>Se!==w.id).map(Se=>{var Ge;return((Ge=h.messages[Se])==null?void 0:Ge.selectedModelId)??h.messages[Se].model})}:{}},meta:{arena:w?w.arena:!1,model_id:w.model,message_id:w.id,message_index:Je.length,chat_id:g},snapshot:{chat:Oe}};const Vt=[Ye.data.model_id,...Ye.data.sibling_model_ids??[]].reduce((Se,Ge)=>{var wt;const nt=l.find(Ct=>Ct.id===Ge);return nt?Se[nt.id]=((wt=nt==null?void 0:nt.info)==null?void 0:wt.base_model_id)??null:console.warn(`Model with ID ${Ge} not found`),Se},{});Ye.meta.base_models=Vt;let ct=null;if(w!=null&&w.feedbackId?ct=await _l(localStorage.token,w.feedbackId,Ye).catch(Se=>{Pe.error(`${Se}`)}):(ct=await mr(localStorage.token,Ye).catch(Se=>{Pe.error(`${Se}`)}),ct&&(we.feedbackId=ct.id)),console.log(we),T(w.id,we),await Ne(),!Me&&(t(21,pe=!0),!((kt=we.annotation)!=null&&kt.tags))){const Se=await gr(localStorage.token,w.model,Je,g).catch(Ge=>(console.error(Ge),[]));console.log(Se),Se&&(we.annotation.tags=Se,Ye.data.tags=Se,T(w.id,we),await _l(localStorage.token,we.feedbackId,Ye).catch(Ge=>{Pe.error(`${Ge}`)}))}t(22,De=!1)},Ce=async()=>{O(w.id)};bt(async()=>{await Ne()});function He(J){te=J,t(14,te)}const ze=()=>{Ce()};function Fe(J){je[J?"unshift":"push"](()=>{he=J,t(17,he)})}function tt(){Q=this.value,t(16,Q)}const lt=J=>{var Oe,Je;J.key==="Escape"&&((Oe=document.getElementById("close-edit-message-button"))==null||Oe.click());const Me=J.metaKey||J.ctrlKey,we=J.key==="Enter";Me&&we&&((Je=document.getElementById("confirm-edit-message-button"))==null||Je.click())},ot=()=>{ce()},at=()=>{ee()},xe=()=>{me()},ft=async J=>{console.log(J)},ut=async(J,Me)=>{console.log(J,Me);let we=document.getElementById(`source-${w.id}-${Me}`);const Oe=document.getElementById("collapsible-sources");we?we.click():Oe&&(Oe.querySelector("div:first-child").dispatchEvent(new PointerEvent("pointerup",{})),await new Promise(Je=>{requestAnimationFrame(()=>{requestAnimationFrame(Je)})}),we=document.getElementById(`source-${w.id}-${Me}`),we&&we.click())},st=({modelId:J,parentId:Me,messages:we})=>{W({modelId:J,parentId:Me,messages:we})},It=J=>{const{raw:Me,oldContent:we,newContent:Oe}=J.detail;t(0,h.messages[w.id].content=h.messages[w.id].content.replace(Me,Me.replace(we,Oe)),h),B()},Et=J=>{var Oe;const{type:Me,content:we}=J.detail;if(Me==="explain")C(w.id,`Explain this section to me in more detail

\`\`\`
${we}
\`\`\``);else if(Me==="ask"){const Je=((Oe=J.detail)==null?void 0:Oe.input)??"";C(w.id,`\`\`\`
${we}
\`\`\`
${Je}`)}},Mt=()=>{E(w)},Nt=()=>{y(w)},Dt=()=>{oe()},Pn=()=>{ye(w.content)},An=()=>{ae||F()},jn=()=>{re||ge(w)},Hn=()=>{console.log(w)},zn=async()=>{await Le(1),window.setTimeout(()=>{var J;(J=document.getElementById(`message-feedback-${w.id}`))==null||J.scrollIntoView()},0)},Wn=async()=>{await Le(-1),window.setTimeout(()=>{var J;(J=document.getElementById(`message-feedback-${w.id}`))==null||J.scrollIntoView()},0)},Un=()=>{P()},qn=()=>{t(21,pe=!1),S(w),((ie==null?void 0:ie.actions)??[]).forEach(J=>{c("action",{id:J.id,event:{id:"regenerate-response",data:{messageId:w.id}}})})},Fn=()=>{t(14,te=!0)},Jn=J=>{R(J.id,w)};function Gn(J){w=J,t(12,w),t(0,h),t(40,p)}function Zn(J){pe=J,t(21,pe)}const Kn=async J=>{await Le(null,{...J.detail})};return n.$$set=J=>{"chatId"in J&&t(39,g=J.chatId),"history"in J&&t(0,h=J.history),"messageId"in J&&t(40,p=J.messageId),"siblings"in J&&t(1,v=J.siblings),"showPreviousMessage"in J&&t(2,E=J.showPreviousMessage),"showNextMessage"in J&&t(3,y=J.showNextMessage),"updateChat"in J&&t(4,B=J.updateChat),"editMessage"in J&&t(41,L=J.editMessage),"saveMessage"in J&&t(42,T=J.saveMessage),"rateMessage"in J&&t(43,I=J.rateMessage),"actionMessage"in J&&t(5,R=J.actionMessage),"deleteMessage"in J&&t(44,O=J.deleteMessage),"submitMessage"in J&&t(6,C=J.submitMessage),"continueResponse"in J&&t(7,P=J.continueResponse),"regenerateResponse"in J&&t(8,S=J.regenerateResponse),"addMessages"in J&&t(9,W=J.addMessages),"isLastMessage"in J&&t(10,ne=J.isLastMessage),"readOnly"in J&&t(11,ue=J.readOnly)},n.$$.update=()=>{n.$$.dirty[0]&4097|n.$$.dirty[1]&512&&h.messages&&JSON.stringify(w)!==JSON.stringify(h.messages[p])&&t(12,w=JSON.parse(JSON.stringify(h.messages[p]))),n.$$.dirty[0]&4096|n.$$.dirty[1]&16384&&t(15,ie=l.find(J=>J.id===w.model)),n.$$.dirty[0]&8192&&(G||(async()=>await Ne())())},[h,v,E,y,B,R,C,P,S,W,ne,ue,w,G,te,ie,Q,he,Z,ae,re,pe,De,s,r,o,a,f,u,c,ye,F,oe,me,ce,ee,ge,Le,Ce,g,p,L,T,I,O,l,He,ze,Fe,tt,lt,ot,at,xe,ft,ut,st,It,Et,Mt,Nt,Dt,Pn,An,jn,Hn,zn,Wn,Un,qn,Fn,Jn,Gn,Zn,Kn]}class Ln extends Te{constructor(e){super(),Be(this,e,sa,ta,Ve,{chatId:39,history:0,messageId:40,siblings:1,showPreviousMessage:2,showNextMessage:3,updateChat:4,editMessage:41,saveMessage:42,rateMessage:43,actionMessage:5,deleteMessage:44,submitMessage:6,continueResponse:7,regenerateResponse:8,addMessages:9,isLastMessage:10,readOnly:11},null,[-1,-1,-1])}}function na(n){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M8 8v8m0-8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm6-2a2 2 0 1 1 4 0 2 2 0 0 1-4 0Zm0 0h-1a5 5 0 0 1-5-5v-.5"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width",n[1]),d(e,"stroke","currentColor"),d(e,"class",n[0])},m(l,s){V(l,e,s),_(e,t)},p(l,[s]){s&2&&d(e,"stroke-width",l[1]),s&1&&d(e,"class",l[0])},i:ve,o:ve,d(l){l&&m(e)}}}function ra(n,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class ia extends Te{constructor(e){super(),Be(this,e,ra,na,Ve,{className:0,strokeWidth:1})}}function qt(n){var l;const e=n.slice(),t=(l=e[0].messages[e[2]])==null?void 0:l.merged;return e[16]=t,e}function Ls(n,e,t){const l=n.slice();return l[36]=e[t],l}function Ft(n){const e=n.slice(),t=e[19][e[36]].messageIds[e[20][e[36]]];return e[39]=t,e}function Ps(n){let e,t,l,s,r,i=Ee(Object.keys(n[19])),o=[];for(let u=0;u<i.length;u+=1)o[u]=zs(Ls(n,i,u));const a=u=>D(o[u],1,1,()=>{o[u]=null});let f=!n[4]&&Ws(n);return{c(){e=M("div"),t=M("div");for(let u=0;u<o.length;u+=1)o[u].c();s=j(),f&&f.c(),this.h()},l(u){e=N(u,"DIV",{});var c=k(e);t=N(c,"DIV",{class:!0,id:!0});var g=k(t);for(let h=0;h<o.length;h+=1)o[h].l(g);g.forEach(m),s=H(c),f&&f.l(c),c.forEach(m),this.h()},h(){d(t,"class","flex snap-x snap-mandatory overflow-x-auto scrollbar-hidden"),d(t,"id",l="responses-container-"+n[1]+"-"+n[18].id)},m(u,c){V(u,e,c),_(e,t);for(let g=0;g<o.length;g+=1)o[g]&&o[g].m(t,null);_(e,s),f&&f.m(e,null),r=!0},p(u,c){if(c[0]&54132727){i=Ee(Object.keys(u[19]));let g;for(g=0;g<i.length;g+=1){const h=Ls(u,i,g);o[g]?(o[g].p(h,c),b(o[g],1)):(o[g]=zs(h),o[g].c(),b(o[g],1),o[g].m(t,null))}for(le(),g=i.length;g<o.length;g+=1)a(g);se()}(!r||c[0]&262146&&l!==(l="responses-container-"+u[1]+"-"+u[18].id))&&d(t,"id",l),u[4]?f&&(le(),D(f,1,1,()=>{f=null}),se()):f?(f.p(u,c),c[0]&16&&b(f,1)):(f=Ws(u),f.c(),b(f,1),f.m(e,null))},i(u){if(!r){for(let c=0;c<i.length;c+=1)b(o[c]);b(f),r=!0}},o(u){o=o.filter(Boolean);for(let c=0;c<o.length;c+=1)D(o[c]);D(f),r=!1},d(u){u&&m(e),Ue(o,u),f&&f.d()}}}function As(n){let e,t=n[0].currentId,l,s,r,i,o,a=Hs(n);function f(){return n[32](n[39])}return{c(){e=M("div"),a.c(),l=j(),this.h()},l(u){e=N(u,"DIV",{class:!0});var c=k(e);a.l(c),l=H(c),c.forEach(m),this.h()},h(){var u;d(e,"class",s="snap-center w-full max-w-full m-1 border "+(((u=n[0].messages[n[2]])==null?void 0:u.modelIdx)==n[36]?`border-gray-100 dark:border-gray-850 border-[1.5px] ${n[21]?"min-w-full":"min-w-80"}`:`border-gray-100 dark:border-gray-850 border-dashed ${n[21]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl")},m(u,c){V(u,e,c),a.m(e,null),_(e,l),r=!0,i||(o=_e(e,"click",f),i=!0)},p(u,c){var g;n=u,c[0]&1&&Ve(t,t=n[0].currentId)?(le(),D(a,1,1,ve),se(),a=Hs(n),a.c(),b(a,1),a.m(e,l)):a.p(n,c),(!r||c[0]&2621445&&s!==(s="snap-center w-full max-w-full m-1 border "+(((g=n[0].messages[n[2]])==null?void 0:g.modelIdx)==n[36]?`border-gray-100 dark:border-gray-850 border-[1.5px] ${n[21]?"min-w-full":"min-w-80"}`:`border-gray-100 dark:border-gray-850 border-dashed ${n[21]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl"))&&d(e,"class",s)},i(u){r||(b(a),r=!0)},o(u){D(a),r=!1},d(u){u&&m(e),a.d(u),i=!1,o()}}}function js(n){let e,t;function l(){return n[29](n[36])}function s(){return n[30](n[36])}function r(...i){return n[31](n[36],...i)}return e=new Ln({props:{chatId:n[1],history:n[0],messageId:n[39],isLastMessage:!0,siblings:n[19][n[36]].messageIds,showPreviousMessage:l,showNextMessage:s,updateChat:n[5],editMessage:n[6],saveMessage:n[7],rateMessage:n[8],deleteMessage:n[11],actionMessage:n[9],submitMessage:n[10],continueResponse:n[12],regenerateResponse:r,addMessages:n[14],readOnly:n[4]}}),{c(){X(e.$$.fragment)},l(i){Y(e.$$.fragment,i)},m(i,o){$(e,i,o),t=!0},p(i,o){n=i;const a={};o[0]&2&&(a.chatId=n[1]),o[0]&1&&(a.history=n[0]),o[0]&1572864&&(a.messageId=n[39]),o[0]&524288&&(a.siblings=n[19][n[36]].messageIds),o[0]&524288&&(a.showPreviousMessage=l),o[0]&524288&&(a.showNextMessage=s),o[0]&32&&(a.updateChat=n[5]),o[0]&64&&(a.editMessage=n[6]),o[0]&128&&(a.saveMessage=n[7]),o[0]&256&&(a.rateMessage=n[8]),o[0]&2048&&(a.deleteMessage=n[11]),o[0]&512&&(a.actionMessage=n[9]),o[0]&1024&&(a.submitMessage=n[10]),o[0]&4096&&(a.continueResponse=n[12]),o[0]&1581056&&(a.regenerateResponse=r),o[0]&16384&&(a.addMessages=n[14]),o[0]&16&&(a.readOnly=n[4]),e.$set(a)},i(i){t||(b(e.$$.fragment,i),t=!0)},o(i){D(e.$$.fragment,i),t=!1},d(i){x(e,i)}}}function Hs(n){let e,t,l=n[16]&&js(n);return{c(){l&&l.c(),e=fe()},l(s){l&&l.l(s),e=fe()},m(s,r){l&&l.m(s,r),V(s,e,r),t=!0},p(s,r){s[16]?l?(l.p(s,r),r[0]&65536&&b(l,1)):(l=js(s),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(le(),D(l,1,1,()=>{l=null}),se())},i(s){t||(b(l),t=!0)},o(s){D(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function zs(n){let e,t,l=n[20][n[36]]!==void 0&&n[19][n[36]].messageIds.length>0&&As(Ft(n));return{c(){l&&l.c(),e=fe()},l(s){l&&l.l(s),e=fe()},m(s,r){l&&l.m(s,r),V(s,e,r),t=!0},p(s,r){s[20][s[36]]!==void 0&&s[19][s[36]].messageIds.length>0?l?(l.p(Ft(s),r),r[0]&1572864&&b(l,1)):(l=As(Ft(s)),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(le(),D(l,1,1,()=>{l=null}),se())},i(s){t||(b(l),t=!0)},o(s){D(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function Ws(n){let e=!Object.keys(n[19]).find(n[28]),t,l,s=e&&Us(n);return{c(){s&&s.c(),t=fe()},l(r){s&&s.l(r),t=fe()},m(r,i){s&&s.m(r,i),V(r,t,i),l=!0},p(r,i){i[0]&1572865&&(e=!Object.keys(r[19]).find(r[28])),e?s?(s.p(r,i),i[0]&1572865&&b(s,1)):(s=Us(r),s.c(),b(s,1),s.m(t.parentNode,t)):s&&(le(),D(s,1,1,()=>{s=null}),se())},i(r){l||(b(s),l=!0)},o(r){D(s),l=!1},d(r){r&&m(t),s&&s.d(r)}}}function Us(n){var o,a;let e,t,l,s,r=((a=(o=n[0].messages[n[2]])==null?void 0:o.merged)==null?void 0:a.status)&&qs(qt(n)),i=n[3]&&Js(n);return{c(){e=M("div"),t=M("div"),r&&r.c(),l=j(),i&&i.c(),this.h()},l(f){e=N(f,"DIV",{class:!0});var u=k(e);t=N(u,"DIV",{class:!0});var c=k(t);r&&r.l(c),c.forEach(m),l=H(u),i&&i.l(u),u.forEach(m),this.h()},h(){d(t,"class","w-full"),d(e,"class","flex justify-end")},m(f,u){V(f,e,u),_(e,t),r&&r.m(t,null),_(e,l),i&&i.m(e,null),s=!0},p(f,u){var c,g;(g=(c=f[0].messages[f[2]])==null?void 0:c.merged)!=null&&g.status?r?(r.p(qt(f),u),u[0]&5&&b(r,1)):(r=qs(qt(f)),r.c(),b(r,1),r.m(t,null)):r&&(le(),D(r,1,1,()=>{r=null}),se()),f[3]?i?(i.p(f,u),u[0]&8&&b(i,1)):(i=Js(f),i.c(),b(i,1),i.m(e,null)):i&&(le(),D(i,1,1,()=>{i=null}),se())},i(f){s||(b(r),b(i),s=!0)},o(f){D(r),D(i),s=!1},d(f){f&&m(e),r&&r.d(),i&&i.d()}}}function qs(n){let e,t,l,s,r,i,o;t=new Kt({props:{$$slots:{default:[oa]},$$scope:{ctx:n}}});const a=[fa,aa],f=[];function u(c,g){var h;return(((h=c[16])==null?void 0:h.content)??"")===""?0:1}return r=u(n),i=f[r]=a[r](n),{c(){e=M("div"),X(t.$$.fragment),l=j(),s=M("div"),i.c(),this.h()},l(c){e=N(c,"DIV",{class:!0});var g=k(e);Y(t.$$.fragment,g),l=H(g),s=N(g,"DIV",{class:!0});var h=k(s);i.l(h),h.forEach(m),g.forEach(m),this.h()},h(){d(s,"class","mt-1 markdown-prose w-full min-w-full"),d(e,"class","w-full rounded-xl pl-5 pr-2 py-2")},m(c,g){V(c,e,g),$(t,e,null),_(e,l),_(e,s),f[r].m(s,null),o=!0},p(c,g){const h={};g[0]&5|g[1]&512&&(h.$$scope={dirty:g,ctx:c}),t.$set(h);let p=r;r=u(c),r===p?f[r].p(c,g):(le(),D(f[p],1,1,()=>{f[p]=null}),se(),i=f[r],i?i.p(c,g):(i=f[r]=a[r](c),i.c()),b(i,1),i.m(s,null))},i(c){o||(b(t.$$.fragment,c),b(i),o=!0)},o(c){D(t.$$.fragment,c),D(i),o=!1},d(c){c&&m(e),x(t),f[r].d()}}}function Fs(n){let e,t=it(n[16].timestamp*1e3).format("LT")+"",l;return{c(){e=M("span"),l=U(t),this.h()},l(s){e=N(s,"SPAN",{class:!0});var r=k(e);l=q(r,t),r.forEach(m),this.h()},h(){d(e,"class","self-center invisible group-hover:visible text-gray-400 text-xs font-medium uppercase ml-0.5 -mt-0.5")},m(s,r){V(s,e,r),_(e,l)},p(s,r){r[0]&5&&t!==(t=it(s[16].timestamp*1e3).format("LT")+"")&&K(l,t)},d(s){s&&m(e)}}}function oa(n){let e,t,l=n[16].timestamp&&Fs(n);return{c(){e=U(`Merged Response

									`),l&&l.c(),t=fe()},l(s){e=q(s,`Merged Response

									`),l&&l.l(s),t=fe()},m(s,r){V(s,e,r),l&&l.m(s,r),V(s,t,r)},p(s,r){s[16].timestamp?l?l.p(s,r):(l=Fs(s),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null)},d(s){s&&(m(e),m(t)),l&&l.d(s)}}}function aa(n){let e,t;return e=new yt({props:{id:"merged",content:n[16].content??""}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&5&&(r.content=l[16].content??""),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function fa(n){let e,t;return e=new Xt({}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Js(n){let e,t,l;return t=new Re({props:{content:n[22].t("Merge Responses"),placement:"bottom",$$slots:{default:[ua]},$$scope:{ctx:n}}}),{c(){e=M("div"),X(t.$$.fragment),this.h()},l(s){e=N(s,"DIV",{class:!0});var r=k(e);Y(t.$$.fragment,r),r.forEach(m),this.h()},h(){d(e,"class","shrink-0 text-gray-600 dark:text-gray-500 mt-1")},m(s,r){V(s,e,r),$(t,e,null),l=!0},p(s,r){const i={};r[0]&4194304&&(i.content=s[22].t("Merge Responses")),r[1]&512&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),x(t)}}}function ua(n){let e,t,l,s,r;return t=new ia({props:{className:" size-5 "}}),{c(){e=M("button"),X(t.$$.fragment),this.h()},l(i){e=N(i,"BUTTON",{type:!0,id:!0,class:!0});var o=k(e);Y(t.$$.fragment,o),o.forEach(m),this.h()},h(){d(e,"type","button"),d(e,"id","merge-response-button"),d(e,"class","visible p-1 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(i,o){V(i,e,o),$(t,e,null),l=!0,s||(r=_e(e,"click",n[33]),s=!0)},p:ve,i(i){l||(b(t.$$.fragment,i),l=!0)},o(i){D(t.$$.fragment,i),l=!1},d(i){i&&m(e),x(t),s=!1,r()}}}function ca(n){let e,t,l=n[18]&&Ps(n);return{c(){l&&l.c(),e=fe()},l(s){l&&l.l(s),e=fe()},m(s,r){l&&l.m(s,r),V(s,e,r),t=!0},p(s,r){s[18]?l?(l.p(s,r),r[0]&262144&&b(l,1)):(l=Ps(s),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(le(),D(l,1,1,()=>{l=null}),se())},i(s){t||(b(l),t=!0)},o(s){D(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function da(n,e,t){let l,s;Ie(n,En,z=>t(21,l=z));const r=qe("i18n");Ie(n,r,z=>t(22,s=z)),it.extend(Dn);let{chatId:i}=e,{history:o}=e,{messageId:a}=e,{isLastMessage:f}=e,{readOnly:u=!1}=e,{updateChat:c}=e,{editMessage:g}=e,{saveMessage:h}=e,{rateMessage:p}=e,{actionMessage:w}=e,{submitMessage:v}=e,{deleteMessage:E}=e,{continueResponse:y}=e,{regenerateResponse:B}=e,{mergeResponses:L}=e,{addMessages:T}=e,{triggerScroll:I}=e;gt();let R,O,C={},P={},S=JSON.parse(JSON.stringify(o.messages[a]));const W=async z=>{t(20,P[z]=Math.max(0,P[z]-1),P);let ae=C[z].messageIds[P[z]];console.log(ae);let re=o.messages[ae].childrenIds;for(;re.length!==0;)ae=re.at(-1),re=o.messages[ae].childrenIds;t(0,o.currentId=ae,o),await Ne(),await c(),I()},ne=async z=>{t(20,P[z]=Math.min(C[z].messageIds.length-1,P[z]+1),P);let ae=C[z].messageIds[P[z]];console.log(ae);let re=o.messages[ae].childrenIds;for(;re.length!==0;)ae=re.at(-1),re=o.messages[ae].childrenIds;t(0,o.currentId=ae,o),await Ne(),await c(),I()},ue=async()=>{console.log("multiresponse:initHandler"),await Ne(),t(17,R=a),t(18,O=o.messages[a].parentId?o.messages[o.messages[a].parentId]:null),t(19,C=O==null?void 0:O.models.reduce((z,ae,re)=>{let pe=O==null?void 0:O.childrenIds.map(ye=>o.messages[ye]).filter(ye=>(ye==null?void 0:ye.modelIdx)===re).map(ye=>ye.id);if(pe.length===0){let ye=O==null?void 0:O.childrenIds.map(A=>o.messages[A]).filter(A=>(A==null?void 0:A.model)===ae);ye.forEach(A=>{A.modelIdx=re}),pe=ye.map(A=>A.id)}return{...z,[re]:{messageIds:pe}}},{})),t(20,P=O==null?void 0:O.models.reduce((z,ae,re)=>{const pe=C[re].messageIds.findIndex(ye=>ye===a);return pe!==-1?{...z,[re]:pe}:{...z,[re]:C[re].messageIds.length-1}},{})),console.log(C,P),await Ne()},te=async()=>{const z=Object.keys(C).map(ae=>{const{messageIds:re}=C[ae],pe=re[P[ae]];return o.messages[pe].content});L(a,z,i)};bt(async()=>{await ue(),await Ne();const z=document.getElementById(`message-${a}`);z&&z.scrollIntoView({block:"start"})});const ie=z=>{var pe;const{messageIds:ae}=C[z],re=ae[P[z]];return!((pe=o.messages[re])!=null&&pe.done)},G=z=>W(z),Q=z=>ne(z),he=async(z,ae)=>{B(ae),await Ne(),t(20,P[z]=C[z].messageIds.length-1,P)},de=async z=>{if(a!=z){let ae=z,re=o.messages[ae].childrenIds;for(;re.length!==0;)ae=re.at(-1),re=o.messages[ae].childrenIds;t(0,o.currentId=ae,o),await Ne(),await c(),I()}},Z=()=>{te()};return n.$$set=z=>{"chatId"in z&&t(1,i=z.chatId),"history"in z&&t(0,o=z.history),"messageId"in z&&t(2,a=z.messageId),"isLastMessage"in z&&t(3,f=z.isLastMessage),"readOnly"in z&&t(4,u=z.readOnly),"updateChat"in z&&t(5,c=z.updateChat),"editMessage"in z&&t(6,g=z.editMessage),"saveMessage"in z&&t(7,h=z.saveMessage),"rateMessage"in z&&t(8,p=z.rateMessage),"actionMessage"in z&&t(9,w=z.actionMessage),"submitMessage"in z&&t(10,v=z.submitMessage),"deleteMessage"in z&&t(11,E=z.deleteMessage),"continueResponse"in z&&t(12,y=z.continueResponse),"regenerateResponse"in z&&t(13,B=z.regenerateResponse),"mergeResponses"in z&&t(27,L=z.mergeResponses),"addMessages"in z&&t(14,T=z.addMessages),"triggerScroll"in z&&t(15,I=z.triggerScroll)},n.$$.update=()=>{n.$$.dirty[0]&65541&&o.messages&&JSON.stringify(S)!==JSON.stringify(o.messages[a])&&t(16,S=JSON.parse(JSON.stringify(o.messages[a])))},[o,i,a,f,u,c,g,h,p,w,v,E,y,B,T,I,S,R,O,C,P,l,s,r,W,ne,te,L,ie,G,Q,he,de,Z]}class ha extends Te{constructor(e){super(),Be(this,e,da,ca,Ve,{chatId:1,history:0,messageId:2,isLastMessage:3,readOnly:4,updateChat:5,editMessage:6,saveMessage:7,rateMessage:8,actionMessage:9,submitMessage:10,deleteMessage:11,continueResponse:12,regenerateResponse:13,mergeResponses:27,addMessages:14,triggerScroll:15},null,[-1,-1])}}function Gs(n,e,t){const l=n.slice();return l[41]=e[t],l}function Zs(n){var r,i,o,a;let e,t,l,s;return t=new Vn({props:{src:n[6].user?((o=(i=(r=n[13].find(n[27]))==null?void 0:r.info)==null?void 0:i.meta)==null?void 0:o.profile_image_url)??"/user.png":((a=n[0])==null?void 0:a.profile_image_url)??"/user.png",className:"size-8"}}),{c(){e=M("div"),X(t.$$.fragment),this.h()},l(f){e=N(f,"DIV",{class:!0});var u=k(e);Y(t.$$.fragment,u),u.forEach(m),this.h()},h(){var f;d(e,"class",l=`shrink-0 ${(((f=n[12])==null?void 0:f.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`)},m(f,u){V(f,e,u),$(t,e,null),s=!0},p(f,u){var g,h,p,w,v;const c={};u[0]&8257&&(c.src=f[6].user?((p=(h=(g=f[13].find(f[27]))==null?void 0:g.info)==null?void 0:h.meta)==null?void 0:p.profile_image_url)??"/user.png":((w=f[0])==null?void 0:w.profile_image_url)??"/user.png"),t.$set(c),(!s||u[0]&4096&&l!==(l=`shrink-0 ${(((v=f[12])==null?void 0:v.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`))&&d(e,"class",l)},i(f){s||(b(t.$$.fragment,f),s=!0)},o(f){D(t.$$.fragment,f),s=!1},d(f){f&&m(e),x(t)}}}function Ks(n){let e,t,l;return t=new Kt({props:{$$slots:{default:[pa]},$$scope:{ctx:n}}}),{c(){e=M("div"),X(t.$$.fragment)},l(s){e=N(s,"DIV",{});var r=k(e);Y(t.$$.fragment,r),r.forEach(m)},m(s,r){V(s,e,r),$(t,e,null),l=!0},p(s,r){const i={};r[0]&22593|r[1]&8192&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),x(t)}}}function ma(n){let e=n[11].t("You")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&2048&&e!==(e=l[11].t("You")+"")&&K(t,e)},d(l){l&&m(t)}}}function ga(n){let e=n[0].name+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&1&&e!==(e=l[0].name+"")&&K(t,e)},d(l){l&&m(t)}}}function _a(n){var o;let e=n[11].t("You")+"",t,l,s,r=(((o=n[6])==null?void 0:o.user)??"")+"",i;return{c(){t=U(e),l=j(),s=M("span"),i=U(r),this.h()},l(a){t=q(a,e),l=H(a),s=N(a,"SPAN",{class:!0});var f=k(s);i=q(f,r),f.forEach(m),this.h()},h(){d(s,"class","text-gray-500 text-sm font-medium")},m(a,f){V(a,t,f),V(a,l,f),V(a,s,f),_(s,i)},p(a,f){var u;f[0]&2048&&e!==(e=a[11].t("You")+"")&&K(t,e),f[0]&64&&r!==(r=(((u=a[6])==null?void 0:u.user)??"")+"")&&K(i,r)},d(a){a&&(m(t),m(l),m(s))}}}function Qs(n){let e,t,l;return t=new Re({props:{content:it(n[6].timestamp*1e3).format("LLLL"),$$slots:{default:[va]},$$scope:{ctx:n}}}),{c(){e=M("div"),X(t.$$.fragment),this.h()},l(s){e=N(s,"DIV",{class:!0});var r=k(e);Y(t.$$.fragment,r),r.forEach(m),this.h()},h(){d(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,r){V(s,e,r),$(t,e,null),l=!0},p(s,r){const i={};r[0]&64&&(i.content=it(s[6].timestamp*1e3).format("LLLL")),r[0]&64|r[1]&8192&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),x(t)}}}function va(n){let e,t=Pt(n[6].timestamp*1e3)+"",l;return{c(){e=M("span"),l=U(t),this.h()},l(s){e=N(s,"SPAN",{class:!0});var r=k(e);l=q(r,t),r.forEach(m),this.h()},h(){d(e,"class","line-clamp-1")},m(s,r){V(s,e,r),_(e,l)},p(s,r){r[0]&64&&t!==(t=Pt(s[6].timestamp*1e3)+"")&&K(l,t)},d(s){s&&m(e)}}}function pa(n){let e,t,l;function s(a,f){return a[6].user?_a:a[12].showUsername||a[14].name!==a[0].name?ga:ma}let r=s(n),i=r(n),o=n[6].timestamp&&Qs(n);return{c(){i.c(),e=j(),o&&o.c(),t=fe()},l(a){i.l(a),e=H(a),o&&o.l(a),t=fe()},m(a,f){i.m(a,f),V(a,e,f),o&&o.m(a,f),V(a,t,f),l=!0},p(a,f){r===(r=s(a))&&i?i.p(a,f):(i.d(1),i=r(a),i&&(i.c(),i.m(e.parentNode,e))),a[6].timestamp?o?(o.p(a,f),f[0]&64&&b(o,1)):(o=Qs(a),o.c(),b(o,1),o.m(t.parentNode,t)):o&&(le(),D(o,1,1,()=>{o=null}),se())},i(a){l||(b(o),l=!0)},o(a){D(o),l=!1},d(a){a&&(m(e),m(t)),i.d(a),o&&o.d(a)}}}function Xs(n){let e,t,l=Ee(n[6].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=Ys(Gs(n,l,i));const r=i=>D(s[i],1,1,()=>{s[i]=null});return{c(){e=M("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=N(i,"DIV",{class:!0});var o=k(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),this.h()},h(){d(e,"class","mt-2.5 mb-1 w-full flex flex-col justify-end overflow-x-auto gap-1 flex-wrap")},m(i,o){V(i,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(i,o){if(o[0]&4160){l=Ee(i[6].files);let a;for(a=0;a<l.length;a+=1){const f=Gs(i,l,a);s[a]?(s[a].p(f,o),b(s[a],1)):(s[a]=Ys(f),s[a].c(),b(s[a],1),s[a].m(e,null))}for(le(),a=l.length;a<s.length;a+=1)r(a);se()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)b(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)D(s[o]);t=!1},d(i){i&&m(e),Ue(s,i)}}}function ba(n){var l;let e,t;return e=new yr({props:{item:n[41],url:n[41].url,name:n[41].name,type:n[41].type,size:(l=n[41])==null?void 0:l.size,colorClassName:"bg-white dark:bg-gray-850 "}}),{c(){X(e.$$.fragment)},l(s){Y(e.$$.fragment,s)},m(s,r){$(e,s,r),t=!0},p(s,r){var o;const i={};r[0]&64&&(i.item=s[41]),r[0]&64&&(i.url=s[41].url),r[0]&64&&(i.name=s[41].name),r[0]&64&&(i.type=s[41].type),r[0]&64&&(i.size=(o=s[41])==null?void 0:o.size),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){x(e,s)}}}function ka(n){let e,t;return e=new Cn({props:{src:n[41].url,imageClassName:" max-h-96 rounded-lg"}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&64&&(r.src=l[41].url),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ys(n){let e,t,l,s,r,i;const o=[ka,ba],a=[];function f(u,c){return u[41].type==="image"?0:1}return t=f(n),l=a[t]=o[t](n),{c(){e=M("div"),l.c(),s=j(),this.h()},l(u){e=N(u,"DIV",{class:!0});var c=k(e);l.l(c),s=H(c),c.forEach(m),this.h()},h(){var u;d(e,"class",r=((u=n[12])==null?void 0:u.chatBubble)??!0?"self-end":"")},m(u,c){V(u,e,c),a[t].m(e,null),_(e,s),i=!0},p(u,c){var h;let g=t;t=f(u),t===g?a[t].p(u,c):(le(),D(a[g],1,1,()=>{a[g]=null}),se(),l=a[t],l?l.p(u,c):(l=a[t]=o[t](u),l.c()),b(l,1),l.m(e,s)),(!i||c[0]&4096&&r!==(r=((h=u[12])==null?void 0:h.chatBubble)??!0?"self-end":""))&&d(e,"class",r)},i(u){i||(b(l),i=!0)},o(u){D(l),i=!1},d(u){u&&m(e),a[t].d()}}}function $s(n){let e,t,l,s;const r=[ya,wa],i=[];function o(a,f){return a[8]===!0?0:1}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=fe()},l(a){t.l(a),l=fe()},m(a,f){i[e].m(a,f),V(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(le(),D(i[u],1,1,()=>{i[u]=null}),se(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){s||(b(t),s=!0)},o(a){D(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function wa(n){var L,T;let e,t,l,s,r,i,o,a,f,u,c,g,h,p,w=n[6].content&&xs(n),v=!(((L=n[12])==null?void 0:L.chatBubble)??!0)&&en(n),E=!n[5]&&ln(n);u=new Re({props:{content:n[11].t("Copy"),placement:"bottom",$$slots:{default:[Ea]},$$scope:{ctx:n}}});let y=!n[4]&&!n[5]&&sn(n),B=(((T=n[12])==null?void 0:T.chatBubble)??!0)&&nn(n);return{c(){e=M("div"),t=M("div"),l=M("div"),w&&w.c(),i=j(),o=M("div"),v&&v.c(),a=j(),E&&E.c(),f=j(),X(u.$$.fragment),c=j(),y&&y.c(),g=j(),B&&B.c(),this.h()},l(I){e=N(I,"DIV",{class:!0});var R=k(e);t=N(R,"DIV",{class:!0});var O=k(t);l=N(O,"DIV",{class:!0});var C=k(l);w&&w.l(C),C.forEach(m),O.forEach(m),i=H(R),o=N(R,"DIV",{class:!0});var P=k(o);v&&v.l(P),a=H(P),E&&E.l(P),f=H(P),Y(u.$$.fragment,P),c=H(P),y&&y.l(P),g=H(P),B&&B.l(P),P.forEach(m),R.forEach(m),this.h()},h(){var I,R,O;d(l,"class",s="rounded-3xl "+(((I=n[12])==null?void 0:I.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${n[6].files?"rounded-tr-lg":""}`:" w-full")),d(t,"class",r="flex "+(((R=n[12])==null?void 0:R.chatBubble)??!0?"justify-end pb-1":"w-full")),d(o,"class",h="flex "+(((O=n[12])==null?void 0:O.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"),d(e,"class","w-full")},m(I,R){V(I,e,R),_(e,t),_(t,l),w&&w.m(l,null),_(e,i),_(e,o),v&&v.m(o,null),_(o,a),E&&E.m(o,null),_(o,f),$(u,o,null),_(o,c),y&&y.m(o,null),_(o,g),B&&B.m(o,null),p=!0},p(I,R){var C,P,S,W,ne;I[6].content?w?(w.p(I,R),R[0]&64&&b(w,1)):(w=xs(I),w.c(),b(w,1),w.m(l,null)):w&&(le(),D(w,1,1,()=>{w=null}),se()),(!p||R[0]&4160&&s!==(s="rounded-3xl "+(((C=I[12])==null?void 0:C.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${I[6].files?"rounded-tr-lg":""}`:" w-full")))&&d(l,"class",s),(!p||R[0]&4096&&r!==(r="flex "+(((P=I[12])==null?void 0:P.chatBubble)??!0?"justify-end pb-1":"w-full")))&&d(t,"class",r),((S=I[12])==null?void 0:S.chatBubble)??!0?v&&(v.d(1),v=null):v?v.p(I,R):(v=en(I),v.c(),v.m(o,a)),I[5]?E&&(le(),D(E,1,1,()=>{E=null}),se()):E?(E.p(I,R),R[0]&32&&b(E,1)):(E=ln(I),E.c(),b(E,1),E.m(o,f));const O={};R[0]&2048&&(O.content=I[11].t("Copy")),R[0]&64|R[1]&8192&&(O.$$scope={dirty:R,ctx:I}),u.$set(O),!I[4]&&!I[5]?y?(y.p(I,R),R[0]&48&&b(y,1)):(y=sn(I),y.c(),b(y,1),y.m(o,g)):y&&(le(),D(y,1,1,()=>{y=null}),se()),((W=I[12])==null?void 0:W.chatBubble)??!0?B?B.p(I,R):(B=nn(I),B.c(),B.m(o,null)):B&&(B.d(1),B=null),(!p||R[0]&4096&&h!==(h="flex "+(((ne=I[12])==null?void 0:ne.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"))&&d(o,"class",h)},i(I){p||(b(w),b(E),b(u.$$.fragment,I),b(y),p=!0)},o(I){D(w),D(E),D(u.$$.fragment,I),D(y),p=!1},d(I){I&&m(e),w&&w.d(),v&&v.d(),E&&E.d(),x(u),y&&y.d(),B&&B.d()}}}function ya(n){let e,t,l,s,r,i,o,a,f=n[11].t("Save")+"",u,c,g,h,p=n[11].t("Cancel")+"",w,v,E,y=n[11].t("Send")+"",B,L,T;return{c(){e=M("div"),t=M("div"),l=M("textarea"),r=j(),i=M("div"),o=M("div"),a=M("button"),u=U(f),c=j(),g=M("div"),h=M("button"),w=U(p),v=j(),E=M("button"),B=U(y),this.h()},l(I){e=N(I,"DIV",{class:!0});var R=k(e);t=N(R,"DIV",{class:!0});var O=k(t);l=N(O,"TEXTAREA",{id:!0,class:!0}),k(l).forEach(m),O.forEach(m),r=H(R),i=N(R,"DIV",{class:!0});var C=k(i);o=N(C,"DIV",{});var P=k(o);a=N(P,"BUTTON",{id:!0,class:!0});var S=k(a);u=q(S,f),S.forEach(m),P.forEach(m),c=H(C),g=N(C,"DIV",{class:!0});var W=k(g);h=N(W,"BUTTON",{id:!0,class:!0});var ne=k(h);w=q(ne,p),ne.forEach(m),v=H(W),E=N(W,"BUTTON",{id:!0,class:!0});var ue=k(E);B=q(ue,y),ue.forEach(m),W.forEach(m),C.forEach(m),R.forEach(m),this.h()},h(){d(l,"id",s="message-edit-"+n[6].id),d(l,"class","bg-transparent outline-hidden w-full resize-none"),d(t,"class","max-h-96 overflow-auto"),d(a,"id","save-edit-message-button"),d(a,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),d(h,"id","close-edit-message-button"),d(h,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),d(E,"id","confirm-edit-message-button"),d(E,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),d(g,"class","flex space-x-1.5"),d(i,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),d(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 mb-2")},m(I,R){V(I,e,R),_(e,t),_(t,l),n[28](l),rt(l,n[9]),_(e,r),_(e,i),_(i,o),_(o,a),_(a,u),_(i,c),_(i,g),_(g,h),_(h,w),_(g,v),_(g,E),_(E,B),L||(T=[_e(l,"input",n[29]),_e(l,"input",Da),_e(l,"keydown",n[30]),_e(a,"click",n[31]),_e(h,"click",n[32]),_e(E,"click",n[33])],L=!0)},p(I,R){R[0]&64&&s!==(s="message-edit-"+I[6].id)&&d(l,"id",s),R[0]&512&&rt(l,I[9]),R[0]&2048&&f!==(f=I[11].t("Save")+"")&&K(u,f),R[0]&2048&&p!==(p=I[11].t("Cancel")+"")&&K(w,p),R[0]&2048&&y!==(y=I[11].t("Send")+"")&&K(B,y)},i:ve,o:ve,d(I){I&&m(e),n[28](null),L=!1,et(T)}}}function xs(n){let e,t;return e=new yt({props:{id:n[6].id,content:n[6].content}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&64&&(r.id=l[6].id),s[0]&64&&(r.content=l[6].content),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function en(n){let e,t=n[1].length>1&&tn(n);return{c(){t&&t.c(),e=fe()},l(l){t&&t.l(l),e=fe()},m(l,s){t&&t.m(l,s),V(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=tn(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&m(e),t&&t.d(l)}}}function tn(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i=n[1].indexOf(n[6].id)+1+"",o,a,f=n[1].length+"",u,c,g,h='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',p,w;return{c(){e=M("div"),t=M("button"),t.innerHTML=l,s=j(),r=M("div"),o=U(i),a=U("/"),u=U(f),c=j(),g=M("button"),g.innerHTML=h,this.h()},l(v){e=N(v,"DIV",{class:!0,dir:!0});var E=k(e);t=N(E,"BUTTON",{class:!0,"data-svelte-h":!0}),Ae(t)!=="svelte-buado9"&&(t.innerHTML=l),s=H(E),r=N(E,"DIV",{class:!0});var y=k(r);o=q(y,i),a=q(y,"/"),u=q(y,f),y.forEach(m),c=H(E),g=N(E,"BUTTON",{class:!0,"data-svelte-h":!0}),Ae(g)!=="svelte-4phel2"&&(g.innerHTML=h),E.forEach(m),this.h()},h(){d(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(r,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100"),d(g,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(e,"class","flex self-center"),d(e,"dir","ltr")},m(v,E){V(v,e,E),_(e,t),_(e,s),_(e,r),_(r,o),_(r,a),_(r,u),_(e,c),_(e,g),p||(w=[_e(t,"click",n[34]),_e(g,"click",n[35])],p=!0)},p(v,E){E[0]&66&&i!==(i=v[1].indexOf(v[6].id)+1+"")&&K(o,i),E[0]&2&&f!==(f=v[1].length+"")&&K(u,f)},d(v){v&&m(e),p=!1,et(w)}}}function ln(n){let e,t;return e=new Re({props:{content:n[11].t("Edit"),placement:"bottom",$$slots:{default:[Ia]},$$scope:{ctx:n}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&2048&&(r.content=l[11].t("Edit")),s[1]&8192&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ia(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"></path></svg>',l,s;return{c(){e=M("button"),e.innerHTML=t,this.h()},l(r){e=N(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Ae(e)!=="svelte-tlrz1q"&&(e.innerHTML=t),this.h()},h(){d(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition edit-user-message-button")},m(r,i){V(r,e,i),l||(s=_e(e,"click",n[36]),l=!0)},p:ve,d(r){r&&m(e),l=!1,s()}}}function Ea(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"></path></svg>',l,s;return{c(){e=M("button"),e.innerHTML=t,this.h()},l(r){e=N(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Ae(e)!=="svelte-1ivgdx2"&&(e.innerHTML=t),this.h()},h(){d(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(r,i){V(r,e,i),l||(s=_e(e,"click",n[37]),l=!0)},p:ve,d(r){r&&m(e),l=!1,s()}}}function sn(n){let e,t;return e=new Re({props:{content:n[11].t("Delete"),placement:"bottom",$$slots:{default:[Ma]},$$scope:{ctx:n}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&2048&&(r.content=l[11].t("Delete")),s[0]&128|s[1]&8192&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ma(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path></svg>',l,s;return{c(){e=M("button"),e.innerHTML=t,this.h()},l(r){e=N(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Ae(e)!=="svelte-146x2zz"&&(e.innerHTML=t),this.h()},h(){d(e,"class","invisible group-hover:visible p-1 rounded-sm dark:hover:text-white hover:text-black transition")},m(r,i){V(r,e,i),l||(s=_e(e,"click",n[38]),l=!0)},p:ve,d(r){r&&m(e),l=!1,s()}}}function nn(n){let e,t=n[1].length>1&&rn(n);return{c(){t&&t.c(),e=fe()},l(l){t&&t.l(l),e=fe()},m(l,s){t&&t.m(l,s),V(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=rn(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&m(e),t&&t.d(l)}}}function rn(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i=n[1].indexOf(n[6].id)+1+"",o,a,f=n[1].length+"",u,c,g,h='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',p,w;return{c(){e=M("div"),t=M("button"),t.innerHTML=l,s=j(),r=M("div"),o=U(i),a=U("/"),u=U(f),c=j(),g=M("button"),g.innerHTML=h,this.h()},l(v){e=N(v,"DIV",{class:!0,dir:!0});var E=k(e);t=N(E,"BUTTON",{class:!0,"data-svelte-h":!0}),Ae(t)!=="svelte-buado9"&&(t.innerHTML=l),s=H(E),r=N(E,"DIV",{class:!0});var y=k(r);o=q(y,i),a=q(y,"/"),u=q(y,f),y.forEach(m),c=H(E),g=N(E,"BUTTON",{class:!0,"data-svelte-h":!0}),Ae(g)!=="svelte-4phel2"&&(g.innerHTML=h),E.forEach(m),this.h()},h(){d(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(r,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100"),d(g,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(e,"class","flex self-center"),d(e,"dir","ltr")},m(v,E){V(v,e,E),_(e,t),_(e,s),_(e,r),_(r,o),_(r,a),_(r,u),_(e,c),_(e,g),p||(w=[_e(t,"click",n[39]),_e(g,"click",n[40])],p=!0)},p(v,E){E[0]&66&&i!==(i=v[1].indexOf(v[6].id)+1+"")&&K(o,i),E[0]&2&&f!==(f=v[1].length+"")&&K(u,f)},d(v){v&&m(e),p=!1,et(w)}}}function Na(n){var L,T;let e,t,l,s,r,i,o,a,f,u,c,g,h;function p(I){n[25](I)}let w={title:n[11].t("Delete message?")};n[7]!==void 0&&(w.show=n[7]),e=new Sn({props:w}),je.push(()=>Ke(e,"show",p)),e.$on("confirm",n[26]);let v=!(((L=n[12])==null?void 0:L.chatBubble)??!0)&&Zs(n),E=!(((T=n[12])==null?void 0:T.chatBubble)??!0)&&Ks(n),y=n[6].files&&Xs(n),B=n[6].content!==""&&$s(n);return{c(){X(e.$$.fragment),l=j(),s=M("div"),v&&v.c(),r=j(),i=M("div"),E&&E.c(),o=j(),a=M("div"),y&&y.c(),f=j(),B&&B.c(),this.h()},l(I){Y(e.$$.fragment,I),l=H(I),s=N(I,"DIV",{class:!0,dir:!0,id:!0});var R=k(s);v&&v.l(R),r=H(R),i=N(R,"DIV",{class:!0});var O=k(i);E&&E.l(O),o=H(O),a=N(O,"DIV",{class:!0});var C=k(a);y&&y.l(C),f=H(C),B&&B.l(C),C.forEach(m),O.forEach(m),R.forEach(m),this.h()},h(){d(a,"class",u="chat-"+n[6].role+" w-full min-w-full markdown-prose"),d(i,"class","flex-auto w-0 max-w-full pl-1"),d(s,"class","flex w-full user-message"),d(s,"dir",c=n[12].chatDirection),d(s,"id",g="message-"+n[6].id)},m(I,R){$(e,I,R),V(I,l,R),V(I,s,R),v&&v.m(s,null),_(s,r),_(s,i),E&&E.m(i,null),_(i,o),_(i,a),y&&y.m(a,null),_(a,f),B&&B.m(a,null),h=!0},p(I,R){var C,P;const O={};R[0]&2048&&(O.title=I[11].t("Delete message?")),!t&&R[0]&128&&(t=!0,O.show=I[7],Ze(()=>t=!1)),e.$set(O),((C=I[12])==null?void 0:C.chatBubble)??!0?v&&(le(),D(v,1,1,()=>{v=null}),se()):v?(v.p(I,R),R[0]&4096&&b(v,1)):(v=Zs(I),v.c(),b(v,1),v.m(s,r)),((P=I[12])==null?void 0:P.chatBubble)??!0?E&&(le(),D(E,1,1,()=>{E=null}),se()):E?(E.p(I,R),R[0]&4096&&b(E,1)):(E=Ks(I),E.c(),b(E,1),E.m(i,o)),I[6].files?y?(y.p(I,R),R[0]&64&&b(y,1)):(y=Xs(I),y.c(),b(y,1),y.m(a,f)):y&&(le(),D(y,1,1,()=>{y=null}),se()),I[6].content!==""?B?(B.p(I,R),R[0]&64&&b(B,1)):(B=$s(I),B.c(),b(B,1),B.m(a,null)):B&&(le(),D(B,1,1,()=>{B=null}),se()),(!h||R[0]&64&&u!==(u="chat-"+I[6].role+" w-full min-w-full markdown-prose"))&&d(a,"class",u),(!h||R[0]&4096&&c!==(c=I[12].chatDirection))&&d(s,"dir",c),(!h||R[0]&64&&g!==(g="message-"+I[6].id))&&d(s,"id",g)},i(I){h||(b(e.$$.fragment,I),b(v),b(E),b(y),b(B),h=!0)},o(I){D(e.$$.fragment,I),D(v),D(E),D(y),D(B),h=!1},d(I){I&&(m(l),m(s)),x(e,I),v&&v.d(),E&&E.d(),y&&y.d(),B&&B.d()}}}const Da=n=>{n.target.style.height="",n.target.style.height=`${n.target.scrollHeight}px`};function Va(n,e,t){let l,s,r,i;Ie(n,Ht,F=>t(12,s=F)),Ie(n,jt,F=>t(13,r=F)),Ie(n,zt,F=>t(14,i=F));const o=qe("i18n");Ie(n,o,F=>t(11,l=F)),it.extend(Dn);let{user:a}=e,{history:f}=e,{messageId:u}=e,{siblings:c}=e,{showPreviousMessage:g}=e,{showNextMessage:h}=e,{editMessage:p}=e,{deleteMessage:w}=e,{isFirstMessage:v}=e,{readOnly:E}=e,y=!1,B=!1,L="",T,I=JSON.parse(JSON.stringify(f.messages[u]));const R=async F=>{await Nn(F)&&Pe.success(l.t("Copying to clipboard was successful!"))},O=async()=>{t(8,B=!0),t(9,L=I.content),await Ne(),t(10,T.style.height="",T),t(10,T.style.height=`${T.scrollHeight}px`,T),T==null||T.focus()},C=async(F=!0)=>{p(I.id,L,F),t(8,B=!1),t(9,L="")},P=()=>{t(8,B=!1),t(9,L="")},S=async()=>{w(I.id)};bt(()=>{});function W(F){y=F,t(7,y)}const ne=()=>{S()},ue=F=>F.id===I.user;function te(F){je[F?"unshift":"push"](()=>{T=F,t(10,T)})}function ie(){L=this.value,t(9,L)}const G=F=>{var ce,ee;F.key==="Escape"&&((ce=document.getElementById("close-edit-message-button"))==null||ce.click());const oe=F.metaKey||F.ctrlKey,me=F.key==="Enter";oe&&me&&((ee=document.getElementById("confirm-edit-message-button"))==null||ee.click())},Q=()=>{C(!1)},he=()=>{P()},de=()=>{C()},Z=()=>{g(I)},z=()=>{h(I)},ae=()=>{O()},re=()=>{R(I.content)},pe=()=>{t(7,y=!0)},ye=()=>{g(I)},A=()=>{h(I)};return n.$$set=F=>{"user"in F&&t(0,a=F.user),"history"in F&&t(21,f=F.history),"messageId"in F&&t(22,u=F.messageId),"siblings"in F&&t(1,c=F.siblings),"showPreviousMessage"in F&&t(2,g=F.showPreviousMessage),"showNextMessage"in F&&t(3,h=F.showNextMessage),"editMessage"in F&&t(23,p=F.editMessage),"deleteMessage"in F&&t(24,w=F.deleteMessage),"isFirstMessage"in F&&t(4,v=F.isFirstMessage),"readOnly"in F&&t(5,E=F.readOnly)},n.$$.update=()=>{n.$$.dirty[0]&6291520&&f.messages&&JSON.stringify(I)!==JSON.stringify(f.messages[u])&&t(6,I=JSON.parse(JSON.stringify(f.messages[u])))},[a,c,g,h,v,E,I,y,B,L,T,l,s,r,i,o,R,O,C,P,S,f,u,p,w,W,ne,ue,te,ie,G,Q,he,de,Z,z,ae,re,pe,ye,A]}class Ca extends Te{constructor(e){super(),Be(this,e,Va,Na,Ve,{user:0,history:21,messageId:22,siblings:1,showPreviousMessage:2,showNextMessage:3,editMessage:23,deleteMessage:24,isFirstMessage:4,readOnly:5},null,[-1,-1])}}function on(n){let e,t,l,s;const r=[Ra,Ba,Ta],i=[];function o(a,f){var u,c;return a[0].messages[a[3]].role==="user"?0:(((c=(u=a[0].messages[a[0].messages[a[3]].parentId])==null?void 0:u.models)==null?void 0:c.length)??1)===1?1:2}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=fe()},l(a){t.l(a),l=fe()},m(a,f){i[e].m(a,f),V(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(le(),D(i[u],1,1,()=>{i[u]=null}),se(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){s||(b(t),s=!0)},o(a){D(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function Ta(n){var i;let e,t,l;function s(o){n[21](o)}let r={chatId:n[1],messageId:n[3],isLastMessage:n[3]===((i=n[0])==null?void 0:i.currentId),updateChat:n[7],editMessage:n[8],saveMessage:n[9],rateMessage:n[11],actionMessage:n[12],submitMessage:n[13],deleteMessage:n[10],continueResponse:n[15],regenerateResponse:n[14],mergeResponses:n[16],triggerScroll:n[18],addMessages:n[17],readOnly:n[19]};return n[0]!==void 0&&(r.history=n[0]),e=new ha({props:r}),je.push(()=>Ke(e,"history",s)),{c(){X(e.$$.fragment)},l(o){Y(e.$$.fragment,o)},m(o,a){$(e,o,a),l=!0},p(o,a){var u;const f={};a&2&&(f.chatId=o[1]),a&8&&(f.messageId=o[3]),a&9&&(f.isLastMessage=o[3]===((u=o[0])==null?void 0:u.currentId)),a&128&&(f.updateChat=o[7]),a&256&&(f.editMessage=o[8]),a&512&&(f.saveMessage=o[9]),a&2048&&(f.rateMessage=o[11]),a&4096&&(f.actionMessage=o[12]),a&8192&&(f.submitMessage=o[13]),a&1024&&(f.deleteMessage=o[10]),a&32768&&(f.continueResponse=o[15]),a&16384&&(f.regenerateResponse=o[14]),a&65536&&(f.mergeResponses=o[16]),a&262144&&(f.triggerScroll=o[18]),a&131072&&(f.addMessages=o[17]),a&524288&&(f.readOnly=o[19]),!t&&a&1&&(t=!0,f.history=o[0],Ze(()=>t=!1)),e.$set(f)},i(o){l||(b(e.$$.fragment,o),l=!0)},o(o){D(e.$$.fragment,o),l=!1},d(o){x(e,o)}}}function Ba(n){var l;let e,t;return e=new Ln({props:{chatId:n[1],history:n[0],messageId:n[3],isLastMessage:n[3]===n[0].currentId,siblings:((l=n[0].messages[n[0].messages[n[3]].parentId])==null?void 0:l.childrenIds)??[],showPreviousMessage:n[5],showNextMessage:n[6],updateChat:n[7],editMessage:n[8],saveMessage:n[9],rateMessage:n[11],actionMessage:n[12],submitMessage:n[13],deleteMessage:n[10],continueResponse:n[15],regenerateResponse:n[14],addMessages:n[17],readOnly:n[19]}}),{c(){X(e.$$.fragment)},l(s){Y(e.$$.fragment,s)},m(s,r){$(e,s,r),t=!0},p(s,r){var o;const i={};r&2&&(i.chatId=s[1]),r&1&&(i.history=s[0]),r&8&&(i.messageId=s[3]),r&9&&(i.isLastMessage=s[3]===s[0].currentId),r&9&&(i.siblings=((o=s[0].messages[s[0].messages[s[3]].parentId])==null?void 0:o.childrenIds)??[]),r&32&&(i.showPreviousMessage=s[5]),r&64&&(i.showNextMessage=s[6]),r&128&&(i.updateChat=s[7]),r&256&&(i.editMessage=s[8]),r&512&&(i.saveMessage=s[9]),r&2048&&(i.rateMessage=s[11]),r&4096&&(i.actionMessage=s[12]),r&8192&&(i.submitMessage=s[13]),r&1024&&(i.deleteMessage=s[10]),r&32768&&(i.continueResponse=s[15]),r&16384&&(i.regenerateResponse=s[14]),r&131072&&(i.addMessages=s[17]),r&524288&&(i.readOnly=s[19]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){x(e,s)}}}function Ra(n){var l;let e,t;return e=new Ca({props:{user:n[4],history:n[0],messageId:n[3],isFirstMessage:n[2]===0,siblings:n[0].messages[n[3]].parentId!==null?((l=n[0].messages[n[0].messages[n[3]].parentId])==null?void 0:l.childrenIds)??[]:Object.values(n[0].messages).filter(an).map(fn)??[],showPreviousMessage:n[5],showNextMessage:n[6],editMessage:n[8],deleteMessage:n[10],readOnly:n[19]}}),{c(){X(e.$$.fragment)},l(s){Y(e.$$.fragment,s)},m(s,r){$(e,s,r),t=!0},p(s,r){var o;const i={};r&16&&(i.user=s[4]),r&1&&(i.history=s[0]),r&8&&(i.messageId=s[3]),r&4&&(i.isFirstMessage=s[2]===0),r&9&&(i.siblings=s[0].messages[s[3]].parentId!==null?((o=s[0].messages[s[0].messages[s[3]].parentId])==null?void 0:o.childrenIds)??[]:Object.values(s[0].messages).filter(an).map(fn)??[]),r&32&&(i.showPreviousMessage=s[5]),r&64&&(i.showNextMessage=s[6]),r&256&&(i.editMessage=s[8]),r&1024&&(i.deleteMessage=s[10]),r&524288&&(i.readOnly=s[19]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){x(e,s)}}}function Sa(n){let e,t,l,s=n[0].messages[n[3]]&&on(n);return{c(){e=M("div"),s&&s.c(),this.h()},l(r){e=N(r,"DIV",{class:!0});var i=k(e);s&&s.l(i),i.forEach(m),this.h()},h(){var r;d(e,"class",t="flex flex-col justify-between px-5 mb-3 w-full "+(((r=n[20])==null?void 0:r.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group")},m(r,i){V(r,e,i),s&&s.m(e,null),l=!0},p(r,[i]){var o;r[0].messages[r[3]]?s?(s.p(r,i),i&9&&b(s,1)):(s=on(r),s.c(),b(s,1),s.m(e,null)):s&&(le(),D(s,1,1,()=>{s=null}),se()),(!l||i&1048576&&t!==(t="flex flex-col justify-between px-5 mb-3 w-full "+(((o=r[20])==null?void 0:o.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group"))&&d(e,"class",t)},i(r){l||(b(s),l=!0)},o(r){D(s),l=!1},d(r){r&&m(e),s&&s.d()}}}const an=n=>n.parentId===null,fn=n=>n.id;function Oa(n,e,t){let l;Ie(n,Ht,C=>t(20,l=C)),gt(),qe("i18n");let{chatId:s}=e,{idx:r=0}=e,{history:i}=e,{messageId:o}=e,{user:a}=e,{showPreviousMessage:f}=e,{showNextMessage:u}=e,{updateChat:c}=e,{editMessage:g}=e,{saveMessage:h}=e,{deleteMessage:p}=e,{rateMessage:w}=e,{actionMessage:v}=e,{submitMessage:E}=e,{regenerateResponse:y}=e,{continueResponse:B}=e,{mergeResponses:L}=e,{addMessages:T}=e,{triggerScroll:I}=e,{readOnly:R=!1}=e;function O(C){i=C,t(0,i)}return n.$$set=C=>{"chatId"in C&&t(1,s=C.chatId),"idx"in C&&t(2,r=C.idx),"history"in C&&t(0,i=C.history),"messageId"in C&&t(3,o=C.messageId),"user"in C&&t(4,a=C.user),"showPreviousMessage"in C&&t(5,f=C.showPreviousMessage),"showNextMessage"in C&&t(6,u=C.showNextMessage),"updateChat"in C&&t(7,c=C.updateChat),"editMessage"in C&&t(8,g=C.editMessage),"saveMessage"in C&&t(9,h=C.saveMessage),"deleteMessage"in C&&t(10,p=C.deleteMessage),"rateMessage"in C&&t(11,w=C.rateMessage),"actionMessage"in C&&t(12,v=C.actionMessage),"submitMessage"in C&&t(13,E=C.submitMessage),"regenerateResponse"in C&&t(14,y=C.regenerateResponse),"continueResponse"in C&&t(15,B=C.continueResponse),"mergeResponses"in C&&t(16,L=C.mergeResponses),"addMessages"in C&&t(17,T=C.addMessages),"triggerScroll"in C&&t(18,I=C.triggerScroll),"readOnly"in C&&t(19,R=C.readOnly)},[i,s,r,o,a,f,u,c,g,h,p,w,v,E,y,B,L,T,I,R,l,O]}class La extends Te{constructor(e){super(),Be(this,e,Oa,Sa,Ve,{chatId:1,idx:2,history:0,messageId:3,user:4,showPreviousMessage:5,showNextMessage:6,updateChat:7,editMessage:8,saveMessage:9,deleteMessage:10,rateMessage:11,actionMessage:12,submitMessage:13,regenerateResponse:14,continueResponse:15,mergeResponses:16,addMessages:17,triggerScroll:18,readOnly:19})}}function Pa(n){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width",n[1]),d(e,"stroke","currentColor"),d(e,"class",n[0])},m(l,s){V(l,e,s),_(e,t)},p(l,[s]){s&2&&d(e,"stroke-width",l[1]),s&1&&d(e,"class",l[0])},i:ve,o:ve,d(l){l&&m(e)}}}function Aa(n,e,t){let{className:l="size-3"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class ja extends Te{constructor(e){super(),Be(this,e,Aa,Pa,Ve,{className:0,strokeWidth:1})}}function un(n,e,t){const l=n.slice();return l[13]=e[t],l[15]=t,l}function Ha(n){let e,t,l,s;return{c(){e=M("div"),t=U(n[3]),l=U(" ‧ v"),s=U(hl),this.h()},l(r){e=N(r,"DIV",{class:!0});var i=k(e);t=q(i,n[3]),l=q(i," ‧ v"),s=q(i,hl),i.forEach(m),this.h()},h(){d(e,"class","flex w-full text-center items-center justify-center self-start text-gray-400 dark:text-gray-600")},m(r,i){V(r,e,i),_(e,t),_(e,l),_(e,s)},p(r,i){i&8&&K(t,r[3])},i:ve,o:ve,d(r){r&&m(e)}}}function za(n){let e,t,l=n[2].t("Suggested")+"",s,r;return e=new ja({}),{c(){X(e.$$.fragment),t=j(),s=U(l)},l(i){Y(e.$$.fragment,i),t=H(i),s=q(i,l)},m(i,o){$(e,i,o),V(i,t,o),V(i,s,o),r=!0},p(i,o){(!r||o&4)&&l!==(l=i[2].t("Suggested")+"")&&K(s,l)},i(i){r||(b(e.$$.fragment,i),r=!0)},o(i){D(e.$$.fragment,i),r=!1},d(i){i&&(m(t),m(s)),x(e,i)}}}function cn(n){let e=[],t=new Map,l,s=Ee(n[1]);const r=i=>i[13].id||i[13].content;for(let i=0;i<s.length;i+=1){let o=un(n,s,i),a=r(o);t.set(a,e[i]=dn(a,o))}return{c(){for(let i=0;i<e.length;i+=1)e[i].c();l=fe()},l(i){for(let o=0;o<e.length;o+=1)e[o].l(i);l=fe()},m(i,o){for(let a=0;a<e.length;a+=1)e[a]&&e[a].m(i,o);V(i,l,o)},p(i,o){o&38&&(s=Ee(i[1]),e=Gt(e,o,r,1,i,s,t,l.parentNode,nr,dn,l,un))},d(i){i&&m(l);for(let o=0;o<e.length;o+=1)e[o].d(i)}}}function Wa(n){let e,t=n[13].content+"",l,s,r,i=n[2].t("Prompt")+"",o;return{c(){e=M("div"),l=U(t),s=j(),r=M("div"),o=U(i),this.h()},l(a){e=N(a,"DIV",{class:!0});var f=k(e);l=q(f,t),f.forEach(m),s=H(a),r=N(a,"DIV",{class:!0});var u=k(r);o=q(u,i),u.forEach(m),this.h()},h(){d(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),d(r,"class","text-xs text-gray-500 font-normal line-clamp-1")},m(a,f){V(a,e,f),_(e,l),V(a,s,f),V(a,r,f),_(r,o)},p(a,f){f&2&&t!==(t=a[13].content+"")&&K(l,t),f&4&&i!==(i=a[2].t("Prompt")+"")&&K(o,i)},d(a){a&&(m(e),m(s),m(r))}}}function Ua(n){let e,t=n[13].title[0]+"",l,s,r,i=n[13].title[1]+"",o;return{c(){e=M("div"),l=U(t),s=j(),r=M("div"),o=U(i),this.h()},l(a){e=N(a,"DIV",{class:!0});var f=k(e);l=q(f,t),f.forEach(m),s=H(a),r=N(a,"DIV",{class:!0});var u=k(r);o=q(u,i),u.forEach(m),this.h()},h(){d(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),d(r,"class","text-xs text-gray-500 font-normal line-clamp-1")},m(a,f){V(a,e,f),_(e,l),V(a,s,f),V(a,r,f),_(r,o)},p(a,f){f&2&&t!==(t=a[13].title[0]+"")&&K(l,t),f&2&&i!==(i=a[13].title[1]+"")&&K(o,i)},d(a){a&&(m(e),m(s),m(r))}}}function dn(n,e){let t,l,s,r,i;function o(c,g){return c[13].title&&c[13].title[0]!==""?Ua:Wa}let a=o(e),f=a(e);function u(){return e[9](e[13])}return{key:n,first:null,c(){t=M("button"),l=M("div"),f.c(),s=j(),this.h()},l(c){t=N(c,"BUTTON",{class:!0,style:!0});var g=k(t);l=N(g,"DIV",{class:!0});var h=k(l);f.l(h),h.forEach(m),s=H(g),g.forEach(m),this.h()},h(){d(l,"class","flex flex-col text-left"),d(t,"class","waterfall flex flex-col flex-1 shrink-0 w-full justify-between px-3 py-2 rounded-xl bg-transparent hover:bg-black/5 dark:hover:bg-white/5 transition group svelte-1co34if"),St(t,"animation-delay",e[15]*60+"ms"),this.first=t},m(c,g){V(c,t,g),_(t,l),f.m(l,null),_(t,s),r||(i=_e(t,"click",u),r=!0)},p(c,g){e=c,a===(a=o(e))&&f?f.p(e,g):(f.d(1),f=a(e),f&&(f.c(),f.m(l,null))),g&2&&St(t,"animation-delay",e[15]*60+"ms")},d(c){c&&m(t),f.d(),r=!1,i()}}}function qa(n){let e,t,l,s,r,i,o;const a=[za,Ha],f=[];function u(g,h){return g[1].length>0?0:1}t=u(n),l=f[t]=a[t](n);let c=n[1].length>0&&cn(n);return{c(){e=M("div"),l.c(),s=j(),r=M("div"),c&&c.c(),this.h()},l(g){e=N(g,"DIV",{class:!0});var h=k(e);l.l(h),h.forEach(m),s=H(g),r=N(g,"DIV",{class:!0});var p=k(r);c&&c.l(p),p.forEach(m),this.h()},h(){d(e,"class","mb-1 flex gap-1 text-xs font-medium items-center text-gray-400 dark:text-gray-600"),d(r,"class",i="h-40 overflow-auto scrollbar-none "+n[0]+" items-start svelte-1co34if")},m(g,h){V(g,e,h),f[t].m(e,null),V(g,s,h),V(g,r,h),c&&c.m(r,null),o=!0},p(g,[h]){let p=t;t=u(g),t===p?f[t].p(g,h):(le(),D(f[p],1,1,()=>{f[p]=null}),se(),l=f[t],l?l.p(g,h):(l=f[t]=a[t](g),l.c()),b(l,1),l.m(e,null)),g[1].length>0?c?c.p(g,h):(c=cn(g),c.c(),c.m(r,null)):c&&(c.d(1),c=null),(!o||h&1&&i!==(i="h-40 overflow-auto scrollbar-none "+g[0]+" items-start svelte-1co34if"))&&d(r,"class",i)},i(g){o||(b(l),o=!0)},o(g){D(l),o=!1},d(g){g&&(m(e),m(s),m(r)),f[t].d(),c&&c.d()}}}function Fa(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if((n[t].id??n[t].content)!==(e[t].id??e[t].content))return!1;return!0}function Ja(n,e,t){let l,s;Ie(n,ar,v=>t(3,s=v));const r=qe("i18n");Ie(n,r,v=>t(2,l=v));const i=gt();let{suggestionPrompts:o=[]}=e,{className:a=""}=e,{inputValue:f=""}=e,u=[];const c={keys:["content","title"],threshold:.5};let g,h=[];const p=v=>{if(v.length>500)t(1,h=[]);else{const E=v.trim()?g.search(v.trim()).map(y=>y.item):u;Fa(h,E)||t(1,h=E)}},w=v=>i("select",v.content);return n.$$set=v=>{"suggestionPrompts"in v&&t(6,o=v.suggestionPrompts),"className"in v&&t(0,a=v.className),"inputValue"in v&&t(7,f=v.inputValue)},n.$$.update=()=>{n.$$.dirty&192&&o&&(t(8,u=[...o??[]].sort(()=>Math.random()-.5)),p(f)),n.$$.dirty&256&&(g=new Dr(u,c)),n.$$.dirty&128&&p(f)},[a,h,l,s,r,i,o,f,u,w]}class Ga extends Te{constructor(e){super(),Be(this,e,Ja,qa,Ve,{suggestionPrompts:6,className:0,inputValue:7})}}function Za(n){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width",n[1]),d(e,"stroke","currentColor"),d(e,"class",n[0])},m(l,s){V(l,e,s),_(e,t)},p(l,[s]){s&2&&d(e,"stroke-width",l[1]),s&1&&d(e,"class",l[0])},i:ve,o:ve,d(l){l&&m(e)}}}function Ka(n,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class Qa extends Te{constructor(e){super(),Be(this,e,Ka,Za,Ve,{className:0,strokeWidth:1})}}function hn(n,e,t){const l=n.slice();return l[13]=e[t],l[15]=t,l}function Xa(n){let e,t;return{c(){e=M("img"),this.h()},l(l){e=N(l,"IMG",{crossorigin:!0,src:!0,class:!0,alt:!0,draggable:!0}),this.h()},h(){var l,s,r;d(e,"crossorigin","anonymous"),Ot(e.src,t=((r=(s=(l=n[13])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:r.profile_image_url)??(n[4].language==="dg-DG"?"/doge.png":`${Lt}/static/favicon.png`))||d(e,"src",t),d(e,"class","size-[2.7rem] rounded-full border-[1px] border-gray-200 dark:border-none"),d(e,"alt","logo"),d(e,"draggable","false")},m(l,s){V(l,e,s)},p(l,s){var r,i,o;s&17&&!Ot(e.src,t=((o=(i=(r=l[13])==null?void 0:r.info)==null?void 0:i.meta)==null?void 0:o.profile_image_url)??(l[4].language==="dg-DG"?"/doge.png":`${Lt}/static/favicon.png`))&&d(e,"src",t)},d(l){l&&m(e)}}}function mn(n){var a,f,u;let e,t,l,s,r,i;t=new Re({props:{content:At.parse(pt(((u=(f=(a=n[0][n[3]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.description)??"")),placement:"right",$$slots:{default:[Xa]},$$scope:{ctx:n}}});function o(){return n[11](n[15])}return{c(){e=M("button"),X(t.$$.fragment),l=j()},l(c){e=N(c,"BUTTON",{});var g=k(e);Y(t.$$.fragment,g),l=H(g),g.forEach(m)},m(c,g){V(c,e,g),$(t,e,null),_(e,l),s=!0,r||(i=_e(e,"click",o),r=!0)},p(c,g){var p,w,v;n=c;const h={};g&9&&(h.content=At.parse(pt(((v=(w=(p=n[0][n[3]])==null?void 0:p.info)==null?void 0:w.meta)==null?void 0:v.description)??""))),g&65553&&(h.$$scope={dirty:g,ctx:n}),t.$set(h)},i(c){s||(b(t.$$.fragment,c),s=!0)},o(c){D(t.$$.fragment,c),s=!1},d(c){c&&m(e),x(t),r=!1,i()}}}function gn(n){let e,t;return e=new Re({props:{content:"This chat won't appear in history and your messages will not be saved.",className:"w-fit",placement:"top-start",$$slots:{default:[Ya]},$$scope:{ctx:n}}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ya(n){let e,t,l,s;return t=new Qa({props:{strokeWidth:"2.5",className:"size-5"}}),{c(){e=M("div"),X(t.$$.fragment),l=U(" Temporary Chat"),this.h()},l(r){e=N(r,"DIV",{class:!0});var i=k(e);Y(t.$$.fragment,i),l=q(i," Temporary Chat"),i.forEach(m),this.h()},h(){d(e,"class","flex items-center gap-2 text-gray-500 font-medium text-lg my-2 w-fit")},m(r,i){V(r,e,i),$(t,e,null),_(e,l),s=!0},p:ve,i(r){s||(b(t.$$.fragment,r),s=!0)},o(r){D(t.$$.fragment,r),s=!1},d(r){r&&m(e),x(t)}}}function $a(n){let e=n[4].t("Hello, {{name}}",{name:n[6].name})+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&80&&e!==(e=l[4].t("Hello, {{name}}",{name:l[6].name})+"")&&K(t,e)},d(l){l&&m(t)}}}function xa(n){var l;let e=((l=n[0][n[3]])==null?void 0:l.name)+"",t;return{c(){t=U(e)},l(s){t=q(s,e)},m(s,r){V(s,t,r)},p(s,r){var i;r&9&&e!==(e=((i=s[0][s[3]])==null?void 0:i.name)+"")&&K(t,e)},d(s){s&&m(t)}}}function ef(n){let e,t=n[4].t("How can I help you today?")+"",l;return{c(){e=M("div"),l=U(t),this.h()},l(s){e=N(s,"DIV",{class:!0});var r=k(e);l=q(r,t),r.forEach(m),this.h()},h(){d(e,"class","font-medium text-gray-400 dark:text-gray-500 line-clamp-1 font-p")},m(s,r){V(s,e,r),_(e,l)},p(s,r){r&16&&t!==(t=s[4].t("How can I help you today?")+"")&&K(l,t)},d(s){s&&m(e)}}}function tf(n){var o,a,f,u,c,g;let e,t,l=At.parse(pt((f=(a=(o=n[0][n[3]])==null?void 0:o.info)==null?void 0:a.meta)==null?void 0:f.description))+"",s,r,i=((g=(c=(u=n[0][n[3]])==null?void 0:u.info)==null?void 0:c.meta)==null?void 0:g.user)&&_n(n);return{c(){e=M("div"),t=new lr(!1),s=j(),i&&i.c(),r=fe(),this.h()},l(h){e=N(h,"DIV",{class:!0});var p=k(e);t=sr(p,!1),p.forEach(m),s=H(h),i&&i.l(h),r=fe(),this.h()},h(){t.a=null,d(e,"class","mt-0.5 text-base font-normal text-gray-500 dark:text-gray-400 line-clamp-3 markdown")},m(h,p){V(h,e,p),t.m(l,e),V(h,s,p),i&&i.m(h,p),V(h,r,p)},p(h,p){var w,v,E,y,B,L;p&9&&l!==(l=At.parse(pt((E=(v=(w=h[0][h[3]])==null?void 0:w.info)==null?void 0:v.meta)==null?void 0:E.description))+"")&&t.p(l),(L=(B=(y=h[0][h[3]])==null?void 0:y.info)==null?void 0:B.meta)!=null&&L.user?i?i.p(h,p):(i=_n(h),i.c(),i.m(r.parentNode,r)):i&&(i.d(1),i=null)},d(h){h&&(m(e),m(s),m(r)),i&&i.d(h)}}}function _n(n){let e,t;function l(i,o){var a,f,u;return(u=(f=(a=i[0][i[3]])==null?void 0:a.info)==null?void 0:f.meta)!=null&&u.user.community?sf:lf}let s=l(n),r=s(n);return{c(){e=M("div"),t=U(`By
								`),r.c(),this.h()},l(i){e=N(i,"DIV",{class:!0});var o=k(e);t=q(o,`By
								`),r.l(o),o.forEach(m),this.h()},h(){d(e,"class","mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500")},m(i,o){V(i,e,o),_(e,t),r.m(e,null)},p(i,o){s===(s=l(i))&&r?r.p(i,o):(r.d(1),r=s(i),r&&(r.c(),r.m(e,null)))},d(i){i&&m(e),r.d()}}}function lf(n){var l,s,r;let e=((r=(s=(l=n[0][n[3]])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:r.user.name)+"",t;return{c(){t=U(e)},l(i){t=q(i,e)},m(i,o){V(i,t,o)},p(i,o){var a,f,u;o&9&&e!==(e=((u=(f=(a=i[0][i[3]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.user.name)+"")&&K(t,e)},d(i){i&&m(t)}}}function sf(n){var r,i,o,a,f,u,c,g,h;let e,t=((o=(i=(r=n[0][n[3]])==null?void 0:r.info)==null?void 0:i.meta)!=null&&o.user.name?(u=(f=(a=n[0][n[3]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.user.name:`@${(h=(g=(c=n[0][n[3]])==null?void 0:c.info)==null?void 0:g.meta)==null?void 0:h.user.username}`)+"",l,s;return{c(){e=M("a"),l=U(t),this.h()},l(p){e=N(p,"A",{href:!0});var w=k(e);l=q(w,t),w.forEach(m),this.h()},h(){var p,w,v;d(e,"href",s="https://openwebui.com/m/"+((v=(w=(p=n[0][n[3]])==null?void 0:p.info)==null?void 0:w.meta)==null?void 0:v.user.username))},m(p,w){V(p,e,w),_(e,l)},p(p,w){var v,E,y,B,L,T,I,R,O,C,P,S;w&9&&t!==(t=((y=(E=(v=p[0][p[3]])==null?void 0:v.info)==null?void 0:E.meta)!=null&&y.user.name?(T=(L=(B=p[0][p[3]])==null?void 0:B.info)==null?void 0:L.meta)==null?void 0:T.user.name:`@${(O=(R=(I=p[0][p[3]])==null?void 0:I.info)==null?void 0:R.meta)==null?void 0:O.user.username}`)+"")&&K(l,t),w&9&&s!==(s="https://openwebui.com/m/"+((S=(P=(C=p[0][p[3]])==null?void 0:C.info)==null?void 0:P.meta)==null?void 0:S.user.username))&&d(e,"href",s)},d(p){p&&m(e)}}}function vn(n){var ne,ue,te,ie;let e,t,l,s,r,i,o,a,f,u,c,g,h,p,w,v,E,y,B=Ee(n[0]),L=[];for(let G=0;G<B.length;G+=1)L[G]=mn(hn(n,B,G));const T=G=>D(L[G],1,1,()=>{L[G]=null});let I=n[5]&&gn(n);function R(G,Q){var he;return(he=G[0][G[3]])!=null&&he.name?xa:$a}let O=R(n),C=O(n);function P(G,Q){var he,de,Z;return((Z=(de=(he=G[0][G[3]])==null?void 0:he.info)==null?void 0:de.meta)==null?void 0:Z.description)??null?tf:ef}let S=P(n),W=S(n);return v=new Ga({props:{className:"grid grid-cols-2",suggestionPrompts:((te=(ue=(ne=n[0][n[3]])==null?void 0:ne.info)==null?void 0:ue.meta)==null?void 0:te.suggestion_prompts)??((ie=n[7])==null?void 0:ie.default_prompt_suggestions)??[]}}),v.$on("select",n[12]),{c(){e=M("div"),t=M("div"),l=M("div");for(let G=0;G<L.length;G+=1)L[G].c();r=j(),I&&I.c(),i=j(),o=M("div"),a=M("div"),f=M("div"),C.c(),c=j(),g=M("div"),W.c(),p=j(),w=M("div"),X(v.$$.fragment),this.h()},l(G){e=N(G,"DIV",{class:!0});var Q=k(e);t=N(Q,"DIV",{class:!0});var he=k(t);l=N(he,"DIV",{class:!0});var de=k(l);for(let ye=0;ye<L.length;ye+=1)L[ye].l(de);de.forEach(m),he.forEach(m),r=H(Q),I&&I.l(Q),i=H(Q),o=N(Q,"DIV",{class:!0});var Z=k(o);a=N(Z,"DIV",{});var z=k(a);f=N(z,"DIV",{class:!0});var ae=k(f);C.l(ae),ae.forEach(m),c=H(z),g=N(z,"DIV",{});var re=k(g);W.l(re),re.forEach(m),z.forEach(m),Z.forEach(m),p=H(Q),w=N(Q,"DIV",{class:!0});var pe=k(w);Y(v.$$.fragment,pe),pe.forEach(m),Q.forEach(m),this.h()},h(){d(l,"class","flex -space-x-4 mb-0.5"),d(t,"class","flex justify-start"),d(f,"class","capitalize line-clamp-1"),d(o,"class","mt-2 mb-4 text-3xl text-gray-800 dark:text-gray-100 font-medium text-left flex items-center gap-4 font-primary"),d(w,"class","w-full font-primary"),d(e,"class","m-auto w-full max-w-6xl px-8 lg:px-20")},m(G,Q){V(G,e,Q),_(e,t),_(t,l);for(let he=0;he<L.length;he+=1)L[he]&&L[he].m(l,null);_(e,r),I&&I.m(e,null),_(e,i),_(e,o),_(o,a),_(a,f),C.m(f,null),_(a,c),_(a,g),W.m(g,null),_(e,p),_(e,w),$(v,w,null),y=!0},p(G,Q){var de,Z,z,ae;if(Q&25){B=Ee(G[0]);let re;for(re=0;re<B.length;re+=1){const pe=hn(G,B,re);L[re]?(L[re].p(pe,Q),b(L[re],1)):(L[re]=mn(pe),L[re].c(),b(L[re],1),L[re].m(l,null))}for(le(),re=B.length;re<L.length;re+=1)T(re);se()}G[5]?I?Q&32&&b(I,1):(I=gn(G),I.c(),b(I,1),I.m(e,i)):I&&(le(),D(I,1,1,()=>{I=null}),se()),O===(O=R(G))&&C?C.p(G,Q):(C.d(1),C=O(G),C&&(C.c(),C.m(f,null))),S===(S=P(G))&&W?W.p(G,Q):(W.d(1),W=S(G),W&&(W.c(),W.m(g,null)));const he={};Q&137&&(he.suggestionPrompts=((z=(Z=(de=G[0][G[3]])==null?void 0:de.info)==null?void 0:Z.meta)==null?void 0:z.suggestion_prompts)??((ae=G[7])==null?void 0:ae.default_prompt_suggestions)??[]),v.$set(he)},i(G){if(!y){for(let Q=0;Q<B.length;Q+=1)b(L[Q]);G&&(s||Tt(()=>{s=Bt(l,Rt,{duration:200}),s.start()})),b(I),G&&(u||Tt(()=>{u=Bt(f,Rt,{duration:200}),u.start()})),G&&(h||Tt(()=>{h=Bt(g,Rt,{duration:200,delay:200}),h.start()})),b(v.$$.fragment,G),G&&(E||Tt(()=>{E=Bt(w,Rt,{duration:200,delay:300}),E.start()})),y=!0}},o(G){L=L.filter(Boolean);for(let Q=0;Q<L.length;Q+=1)D(L[Q]);D(I),D(v.$$.fragment,G),y=!1},d(G){G&&m(e),Ue(L,G),I&&I.d(),C.d(),W.d(),x(v)}}}function nf(n){let e=n[2],t,l,s=vn(n);return{c(){s.c(),t=fe()},l(r){s.l(r),t=fe()},m(r,i){s.m(r,i),V(r,t,i),l=!0},p(r,[i]){i&4&&Ve(e,e=r[2])?(le(),D(s,1,1,ve),se(),s=vn(r),s.c(),b(s,1),s.m(t.parentNode,t)):s.p(r,i)},i(r){l||(b(s),l=!0)},o(r){D(s),l=!1},d(r){r&&m(t),s.d(r)}}}function rf(n,e,t){let l,s,r,i,o;Ie(n,jt,v=>t(10,l=v)),Ie(n,Zt,v=>t(5,r=v)),Ie(n,zt,v=>t(6,i=v)),Ie(n,Mn,v=>t(7,o=v));const a=qe("i18n");Ie(n,a,v=>t(4,s=v));let{modelIds:f=[]}=e,{models:u=[]}=e,{submitPrompt:c}=e,g=!1,h=0;bt(()=>{t(2,g=!0)});const p=v=>{t(3,h=v)},w=v=>{c(v.detail)};return n.$$set=v=>{"modelIds"in v&&t(9,f=v.modelIds),"models"in v&&t(0,u=v.models),"submitPrompt"in v&&t(1,c=v.submitPrompt)},n.$$.update=()=>{n.$$.dirty&1536&&t(0,u=f.map(v=>l.find(E=>E.id===v))),n.$$.dirty&513&&f.length>0&&t(3,h=u.length-1)},[u,c,g,h,s,r,i,o,a,f,l,p,w]}class of extends Te{constructor(e){super(),Be(this,e,rf,nf,Ve,{modelIds:9,models:0,submitPrompt:1})}}function pn(n,e,t){const l=n.slice();return l[41]=e[t],l[43]=t,l}function af(n){let e,t=n[3],l,s=yn(n);return{c(){e=M("div"),s.c(),this.h()},l(r){e=N(r,"DIV",{class:!0});var i=k(e);s.l(i),i.forEach(m),this.h()},h(){d(e,"class","w-full pt-2")},m(r,i){V(r,e,i),s.m(e,null),l=!0},p(r,i){i[0]&8&&Ve(t,t=r[3])?(le(),D(s,1,1,ve),se(),s=yn(r),s.c(),b(s,1),s.m(e,null)):s.p(r,i)},i(r){l||(b(s),l=!0)},o(r){D(s),l=!1},d(r){r&&m(e),s.d(r)}}}function ff(n){let e,t;return e=new of({props:{modelIds:n[5],submitPrompt:n[32]}}),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&32&&(r.modelIds=l[5]),s[0]&32770&&(r.submitPrompt=l[32]),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function bn(n){let e,t;return e=new Nr({props:{$$slots:{default:[uf]},$$scope:{ctx:n}}}),e.$on("visible",n[33]),{c(){X(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[1]&8192&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function uf(n){let e,t,l,s,r="Loading...",i;return t=new Wt({props:{className:" size-4"}}),{c(){e=M("div"),X(t.$$.fragment),l=j(),s=M("div"),s.textContent=r,this.h()},l(o){e=N(o,"DIV",{class:!0});var a=k(e);Y(t.$$.fragment,a),l=H(a),s=N(a,"DIV",{class:!0,"data-svelte-h":!0}),Ae(s)!=="svelte-17uns3n"&&(s.textContent=r),a.forEach(m),this.h()},h(){d(s,"class",""),d(e,"class","w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2")},m(o,a){V(o,e,a),$(t,e,null),_(e,l),_(e,s),i=!0},p:ve,i(o){i||(b(t.$$.fragment,o),i=!0)},o(o){D(t.$$.fragment,o),i=!1},d(o){o&&m(e),x(t)}}}function kn(n,e){let t,l,s,r;function i(a){e[34](a)}let o={chatId:e[3],messageId:e[41].id,idx:e[43],user:e[4],showPreviousMessage:e[19],showNextMessage:e[20],updateChat:e[18],editMessage:e[22],deleteMessage:e[25],rateMessage:e[21],actionMessage:e[23],saveMessage:e[24],submitMessage:e[9],regenerateResponse:e[7],continueResponse:e[6],mergeResponses:e[8],addMessages:e[10],triggerScroll:e[26],readOnly:e[11]};return e[0]!==void 0&&(o.history=e[0]),l=new La({props:o}),je.push(()=>Ke(l,"history",i)),{key:n,first:null,c(){t=fe(),X(l.$$.fragment),this.h()},l(a){t=fe(),Y(l.$$.fragment,a),this.h()},h(){this.first=t},m(a,f){V(a,t,f),$(l,a,f),r=!0},p(a,f){e=a;const u={};f[0]&8&&(u.chatId=e[3]),f[0]&8192&&(u.messageId=e[41].id),f[0]&8192&&(u.idx=e[43]),f[0]&16&&(u.user=e[4]),f[0]&512&&(u.submitMessage=e[9]),f[0]&128&&(u.regenerateResponse=e[7]),f[0]&64&&(u.continueResponse=e[6]),f[0]&256&&(u.mergeResponses=e[8]),f[0]&1024&&(u.addMessages=e[10]),f[0]&2048&&(u.readOnly=e[11]),!s&&f[0]&1&&(s=!0,u.history=e[0],Ze(()=>s=!1)),l.$set(u)},i(a){r||(b(l.$$.fragment,a),r=!0)},o(a){D(l.$$.fragment,a),r=!1},d(a){a&&m(t),x(l,a)}}}function wn(n){let e;return{c(){e=M("div"),this.h()},l(t){e=N(t,"DIV",{class:!0}),k(e).forEach(m),this.h()},h(){d(e,"class","pb-6")},m(t,l){V(t,e,l)},d(t){t&&m(e)}}}function yn(n){var w;let e,t=((w=n[13].at(0))==null?void 0:w.parentId)!==null,l,s=[],r=new Map,i,o,a,f,u,c=t&&bn(n),g=Ee(n[13]);const h=v=>v[41].id;for(let v=0;v<g.length;v+=1){let E=pn(n,g,v),y=h(E);r.set(y,s[v]=kn(y,E))}let p=n[12]&&wn();return{c(){e=M("div"),c&&c.c(),l=j();for(let v=0;v<s.length;v+=1)s[v].c();i=j(),o=M("div"),a=j(),p&&p.c(),f=fe(),this.h()},l(v){e=N(v,"DIV",{class:!0});var E=k(e);c&&c.l(E),l=H(E);for(let y=0;y<s.length;y+=1)s[y].l(E);E.forEach(m),i=H(v),o=N(v,"DIV",{class:!0}),k(o).forEach(m),a=H(v),p&&p.l(v),f=fe(),this.h()},h(){d(e,"class","w-full"),d(o,"class","pb-12")},m(v,E){V(v,e,E),c&&c.m(e,null),_(e,l);for(let y=0;y<s.length;y+=1)s[y]&&s[y].m(e,null);V(v,i,E),V(v,o,E),V(v,a,E),p&&p.m(v,E),V(v,f,E),u=!0},p(v,E){var y;E[0]&8192&&(t=((y=v[13].at(0))==null?void 0:y.parentId)!==null),t?c?(c.p(v,E),E[0]&8192&&b(c,1)):(c=bn(v),c.c(),b(c,1),c.m(e,l)):c&&(le(),D(c,1,1,()=>{c=null}),se()),E[0]&133967833&&(g=Ee(v[13]),le(),s=Gt(s,E,h,1,v,g,r,e,In,kn,null,pn),se()),v[12]?p||(p=wn(),p.c(),p.m(f.parentNode,f)):p&&(p.d(1),p=null)},i(v){if(!u){b(c);for(let E=0;E<g.length;E+=1)b(s[E]);u=!0}},o(v){D(c);for(let E=0;E<s.length;E+=1)D(s[E]);u=!1},d(v){v&&(m(e),m(i),m(o),m(a),m(f)),c&&c.d();for(let E=0;E<s.length;E+=1)s[E].d();p&&p.d(v)}}}function cf(n){let e,t,l,s,r;const i=[ff,af],o=[];function a(f,u){var c;return u[0]&1&&(t=null),t==null&&(t=Object.keys(((c=f[0])==null?void 0:c.messages)??{}).length==0),t?0:1}return l=a(n,[-1,-1]),s=o[l]=i[l](n),{c(){e=M("div"),s.c(),this.h()},l(f){e=N(f,"DIV",{class:!0});var u=k(e);s.l(u),u.forEach(m),this.h()},h(){d(e,"class",n[2])},m(f,u){V(f,e,u),o[l].m(e,null),r=!0},p(f,u){let c=l;l=a(f,u),l===c?o[l].p(f,u):(le(),D(o[c],1,1,()=>{o[c]=null}),se(),s=o[l],s?s.p(f,u):(s=o[l]=i[l](f),s.c()),b(s,1),s.m(e,null)),(!r||u[0]&4)&&d(e,"class",f[2])},i(f){r||(b(s),r=!0)},o(f){D(s),r=!1},d(f){f&&m(e),o[l].d()}}}function df(n,e,t){let l,s,r,i,o;Ie(n,Ht,A=>t(35,l=A)),Ie(n,ml,A=>t(36,s=A)),Ie(n,Zt,A=>t(37,r=A)),Ie(n,zt,A=>t(38,i=A)),gt();const a=qe("i18n");Ie(n,a,A=>t(15,o=A));let{className:f="h-full flex pt-8"}=e,{chatId:u=""}=e,{user:c=i}=e,{prompt:g}=e,{history:h={}}=e,{selectedModels:p}=e,w=[],{sendPrompt:v}=e,{continueResponse:E}=e,{regenerateResponse:y}=e,{mergeResponses:B}=e,{chatActionHandler:L}=e,{showMessage:T=()=>{}}=e,{submitMessage:I=()=>{}}=e,{addMessages:R=()=>{}}=e,{readOnly:O=!1}=e,{bottomPadding:C=!1}=e,{autoScroll:P}=e,S=20,W=!1;const ne=async()=>{const A=document.getElementById("messages-container");A.scrollTop=A.scrollTop+100,t(14,W=!0),t(31,S+=20),await Ne(),t(14,W=!1)},ue=()=>{const A=document.getElementById("messages-container");A.scrollTop=A.scrollHeight},te=async()=>{r||(t(0,h),await Ne(),await cr(localStorage.token,u,{history:h,messages:w}),ml.set(1),await fr.set(await dr(localStorage.token,s)))},ie=async A=>{if(A.parentId!==null){let F=h.messages[A.parentId].childrenIds[Math.max(h.messages[A.parentId].childrenIds.indexOf(A.id)-1,0)];if(A.id!==F){let oe=h.messages[F].childrenIds;for(;oe.length!==0;)F=oe.at(-1),oe=h.messages[F].childrenIds;t(0,h.currentId=F,h)}}else{let F=Object.values(h.messages).filter(me=>me.parentId===null).map(me=>me.id),oe=F[Math.max(F.indexOf(A.id)-1,0)];if(A.id!==oe){let me=h.messages[oe].childrenIds;for(;me.length!==0;)oe=me.at(-1),me=h.messages[oe].childrenIds;t(0,h.currentId=oe,h)}}if(await Ne(),(l==null?void 0:l.scrollOnBranchChange)??!0){const F=document.getElementById("messages-container");t(27,P=F.scrollHeight-F.scrollTop<=F.clientHeight+50),setTimeout(()=>{ue()},100)}},G=async A=>{if(A.parentId!==null){let F=h.messages[A.parentId].childrenIds[Math.min(h.messages[A.parentId].childrenIds.indexOf(A.id)+1,h.messages[A.parentId].childrenIds.length-1)];if(A.id!==F){let oe=h.messages[F].childrenIds;for(;oe.length!==0;)F=oe.at(-1),oe=h.messages[F].childrenIds;t(0,h.currentId=F,h)}}else{let F=Object.values(h.messages).filter(me=>me.parentId===null).map(me=>me.id),oe=F[Math.min(F.indexOf(A.id)+1,F.length-1)];if(A.id!==oe){let me=h.messages[oe].childrenIds;for(;me.length!==0;)oe=me.at(-1),me=h.messages[oe].childrenIds;t(0,h.currentId=oe,h)}}if(await Ne(),(l==null?void 0:l.scrollOnBranchChange)??!0){const F=document.getElementById("messages-container");t(27,P=F.scrollHeight-F.scrollTop<=F.clientHeight+50),setTimeout(()=>{ue()},100)}},Q=async(A,F)=>{t(0,h.messages[A].annotation={...h.messages[A].annotation,rating:F},h),await te()},he=async(A,F,oe=!0)=>{if(h.messages[A].role==="user")if(oe){let me=F,ce=gl(),ee={id:ce,parentId:h.messages[A].parentId,childrenIds:[],role:"user",content:me,...h.messages[A].files&&{files:h.messages[A].files},models:p},ge=h.messages[A].parentId;ge!==null&&t(0,h.messages[ge].childrenIds=[...h.messages[ge].childrenIds,ce],h),t(0,h.messages[ce]=ee,h),t(0,h.currentId=ce,h),await Ne(),await v(h,me,ce)}else t(0,h.messages[A].content=F,h),await te();else if(oe){const me=gl(),ce=h.messages[A],ee=ce.parentId,ge={...ce,id:me,parentId:ee,childrenIds:[],files:void 0,content:F,timestamp:Math.floor(Date.now()/1e3)};t(0,h.messages[me]=ge,h),t(0,h.currentId=me,h),ee!==null&&t(0,h.messages[ee].childrenIds=[...h.messages[ee].childrenIds,me],h),await te()}else t(0,h.messages[A].originalContent=h.messages[A].content,h),t(0,h.messages[A].content=F,h),await te()},de=async(A,F,oe=null)=>{await L(u,A,F.model,F.id,oe)},Z=async(A,F)=>{t(0,h.messages[A]=F,h),await te()},z=async A=>{const F=h.messages[A],oe=F.parentId,me=F.childrenIds??[],ce=me.flatMap(ee=>{var ge;return((ge=h.messages[ee])==null?void 0:ge.childrenIds)??[]});oe&&h.messages[oe]&&t(0,h.messages[oe].childrenIds=[...h.messages[oe].childrenIds.filter(ee=>ee!==A),...ce],h),ce.forEach(ee=>{h.messages[ee]&&t(0,h.messages[ee].parentId=oe,h)}),[A,...me].forEach(ee=>{delete h.messages[ee]}),await Ne(),T({id:oe}),await te()},ae=()=>{if(P){const A=document.getElementById("messages-container");t(27,P=A.scrollHeight-A.scrollTop<=A.clientHeight+50),setTimeout(()=>{ue()},100)}},re=async A=>{let F=A;if(A.includes("{{CLIPBOARD}}")){const me=await navigator.clipboard.readText().catch(ce=>(Pe.error(o.t("Failed to read clipboard contents")),"{{CLIPBOARD}}"));F=A.replaceAll("{{CLIPBOARD}}",me)}t(1,g=F),await Ne();const oe=document.getElementById("chat-input-container");oe&&(t(1,g=A),oe.style.height="",oe.style.height=Math.min(oe.scrollHeight,200)+"px",oe.focus()),await Ne()},pe=A=>{console.log("visible"),W||ne()};function ye(A){h=A,t(0,h)}return n.$$set=A=>{"className"in A&&t(2,f=A.className),"chatId"in A&&t(3,u=A.chatId),"user"in A&&t(4,c=A.user),"prompt"in A&&t(1,g=A.prompt),"history"in A&&t(0,h=A.history),"selectedModels"in A&&t(5,p=A.selectedModels),"sendPrompt"in A&&t(28,v=A.sendPrompt),"continueResponse"in A&&t(6,E=A.continueResponse),"regenerateResponse"in A&&t(7,y=A.regenerateResponse),"mergeResponses"in A&&t(8,B=A.mergeResponses),"chatActionHandler"in A&&t(29,L=A.chatActionHandler),"showMessage"in A&&t(30,T=A.showMessage),"submitMessage"in A&&t(9,I=A.submitMessage),"addMessages"in A&&t(10,R=A.addMessages),"readOnly"in A&&t(11,O=A.readOnly),"bottomPadding"in A&&t(12,C=A.bottomPadding),"autoScroll"in A&&t(27,P=A.autoScroll)},n.$$.update=()=>{if(n.$$.dirty[0]&1|n.$$.dirty[1]&1)if(h.currentId){let A=[],F=h.messages[h.currentId];for(;F&&A.length<=S;)A.unshift({...F}),F=F.parentId!==null?h.messages[F.parentId]:null;t(13,w=A)}else t(13,w=[]);n.$$.dirty[0]&134221824&&P&&C&&(async()=>(await Ne(),ue()))()},[h,g,f,u,c,p,E,y,B,I,R,O,C,w,W,o,a,ne,te,ie,G,Q,he,de,Z,z,ae,P,v,L,T,S,re,pe,ye]}class Zf extends Te{constructor(e){super(),Be(this,e,df,cf,Ve,{className:2,chatId:3,user:4,prompt:1,history:0,selectedModels:5,sendPrompt:28,continueResponse:6,regenerateResponse:7,mergeResponses:8,chatActionHandler:29,showMessage:30,submitMessage:9,addMessages:10,readOnly:11,bottomPadding:12,autoScroll:27},null,[-1,-1])}}export{Qa as E,Zf as M,Ga as S};
//# sourceMappingURL=Messages.DNwopQIv.js.map
